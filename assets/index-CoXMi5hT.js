(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function mw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ly={exports:{}},ic={},Oy={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $a=Symbol.for("react.element"),gw=Symbol.for("react.portal"),yw=Symbol.for("react.fragment"),vw=Symbol.for("react.strict_mode"),_w=Symbol.for("react.profiler"),ww=Symbol.for("react.provider"),xw=Symbol.for("react.context"),Ew=Symbol.for("react.forward_ref"),Iw=Symbol.for("react.suspense"),Tw=Symbol.for("react.memo"),kw=Symbol.for("react.lazy"),rm=Symbol.iterator;function Sw(t){return t===null||typeof t!="object"?null:(t=rm&&t[rm]||t["@@iterator"],typeof t=="function"?t:null)}var Vy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fy=Object.assign,Uy={};function lo(t,e,n){this.props=t,this.context=e,this.refs=Uy,this.updater=n||Vy}lo.prototype.isReactComponent={};lo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};lo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zy(){}zy.prototype=lo.prototype;function Zh(t,e,n){this.props=t,this.context=e,this.refs=Uy,this.updater=n||Vy}var ef=Zh.prototype=new zy;ef.constructor=Zh;Fy(ef,lo.prototype);ef.isPureReactComponent=!0;var sm=Array.isArray,$y=Object.prototype.hasOwnProperty,tf={current:null},By={key:!0,ref:!0,__self:!0,__source:!0};function Wy(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)$y.call(e,r)&&!By.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:$a,type:t,key:i,ref:o,props:s,_owner:tf.current}}function Aw(t,e){return{$$typeof:$a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nf(t){return typeof t=="object"&&t!==null&&t.$$typeof===$a}function bw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var im=/\/+/g;function Gc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?bw(""+t.key):e.toString(36)}function Ql(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $a:case gw:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Gc(o,0):r,sm(s)?(n="",t!=null&&(n=t.replace(im,"$&/")+"/"),Ql(s,e,n,"",function(h){return h})):s!=null&&(nf(s)&&(s=Aw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(im,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",sm(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Gc(i,l);o+=Ql(i,e,n,u,s)}else if(u=Sw(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Gc(i,l++),o+=Ql(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function kl(t,e,n){if(t==null)return t;var r=[],s=0;return Ql(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Cw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},Xl={transition:null},Rw={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:Xl,ReactCurrentOwner:tf};function Hy(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:kl,forEach:function(t,e,n){kl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return kl(t,function(){e++}),e},toArray:function(t){return kl(t,function(e){return e})||[]},only:function(t){if(!nf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=lo;Te.Fragment=yw;Te.Profiler=_w;Te.PureComponent=Zh;Te.StrictMode=vw;Te.Suspense=Iw;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rw;Te.act=Hy;Te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Fy({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=tf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)$y.call(e,u)&&!By.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:$a,type:t.type,key:s,ref:i,props:r,_owner:o}};Te.createContext=function(t){return t={$$typeof:xw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ww,_context:t},t.Consumer=t};Te.createElement=Wy;Te.createFactory=function(t){var e=Wy.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:Ew,render:t}};Te.isValidElement=nf;Te.lazy=function(t){return{$$typeof:kw,_payload:{_status:-1,_result:t},_init:Cw}};Te.memo=function(t,e){return{$$typeof:Tw,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=Xl.transition;Xl.transition={};try{t()}finally{Xl.transition=e}};Te.unstable_act=Hy;Te.useCallback=function(t,e){return rn.current.useCallback(t,e)};Te.useContext=function(t){return rn.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};Te.useEffect=function(t,e){return rn.current.useEffect(t,e)};Te.useId=function(){return rn.current.useId()};Te.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};Te.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return rn.current.useMemo(t,e)};Te.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};Te.useRef=function(t){return rn.current.useRef(t)};Te.useState=function(t){return rn.current.useState(t)};Te.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};Te.useTransition=function(){return rn.current.useTransition()};Te.version="18.3.1";Oy.exports=Te;var Q=Oy.exports;const qy=mw(Q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pw=Q,Nw=Symbol.for("react.element"),Dw=Symbol.for("react.fragment"),Mw=Object.prototype.hasOwnProperty,jw=Pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lw={key:!0,ref:!0,__self:!0,__source:!0};function Gy(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Mw.call(e,r)&&!Lw.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Nw,type:t,key:i,ref:o,props:s,_owner:jw.current}}ic.Fragment=Dw;ic.jsx=Gy;ic.jsxs=Gy;Ly.exports=ic;var c=Ly.exports,Md={},Ky={exports:{}},Sn={},Qy={exports:{}},Xy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ee,B){var de=ee.length;ee.push(B);e:for(;0<de;){var le=de-1>>>1,Ce=ee[le];if(0<s(Ce,B))ee[le]=B,ee[de]=Ce,de=le;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var B=ee[0],de=ee.pop();if(de!==B){ee[0]=de;e:for(var le=0,Ce=ee.length,he=Ce>>>1;le<he;){var Qt=2*(le+1)-1,Xt=ee[Qt],bn=Qt+1,kt=ee[bn];if(0>s(Xt,de))bn<Ce&&0>s(kt,Xt)?(ee[le]=kt,ee[bn]=de,le=bn):(ee[le]=Xt,ee[Qt]=de,le=Qt);else if(bn<Ce&&0>s(kt,de))ee[le]=kt,ee[bn]=de,le=bn;else break e}}return B}function s(ee,B){var de=ee.sortIndex-B.sortIndex;return de!==0?de:ee.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],h=[],p=1,m=null,w=3,C=!1,M=!1,j=!1,F=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(ee){for(var B=n(h);B!==null;){if(B.callback===null)r(h);else if(B.startTime<=ee)r(h),B.sortIndex=B.expirationTime,e(u,B);else break;B=n(h)}}function P(ee){if(j=!1,T(ee),!M)if(n(u)!==null)M=!0,on(O);else{var B=n(h);B!==null&&Lt(P,B.startTime-ee)}}function O(ee,B){M=!1,j&&(j=!1,S(y),y=-1),C=!0;var de=w;try{for(T(B),m=n(u);m!==null&&(!(m.expirationTime>B)||ee&&!R());){var le=m.callback;if(typeof le=="function"){m.callback=null,w=m.priorityLevel;var Ce=le(m.expirationTime<=B);B=t.unstable_now(),typeof Ce=="function"?m.callback=Ce:m===n(u)&&r(u),T(B)}else r(u);m=n(u)}if(m!==null)var he=!0;else{var Qt=n(h);Qt!==null&&Lt(P,Qt.startTime-B),he=!1}return he}finally{m=null,w=de,C=!1}}var H=!1,E=null,y=-1,x=5,I=-1;function R(){return!(t.unstable_now()-I<x)}function N(){if(E!==null){var ee=t.unstable_now();I=ee;var B=!0;try{B=E(!0,ee)}finally{B?A():(H=!1,E=null)}}else H=!1}var A;if(typeof k=="function")A=function(){k(N)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,tt=fe.port2;fe.port1.onmessage=N,A=function(){tt.postMessage(null)}}else A=function(){F(N,0)};function on(ee){E=ee,H||(H=!0,A())}function Lt(ee,B){y=F(function(){ee(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){M||C||(M=!0,on(O))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(ee){switch(w){case 1:case 2:case 3:var B=3;break;default:B=w}var de=w;w=B;try{return ee()}finally{w=de}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,B){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var de=w;w=ee;try{return B()}finally{w=de}},t.unstable_scheduleCallback=function(ee,B,de){var le=t.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?le+de:le):de=le,ee){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=de+Ce,ee={id:p++,callback:B,priorityLevel:ee,startTime:de,expirationTime:Ce,sortIndex:-1},de>le?(ee.sortIndex=de,e(h,ee),n(u)===null&&ee===n(h)&&(j?(S(y),y=-1):j=!0,Lt(P,de-le))):(ee.sortIndex=Ce,e(u,ee),M||C||(M=!0,on(O))),ee},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(ee){var B=w;return function(){var de=w;w=B;try{return ee.apply(this,arguments)}finally{w=de}}}})(Xy);Qy.exports=Xy;var Ow=Qy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vw=Q,kn=Ow;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yy=new Set,pa={};function ri(t,e){Hi(t,e),Hi(t+"Capture",e)}function Hi(t,e){for(pa[t]=e,t=0;t<e.length;t++)Yy.add(e[t])}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jd=Object.prototype.hasOwnProperty,Fw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,om={},am={};function Uw(t){return jd.call(am,t)?!0:jd.call(om,t)?!1:Fw.test(t)?am[t]=!0:(om[t]=!0,!1)}function zw(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $w(t,e,n,r){if(e===null||typeof e>"u"||zw(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mt[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mt[e]=new sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mt[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mt[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mt[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mt[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mt[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mt[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mt[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var rf=/[\-:]([a-z])/g;function sf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rf,sf);Mt[e]=new sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rf,sf);Mt[e]=new sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rf,sf);Mt[e]=new sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mt[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mt[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function of(t,e,n,r){var s=Mt.hasOwnProperty(e)?Mt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($w(e,n,s,r)&&(n=null),r||s===null?Uw(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Br=Vw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sl=Symbol.for("react.element"),Ei=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),af=Symbol.for("react.strict_mode"),Ld=Symbol.for("react.profiler"),Jy=Symbol.for("react.provider"),Zy=Symbol.for("react.context"),lf=Symbol.for("react.forward_ref"),Od=Symbol.for("react.suspense"),Vd=Symbol.for("react.suspense_list"),uf=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),e0=Symbol.for("react.offscreen"),lm=Symbol.iterator;function Lo(t){return t===null||typeof t!="object"?null:(t=lm&&t[lm]||t["@@iterator"],typeof t=="function"?t:null)}var Ze=Object.assign,Kc;function Ho(t){if(Kc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kc=e&&e[1]||""}return`
`+Kc+t}var Qc=!1;function Xc(t,e){if(!t||Qc)return"";Qc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Qc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ho(t):""}function Bw(t){switch(t.tag){case 5:return Ho(t.type);case 16:return Ho("Lazy");case 13:return Ho("Suspense");case 19:return Ho("SuspenseList");case 0:case 2:case 15:return t=Xc(t.type,!1),t;case 11:return t=Xc(t.type.render,!1),t;case 1:return t=Xc(t.type,!0),t;default:return""}}function Fd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ii:return"Fragment";case Ei:return"Portal";case Ld:return"Profiler";case af:return"StrictMode";case Od:return"Suspense";case Vd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Zy:return(t.displayName||"Context")+".Consumer";case Jy:return(t._context.displayName||"Context")+".Provider";case lf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uf:return e=t.displayName||null,e!==null?e:Fd(t.type)||"Memo";case Jr:e=t._payload,t=t._init;try{return Fd(t(e))}catch{}}return null}function Ww(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fd(e);case 8:return e===af?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Es(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hw(t){var e=t0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Al(t){t._valueTracker||(t._valueTracker=Hw(t))}function n0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=t0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function yu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ud(t,e){var n=e.checked;return Ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function um(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Es(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function r0(t,e){e=e.checked,e!=null&&of(t,"checked",e,!1)}function zd(t,e){r0(t,e);var n=Es(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$d(t,e.type,n):e.hasOwnProperty("defaultValue")&&$d(t,e.type,Es(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $d(t,e,n){(e!=="number"||yu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qo=Array.isArray;function ji(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Es(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Bd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return Ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(qo(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Es(n)}}function s0(t,e){var n=Es(e.value),r=Es(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function hm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function i0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?i0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bl,o0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bl=bl||document.createElement("div"),bl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ma(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ea={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qw=["Webkit","ms","Moz","O"];Object.keys(ea).forEach(function(t){qw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ea[e]=ea[t]})});function a0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ea.hasOwnProperty(t)&&ea[t]?(""+e).trim():e+"px"}function l0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=a0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Gw=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hd(t,e){if(e){if(Gw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function qd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gd=null;function cf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kd=null,Li=null,Oi=null;function fm(t){if(t=Ha(t)){if(typeof Kd!="function")throw Error(X(280));var e=t.stateNode;e&&(e=cc(e),Kd(t.stateNode,t.type,e))}}function u0(t){Li?Oi?Oi.push(t):Oi=[t]:Li=t}function c0(){if(Li){var t=Li,e=Oi;if(Oi=Li=null,fm(t),e)for(t=0;t<e.length;t++)fm(e[t])}}function d0(t,e){return t(e)}function h0(){}var Yc=!1;function f0(t,e,n){if(Yc)return t(e,n);Yc=!0;try{return d0(t,e,n)}finally{Yc=!1,(Li!==null||Oi!==null)&&(h0(),c0())}}function ga(t,e){var n=t.stateNode;if(n===null)return null;var r=cc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var Qd=!1;if(Dr)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){Qd=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{Qd=!1}function Kw(t,e,n,r,s,i,o,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var ta=!1,vu=null,_u=!1,Xd=null,Qw={onError:function(t){ta=!0,vu=t}};function Xw(t,e,n,r,s,i,o,l,u){ta=!1,vu=null,Kw.apply(Qw,arguments)}function Yw(t,e,n,r,s,i,o,l,u){if(Xw.apply(this,arguments),ta){if(ta){var h=vu;ta=!1,vu=null}else throw Error(X(198));_u||(_u=!0,Xd=h)}}function si(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function p0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pm(t){if(si(t)!==t)throw Error(X(188))}function Jw(t){var e=t.alternate;if(!e){if(e=si(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return pm(s),t;if(i===r)return pm(s),e;i=i.sibling}throw Error(X(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function m0(t){return t=Jw(t),t!==null?g0(t):null}function g0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=g0(t);if(e!==null)return e;t=t.sibling}return null}var y0=kn.unstable_scheduleCallback,mm=kn.unstable_cancelCallback,Zw=kn.unstable_shouldYield,ex=kn.unstable_requestPaint,lt=kn.unstable_now,tx=kn.unstable_getCurrentPriorityLevel,df=kn.unstable_ImmediatePriority,v0=kn.unstable_UserBlockingPriority,wu=kn.unstable_NormalPriority,nx=kn.unstable_LowPriority,_0=kn.unstable_IdlePriority,oc=null,hr=null;function rx(t){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(oc,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:ox,sx=Math.log,ix=Math.LN2;function ox(t){return t>>>=0,t===0?32:31-(sx(t)/ix|0)|0}var Cl=64,Rl=4194304;function Go(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Go(l):(i&=o,i!==0&&(r=Go(i)))}else o=n&~s,o!==0?r=Go(o):i!==0&&(r=Go(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),s=1<<n,r|=t[n],e&=~s;return r}function ax(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-er(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=ax(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Yd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function w0(){var t=Cl;return Cl<<=1,!(Cl&4194240)&&(Cl=64),t}function Jc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ba(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function ux(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-er(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function hf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function x0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var E0,ff,I0,T0,k0,Jd=!1,Pl=[],cs=null,ds=null,hs=null,ya=new Map,va=new Map,es=[],cx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(t,e){switch(t){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":ya.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":va.delete(e.pointerId)}}function Vo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ha(e),e!==null&&ff(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function dx(t,e,n,r,s){switch(e){case"focusin":return cs=Vo(cs,t,e,n,r,s),!0;case"dragenter":return ds=Vo(ds,t,e,n,r,s),!0;case"mouseover":return hs=Vo(hs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ya.set(i,Vo(ya.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,va.set(i,Vo(va.get(i)||null,t,e,n,r,s)),!0}return!1}function S0(t){var e=Vs(t.target);if(e!==null){var n=si(e);if(n!==null){if(e=n.tag,e===13){if(e=p0(n),e!==null){t.blockedOn=e,k0(t.priority,function(){I0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gd=r,n.target.dispatchEvent(r),Gd=null}else return e=Ha(n),e!==null&&ff(e),t.blockedOn=n,!1;e.shift()}return!0}function ym(t,e,n){Yl(t)&&n.delete(e)}function hx(){Jd=!1,cs!==null&&Yl(cs)&&(cs=null),ds!==null&&Yl(ds)&&(ds=null),hs!==null&&Yl(hs)&&(hs=null),ya.forEach(ym),va.forEach(ym)}function Fo(t,e){t.blockedOn===e&&(t.blockedOn=null,Jd||(Jd=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,hx)))}function _a(t){function e(s){return Fo(s,t)}if(0<Pl.length){Fo(Pl[0],t);for(var n=1;n<Pl.length;n++){var r=Pl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cs!==null&&Fo(cs,t),ds!==null&&Fo(ds,t),hs!==null&&Fo(hs,t),ya.forEach(e),va.forEach(e),n=0;n<es.length;n++)r=es[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<es.length&&(n=es[0],n.blockedOn===null);)S0(n),n.blockedOn===null&&es.shift()}var Vi=Br.ReactCurrentBatchConfig,Eu=!0;function fx(t,e,n,r){var s=De,i=Vi.transition;Vi.transition=null;try{De=1,pf(t,e,n,r)}finally{De=s,Vi.transition=i}}function px(t,e,n,r){var s=De,i=Vi.transition;Vi.transition=null;try{De=4,pf(t,e,n,r)}finally{De=s,Vi.transition=i}}function pf(t,e,n,r){if(Eu){var s=Zd(t,e,n,r);if(s===null)ld(t,e,r,Iu,n),gm(t,r);else if(dx(s,t,e,n,r))r.stopPropagation();else if(gm(t,r),e&4&&-1<cx.indexOf(t)){for(;s!==null;){var i=Ha(s);if(i!==null&&E0(i),i=Zd(t,e,n,r),i===null&&ld(t,e,r,Iu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ld(t,e,r,null,n)}}var Iu=null;function Zd(t,e,n,r){if(Iu=null,t=cf(r),t=Vs(t),t!==null)if(e=si(t),e===null)t=null;else if(n=e.tag,n===13){if(t=p0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Iu=t,null}function A0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tx()){case df:return 1;case v0:return 4;case wu:case nx:return 16;case _0:return 536870912;default:return 16}default:return 16}}var as=null,mf=null,Jl=null;function b0(){if(Jl)return Jl;var t,e=mf,n=e.length,r,s="value"in as?as.value:as.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Jl=s.slice(t,1<r?1-r:void 0)}function Zl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Nl(){return!0}function vm(){return!1}function An(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Nl:vm,this.isPropagationStopped=vm,this}return Ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Nl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Nl)},persist:function(){},isPersistent:Nl}),e}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gf=An(uo),Wa=Ze({},uo,{view:0,detail:0}),mx=An(Wa),Zc,ed,Uo,ac=Ze({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Uo&&(Uo&&t.type==="mousemove"?(Zc=t.screenX-Uo.screenX,ed=t.screenY-Uo.screenY):ed=Zc=0,Uo=t),Zc)},movementY:function(t){return"movementY"in t?t.movementY:ed}}),_m=An(ac),gx=Ze({},ac,{dataTransfer:0}),yx=An(gx),vx=Ze({},Wa,{relatedTarget:0}),td=An(vx),_x=Ze({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),wx=An(_x),xx=Ze({},uo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ex=An(xx),Ix=Ze({},uo,{data:0}),wm=An(Ix),Tx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ax(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Sx[t])?!!e[t]:!1}function yf(){return Ax}var bx=Ze({},Wa,{key:function(t){if(t.key){var e=Tx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yf,charCode:function(t){return t.type==="keypress"?Zl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Cx=An(bx),Rx=Ze({},ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xm=An(Rx),Px=Ze({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yf}),Nx=An(Px),Dx=Ze({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mx=An(Dx),jx=Ze({},ac,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Lx=An(jx),Ox=[9,13,27,32],vf=Dr&&"CompositionEvent"in window,na=null;Dr&&"documentMode"in document&&(na=document.documentMode);var Vx=Dr&&"TextEvent"in window&&!na,C0=Dr&&(!vf||na&&8<na&&11>=na),Em=" ",Im=!1;function R0(t,e){switch(t){case"keyup":return Ox.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ti=!1;function Fx(t,e){switch(t){case"compositionend":return P0(e);case"keypress":return e.which!==32?null:(Im=!0,Em);case"textInput":return t=e.data,t===Em&&Im?null:t;default:return null}}function Ux(t,e){if(Ti)return t==="compositionend"||!vf&&R0(t,e)?(t=b0(),Jl=mf=as=null,Ti=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return C0&&e.locale!=="ko"?null:e.data;default:return null}}var zx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zx[t.type]:e==="textarea"}function N0(t,e,n,r){u0(r),e=Tu(e,"onChange"),0<e.length&&(n=new gf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ra=null,wa=null;function $x(t){B0(t,0)}function lc(t){var e=Ai(t);if(n0(e))return t}function Bx(t,e){if(t==="change")return e}var D0=!1;if(Dr){var nd;if(Dr){var rd="oninput"in document;if(!rd){var km=document.createElement("div");km.setAttribute("oninput","return;"),rd=typeof km.oninput=="function"}nd=rd}else nd=!1;D0=nd&&(!document.documentMode||9<document.documentMode)}function Sm(){ra&&(ra.detachEvent("onpropertychange",M0),wa=ra=null)}function M0(t){if(t.propertyName==="value"&&lc(wa)){var e=[];N0(e,wa,t,cf(t)),f0($x,e)}}function Wx(t,e,n){t==="focusin"?(Sm(),ra=e,wa=n,ra.attachEvent("onpropertychange",M0)):t==="focusout"&&Sm()}function Hx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lc(wa)}function qx(t,e){if(t==="click")return lc(e)}function Gx(t,e){if(t==="input"||t==="change")return lc(e)}function Kx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nr=typeof Object.is=="function"?Object.is:Kx;function xa(t,e){if(nr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!jd.call(e,s)||!nr(t[s],e[s]))return!1}return!0}function Am(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bm(t,e){var n=Am(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Am(n)}}function j0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?j0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function L0(){for(var t=window,e=yu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=yu(t.document)}return e}function _f(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Qx(t){var e=L0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&j0(n.ownerDocument.documentElement,n)){if(r!==null&&_f(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=bm(n,i);var o=bm(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Xx=Dr&&"documentMode"in document&&11>=document.documentMode,ki=null,eh=null,sa=null,th=!1;function Cm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;th||ki==null||ki!==yu(r)||(r=ki,"selectionStart"in r&&_f(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),sa&&xa(sa,r)||(sa=r,r=Tu(eh,"onSelect"),0<r.length&&(e=new gf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ki)))}function Dl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Si={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionend:Dl("Transition","TransitionEnd")},sd={},O0={};Dr&&(O0=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function uc(t){if(sd[t])return sd[t];if(!Si[t])return t;var e=Si[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in O0)return sd[t]=e[n];return t}var V0=uc("animationend"),F0=uc("animationiteration"),U0=uc("animationstart"),z0=uc("transitionend"),$0=new Map,Rm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(t,e){$0.set(t,e),ri(e,[t])}for(var id=0;id<Rm.length;id++){var od=Rm[id],Yx=od.toLowerCase(),Jx=od[0].toUpperCase()+od.slice(1);As(Yx,"on"+Jx)}As(V0,"onAnimationEnd");As(F0,"onAnimationIteration");As(U0,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(z0,"onTransitionEnd");Hi("onMouseEnter",["mouseout","mouseover"]);Hi("onMouseLeave",["mouseout","mouseover"]);Hi("onPointerEnter",["pointerout","pointerover"]);Hi("onPointerLeave",["pointerout","pointerover"]);ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ri("onBeforeInput",["compositionend","keypress","textInput","paste"]);ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ko));function Pm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Yw(r,e,void 0,t),t.currentTarget=null}function B0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Pm(s,l,h),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Pm(s,l,h),i=u}}}if(_u)throw t=Xd,_u=!1,Xd=null,t}function We(t,e){var n=e[oh];n===void 0&&(n=e[oh]=new Set);var r=t+"__bubble";n.has(r)||(W0(e,t,2,!1),n.add(r))}function ad(t,e,n){var r=0;e&&(r|=4),W0(n,t,r,e)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function Ea(t){if(!t[Ml]){t[Ml]=!0,Yy.forEach(function(n){n!=="selectionchange"&&(Zx.has(n)||ad(n,!1,t),ad(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ml]||(e[Ml]=!0,ad("selectionchange",!1,e))}}function W0(t,e,n,r){switch(A0(e)){case 1:var s=fx;break;case 4:s=px;break;default:s=pf}n=s.bind(null,e,n,t),s=void 0,!Qd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ld(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Vs(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}f0(function(){var h=i,p=cf(n),m=[];e:{var w=$0.get(t);if(w!==void 0){var C=gf,M=t;switch(t){case"keypress":if(Zl(n)===0)break e;case"keydown":case"keyup":C=Cx;break;case"focusin":M="focus",C=td;break;case"focusout":M="blur",C=td;break;case"beforeblur":case"afterblur":C=td;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=_m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=yx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Nx;break;case V0:case F0:case U0:C=wx;break;case z0:C=Mx;break;case"scroll":C=mx;break;case"wheel":C=Lx;break;case"copy":case"cut":case"paste":C=Ex;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=xm}var j=(e&4)!==0,F=!j&&t==="scroll",S=j?w!==null?w+"Capture":null:w;j=[];for(var k=h,T;k!==null;){T=k;var P=T.stateNode;if(T.tag===5&&P!==null&&(T=P,S!==null&&(P=ga(k,S),P!=null&&j.push(Ia(k,P,T)))),F)break;k=k.return}0<j.length&&(w=new C(w,M,null,n,p),m.push({event:w,listeners:j}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",w&&n!==Gd&&(M=n.relatedTarget||n.fromElement)&&(Vs(M)||M[Mr]))break e;if((C||w)&&(w=p.window===p?p:(w=p.ownerDocument)?w.defaultView||w.parentWindow:window,C?(M=n.relatedTarget||n.toElement,C=h,M=M?Vs(M):null,M!==null&&(F=si(M),M!==F||M.tag!==5&&M.tag!==6)&&(M=null)):(C=null,M=h),C!==M)){if(j=_m,P="onMouseLeave",S="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(j=xm,P="onPointerLeave",S="onPointerEnter",k="pointer"),F=C==null?w:Ai(C),T=M==null?w:Ai(M),w=new j(P,k+"leave",C,n,p),w.target=F,w.relatedTarget=T,P=null,Vs(p)===h&&(j=new j(S,k+"enter",M,n,p),j.target=T,j.relatedTarget=F,P=j),F=P,C&&M)t:{for(j=C,S=M,k=0,T=j;T;T=yi(T))k++;for(T=0,P=S;P;P=yi(P))T++;for(;0<k-T;)j=yi(j),k--;for(;0<T-k;)S=yi(S),T--;for(;k--;){if(j===S||S!==null&&j===S.alternate)break t;j=yi(j),S=yi(S)}j=null}else j=null;C!==null&&Nm(m,w,C,j,!1),M!==null&&F!==null&&Nm(m,F,M,j,!0)}}e:{if(w=h?Ai(h):window,C=w.nodeName&&w.nodeName.toLowerCase(),C==="select"||C==="input"&&w.type==="file")var O=Bx;else if(Tm(w))if(D0)O=Gx;else{O=Hx;var H=Wx}else(C=w.nodeName)&&C.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(O=qx);if(O&&(O=O(t,h))){N0(m,O,n,p);break e}H&&H(t,w,h),t==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&$d(w,"number",w.value)}switch(H=h?Ai(h):window,t){case"focusin":(Tm(H)||H.contentEditable==="true")&&(ki=H,eh=h,sa=null);break;case"focusout":sa=eh=ki=null;break;case"mousedown":th=!0;break;case"contextmenu":case"mouseup":case"dragend":th=!1,Cm(m,n,p);break;case"selectionchange":if(Xx)break;case"keydown":case"keyup":Cm(m,n,p)}var E;if(vf)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Ti?R0(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(C0&&n.locale!=="ko"&&(Ti||y!=="onCompositionStart"?y==="onCompositionEnd"&&Ti&&(E=b0()):(as=p,mf="value"in as?as.value:as.textContent,Ti=!0)),H=Tu(h,y),0<H.length&&(y=new wm(y,t,null,n,p),m.push({event:y,listeners:H}),E?y.data=E:(E=P0(n),E!==null&&(y.data=E)))),(E=Vx?Fx(t,n):Ux(t,n))&&(h=Tu(h,"onBeforeInput"),0<h.length&&(p=new wm("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=E))}B0(m,e)})}function Ia(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Tu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ga(t,n),i!=null&&r.unshift(Ia(t,i,s)),i=ga(t,e),i!=null&&r.push(Ia(t,i,s))),t=t.return}return r}function yi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Nm(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=ga(n,i),u!=null&&o.unshift(Ia(n,u,l))):s||(u=ga(n,i),u!=null&&o.push(Ia(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var eE=/\r\n?/g,tE=/\u0000|\uFFFD/g;function Dm(t){return(typeof t=="string"?t:""+t).replace(eE,`
`).replace(tE,"")}function jl(t,e,n){if(e=Dm(e),Dm(t)!==e&&n)throw Error(X(425))}function ku(){}var nh=null,rh=null;function sh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ih=typeof setTimeout=="function"?setTimeout:void 0,nE=typeof clearTimeout=="function"?clearTimeout:void 0,Mm=typeof Promise=="function"?Promise:void 0,rE=typeof queueMicrotask=="function"?queueMicrotask:typeof Mm<"u"?function(t){return Mm.resolve(null).then(t).catch(sE)}:ih;function sE(t){setTimeout(function(){throw t})}function ud(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),_a(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);_a(e)}function fs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var co=Math.random().toString(36).slice(2),ur="__reactFiber$"+co,Ta="__reactProps$"+co,Mr="__reactContainer$"+co,oh="__reactEvents$"+co,iE="__reactListeners$"+co,oE="__reactHandles$"+co;function Vs(t){var e=t[ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Mr]||n[ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jm(t);t!==null;){if(n=t[ur])return n;t=jm(t)}return e}t=n,n=t.parentNode}return null}function Ha(t){return t=t[ur]||t[Mr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ai(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function cc(t){return t[Ta]||null}var ah=[],bi=-1;function bs(t){return{current:t}}function qe(t){0>bi||(t.current=ah[bi],ah[bi]=null,bi--)}function $e(t,e){bi++,ah[bi]=t.current,t.current=e}var Is={},Gt=bs(Is),dn=bs(!1),Gs=Is;function qi(t,e){var n=t.type.contextTypes;if(!n)return Is;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function hn(t){return t=t.childContextTypes,t!=null}function Su(){qe(dn),qe(Gt)}function Lm(t,e,n){if(Gt.current!==Is)throw Error(X(168));$e(Gt,e),$e(dn,n)}function H0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(X(108,Ww(t)||"Unknown",s));return Ze({},n,r)}function Au(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Is,Gs=Gt.current,$e(Gt,t),$e(dn,dn.current),!0}function Om(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=H0(t,e,Gs),r.__reactInternalMemoizedMergedChildContext=t,qe(dn),qe(Gt),$e(Gt,t)):qe(dn),$e(dn,n)}var kr=null,dc=!1,cd=!1;function q0(t){kr===null?kr=[t]:kr.push(t)}function aE(t){dc=!0,q0(t)}function Cs(){if(!cd&&kr!==null){cd=!0;var t=0,e=De;try{var n=kr;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}kr=null,dc=!1}catch(s){throw kr!==null&&(kr=kr.slice(t+1)),y0(df,Cs),s}finally{De=e,cd=!1}}return null}var Ci=[],Ri=0,bu=null,Cu=0,jn=[],Ln=0,Ks=null,Sr=1,Ar="";function js(t,e){Ci[Ri++]=Cu,Ci[Ri++]=bu,bu=t,Cu=e}function G0(t,e,n){jn[Ln++]=Sr,jn[Ln++]=Ar,jn[Ln++]=Ks,Ks=t;var r=Sr;t=Ar;var s=32-er(r)-1;r&=~(1<<s),n+=1;var i=32-er(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Sr=1<<32-er(e)+s|n<<s|r,Ar=i+t}else Sr=1<<i|n<<s|r,Ar=t}function wf(t){t.return!==null&&(js(t,1),G0(t,1,0))}function xf(t){for(;t===bu;)bu=Ci[--Ri],Ci[Ri]=null,Cu=Ci[--Ri],Ci[Ri]=null;for(;t===Ks;)Ks=jn[--Ln],jn[Ln]=null,Ar=jn[--Ln],jn[Ln]=null,Sr=jn[--Ln],jn[Ln]=null}var Tn=null,In=null,Xe=!1,Jn=null;function K0(t,e){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Vm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tn=t,In=fs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tn=t,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ks!==null?{id:Sr,overflow:Ar}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Tn=t,In=null,!0):!1;default:return!1}}function lh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function uh(t){if(Xe){var e=In;if(e){var n=e;if(!Vm(t,e)){if(lh(t))throw Error(X(418));e=fs(n.nextSibling);var r=Tn;e&&Vm(t,e)?K0(r,n):(t.flags=t.flags&-4097|2,Xe=!1,Tn=t)}}else{if(lh(t))throw Error(X(418));t.flags=t.flags&-4097|2,Xe=!1,Tn=t}}}function Fm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tn=t}function Ll(t){if(t!==Tn)return!1;if(!Xe)return Fm(t),Xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sh(t.type,t.memoizedProps)),e&&(e=In)){if(lh(t))throw Q0(),Error(X(418));for(;e;)K0(t,e),e=fs(e.nextSibling)}if(Fm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){In=fs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}In=null}}else In=Tn?fs(t.stateNode.nextSibling):null;return!0}function Q0(){for(var t=In;t;)t=fs(t.nextSibling)}function Gi(){In=Tn=null,Xe=!1}function Ef(t){Jn===null?Jn=[t]:Jn.push(t)}var lE=Br.ReactCurrentBatchConfig;function zo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function Ol(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Um(t){var e=t._init;return e(t._payload)}function X0(t){function e(S,k){if(t){var T=S.deletions;T===null?(S.deletions=[k],S.flags|=16):T.push(k)}}function n(S,k){if(!t)return null;for(;k!==null;)e(S,k),k=k.sibling;return null}function r(S,k){for(S=new Map;k!==null;)k.key!==null?S.set(k.key,k):S.set(k.index,k),k=k.sibling;return S}function s(S,k){return S=ys(S,k),S.index=0,S.sibling=null,S}function i(S,k,T){return S.index=T,t?(T=S.alternate,T!==null?(T=T.index,T<k?(S.flags|=2,k):T):(S.flags|=2,k)):(S.flags|=1048576,k)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function l(S,k,T,P){return k===null||k.tag!==6?(k=yd(T,S.mode,P),k.return=S,k):(k=s(k,T),k.return=S,k)}function u(S,k,T,P){var O=T.type;return O===Ii?p(S,k,T.props.children,P,T.key):k!==null&&(k.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Jr&&Um(O)===k.type)?(P=s(k,T.props),P.ref=zo(S,k,T),P.return=S,P):(P=ou(T.type,T.key,T.props,null,S.mode,P),P.ref=zo(S,k,T),P.return=S,P)}function h(S,k,T,P){return k===null||k.tag!==4||k.stateNode.containerInfo!==T.containerInfo||k.stateNode.implementation!==T.implementation?(k=vd(T,S.mode,P),k.return=S,k):(k=s(k,T.children||[]),k.return=S,k)}function p(S,k,T,P,O){return k===null||k.tag!==7?(k=Bs(T,S.mode,P,O),k.return=S,k):(k=s(k,T),k.return=S,k)}function m(S,k,T){if(typeof k=="string"&&k!==""||typeof k=="number")return k=yd(""+k,S.mode,T),k.return=S,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Sl:return T=ou(k.type,k.key,k.props,null,S.mode,T),T.ref=zo(S,null,k),T.return=S,T;case Ei:return k=vd(k,S.mode,T),k.return=S,k;case Jr:var P=k._init;return m(S,P(k._payload),T)}if(qo(k)||Lo(k))return k=Bs(k,S.mode,T,null),k.return=S,k;Ol(S,k)}return null}function w(S,k,T,P){var O=k!==null?k.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:l(S,k,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Sl:return T.key===O?u(S,k,T,P):null;case Ei:return T.key===O?h(S,k,T,P):null;case Jr:return O=T._init,w(S,k,O(T._payload),P)}if(qo(T)||Lo(T))return O!==null?null:p(S,k,T,P,null);Ol(S,T)}return null}function C(S,k,T,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return S=S.get(T)||null,l(k,S,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Sl:return S=S.get(P.key===null?T:P.key)||null,u(k,S,P,O);case Ei:return S=S.get(P.key===null?T:P.key)||null,h(k,S,P,O);case Jr:var H=P._init;return C(S,k,T,H(P._payload),O)}if(qo(P)||Lo(P))return S=S.get(T)||null,p(k,S,P,O,null);Ol(k,P)}return null}function M(S,k,T,P){for(var O=null,H=null,E=k,y=k=0,x=null;E!==null&&y<T.length;y++){E.index>y?(x=E,E=null):x=E.sibling;var I=w(S,E,T[y],P);if(I===null){E===null&&(E=x);break}t&&E&&I.alternate===null&&e(S,E),k=i(I,k,y),H===null?O=I:H.sibling=I,H=I,E=x}if(y===T.length)return n(S,E),Xe&&js(S,y),O;if(E===null){for(;y<T.length;y++)E=m(S,T[y],P),E!==null&&(k=i(E,k,y),H===null?O=E:H.sibling=E,H=E);return Xe&&js(S,y),O}for(E=r(S,E);y<T.length;y++)x=C(E,S,y,T[y],P),x!==null&&(t&&x.alternate!==null&&E.delete(x.key===null?y:x.key),k=i(x,k,y),H===null?O=x:H.sibling=x,H=x);return t&&E.forEach(function(R){return e(S,R)}),Xe&&js(S,y),O}function j(S,k,T,P){var O=Lo(T);if(typeof O!="function")throw Error(X(150));if(T=O.call(T),T==null)throw Error(X(151));for(var H=O=null,E=k,y=k=0,x=null,I=T.next();E!==null&&!I.done;y++,I=T.next()){E.index>y?(x=E,E=null):x=E.sibling;var R=w(S,E,I.value,P);if(R===null){E===null&&(E=x);break}t&&E&&R.alternate===null&&e(S,E),k=i(R,k,y),H===null?O=R:H.sibling=R,H=R,E=x}if(I.done)return n(S,E),Xe&&js(S,y),O;if(E===null){for(;!I.done;y++,I=T.next())I=m(S,I.value,P),I!==null&&(k=i(I,k,y),H===null?O=I:H.sibling=I,H=I);return Xe&&js(S,y),O}for(E=r(S,E);!I.done;y++,I=T.next())I=C(E,S,y,I.value,P),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?y:I.key),k=i(I,k,y),H===null?O=I:H.sibling=I,H=I);return t&&E.forEach(function(N){return e(S,N)}),Xe&&js(S,y),O}function F(S,k,T,P){if(typeof T=="object"&&T!==null&&T.type===Ii&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Sl:e:{for(var O=T.key,H=k;H!==null;){if(H.key===O){if(O=T.type,O===Ii){if(H.tag===7){n(S,H.sibling),k=s(H,T.props.children),k.return=S,S=k;break e}}else if(H.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Jr&&Um(O)===H.type){n(S,H.sibling),k=s(H,T.props),k.ref=zo(S,H,T),k.return=S,S=k;break e}n(S,H);break}else e(S,H);H=H.sibling}T.type===Ii?(k=Bs(T.props.children,S.mode,P,T.key),k.return=S,S=k):(P=ou(T.type,T.key,T.props,null,S.mode,P),P.ref=zo(S,k,T),P.return=S,S=P)}return o(S);case Ei:e:{for(H=T.key;k!==null;){if(k.key===H)if(k.tag===4&&k.stateNode.containerInfo===T.containerInfo&&k.stateNode.implementation===T.implementation){n(S,k.sibling),k=s(k,T.children||[]),k.return=S,S=k;break e}else{n(S,k);break}else e(S,k);k=k.sibling}k=vd(T,S.mode,P),k.return=S,S=k}return o(S);case Jr:return H=T._init,F(S,k,H(T._payload),P)}if(qo(T))return M(S,k,T,P);if(Lo(T))return j(S,k,T,P);Ol(S,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,k!==null&&k.tag===6?(n(S,k.sibling),k=s(k,T),k.return=S,S=k):(n(S,k),k=yd(T,S.mode,P),k.return=S,S=k),o(S)):n(S,k)}return F}var Ki=X0(!0),Y0=X0(!1),Ru=bs(null),Pu=null,Pi=null,If=null;function Tf(){If=Pi=Pu=null}function kf(t){var e=Ru.current;qe(Ru),t._currentValue=e}function ch(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Fi(t,e){Pu=t,If=Pi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(cn=!0),t.firstContext=null)}function Un(t){var e=t._currentValue;if(If!==t)if(t={context:t,memoizedValue:e,next:null},Pi===null){if(Pu===null)throw Error(X(308));Pi=t,Pu.dependencies={lanes:0,firstContext:t}}else Pi=Pi.next=t;return e}var Fs=null;function Sf(t){Fs===null?Fs=[t]:Fs.push(t)}function J0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Sf(e)):(n.next=s.next,s.next=n),e.interleaved=n,jr(t,r)}function jr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zr=!1;function Af(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Z0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ps(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,jr(t,n)}return s=r.interleaved,s===null?(e.next=e,Sf(r)):(e.next=s.next,s.next=e),r.interleaved=e,jr(t,n)}function eu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hf(t,n)}}function zm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Nu(t,e,n,r){var s=t.updateQueue;Zr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,o===null?i=h:o.next=h,o=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,p=h=u=null,l=i;do{var w=l.lane,C=l.eventTime;if((r&w)===w){p!==null&&(p=p.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var M=t,j=l;switch(w=e,C=n,j.tag){case 1:if(M=j.payload,typeof M=="function"){m=M.call(C,m,w);break e}m=M;break e;case 3:M.flags=M.flags&-65537|128;case 0:if(M=j.payload,w=typeof M=="function"?M.call(C,m,w):M,w==null)break e;m=Ze({},m,w);break e;case 2:Zr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,w=s.effects,w===null?s.effects=[l]:w.push(l))}else C={eventTime:C,lane:w,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=C,u=m):p=p.next=C,o|=w;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;w=l,l=w.next,w.next=null,s.lastBaseUpdate=w,s.shared.pending=null}}while(!0);if(p===null&&(u=m),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Xs|=o,t.lanes=o,t.memoizedState=m}}function $m(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(X(191,s));s.call(r)}}}var qa={},fr=bs(qa),ka=bs(qa),Sa=bs(qa);function Us(t){if(t===qa)throw Error(X(174));return t}function bf(t,e){switch($e(Sa,e),$e(ka,t),$e(fr,qa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wd(e,t)}qe(fr),$e(fr,e)}function Qi(){qe(fr),qe(ka),qe(Sa)}function ev(t){Us(Sa.current);var e=Us(fr.current),n=Wd(e,t.type);e!==n&&($e(ka,t),$e(fr,n))}function Cf(t){ka.current===t&&(qe(fr),qe(ka))}var Ye=bs(0);function Du(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dd=[];function Rf(){for(var t=0;t<dd.length;t++)dd[t]._workInProgressVersionPrimary=null;dd.length=0}var tu=Br.ReactCurrentDispatcher,hd=Br.ReactCurrentBatchConfig,Qs=0,Je=null,gt=null,Et=null,Mu=!1,ia=!1,Aa=0,uE=0;function Ut(){throw Error(X(321))}function Pf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!nr(t[n],e[n]))return!1;return!0}function Nf(t,e,n,r,s,i){if(Qs=i,Je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tu.current=t===null||t.memoizedState===null?fE:pE,t=n(r,s),ia){i=0;do{if(ia=!1,Aa=0,25<=i)throw Error(X(301));i+=1,Et=gt=null,e.updateQueue=null,tu.current=mE,t=n(r,s)}while(ia)}if(tu.current=ju,e=gt!==null&&gt.next!==null,Qs=0,Et=gt=Je=null,Mu=!1,e)throw Error(X(300));return t}function Df(){var t=Aa!==0;return Aa=0,t}function lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?Je.memoizedState=Et=t:Et=Et.next=t,Et}function zn(){if(gt===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=gt.next;var e=Et===null?Je.memoizedState:Et.next;if(e!==null)Et=e,gt=t;else{if(t===null)throw Error(X(310));gt=t,t={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Et===null?Je.memoizedState=Et=t:Et=Et.next=t}return Et}function ba(t,e){return typeof e=="function"?e(t):e}function fd(t){var e=zn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=gt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,h=i;do{var p=h.lane;if((Qs&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=m,o=r):u=u.next=m,Je.lanes|=p,Xs|=p}h=h.next}while(h!==null&&h!==i);u===null?o=r:u.next=l,nr(r,e.memoizedState)||(cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Je.lanes|=i,Xs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pd(t){var e=zn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);nr(i,e.memoizedState)||(cn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function tv(){}function nv(t,e){var n=Je,r=zn(),s=e(),i=!nr(r.memoizedState,s);if(i&&(r.memoizedState=s,cn=!0),r=r.queue,Mf(iv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Ca(9,sv.bind(null,n,r,s,e),void 0,null),Tt===null)throw Error(X(349));Qs&30||rv(n,e,s)}return s}function rv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sv(t,e,n,r){e.value=n,e.getSnapshot=r,ov(e)&&av(t)}function iv(t,e,n){return n(function(){ov(e)&&av(t)})}function ov(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!nr(t,n)}catch{return!0}}function av(t){var e=jr(t,1);e!==null&&tr(e,t,1,-1)}function Bm(t){var e=lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:t},e.queue=t,t=t.dispatch=hE.bind(null,Je,t),[e.memoizedState,t]}function Ca(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function lv(){return zn().memoizedState}function nu(t,e,n,r){var s=lr();Je.flags|=t,s.memoizedState=Ca(1|e,n,void 0,r===void 0?null:r)}function hc(t,e,n,r){var s=zn();r=r===void 0?null:r;var i=void 0;if(gt!==null){var o=gt.memoizedState;if(i=o.destroy,r!==null&&Pf(r,o.deps)){s.memoizedState=Ca(e,n,i,r);return}}Je.flags|=t,s.memoizedState=Ca(1|e,n,i,r)}function Wm(t,e){return nu(8390656,8,t,e)}function Mf(t,e){return hc(2048,8,t,e)}function uv(t,e){return hc(4,2,t,e)}function cv(t,e){return hc(4,4,t,e)}function dv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hv(t,e,n){return n=n!=null?n.concat([t]):null,hc(4,4,dv.bind(null,e,t),n)}function jf(){}function fv(t,e){var n=zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function pv(t,e){var n=zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function mv(t,e,n){return Qs&21?(nr(n,e)||(n=w0(),Je.lanes|=n,Xs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,cn=!0),t.memoizedState=n)}function cE(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=hd.transition;hd.transition={};try{t(!1),e()}finally{De=n,hd.transition=r}}function gv(){return zn().memoizedState}function dE(t,e,n){var r=gs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},yv(t))vv(e,n);else if(n=J0(t,e,n,r),n!==null){var s=nn();tr(n,t,r,s),_v(n,e,r)}}function hE(t,e,n){var r=gs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(yv(t))vv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,nr(l,o)){var u=e.interleaved;u===null?(s.next=s,Sf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=J0(t,e,s,r),n!==null&&(s=nn(),tr(n,t,r,s),_v(n,e,r))}}function yv(t){var e=t.alternate;return t===Je||e!==null&&e===Je}function vv(t,e){ia=Mu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function _v(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hf(t,n)}}var ju={readContext:Un,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},fE={readContext:Un,useCallback:function(t,e){return lr().memoizedState=[t,e===void 0?null:e],t},useContext:Un,useEffect:Wm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,nu(4194308,4,dv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return nu(4194308,4,t,e)},useInsertionEffect:function(t,e){return nu(4,2,t,e)},useMemo:function(t,e){var n=lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dE.bind(null,Je,t),[r.memoizedState,t]},useRef:function(t){var e=lr();return t={current:t},e.memoizedState=t},useState:Bm,useDebugValue:jf,useDeferredValue:function(t){return lr().memoizedState=t},useTransition:function(){var t=Bm(!1),e=t[0];return t=cE.bind(null,t[1]),lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Je,s=lr();if(Xe){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),Tt===null)throw Error(X(349));Qs&30||rv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Wm(iv.bind(null,r,i,t),[t]),r.flags|=2048,Ca(9,sv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=lr(),e=Tt.identifierPrefix;if(Xe){var n=Ar,r=Sr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Aa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=uE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pE={readContext:Un,useCallback:fv,useContext:Un,useEffect:Mf,useImperativeHandle:hv,useInsertionEffect:uv,useLayoutEffect:cv,useMemo:pv,useReducer:fd,useRef:lv,useState:function(){return fd(ba)},useDebugValue:jf,useDeferredValue:function(t){var e=zn();return mv(e,gt.memoizedState,t)},useTransition:function(){var t=fd(ba)[0],e=zn().memoizedState;return[t,e]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1},mE={readContext:Un,useCallback:fv,useContext:Un,useEffect:Mf,useImperativeHandle:hv,useInsertionEffect:uv,useLayoutEffect:cv,useMemo:pv,useReducer:pd,useRef:lv,useState:function(){return pd(ba)},useDebugValue:jf,useDeferredValue:function(t){var e=zn();return gt===null?e.memoizedState=t:mv(e,gt.memoizedState,t)},useTransition:function(){var t=pd(ba)[0],e=zn().memoizedState;return[t,e]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1};function Xn(t,e){if(t&&t.defaultProps){e=Ze({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function dh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fc={isMounted:function(t){return(t=t._reactInternals)?si(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nn(),s=gs(t),i=Pr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(tr(e,t,s,r),eu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nn(),s=gs(t),i=Pr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(tr(e,t,s,r),eu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nn(),r=gs(t),s=Pr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ps(t,s,r),e!==null&&(tr(e,t,r,n),eu(e,t,r))}};function Hm(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!xa(n,r)||!xa(s,i):!0}function wv(t,e,n){var r=!1,s=Is,i=e.contextType;return typeof i=="object"&&i!==null?i=Un(i):(s=hn(e)?Gs:Gt.current,r=e.contextTypes,i=(r=r!=null)?qi(t,s):Is),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function qm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&fc.enqueueReplaceState(e,e.state,null)}function hh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Af(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Un(i):(i=hn(e)?Gs:Gt.current,s.context=qi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(dh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&fc.enqueueReplaceState(s,s.state,null),Nu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Xi(t,e){try{var n="",r=e;do n+=Bw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function md(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function fh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gE=typeof WeakMap=="function"?WeakMap:Map;function xv(t,e,n){n=Pr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ou||(Ou=!0,Ih=r),fh(t,e)},n}function Ev(t,e,n){n=Pr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){fh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fh(t,e),typeof r!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Gm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gE;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=RE.bind(null,t,e,n),e.then(t,t))}function Km(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qm(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Pr(-1,1),e.tag=2,ps(n,e,1))),n.lanes|=1),t)}var yE=Br.ReactCurrentOwner,cn=!1;function tn(t,e,n,r){e.child=t===null?Y0(e,null,n,r):Ki(e,t.child,n,r)}function Xm(t,e,n,r,s){n=n.render;var i=e.ref;return Fi(e,s),r=Nf(t,e,n,r,i,s),n=Df(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lr(t,e,s)):(Xe&&n&&wf(e),e.flags|=1,tn(t,e,r,s),e.child)}function Ym(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Bf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Iv(t,e,i,r,s)):(t=ou(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:xa,n(o,r)&&t.ref===e.ref)return Lr(t,e,s)}return e.flags|=1,t=ys(i,r),t.ref=e.ref,t.return=e,e.child=t}function Iv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xa(i,r)&&t.ref===e.ref)if(cn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(cn=!0);else return e.lanes=t.lanes,Lr(t,e,s)}return ph(t,e,n,r,s)}function Tv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Di,En),En|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,$e(Di,En),En|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,$e(Di,En),En|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,$e(Di,En),En|=r;return tn(t,e,s,n),e.child}function kv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ph(t,e,n,r,s){var i=hn(n)?Gs:Gt.current;return i=qi(e,i),Fi(e,s),n=Nf(t,e,n,r,i,s),r=Df(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lr(t,e,s)):(Xe&&r&&wf(e),e.flags|=1,tn(t,e,n,s),e.child)}function Jm(t,e,n,r,s){if(hn(n)){var i=!0;Au(e)}else i=!1;if(Fi(e,s),e.stateNode===null)ru(t,e),wv(e,n,r),hh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Un(h):(h=hn(n)?Gs:Gt.current,h=qi(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==h)&&qm(e,o,r,h),Zr=!1;var w=e.memoizedState;o.state=w,Nu(e,r,o,s),u=e.memoizedState,l!==r||w!==u||dn.current||Zr?(typeof p=="function"&&(dh(e,n,p,r),u=e.memoizedState),(l=Zr||Hm(e,n,l,r,w,u,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Z0(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Xn(e.type,l),o.props=h,m=e.pendingProps,w=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Un(u):(u=hn(n)?Gs:Gt.current,u=qi(e,u));var C=n.getDerivedStateFromProps;(p=typeof C=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||w!==u)&&qm(e,o,r,u),Zr=!1,w=e.memoizedState,o.state=w,Nu(e,r,o,s);var M=e.memoizedState;l!==m||w!==M||dn.current||Zr?(typeof C=="function"&&(dh(e,n,C,r),M=e.memoizedState),(h=Zr||Hm(e,n,h,r,w,M,u)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,M,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,M,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=M),o.props=r,o.state=M,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return mh(t,e,n,r,i,s)}function mh(t,e,n,r,s,i){kv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Om(e,n,!1),Lr(t,e,i);r=e.stateNode,yE.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ki(e,t.child,null,i),e.child=Ki(e,null,l,i)):tn(t,e,l,i),e.memoizedState=r.state,s&&Om(e,n,!0),e.child}function Sv(t){var e=t.stateNode;e.pendingContext?Lm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Lm(t,e.context,!1),bf(t,e.containerInfo)}function Zm(t,e,n,r,s){return Gi(),Ef(s),e.flags|=256,tn(t,e,n,r),e.child}var gh={dehydrated:null,treeContext:null,retryLane:0};function yh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Av(t,e,n){var r=e.pendingProps,s=Ye.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),$e(Ye,s&1),t===null)return uh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=gc(o,r,0,null),t=Bs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=yh(n),e.memoizedState=gh,t):Lf(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return vE(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=ys(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ys(l,i):(i=Bs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?yh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=gh,r}return i=t.child,t=i.sibling,r=ys(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lf(t,e){return e=gc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vl(t,e,n,r){return r!==null&&Ef(r),Ki(e,t.child,null,n),t=Lf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vE(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=md(Error(X(422))),Vl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=gc({mode:"visible",children:r.children},s,0,null),i=Bs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ki(e,t.child,null,o),e.child.memoizedState=yh(o),e.memoizedState=gh,i);if(!(e.mode&1))return Vl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(X(419)),r=md(i,r,void 0),Vl(t,e,o,r)}if(l=(o&t.childLanes)!==0,cn||l){if(r=Tt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,jr(t,s),tr(r,t,s,-1))}return $f(),r=md(Error(X(421))),Vl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=PE.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,In=fs(s.nextSibling),Tn=e,Xe=!0,Jn=null,t!==null&&(jn[Ln++]=Sr,jn[Ln++]=Ar,jn[Ln++]=Ks,Sr=t.id,Ar=t.overflow,Ks=e),e=Lf(e,r.children),e.flags|=4096,e)}function eg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ch(t.return,e,n)}function gd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function bv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(tn(t,e,r.children,n),r=Ye.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eg(t,n,e);else if(t.tag===19)eg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if($e(Ye,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Du(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),gd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Du(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}gd(e,!0,n,null,i);break;case"together":gd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ru(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Lr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=ys(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ys(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _E(t,e,n){switch(e.tag){case 3:Sv(e),Gi();break;case 5:ev(e);break;case 1:hn(e.type)&&Au(e);break;case 4:bf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;$e(Ru,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?($e(Ye,Ye.current&1),e.flags|=128,null):n&e.child.childLanes?Av(t,e,n):($e(Ye,Ye.current&1),t=Lr(t,e,n),t!==null?t.sibling:null);$e(Ye,Ye.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return bv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$e(Ye,Ye.current),r)break;return null;case 22:case 23:return e.lanes=0,Tv(t,e,n)}return Lr(t,e,n)}var Cv,vh,Rv,Pv;Cv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vh=function(){};Rv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Us(fr.current);var i=null;switch(n){case"input":s=Ud(t,s),r=Ud(t,r),i=[];break;case"select":s=Ze({},s,{value:void 0}),r=Ze({},r,{value:void 0}),i=[];break;case"textarea":s=Bd(t,s),r=Bd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ku)}Hd(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(pa.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(pa.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&We("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Pv=function(t,e,n,r){n!==r&&(e.flags|=4)};function $o(t,e){if(!Xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wE(t,e,n){var r=e.pendingProps;switch(xf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return hn(e.type)&&Su(),zt(e),null;case 3:return r=e.stateNode,Qi(),qe(dn),qe(Gt),Rf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ll(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jn!==null&&(Sh(Jn),Jn=null))),vh(t,e),zt(e),null;case 5:Cf(e);var s=Us(Sa.current);if(n=e.type,t!==null&&e.stateNode!=null)Rv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return zt(e),null}if(t=Us(fr.current),Ll(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ur]=e,r[Ta]=i,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(s=0;s<Ko.length;s++)We(Ko[s],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":um(r,i),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},We("invalid",r);break;case"textarea":dm(r,i),We("invalid",r)}Hd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&jl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&jl(r.textContent,l,t),s=["children",""+l]):pa.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&We("scroll",r)}switch(n){case"input":Al(r),cm(r,i,!0);break;case"textarea":Al(r),hm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ku)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=i0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ur]=e,t[Ta]=r,Cv(t,e,!1,!1),e.stateNode=t;e:{switch(o=qd(n,r),n){case"dialog":We("cancel",t),We("close",t),s=r;break;case"iframe":case"object":case"embed":We("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ko.length;s++)We(Ko[s],t);s=r;break;case"source":We("error",t),s=r;break;case"img":case"image":case"link":We("error",t),We("load",t),s=r;break;case"details":We("toggle",t),s=r;break;case"input":um(t,r),s=Ud(t,r),We("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ze({},r,{value:void 0}),We("invalid",t);break;case"textarea":dm(t,r),s=Bd(t,r),We("invalid",t);break;default:s=r}Hd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?l0(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&o0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ma(t,u):typeof u=="number"&&ma(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&We("scroll",t):u!=null&&of(t,i,u,o))}switch(n){case"input":Al(t),cm(t,r,!1);break;case"textarea":Al(t),hm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Es(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ji(t,!!r.multiple,i,!1):r.defaultValue!=null&&ji(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ku)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(t&&e.stateNode!=null)Pv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=Us(Sa.current),Us(fr.current),Ll(e)){if(r=e.stateNode,n=e.memoizedProps,r[ur]=e,(i=r.nodeValue!==n)&&(t=Tn,t!==null))switch(t.tag){case 3:jl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ur]=e,e.stateNode=r}return zt(e),null;case 13:if(qe(Ye),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xe&&In!==null&&e.mode&1&&!(e.flags&128))Q0(),Gi(),e.flags|=98560,i=!1;else if(i=Ll(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[ur]=e}else Gi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),i=!1}else Jn!==null&&(Sh(Jn),Jn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ye.current&1?yt===0&&(yt=3):$f())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return Qi(),vh(t,e),t===null&&Ea(e.stateNode.containerInfo),zt(e),null;case 10:return kf(e.type._context),zt(e),null;case 17:return hn(e.type)&&Su(),zt(e),null;case 19:if(qe(Ye),i=e.memoizedState,i===null)return zt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)$o(i,!1);else{if(yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Du(t),o!==null){for(e.flags|=128,$o(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return $e(Ye,Ye.current&1|2),e.child}t=t.sibling}i.tail!==null&&lt()>Yi&&(e.flags|=128,r=!0,$o(i,!1),e.lanes=4194304)}else{if(!r)if(t=Du(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),$o(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Xe)return zt(e),null}else 2*lt()-i.renderingStartTime>Yi&&n!==1073741824&&(e.flags|=128,r=!0,$o(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=lt(),e.sibling=null,n=Ye.current,$e(Ye,r?n&1|2:n&1),e):(zt(e),null);case 22:case 23:return zf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?En&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function xE(t,e){switch(xf(e),e.tag){case 1:return hn(e.type)&&Su(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qi(),qe(dn),qe(Gt),Rf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cf(e),null;case 13:if(qe(Ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Gi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return qe(Ye),null;case 4:return Qi(),null;case 10:return kf(e.type._context),null;case 22:case 23:return zf(),null;case 24:return null;default:return null}}var Fl=!1,Ht=!1,EE=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Ni(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(t,e,r)}else n.current=null}function _h(t,e,n){try{n()}catch(r){it(t,e,r)}}var tg=!1;function IE(t,e){if(nh=Eu,t=L0(),_f(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,h=0,p=0,m=t,w=null;t:for(;;){for(var C;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(C=m.firstChild)!==null;)w=m,m=C;for(;;){if(m===t)break t;if(w===n&&++h===s&&(l=o),w===i&&++p===r&&(u=o),(C=m.nextSibling)!==null)break;m=w,w=m.parentNode}m=C}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(rh={focusedElem:t,selectionRange:n},Eu=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var M=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(M!==null){var j=M.memoizedProps,F=M.memoizedState,S=e.stateNode,k=S.getSnapshotBeforeUpdate(e.elementType===e.type?j:Xn(e.type,j),F);S.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(P){it(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return M=tg,tg=!1,M}function oa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&_h(e,n,i)}s=s.next}while(s!==r)}}function pc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Nv(t){var e=t.alternate;e!==null&&(t.alternate=null,Nv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ur],delete e[Ta],delete e[oh],delete e[iE],delete e[oE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Dv(t){return t.tag===5||t.tag===3||t.tag===4}function ng(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Dv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ku));else if(r!==4&&(t=t.child,t!==null))for(xh(t,e,n),t=t.sibling;t!==null;)xh(t,e,n),t=t.sibling}function Eh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Eh(t,e,n),t=t.sibling;t!==null;)Eh(t,e,n),t=t.sibling}var Ct=null,Yn=!1;function Xr(t,e,n){for(n=n.child;n!==null;)Mv(t,e,n),n=n.sibling}function Mv(t,e,n){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(oc,n)}catch{}switch(n.tag){case 5:Ht||Ni(n,e);case 6:var r=Ct,s=Yn;Ct=null,Xr(t,e,n),Ct=r,Yn=s,Ct!==null&&(Yn?(t=Ct,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ct.removeChild(n.stateNode));break;case 18:Ct!==null&&(Yn?(t=Ct,n=n.stateNode,t.nodeType===8?ud(t.parentNode,n):t.nodeType===1&&ud(t,n),_a(t)):ud(Ct,n.stateNode));break;case 4:r=Ct,s=Yn,Ct=n.stateNode.containerInfo,Yn=!0,Xr(t,e,n),Ct=r,Yn=s;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&_h(n,e,o),s=s.next}while(s!==r)}Xr(t,e,n);break;case 1:if(!Ht&&(Ni(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){it(n,e,l)}Xr(t,e,n);break;case 21:Xr(t,e,n);break;case 22:n.mode&1?(Ht=(r=Ht)||n.memoizedState!==null,Xr(t,e,n),Ht=r):Xr(t,e,n);break;default:Xr(t,e,n)}}function rg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new EE),e.forEach(function(r){var s=NE.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ct=l.stateNode,Yn=!1;break e;case 3:Ct=l.stateNode.containerInfo,Yn=!0;break e;case 4:Ct=l.stateNode.containerInfo,Yn=!0;break e}l=l.return}if(Ct===null)throw Error(X(160));Mv(i,o,s),Ct=null,Yn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){it(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jv(e,t),e=e.sibling}function jv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),ar(t),r&4){try{oa(3,t,t.return),pc(3,t)}catch(j){it(t,t.return,j)}try{oa(5,t,t.return)}catch(j){it(t,t.return,j)}}break;case 1:Qn(e,t),ar(t),r&512&&n!==null&&Ni(n,n.return);break;case 5:if(Qn(e,t),ar(t),r&512&&n!==null&&Ni(n,n.return),t.flags&32){var s=t.stateNode;try{ma(s,"")}catch(j){it(t,t.return,j)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&r0(s,i),qd(l,o);var h=qd(l,i);for(o=0;o<u.length;o+=2){var p=u[o],m=u[o+1];p==="style"?l0(s,m):p==="dangerouslySetInnerHTML"?o0(s,m):p==="children"?ma(s,m):of(s,p,m,h)}switch(l){case"input":zd(s,i);break;case"textarea":s0(s,i);break;case"select":var w=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?ji(s,!!i.multiple,C,!1):w!==!!i.multiple&&(i.defaultValue!=null?ji(s,!!i.multiple,i.defaultValue,!0):ji(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ta]=i}catch(j){it(t,t.return,j)}}break;case 6:if(Qn(e,t),ar(t),r&4){if(t.stateNode===null)throw Error(X(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(j){it(t,t.return,j)}}break;case 3:if(Qn(e,t),ar(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_a(e.containerInfo)}catch(j){it(t,t.return,j)}break;case 4:Qn(e,t),ar(t);break;case 13:Qn(e,t),ar(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ff=lt())),r&4&&rg(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Ht=(h=Ht)||p,Qn(e,t),Ht=h):Qn(e,t),ar(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(ne=t,p=t.child;p!==null;){for(m=ne=p;ne!==null;){switch(w=ne,C=w.child,w.tag){case 0:case 11:case 14:case 15:oa(4,w,w.return);break;case 1:Ni(w,w.return);var M=w.stateNode;if(typeof M.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,M.props=e.memoizedProps,M.state=e.memoizedState,M.componentWillUnmount()}catch(j){it(r,n,j)}}break;case 5:Ni(w,w.return);break;case 22:if(w.memoizedState!==null){ig(m);continue}}C!==null?(C.return=w,ne=C):ig(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{s=m.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=a0("display",o))}catch(j){it(t,t.return,j)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(j){it(t,t.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Qn(e,t),ar(t),r&4&&rg(t);break;case 21:break;default:Qn(e,t),ar(t)}}function ar(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Dv(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ma(s,""),r.flags&=-33);var i=ng(t);Eh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=ng(t);xh(t,l,o);break;default:throw Error(X(161))}}catch(u){it(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function TE(t,e,n){ne=t,Lv(t)}function Lv(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Fl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Ht;l=Fl;var h=Ht;if(Fl=o,(Ht=u)&&!h)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?og(s):u!==null?(u.return=o,ne=u):og(s);for(;i!==null;)ne=i,Lv(i),i=i.sibling;ne=s,Fl=l,Ht=h}sg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):sg(t)}}function sg(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||pc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$m(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$m(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&_a(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Ht||e.flags&512&&wh(e)}catch(w){it(e,e.return,w)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function ig(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function og(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{pc(4,e)}catch(u){it(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){it(e,s,u)}}var i=e.return;try{wh(e)}catch(u){it(e,i,u)}break;case 5:var o=e.return;try{wh(e)}catch(u){it(e,o,u)}}}catch(u){it(e,e.return,u)}if(e===t){ne=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ne=l;break}ne=e.return}}var kE=Math.ceil,Lu=Br.ReactCurrentDispatcher,Of=Br.ReactCurrentOwner,Fn=Br.ReactCurrentBatchConfig,Re=0,Tt=null,ft=null,Nt=0,En=0,Di=bs(0),yt=0,Ra=null,Xs=0,mc=0,Vf=0,aa=null,un=null,Ff=0,Yi=1/0,Ir=null,Ou=!1,Ih=null,ms=null,Ul=!1,ls=null,Vu=0,la=0,Th=null,su=-1,iu=0;function nn(){return Re&6?lt():su!==-1?su:su=lt()}function gs(t){return t.mode&1?Re&2&&Nt!==0?Nt&-Nt:lE.transition!==null?(iu===0&&(iu=w0()),iu):(t=De,t!==0||(t=window.event,t=t===void 0?16:A0(t.type)),t):1}function tr(t,e,n,r){if(50<la)throw la=0,Th=null,Error(X(185));Ba(t,n,r),(!(Re&2)||t!==Tt)&&(t===Tt&&(!(Re&2)&&(mc|=n),yt===4&&ts(t,Nt)),fn(t,r),n===1&&Re===0&&!(e.mode&1)&&(Yi=lt()+500,dc&&Cs()))}function fn(t,e){var n=t.callbackNode;lx(t,e);var r=xu(t,t===Tt?Nt:0);if(r===0)n!==null&&mm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&mm(n),e===1)t.tag===0?aE(ag.bind(null,t)):q0(ag.bind(null,t)),rE(function(){!(Re&6)&&Cs()}),n=null;else{switch(x0(r)){case 1:n=df;break;case 4:n=v0;break;case 16:n=wu;break;case 536870912:n=_0;break;default:n=wu}n=Wv(n,Ov.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ov(t,e){if(su=-1,iu=0,Re&6)throw Error(X(327));var n=t.callbackNode;if(Ui()&&t.callbackNode!==n)return null;var r=xu(t,t===Tt?Nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Fu(t,r);else{e=r;var s=Re;Re|=2;var i=Fv();(Tt!==t||Nt!==e)&&(Ir=null,Yi=lt()+500,$s(t,e));do try{bE();break}catch(l){Vv(t,l)}while(!0);Tf(),Lu.current=i,Re=s,ft!==null?e=0:(Tt=null,Nt=0,e=yt)}if(e!==0){if(e===2&&(s=Yd(t),s!==0&&(r=s,e=kh(t,s))),e===1)throw n=Ra,$s(t,0),ts(t,r),fn(t,lt()),n;if(e===6)ts(t,r);else{if(s=t.current.alternate,!(r&30)&&!SE(s)&&(e=Fu(t,r),e===2&&(i=Yd(t),i!==0&&(r=i,e=kh(t,i))),e===1))throw n=Ra,$s(t,0),ts(t,r),fn(t,lt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:Ls(t,un,Ir);break;case 3:if(ts(t,r),(r&130023424)===r&&(e=Ff+500-lt(),10<e)){if(xu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){nn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ih(Ls.bind(null,t,un,Ir),e);break}Ls(t,un,Ir);break;case 4:if(ts(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-er(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kE(r/1960))-r,10<r){t.timeoutHandle=ih(Ls.bind(null,t,un,Ir),r);break}Ls(t,un,Ir);break;case 5:Ls(t,un,Ir);break;default:throw Error(X(329))}}}return fn(t,lt()),t.callbackNode===n?Ov.bind(null,t):null}function kh(t,e){var n=aa;return t.current.memoizedState.isDehydrated&&($s(t,e).flags|=256),t=Fu(t,e),t!==2&&(e=un,un=n,e!==null&&Sh(e)),t}function Sh(t){un===null?un=t:un.push.apply(un,t)}function SE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!nr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ts(t,e){for(e&=~Vf,e&=~mc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function ag(t){if(Re&6)throw Error(X(327));Ui();var e=xu(t,0);if(!(e&1))return fn(t,lt()),null;var n=Fu(t,e);if(t.tag!==0&&n===2){var r=Yd(t);r!==0&&(e=r,n=kh(t,r))}if(n===1)throw n=Ra,$s(t,0),ts(t,e),fn(t,lt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ls(t,un,Ir),fn(t,lt()),null}function Uf(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(Yi=lt()+500,dc&&Cs())}}function Ys(t){ls!==null&&ls.tag===0&&!(Re&6)&&Ui();var e=Re;Re|=1;var n=Fn.transition,r=De;try{if(Fn.transition=null,De=1,t)return t()}finally{De=r,Fn.transition=n,Re=e,!(Re&6)&&Cs()}}function zf(){En=Di.current,qe(Di)}function $s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nE(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(xf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Su();break;case 3:Qi(),qe(dn),qe(Gt),Rf();break;case 5:Cf(r);break;case 4:Qi();break;case 13:qe(Ye);break;case 19:qe(Ye);break;case 10:kf(r.type._context);break;case 22:case 23:zf()}n=n.return}if(Tt=t,ft=t=ys(t.current,null),Nt=En=e,yt=0,Ra=null,Vf=mc=Xs=0,un=aa=null,Fs!==null){for(e=0;e<Fs.length;e++)if(n=Fs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Fs=null}return t}function Vv(t,e){do{var n=ft;try{if(Tf(),tu.current=ju,Mu){for(var r=Je.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Mu=!1}if(Qs=0,Et=gt=Je=null,ia=!1,Aa=0,Of.current=null,n===null||n.return===null){yt=1,Ra=e,ft=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=Nt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var w=p.alternate;w?(p.updateQueue=w.updateQueue,p.memoizedState=w.memoizedState,p.lanes=w.lanes):(p.updateQueue=null,p.memoizedState=null)}var C=Km(o);if(C!==null){C.flags&=-257,Qm(C,o,l,i,e),C.mode&1&&Gm(i,h,e),e=C,u=h;var M=e.updateQueue;if(M===null){var j=new Set;j.add(u),e.updateQueue=j}else M.add(u);break e}else{if(!(e&1)){Gm(i,h,e),$f();break e}u=Error(X(426))}}else if(Xe&&l.mode&1){var F=Km(o);if(F!==null){!(F.flags&65536)&&(F.flags|=256),Qm(F,o,l,i,e),Ef(Xi(u,l));break e}}i=u=Xi(u,l),yt!==4&&(yt=2),aa===null?aa=[i]:aa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=xv(i,u,e);zm(i,S);break e;case 1:l=u;var k=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof k.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ms===null||!ms.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=Ev(i,l,e);zm(i,P);break e}}i=i.return}while(i!==null)}zv(n)}catch(O){e=O,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function Fv(){var t=Lu.current;return Lu.current=ju,t===null?ju:t}function $f(){(yt===0||yt===3||yt===2)&&(yt=4),Tt===null||!(Xs&268435455)&&!(mc&268435455)||ts(Tt,Nt)}function Fu(t,e){var n=Re;Re|=2;var r=Fv();(Tt!==t||Nt!==e)&&(Ir=null,$s(t,e));do try{AE();break}catch(s){Vv(t,s)}while(!0);if(Tf(),Re=n,Lu.current=r,ft!==null)throw Error(X(261));return Tt=null,Nt=0,yt}function AE(){for(;ft!==null;)Uv(ft)}function bE(){for(;ft!==null&&!Zw();)Uv(ft)}function Uv(t){var e=Bv(t.alternate,t,En);t.memoizedProps=t.pendingProps,e===null?zv(t):ft=e,Of.current=null}function zv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=xE(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yt=6,ft=null;return}}else if(n=wE(n,e,En),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);yt===0&&(yt=5)}function Ls(t,e,n){var r=De,s=Fn.transition;try{Fn.transition=null,De=1,CE(t,e,n,r)}finally{Fn.transition=s,De=r}return null}function CE(t,e,n,r){do Ui();while(ls!==null);if(Re&6)throw Error(X(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(ux(t,i),t===Tt&&(ft=Tt=null,Nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ul||(Ul=!0,Wv(wu,function(){return Ui(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Fn.transition,Fn.transition=null;var o=De;De=1;var l=Re;Re|=4,Of.current=null,IE(t,n),jv(n,t),Qx(rh),Eu=!!nh,rh=nh=null,t.current=n,TE(n),ex(),Re=l,De=o,Fn.transition=i}else t.current=n;if(Ul&&(Ul=!1,ls=t,Vu=s),i=t.pendingLanes,i===0&&(ms=null),rx(n.stateNode),fn(t,lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ou)throw Ou=!1,t=Ih,Ih=null,t;return Vu&1&&t.tag!==0&&Ui(),i=t.pendingLanes,i&1?t===Th?la++:(la=0,Th=t):la=0,Cs(),null}function Ui(){if(ls!==null){var t=x0(Vu),e=Fn.transition,n=De;try{if(Fn.transition=null,De=16>t?16:t,ls===null)var r=!1;else{if(t=ls,ls=null,Vu=0,Re&6)throw Error(X(331));var s=Re;for(Re|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(ne=h;ne!==null;){var p=ne;switch(p.tag){case 0:case 11:case 15:oa(8,p,i)}var m=p.child;if(m!==null)m.return=p,ne=m;else for(;ne!==null;){p=ne;var w=p.sibling,C=p.return;if(Nv(p),p===h){ne=null;break}if(w!==null){w.return=C,ne=w;break}ne=C}}}var M=i.alternate;if(M!==null){var j=M.child;if(j!==null){M.child=null;do{var F=j.sibling;j.sibling=null,j=F}while(j!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:oa(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,ne=S;break e}ne=i.return}}var k=t.current;for(ne=k;ne!==null;){o=ne;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ne=T;else e:for(o=k;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:pc(9,l)}}catch(O){it(l,l.return,O)}if(l===o){ne=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,ne=P;break e}ne=l.return}}if(Re=s,Cs(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(oc,t)}catch{}r=!0}return r}finally{De=n,Fn.transition=e}}return!1}function lg(t,e,n){e=Xi(n,e),e=xv(t,e,1),t=ps(t,e,1),e=nn(),t!==null&&(Ba(t,1,e),fn(t,e))}function it(t,e,n){if(t.tag===3)lg(t,t,n);else for(;e!==null;){if(e.tag===3){lg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ms===null||!ms.has(r))){t=Xi(n,t),t=Ev(e,t,1),e=ps(e,t,1),t=nn(),e!==null&&(Ba(e,1,t),fn(e,t));break}}e=e.return}}function RE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Nt&n)===n&&(yt===4||yt===3&&(Nt&130023424)===Nt&&500>lt()-Ff?$s(t,0):Vf|=n),fn(t,e)}function $v(t,e){e===0&&(t.mode&1?(e=Rl,Rl<<=1,!(Rl&130023424)&&(Rl=4194304)):e=1);var n=nn();t=jr(t,e),t!==null&&(Ba(t,e,n),fn(t,n))}function PE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$v(t,n)}function NE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),$v(t,n)}var Bv;Bv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dn.current)cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return cn=!1,_E(t,e,n);cn=!!(t.flags&131072)}else cn=!1,Xe&&e.flags&1048576&&G0(e,Cu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ru(t,e),t=e.pendingProps;var s=qi(e,Gt.current);Fi(e,n),s=Nf(null,e,r,t,s,n);var i=Df();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(r)?(i=!0,Au(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Af(e),s.updater=fc,e.stateNode=s,s._reactInternals=e,hh(e,r,t,n),e=mh(null,e,r,!0,i,n)):(e.tag=0,Xe&&i&&wf(e),tn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ru(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=ME(r),t=Xn(r,t),s){case 0:e=ph(null,e,r,t,n);break e;case 1:e=Jm(null,e,r,t,n);break e;case 11:e=Xm(null,e,r,t,n);break e;case 14:e=Ym(null,e,r,Xn(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xn(r,s),ph(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xn(r,s),Jm(t,e,r,s,n);case 3:e:{if(Sv(e),t===null)throw Error(X(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Z0(t,e),Nu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Xi(Error(X(423)),e),e=Zm(t,e,r,n,s);break e}else if(r!==s){s=Xi(Error(X(424)),e),e=Zm(t,e,r,n,s);break e}else for(In=fs(e.stateNode.containerInfo.firstChild),Tn=e,Xe=!0,Jn=null,n=Y0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gi(),r===s){e=Lr(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return ev(e),t===null&&uh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,sh(r,s)?o=null:i!==null&&sh(r,i)&&(e.flags|=32),kv(t,e),tn(t,e,o,n),e.child;case 6:return t===null&&uh(e),null;case 13:return Av(t,e,n);case 4:return bf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ki(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xn(r,s),Xm(t,e,r,s,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,$e(Ru,r._currentValue),r._currentValue=o,i!==null)if(nr(i.value,o)){if(i.children===s.children&&!dn.current){e=Lr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Pr(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),ch(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ch(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}tn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Fi(e,n),s=Un(s),r=r(s),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,s=Xn(r,e.pendingProps),s=Xn(r.type,s),Ym(t,e,r,s,n);case 15:return Iv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xn(r,s),ru(t,e),e.tag=1,hn(r)?(t=!0,Au(e)):t=!1,Fi(e,n),wv(e,r,s),hh(e,r,s,n),mh(null,e,r,!0,t,n);case 19:return bv(t,e,n);case 22:return Tv(t,e,n)}throw Error(X(156,e.tag))};function Wv(t,e){return y0(t,e)}function DE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(t,e,n,r){return new DE(t,e,n,r)}function Bf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ME(t){if(typeof t=="function")return Bf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lf)return 11;if(t===uf)return 14}return 2}function ys(t,e){var n=t.alternate;return n===null?(n=Vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ou(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Bf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ii:return Bs(n.children,s,i,e);case af:o=8,s|=8;break;case Ld:return t=Vn(12,n,e,s|2),t.elementType=Ld,t.lanes=i,t;case Od:return t=Vn(13,n,e,s),t.elementType=Od,t.lanes=i,t;case Vd:return t=Vn(19,n,e,s),t.elementType=Vd,t.lanes=i,t;case e0:return gc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Jy:o=10;break e;case Zy:o=9;break e;case lf:o=11;break e;case uf:o=14;break e;case Jr:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=Vn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Bs(t,e,n,r){return t=Vn(7,t,r,e),t.lanes=n,t}function gc(t,e,n,r){return t=Vn(22,t,r,e),t.elementType=e0,t.lanes=n,t.stateNode={isHidden:!1},t}function yd(t,e,n){return t=Vn(6,t,null,e),t.lanes=n,t}function vd(t,e,n){return e=Vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function jE(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jc(0),this.expirationTimes=Jc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wf(t,e,n,r,s,i,o,l,u){return t=new jE(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Af(i),t}function LE(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ei,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Hv(t){if(!t)return Is;t=t._reactInternals;e:{if(si(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(hn(n))return H0(t,n,e)}return e}function qv(t,e,n,r,s,i,o,l,u){return t=Wf(n,r,!0,t,s,i,o,l,u),t.context=Hv(null),n=t.current,r=nn(),s=gs(n),i=Pr(r,s),i.callback=e??null,ps(n,i,s),t.current.lanes=s,Ba(t,s,r),fn(t,r),t}function yc(t,e,n,r){var s=e.current,i=nn(),o=gs(s);return n=Hv(n),e.context===null?e.context=n:e.pendingContext=n,e=Pr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ps(s,e,o),t!==null&&(tr(t,s,o,i),eu(t,s,o)),o}function Uu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ug(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hf(t,e){ug(t,e),(t=t.alternate)&&ug(t,e)}function OE(){return null}var Gv=typeof reportError=="function"?reportError:function(t){console.error(t)};function qf(t){this._internalRoot=t}vc.prototype.render=qf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));yc(t,e,null,null)};vc.prototype.unmount=qf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ys(function(){yc(null,t,null,null)}),e[Mr]=null}};function vc(t){this._internalRoot=t}vc.prototype.unstable_scheduleHydration=function(t){if(t){var e=T0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<es.length&&e!==0&&e<es[n].priority;n++);es.splice(n,0,t),n===0&&S0(t)}};function Gf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _c(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cg(){}function VE(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Uu(o);i.call(h)}}var o=qv(e,r,t,0,null,!1,!1,"",cg);return t._reactRootContainer=o,t[Mr]=o.current,Ea(t.nodeType===8?t.parentNode:t),Ys(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Uu(u);l.call(h)}}var u=Wf(t,0,!1,null,null,!1,!1,"",cg);return t._reactRootContainer=u,t[Mr]=u.current,Ea(t.nodeType===8?t.parentNode:t),Ys(function(){yc(e,u,n,r)}),u}function wc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=Uu(o);l.call(u)}}yc(e,o,t,s)}else o=VE(n,e,t,s,r);return Uu(o)}E0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Go(e.pendingLanes);n!==0&&(hf(e,n|1),fn(e,lt()),!(Re&6)&&(Yi=lt()+500,Cs()))}break;case 13:Ys(function(){var r=jr(t,1);if(r!==null){var s=nn();tr(r,t,1,s)}}),Hf(t,1)}};ff=function(t){if(t.tag===13){var e=jr(t,134217728);if(e!==null){var n=nn();tr(e,t,134217728,n)}Hf(t,134217728)}};I0=function(t){if(t.tag===13){var e=gs(t),n=jr(t,e);if(n!==null){var r=nn();tr(n,t,e,r)}Hf(t,e)}};T0=function(){return De};k0=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};Kd=function(t,e,n){switch(e){case"input":if(zd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=cc(r);if(!s)throw Error(X(90));n0(r),zd(r,s)}}}break;case"textarea":s0(t,n);break;case"select":e=n.value,e!=null&&ji(t,!!n.multiple,e,!1)}};d0=Uf;h0=Ys;var FE={usingClientEntryPoint:!1,Events:[Ha,Ai,cc,u0,c0,Uf]},Bo={findFiberByHostInstance:Vs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UE={bundleType:Bo.bundleType,version:Bo.version,rendererPackageName:Bo.rendererPackageName,rendererConfig:Bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Br.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=m0(t),t===null?null:t.stateNode},findFiberByHostInstance:Bo.findFiberByHostInstance||OE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{oc=zl.inject(UE),hr=zl}catch{}}Sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;Sn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gf(e))throw Error(X(200));return LE(t,e,null,n)};Sn.createRoot=function(t,e){if(!Gf(t))throw Error(X(299));var n=!1,r="",s=Gv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wf(t,1,!1,null,null,n,!1,r,s),t[Mr]=e.current,Ea(t.nodeType===8?t.parentNode:t),new qf(e)};Sn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=m0(e),t=t===null?null:t.stateNode,t};Sn.flushSync=function(t){return Ys(t)};Sn.hydrate=function(t,e,n){if(!_c(e))throw Error(X(200));return wc(null,t,e,!0,n)};Sn.hydrateRoot=function(t,e,n){if(!Gf(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Gv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=qv(e,null,t,1,n??null,s,!1,i,o),t[Mr]=e.current,Ea(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new vc(e)};Sn.render=function(t,e,n){if(!_c(e))throw Error(X(200));return wc(null,t,e,!1,n)};Sn.unmountComponentAtNode=function(t){if(!_c(t))throw Error(X(40));return t._reactRootContainer?(Ys(function(){wc(null,null,t,!1,function(){t._reactRootContainer=null,t[Mr]=null})}),!0):!1};Sn.unstable_batchedUpdates=Uf;Sn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_c(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return wc(t,e,n,!1,r)};Sn.version="18.3.1-next-f1338f8080-20240426";function Kv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kv)}catch(t){console.error(t)}}Kv(),Ky.exports=Sn;var zE=Ky.exports,dg=zE;Md.createRoot=dg.createRoot,Md.hydrateRoot=dg.hydrateRoot;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $E={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ce=(t,e)=>{const n=Q.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...h},p)=>Q.createElement("svg",{ref:p,...$E,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${BE(t)}`,l].join(" "),...h},[...e.map(([m,w])=>Q.createElement(m,w)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=ce("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=ce("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=ce("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=ce("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=ce("ArrowUpToLine",[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=ce("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=ce("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=ce("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=ce("CircleDashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=ce("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=ce("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=ce("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=ce("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=ce("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=ce("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=ce("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=ce("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=ce("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=ce("Grip",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=ce("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=ce("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=ce("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=ce("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=ce("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=ce("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=ce("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=ce("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=ce("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=ce("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=ce("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=ce("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=ce("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=ce("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=ce("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=ce("Waypoints",[["circle",{cx:"12",cy:"4.5",r:"2.5",key:"r5ysbb"}],["path",{d:"m10.2 6.3-3.9 3.9",key:"1nzqf6"}],["circle",{cx:"4.5",cy:"12",r:"2.5",key:"jydg6v"}],["path",{d:"M7 12h10",key:"b7w52i"}],["circle",{cx:"19.5",cy:"12",r:"2.5",key:"1piiel"}],["path",{d:"m13.8 17.7 3.9-3.9",key:"1wyg1y"}],["circle",{cx:"12",cy:"19.5",r:"2.5",key:"13o1pw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=ce("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=ce("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var gg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},kI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},n_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,m=(i&3)<<4|l>>4;let w=(l&15)<<2|h>>6,C=h&63;u||(C=64,o||(w=64)),r.push(n[p],n[m],n[w],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(t_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):kI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||m==null)throw new SI;const w=i<<2|l>>4;if(r.push(w),h!==64){const C=l<<4&240|h>>2;if(r.push(C),m!==64){const M=h<<6&192|m;r.push(M)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class SI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AI=function(t){const e=t_(t);return n_.encodeByteArray(e,!0)},$u=function(t){return AI(t).replace(/\./g,"")},r_=function(t){try{return n_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=()=>bI().__FIREBASE_DEFAULTS__,RI=()=>{if(typeof process>"u"||typeof gg>"u")return;const t=gg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},PI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&r_(t[1]);return e&&JSON.parse(e)},Ec=()=>{try{return CI()||RI()||PI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},s_=t=>{var e,n;return(n=(e=Ec())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},NI=t=>{const e=s_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},i_=()=>{var t;return(t=Ec())===null||t===void 0?void 0:t.config},o_=t=>{var e;return(e=Ec())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[$u(JSON.stringify(n)),$u(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())}function LI(){var t;const e=(t=Ec())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function OI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function FI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UI(){const t=Kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function zI(){return!LI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $I(){try{return typeof indexedDB=="object"}catch{return!1}}function BI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="FirebaseError";class Wr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=WI,Object.setPrototypeOf(this,Wr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ga.prototype.create)}}class Ga{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?HI(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Wr(s,l,r)}}function HI(t,e){return t.replace(qI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const qI=/\{\$([^}]+)}/g;function GI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Bu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(yg(i)&&yg(o)){if(!Bu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function yg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function KI(t,e){const n=new QI(t,e);return n.subscribe.bind(n)}class QI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");XI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=_d),s.error===void 0&&(s.error=_d),s.complete===void 0&&(s.complete=_d);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function _d(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(t){return t&&t._delegate?t._delegate:t}class Js{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new DI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZI(e))try{this.getOrInitializeService({instanceIdentifier:Os})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Os){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Os){return this.instances.has(e)}getOptions(e=Os){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:JI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Os){return this.component?this.component.multipleInstances?e:Os:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JI(t){return t===Os?void 0:t}function ZI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new YI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Se||(Se={}));const tT={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},nT=Se.INFO,rT={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},sT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qf{constructor(e){this.name=e,this._logLevel=nT,this._logHandler=sT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...e),this._logHandler(this,Se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...e),this._logHandler(this,Se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...e),this._logHandler(this,Se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...e),this._logHandler(this,Se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...e),this._logHandler(this,Se.ERROR,...e)}}const iT=(t,e)=>e.some(n=>t instanceof n);let vg,_g;function oT(){return vg||(vg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aT(){return _g||(_g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const a_=new WeakMap,Ch=new WeakMap,l_=new WeakMap,wd=new WeakMap,Xf=new WeakMap;function lT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(vs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&a_.set(n,t)}).catch(()=>{}),Xf.set(e,t),e}function uT(t){if(Ch.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ch.set(t,e)}let Rh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ch.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cT(t){Rh=t(Rh)}function dT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(xd(this),e,...n);return l_.set(r,e.sort?e.sort():[e]),vs(r)}:aT().includes(t)?function(...e){return t.apply(xd(this),e),vs(a_.get(this))}:function(...e){return vs(t.apply(xd(this),e))}}function hT(t){return typeof t=="function"?dT(t):(t instanceof IDBTransaction&&uT(t),iT(t,oT())?new Proxy(t,Rh):t)}function vs(t){if(t instanceof IDBRequest)return lT(t);if(wd.has(t))return wd.get(t);const e=hT(t);return e!==t&&(wd.set(t,e),Xf.set(e,t)),e}const xd=t=>Xf.get(t);function fT(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=vs(o);return r&&o.addEventListener("upgradeneeded",u=>{r(vs(o.result),u.oldVersion,u.newVersion,vs(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const pT=["get","getKey","getAll","getAllKeys","count"],mT=["put","add","delete","clear"],Ed=new Map;function wg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ed.get(e))return Ed.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=mT.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pT.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return Ed.set(e,i),i}cT(t=>({...t,get:(e,n,r)=>wg(e,n)||t.get(e,n,r),has:(e,n)=>!!wg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(yT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function yT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ph="@firebase/app",xg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new Qf("@firebase/app"),vT="@firebase/app-compat",_T="@firebase/analytics-compat",wT="@firebase/analytics",xT="@firebase/app-check-compat",ET="@firebase/app-check",IT="@firebase/auth",TT="@firebase/auth-compat",kT="@firebase/database",ST="@firebase/data-connect",AT="@firebase/database-compat",bT="@firebase/functions",CT="@firebase/functions-compat",RT="@firebase/installations",PT="@firebase/installations-compat",NT="@firebase/messaging",DT="@firebase/messaging-compat",MT="@firebase/performance",jT="@firebase/performance-compat",LT="@firebase/remote-config",OT="@firebase/remote-config-compat",VT="@firebase/storage",FT="@firebase/storage-compat",UT="@firebase/firestore",zT="@firebase/vertexai-preview",$T="@firebase/firestore-compat",BT="firebase",WT="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh="[DEFAULT]",HT={[Ph]:"fire-core",[vT]:"fire-core-compat",[wT]:"fire-analytics",[_T]:"fire-analytics-compat",[ET]:"fire-app-check",[xT]:"fire-app-check-compat",[IT]:"fire-auth",[TT]:"fire-auth-compat",[kT]:"fire-rtdb",[ST]:"fire-data-connect",[AT]:"fire-rtdb-compat",[bT]:"fire-fn",[CT]:"fire-fn-compat",[RT]:"fire-iid",[PT]:"fire-iid-compat",[NT]:"fire-fcm",[DT]:"fire-fcm-compat",[MT]:"fire-perf",[jT]:"fire-perf-compat",[LT]:"fire-rc",[OT]:"fire-rc-compat",[VT]:"fire-gcs",[FT]:"fire-gcs-compat",[UT]:"fire-fst",[$T]:"fire-fst-compat",[zT]:"fire-vertex","fire-js":"fire-js",[BT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new Map,qT=new Map,Dh=new Map;function Eg(t,e){try{t.container.addComponent(e)}catch(n){Or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Zi(t){const e=t.name;if(Dh.has(e))return Or.debug(`There were multiple attempts to register component ${e}.`),!1;Dh.set(e,t);for(const n of Pa.values())Eg(n,t);for(const n of qT.values())Eg(n,t);return!0}function Yf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function cr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_s=new Ga("app","Firebase",GT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _s.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=WT;function u_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Nh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw _s.create("bad-app-name",{appName:String(s)});if(n||(n=i_()),!n)throw _s.create("no-options");const i=Pa.get(s);if(i){if(Bu(n,i.options)&&Bu(r,i.config))return i;throw _s.create("duplicate-app",{appName:s})}const o=new eT(s);for(const u of Dh.values())o.addComponent(u);const l=new KT(n,r,o);return Pa.set(s,l),l}function Jf(t=Nh){const e=Pa.get(t);if(!e&&t===Nh&&i_())return u_();if(!e)throw _s.create("no-app",{appName:t});return e}function QT(){return Array.from(Pa.values())}function ws(t,e,n){var r;let s=(r=HT[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Or.warn(l.join(" "));return}Zi(new Js(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT="firebase-heartbeat-database",YT=1,Na="firebase-heartbeat-store";let Id=null;function c_(){return Id||(Id=fT(XT,YT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Na)}catch(n){console.warn(n)}}}}).catch(t=>{throw _s.create("idb-open",{originalErrorMessage:t.message})})),Id}async function JT(t){try{const n=(await c_()).transaction(Na),r=await n.objectStore(Na).get(d_(t));return await n.done,r}catch(e){if(e instanceof Wr)Or.warn(e.message);else{const n=_s.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Or.warn(n.message)}}}async function Ig(t,e){try{const r=(await c_()).transaction(Na,"readwrite");await r.objectStore(Na).put(e,d_(t)),await r.done}catch(n){if(n instanceof Wr)Or.warn(n.message);else{const r=_s.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Or.warn(r.message)}}}function d_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT=1024,e2=30*24*60*60*1e3;class t2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new r2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Tg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=e2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Tg(),{heartbeatsToSend:r,unsentEntries:s}=n2(this._heartbeatsCache.heartbeats),i=$u(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Or.warn(n),""}}}function Tg(){return new Date().toISOString().substring(0,10)}function n2(t,e=ZT){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),kg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),kg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class r2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $I()?BI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await JT(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ig(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ig(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function kg(t){return $u(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(t){Zi(new Js("platform-logger",e=>new gT(e),"PRIVATE")),Zi(new Js("heartbeat",e=>new t2(e),"PRIVATE")),ws(Ph,xg,t),ws(Ph,xg,"esm2017"),ws("fire-js","")}s2("");var i2="firebase",o2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ws(i2,o2,"app");function Zf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function h_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const a2=h_,f_=new Ga("auth","Firebase",h_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wu=new Qf("@firebase/auth");function l2(t,...e){Wu.logLevel<=Se.WARN&&Wu.warn(`Auth (${ho}): ${t}`,...e)}function lu(t,...e){Wu.logLevel<=Se.ERROR&&Wu.error(`Auth (${ho}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(t,...e){throw ep(t,...e)}function pr(t,...e){return ep(t,...e)}function p_(t,e,n){const r=Object.assign(Object.assign({},a2()),{[e]:n});return new Ga("auth","Firebase",r).create(e,{appName:t.name})}function Nr(t){return p_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ep(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return f_.create(t,...e)}function me(t,e,...n){if(!t)throw ep(e,...n)}function br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lu(e),new Error(e)}function Fr(t,e){t||br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function u2(){return Sg()==="http:"||Sg()==="https:"}function Sg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(u2()||VI()||"connection"in navigator)?navigator.onLine:!0}function d2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){this.shortDelay=e,this.longDelay=n,Fr(n>e,"Short delay should be less than long delay!"),this.isMobile=jI()||FI()}get(){return c2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(t,e){Fr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=new Qa(3e4,6e4);function Xa(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function fo(t,e,n,r,s={}){return g_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ka(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},i);return OI()||(h.referrerPolicy="no-referrer"),m_.fetch()(y_(t,t.config.apiHost,n,l),h)})}async function g_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},h2),e);try{const s=new p2(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw $l(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw $l(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw $l(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw $l(t,"user-disabled",o);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw p_(t,p,h);Vr(t,p)}}catch(s){if(s instanceof Wr)throw s;Vr(t,"network-request-failed",{message:String(s)})}}async function np(t,e,n,r,s={}){const i=await fo(t,e,n,r,s);return"mfaPendingCredential"in i&&Vr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function y_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?tp(t.config,s):`${t.config.apiScheme}://${s}`}class p2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(pr(this.auth,"network-request-failed")),f2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $l(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=pr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(t,e){return fo(t,"POST","/v1/accounts:delete",e)}async function v_(t,e){return fo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function g2(t,e=!1){const n=mn(t),r=await n.getIdToken(e),s=rp(r);me(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ua(Td(s.auth_time)),issuedAtTime:ua(Td(s.iat)),expirationTime:ua(Td(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Td(t){return Number(t)*1e3}function rp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return lu("JWT malformed, contained fewer than 3 sections"),null;try{const s=r_(n);return s?JSON.parse(s):(lu("Failed to decode base64 JWT payload"),null)}catch(s){return lu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Ag(t){const e=rp(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Da(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Wr&&y2(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function y2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ua(this.lastLoginAt),this.creationTime=ua(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Da(t,v_(n,{idToken:r}));me(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?__(i.providerUserInfo):[],l=w2(t.providerData,o),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),p=u?h:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new jh(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(t,m)}async function _2(t){const e=mn(t);await Hu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function w2(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function __(t){return t.map(e=>{var{providerId:n}=e,r=Zf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x2(t,e){const n=await g_(t,{},async()=>{const r=Ka({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=y_(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",m_.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function E2(t,e){return fo(t,"POST","/v2/accounts:revokeToken",Xa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ag(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=Ag(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await x2(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new zi;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(me(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(me(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zi,this.toJSON())}_performRefresh(){return br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yr(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Cr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new v2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new jh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Da(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return g2(this,e)}reload(){return _2(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Cr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Hu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cr(this.auth.app))return Promise.reject(Nr(this.auth));const e=await this.getIdToken();return await Da(this,m2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,h,p;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,w=(s=n.email)!==null&&s!==void 0?s:void 0,C=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,M=(o=n.photoURL)!==null&&o!==void 0?o:void 0,j=(l=n.tenantId)!==null&&l!==void 0?l:void 0,F=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,S=(h=n.createdAt)!==null&&h!==void 0?h:void 0,k=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:T,emailVerified:P,isAnonymous:O,providerData:H,stsTokenManager:E}=n;me(T&&E,e,"internal-error");const y=zi.fromJSON(this.name,E);me(typeof T=="string",e,"internal-error"),Yr(m,e.name),Yr(w,e.name),me(typeof P=="boolean",e,"internal-error"),me(typeof O=="boolean",e,"internal-error"),Yr(C,e.name),Yr(M,e.name),Yr(j,e.name),Yr(F,e.name),Yr(S,e.name),Yr(k,e.name);const x=new Cr({uid:T,auth:e,email:w,emailVerified:P,displayName:m,isAnonymous:O,photoURL:M,phoneNumber:C,tenantId:j,stsTokenManager:y,createdAt:S,lastLoginAt:k});return H&&Array.isArray(H)&&(x.providerData=H.map(I=>Object.assign({},I))),F&&(x._redirectEventId=F),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new zi;s.updateFromServerResponse(n);const i=new Cr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Hu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];me(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?__(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new zi;l.updateFromIdToken(r);const u=new Cr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new jh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg=new Map;function Rr(t){Fr(t instanceof Function,"Expected a class definition");let e=bg.get(t);return e?(Fr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,bg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}w_.type="NONE";const Cg=w_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t,e,n){return`firebase:${t}:${e}:${n}`}class $i{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=uu(this.userKey,s.apiKey,i),this.fullPersistenceKey=uu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Cr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new $i(Rr(Cg),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Rr(Cg);const o=uu(r,e.config.apiKey,e.name);let l=null;for(const h of n)try{const p=await h._get(o);if(p){const m=Cr._fromJSON(e,p);h!==i&&(l=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new $i(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new $i(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(T_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(x_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S_(e))return"Blackberry";if(A_(e))return"Webos";if(E_(e))return"Safari";if((e.includes("chrome/")||I_(e))&&!e.includes("edge/"))return"Chrome";if(k_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function x_(t=Kt()){return/firefox\//i.test(t)}function E_(t=Kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function I_(t=Kt()){return/crios\//i.test(t)}function T_(t=Kt()){return/iemobile/i.test(t)}function k_(t=Kt()){return/android/i.test(t)}function S_(t=Kt()){return/blackberry/i.test(t)}function A_(t=Kt()){return/webos/i.test(t)}function sp(t=Kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function I2(t=Kt()){var e;return sp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function T2(){return UI()&&document.documentMode===10}function b_(t=Kt()){return sp(t)||k_(t)||A_(t)||S_(t)||/windows phone/i.test(t)||T_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(t,e=[]){let n;switch(t){case"Browser":n=Rg(Kt());break;case"Worker":n=`${Rg(Kt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ho}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S2(t,e={}){return fo(t,"GET","/v2/passwordPolicy",Xa(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2=6;class b2{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:A2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pg(this),this.idTokenSubscription=new Pg(this),this.beforeStateQueue=new k2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await $i.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await v_(this,{idToken:e}),r=await Cr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(cr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Hu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=d2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cr(this.app))return Promise.reject(Nr(this));const n=e?mn(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cr(this.app)?Promise.reject(Nr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cr(this.app)?Promise.reject(Nr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await S2(this),n=new b2(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ga("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await E2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rr(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await $i.create(this,[Rr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=C_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&l2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ya(t){return mn(t)}class Pg{constructor(e){this.auth=e,this.observer=null,this.addObserver=KI(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ip={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R2(t){ip=t}function P2(t){return ip.loadJS(t)}function N2(){return ip.gapiScript}function D2(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t,e){const n=Yf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Bu(i,e??{}))return s;Vr(s,"already-initialized")}return n.initialize({options:e})}function j2(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function L2(t,e,n){const r=Ya(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=R_(e),{host:o,port:l}=O2(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),V2()}function R_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function O2(t){const e=R_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Ng(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Ng(o)}}}function Ng(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function V2(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return br("not implemented")}_getIdTokenResponse(e){return br("not implemented")}_linkToIdToken(e,n){return br("not implemented")}_getReauthenticationResolver(e){return br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bi(t,e){return np(t,"POST","/v1/accounts:signInWithIdp",Xa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="http://localhost";class Zs extends P_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Vr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Zf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Zs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Bi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bi(e,n)}buildRequest(){const e={requestUri:F2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ka(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends N_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Ja{constructor(){super("facebook.com")}static credential(e){return Zs._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.FACEBOOK_SIGN_IN_METHOD="facebook.com";ns.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends Ja{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Zs._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com";rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends Ja{constructor(){super("github.com")}static credential(e){return Zs._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ss.credential(e.oauthAccessToken)}catch{return null}}}ss.GITHUB_SIGN_IN_METHOD="github.com";ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends Ja{constructor(){super("twitter.com")}static credential(e,n){return Zs._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return is.credential(n,r)}catch{return null}}}is.TWITTER_SIGN_IN_METHOD="twitter.com";is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U2(t,e){return np(t,"POST","/v1/accounts:signUp",Xa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Cr._fromIdTokenResponse(e,r,s),o=Dg(r);return new Ur({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Dg(r);return new Ur({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Dg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2(t){var e;if(cr(t.app))return Promise.reject(Nr(t));const n=Ya(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ur({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await U2(n,{returnSecureToken:!0}),s=await Ur._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu extends Wr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,qu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new qu(e,n,r,s)}}function D_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?qu._fromErrorAndOperation(t,i,e,r):i})}async function $2(t,e,n=!1){const r=await Da(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ur._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B2(t,e,n=!1){const{auth:r}=t;if(cr(r.app))return Promise.reject(Nr(r));const s="reauthenticate";try{const i=await Da(t,D_(r,s,e,t),n);me(i.idToken,r,"internal-error");const o=rp(i.idToken);me(o,r,"internal-error");const{sub:l}=o;return me(t.uid===l,r,"user-mismatch"),Ur._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Vr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W2(t,e,n=!1){if(cr(t.app))return Promise.reject(Nr(t));const r="signIn",s=await D_(t,r,e),i=await Ur._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(t,e){return np(t,"POST","/v1/accounts:signInWithCustomToken",Xa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q2(t,e){if(cr(t.app))return Promise.reject(Nr(t));const n=Ya(t),r=await H2(n,{token:e,returnSecureToken:!0}),s=await Ur._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}function G2(t,e,n,r){return mn(t).onIdTokenChanged(e,n,r)}function K2(t,e,n){return mn(t).beforeAuthStateChanged(e,n)}function Q2(t,e,n,r){return mn(t).onAuthStateChanged(e,n,r)}const Gu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Gu,"1"),this.storage.removeItem(Gu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=1e3,Y2=10;class j_ extends M_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);T2()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Y2):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},X2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}j_.type="LOCAL";const J2=j_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_ extends M_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}L_.type="SESSION";const O_=L_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ic(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async h=>h(n.origin,i)),u=await Z2(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ic.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const h=op("",20);s.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const w=m;if(w.data.eventId===h)switch(w.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(w.data.response);break;default:clearTimeout(p),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(){return window}function tk(t){mr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(){return typeof mr().WorkerGlobalScope<"u"&&typeof mr().importScripts=="function"}async function nk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function sk(){return V_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="firebaseLocalStorageDb",ik=1,Ku="firebaseLocalStorage",U_="fbase_key";class Za{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Tc(t,e){return t.transaction([Ku],e?"readwrite":"readonly").objectStore(Ku)}function ok(){const t=indexedDB.deleteDatabase(F_);return new Za(t).toPromise()}function Lh(){const t=indexedDB.open(F_,ik);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ku,{keyPath:U_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ku)?e(r):(r.close(),await ok(),e(await Lh()))})})}async function Mg(t,e,n){const r=Tc(t,!0).put({[U_]:e,value:n});return new Za(r).toPromise()}async function ak(t,e){const n=Tc(t,!1).get(e),r=await new Za(n).toPromise();return r===void 0?null:r.value}function jg(t,e){const n=Tc(t,!0).delete(e);return new Za(n).toPromise()}const lk=800,uk=3;class z_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Lh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>uk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return V_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ic._getInstance(sk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await nk(),!this.activeServiceWorker)return;this.sender=new ek(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||rk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Lh();return await Mg(e,Gu,"1"),await jg(e,Gu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Mg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ak(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>jg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Tc(s,!1).getAll();return new Za(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}z_.type="LOCAL";const ck=z_;new Qa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t,e){return e?Rr(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends P_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function hk(t){return W2(t.auth,new ap(t),t.bypassAuthState)}function fk(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),B2(n,new ap(t),t.bypassAuthState)}async function pk(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),$2(n,new ap(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hk;case"linkViaPopup":case"linkViaRedirect":return pk;case"reauthViaPopup":case"reauthViaRedirect":return fk;default:Vr(this.auth,"internal-error")}}resolve(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=new Qa(2e3,1e4);class Mi extends $_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Mi.currentPopupAction&&Mi.currentPopupAction.cancel(),Mi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){Fr(this.filter.length===1,"Popup operations only handle one event");const e=op();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(pr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(pr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,mk.get())};e()}}Mi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk="pendingRedirect",cu=new Map;class yk extends $_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=cu.get(this.auth._key());if(!e){try{const r=await vk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}cu.set(this.auth._key(),e)}return this.bypassAuthState||cu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vk(t,e){const n=xk(e),r=wk(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function _k(t,e){cu.set(t._key(),e)}function wk(t){return Rr(t._redirectPersistence)}function xk(t){return uu(gk,t.config.apiKey,t.name)}async function Ek(t,e,n=!1){if(cr(t.app))return Promise.reject(Nr(t));const r=Ya(t),s=dk(r,e),o=await new yk(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik=10*60*1e3;class Tk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!kk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!B_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(pr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ik&&this.cachedEventUids.clear(),this.cachedEventUids.has(Lg(e))}saveEventToCache(e){this.cachedEventUids.add(Lg(e)),this.lastProcessedEventTime=Date.now()}}function Lg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function B_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function kk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return B_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sk(t,e={}){return fo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bk=/^https?/;async function Ck(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Sk(t);for(const n of e)try{if(Rk(n))return}catch{}Vr(t,"unauthorized-domain")}function Rk(t){const e=Mh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!bk.test(n))return!1;if(Ak.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=new Qa(3e4,6e4);function Og(){const t=mr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Nk(t){return new Promise((e,n)=>{var r,s,i;function o(){Og(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Og(),n(pr(t,"network-request-failed"))},timeout:Pk.get()})}if(!((s=(r=mr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=mr().gapi)===null||i===void 0)&&i.load)o();else{const l=D2("iframefcb");return mr()[l]=()=>{gapi.load?o():n(pr(t,"network-request-failed"))},P2(`${N2()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw du=null,e})}let du=null;function Dk(t){return du=du||Nk(t),du}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=new Qa(5e3,15e3),jk="__/auth/iframe",Lk="emulator/auth/iframe",Ok={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Vk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fk(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?tp(e,Lk):`https://${t.config.authDomain}/${jk}`,r={apiKey:e.apiKey,appName:t.name,v:ho},s=Vk.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ka(r).slice(1)}`}async function Uk(t){const e=await Dk(t),n=mr().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:Fk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ok,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=pr(t,"network-request-failed"),l=mr().setTimeout(()=>{i(o)},Mk.get());function u(){mr().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$k=500,Bk=600,Wk="_blank",Hk="http://localhost";class Vg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qk(t,e,n,r=$k,s=Bk){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},zk),{width:r.toString(),height:s.toString(),top:i,left:o}),h=Kt().toLowerCase();n&&(l=I_(h)?Wk:n),x_(h)&&(e=e||Hk,u.scrollbars="yes");const p=Object.entries(u).reduce((w,[C,M])=>`${w}${C}=${M},`,"");if(I2(h)&&l!=="_self")return Gk(e||"",l),new Vg(null);const m=window.open(e||"",l,p);me(m,t,"popup-blocked");try{m.focus()}catch{}return new Vg(m)}function Gk(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="__/auth/handler",Qk="emulator/auth/handler",Xk=encodeURIComponent("fac");async function Fg(t,e,n,r,s,i){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ho,eventId:s};if(e instanceof N_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",GI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof Ja){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const u=await t._getAppCheckToken(),h=u?`#${Xk}=${encodeURIComponent(u)}`:"";return`${Yk(t)}?${Ka(l).slice(1)}${h}`}function Yk({config:t}){return t.emulator?tp(t,Qk):`https://${t.authDomain}/${Kk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd="webStorageSupport";class Jk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O_,this._completeRedirectFn=Ek,this._overrideRedirectResult=_k}async _openPopup(e,n,r,s){var i;Fr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Fg(e,n,r,Mh(),s);return qk(e,o,op())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Fg(e,n,r,Mh(),s);return tk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Fr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Uk(e),r=new Tk(e);return n.register("authEvent",s=>(me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(kd,{type:kd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[kd];o!==void 0&&n(!!o),Vr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ck(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return b_()||E_()||sp()}}const Zk=Jk;var Ug="@firebase/auth",zg="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nS(t){Zi(new Js("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:C_(t)},h=new C2(r,s,i,u);return j2(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Zi(new Js("auth-internal",e=>{const n=Ya(e.getProvider("auth").getImmediate());return(r=>new eS(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ws(Ug,zg,tS(t)),ws(Ug,zg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=5*60,sS=o_("authIdTokenMaxAge")||rS;let $g=null;const iS=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>sS)return;const s=n==null?void 0:n.token;$g!==s&&($g=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function oS(t=Jf()){const e=Yf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=M2(t,{popupRedirectResolver:Zk,persistence:[ck,J2,O_]}),r=o_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=iS(i.toString());K2(n,o,()=>o(n.currentUser)),G2(n,l=>o(l))}}const s=s_("auth");return s&&L2(n,`http://${s}`),n}function aS(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}R2({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=pr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",aS().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nS("Browser");var Bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ws,W_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,y){function x(){}x.prototype=y.prototype,E.D=y.prototype,E.prototype=new x,E.prototype.constructor=E,E.C=function(I,R,N){for(var A=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)A[fe-2]=arguments[fe];return y.prototype[R].apply(I,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,y,x){x||(x=0);var I=Array(16);if(typeof y=="string")for(var R=0;16>R;++R)I[R]=y.charCodeAt(x++)|y.charCodeAt(x++)<<8|y.charCodeAt(x++)<<16|y.charCodeAt(x++)<<24;else for(R=0;16>R;++R)I[R]=y[x++]|y[x++]<<8|y[x++]<<16|y[x++]<<24;y=E.g[0],x=E.g[1],R=E.g[2];var N=E.g[3],A=y+(N^x&(R^N))+I[0]+3614090360&4294967295;y=x+(A<<7&4294967295|A>>>25),A=N+(R^y&(x^R))+I[1]+3905402710&4294967295,N=y+(A<<12&4294967295|A>>>20),A=R+(x^N&(y^x))+I[2]+606105819&4294967295,R=N+(A<<17&4294967295|A>>>15),A=x+(y^R&(N^y))+I[3]+3250441966&4294967295,x=R+(A<<22&4294967295|A>>>10),A=y+(N^x&(R^N))+I[4]+4118548399&4294967295,y=x+(A<<7&4294967295|A>>>25),A=N+(R^y&(x^R))+I[5]+1200080426&4294967295,N=y+(A<<12&4294967295|A>>>20),A=R+(x^N&(y^x))+I[6]+2821735955&4294967295,R=N+(A<<17&4294967295|A>>>15),A=x+(y^R&(N^y))+I[7]+4249261313&4294967295,x=R+(A<<22&4294967295|A>>>10),A=y+(N^x&(R^N))+I[8]+1770035416&4294967295,y=x+(A<<7&4294967295|A>>>25),A=N+(R^y&(x^R))+I[9]+2336552879&4294967295,N=y+(A<<12&4294967295|A>>>20),A=R+(x^N&(y^x))+I[10]+4294925233&4294967295,R=N+(A<<17&4294967295|A>>>15),A=x+(y^R&(N^y))+I[11]+2304563134&4294967295,x=R+(A<<22&4294967295|A>>>10),A=y+(N^x&(R^N))+I[12]+1804603682&4294967295,y=x+(A<<7&4294967295|A>>>25),A=N+(R^y&(x^R))+I[13]+4254626195&4294967295,N=y+(A<<12&4294967295|A>>>20),A=R+(x^N&(y^x))+I[14]+2792965006&4294967295,R=N+(A<<17&4294967295|A>>>15),A=x+(y^R&(N^y))+I[15]+1236535329&4294967295,x=R+(A<<22&4294967295|A>>>10),A=y+(R^N&(x^R))+I[1]+4129170786&4294967295,y=x+(A<<5&4294967295|A>>>27),A=N+(x^R&(y^x))+I[6]+3225465664&4294967295,N=y+(A<<9&4294967295|A>>>23),A=R+(y^x&(N^y))+I[11]+643717713&4294967295,R=N+(A<<14&4294967295|A>>>18),A=x+(N^y&(R^N))+I[0]+3921069994&4294967295,x=R+(A<<20&4294967295|A>>>12),A=y+(R^N&(x^R))+I[5]+3593408605&4294967295,y=x+(A<<5&4294967295|A>>>27),A=N+(x^R&(y^x))+I[10]+38016083&4294967295,N=y+(A<<9&4294967295|A>>>23),A=R+(y^x&(N^y))+I[15]+3634488961&4294967295,R=N+(A<<14&4294967295|A>>>18),A=x+(N^y&(R^N))+I[4]+3889429448&4294967295,x=R+(A<<20&4294967295|A>>>12),A=y+(R^N&(x^R))+I[9]+568446438&4294967295,y=x+(A<<5&4294967295|A>>>27),A=N+(x^R&(y^x))+I[14]+3275163606&4294967295,N=y+(A<<9&4294967295|A>>>23),A=R+(y^x&(N^y))+I[3]+4107603335&4294967295,R=N+(A<<14&4294967295|A>>>18),A=x+(N^y&(R^N))+I[8]+1163531501&4294967295,x=R+(A<<20&4294967295|A>>>12),A=y+(R^N&(x^R))+I[13]+2850285829&4294967295,y=x+(A<<5&4294967295|A>>>27),A=N+(x^R&(y^x))+I[2]+4243563512&4294967295,N=y+(A<<9&4294967295|A>>>23),A=R+(y^x&(N^y))+I[7]+1735328473&4294967295,R=N+(A<<14&4294967295|A>>>18),A=x+(N^y&(R^N))+I[12]+2368359562&4294967295,x=R+(A<<20&4294967295|A>>>12),A=y+(x^R^N)+I[5]+4294588738&4294967295,y=x+(A<<4&4294967295|A>>>28),A=N+(y^x^R)+I[8]+2272392833&4294967295,N=y+(A<<11&4294967295|A>>>21),A=R+(N^y^x)+I[11]+1839030562&4294967295,R=N+(A<<16&4294967295|A>>>16),A=x+(R^N^y)+I[14]+4259657740&4294967295,x=R+(A<<23&4294967295|A>>>9),A=y+(x^R^N)+I[1]+2763975236&4294967295,y=x+(A<<4&4294967295|A>>>28),A=N+(y^x^R)+I[4]+1272893353&4294967295,N=y+(A<<11&4294967295|A>>>21),A=R+(N^y^x)+I[7]+4139469664&4294967295,R=N+(A<<16&4294967295|A>>>16),A=x+(R^N^y)+I[10]+3200236656&4294967295,x=R+(A<<23&4294967295|A>>>9),A=y+(x^R^N)+I[13]+681279174&4294967295,y=x+(A<<4&4294967295|A>>>28),A=N+(y^x^R)+I[0]+3936430074&4294967295,N=y+(A<<11&4294967295|A>>>21),A=R+(N^y^x)+I[3]+3572445317&4294967295,R=N+(A<<16&4294967295|A>>>16),A=x+(R^N^y)+I[6]+76029189&4294967295,x=R+(A<<23&4294967295|A>>>9),A=y+(x^R^N)+I[9]+3654602809&4294967295,y=x+(A<<4&4294967295|A>>>28),A=N+(y^x^R)+I[12]+3873151461&4294967295,N=y+(A<<11&4294967295|A>>>21),A=R+(N^y^x)+I[15]+530742520&4294967295,R=N+(A<<16&4294967295|A>>>16),A=x+(R^N^y)+I[2]+3299628645&4294967295,x=R+(A<<23&4294967295|A>>>9),A=y+(R^(x|~N))+I[0]+4096336452&4294967295,y=x+(A<<6&4294967295|A>>>26),A=N+(x^(y|~R))+I[7]+1126891415&4294967295,N=y+(A<<10&4294967295|A>>>22),A=R+(y^(N|~x))+I[14]+2878612391&4294967295,R=N+(A<<15&4294967295|A>>>17),A=x+(N^(R|~y))+I[5]+4237533241&4294967295,x=R+(A<<21&4294967295|A>>>11),A=y+(R^(x|~N))+I[12]+1700485571&4294967295,y=x+(A<<6&4294967295|A>>>26),A=N+(x^(y|~R))+I[3]+2399980690&4294967295,N=y+(A<<10&4294967295|A>>>22),A=R+(y^(N|~x))+I[10]+4293915773&4294967295,R=N+(A<<15&4294967295|A>>>17),A=x+(N^(R|~y))+I[1]+2240044497&4294967295,x=R+(A<<21&4294967295|A>>>11),A=y+(R^(x|~N))+I[8]+1873313359&4294967295,y=x+(A<<6&4294967295|A>>>26),A=N+(x^(y|~R))+I[15]+4264355552&4294967295,N=y+(A<<10&4294967295|A>>>22),A=R+(y^(N|~x))+I[6]+2734768916&4294967295,R=N+(A<<15&4294967295|A>>>17),A=x+(N^(R|~y))+I[13]+1309151649&4294967295,x=R+(A<<21&4294967295|A>>>11),A=y+(R^(x|~N))+I[4]+4149444226&4294967295,y=x+(A<<6&4294967295|A>>>26),A=N+(x^(y|~R))+I[11]+3174756917&4294967295,N=y+(A<<10&4294967295|A>>>22),A=R+(y^(N|~x))+I[2]+718787259&4294967295,R=N+(A<<15&4294967295|A>>>17),A=x+(N^(R|~y))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(R+(A<<21&4294967295|A>>>11))&4294967295,E.g[2]=E.g[2]+R&4294967295,E.g[3]=E.g[3]+N&4294967295}r.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var x=y-this.blockSize,I=this.B,R=this.h,N=0;N<y;){if(R==0)for(;N<=x;)s(this,E,N),N+=this.blockSize;if(typeof E=="string"){for(;N<y;)if(I[R++]=E.charCodeAt(N++),R==this.blockSize){s(this,I),R=0;break}}else for(;N<y;)if(I[R++]=E[N++],R==this.blockSize){s(this,I),R=0;break}}this.h=R,this.o+=y},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var x=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=x&255,x/=256;for(this.u(E),E=Array(16),y=x=0;4>y;++y)for(var I=0;32>I;I+=8)E[x++]=this.g[y]>>>I&255;return E};function i(E,y){var x=l;return Object.prototype.hasOwnProperty.call(x,E)?x[E]:x[E]=y(E)}function o(E,y){this.h=y;for(var x=[],I=!0,R=E.length-1;0<=R;R--){var N=E[R]|0;I&&N==y||(x[R]=N,I=!1)}this.g=x}var l={};function u(E){return-128<=E&&128>E?i(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return F(h(-E));for(var y=[],x=1,I=0;E>=x;I++)y[I]=E/x|0,x*=4294967296;return new o(y,0)}function p(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return F(p(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=h(Math.pow(y,8)),I=m,R=0;R<E.length;R+=8){var N=Math.min(8,E.length-R),A=parseInt(E.substring(R,R+N),y);8>N?(N=h(Math.pow(y,N)),I=I.j(N).add(h(A))):(I=I.j(x),I=I.add(h(A)))}return I}var m=u(0),w=u(1),C=u(16777216);t=o.prototype,t.m=function(){if(j(this))return-F(this).m();for(var E=0,y=1,x=0;x<this.g.length;x++){var I=this.i(x);E+=(0<=I?I:4294967296+I)*y,y*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(M(this))return"0";if(j(this))return"-"+F(this).toString(E);for(var y=h(Math.pow(E,6)),x=this,I="";;){var R=P(x,y).g;x=S(x,R.j(y));var N=((0<x.g.length?x.g[0]:x.h)>>>0).toString(E);if(x=R,M(x))return N+I;for(;6>N.length;)N="0"+N;I=N+I}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function M(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function j(E){return E.h==-1}t.l=function(E){return E=S(this,E),j(E)?-1:M(E)?0:1};function F(E){for(var y=E.g.length,x=[],I=0;I<y;I++)x[I]=~E.g[I];return new o(x,~E.h).add(w)}t.abs=function(){return j(this)?F(this):this},t.add=function(E){for(var y=Math.max(this.g.length,E.g.length),x=[],I=0,R=0;R<=y;R++){var N=I+(this.i(R)&65535)+(E.i(R)&65535),A=(N>>>16)+(this.i(R)>>>16)+(E.i(R)>>>16);I=A>>>16,N&=65535,A&=65535,x[R]=A<<16|N}return new o(x,x[x.length-1]&-2147483648?-1:0)};function S(E,y){return E.add(F(y))}t.j=function(E){if(M(this)||M(E))return m;if(j(this))return j(E)?F(this).j(F(E)):F(F(this).j(E));if(j(E))return F(this.j(F(E)));if(0>this.l(C)&&0>E.l(C))return h(this.m()*E.m());for(var y=this.g.length+E.g.length,x=[],I=0;I<2*y;I++)x[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<E.g.length;R++){var N=this.i(I)>>>16,A=this.i(I)&65535,fe=E.i(R)>>>16,tt=E.i(R)&65535;x[2*I+2*R]+=A*tt,k(x,2*I+2*R),x[2*I+2*R+1]+=N*tt,k(x,2*I+2*R+1),x[2*I+2*R+1]+=A*fe,k(x,2*I+2*R+1),x[2*I+2*R+2]+=N*fe,k(x,2*I+2*R+2)}for(I=0;I<y;I++)x[I]=x[2*I+1]<<16|x[2*I];for(I=y;I<2*y;I++)x[I]=0;return new o(x,0)};function k(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function T(E,y){this.g=E,this.h=y}function P(E,y){if(M(y))throw Error("division by zero");if(M(E))return new T(m,m);if(j(E))return y=P(F(E),y),new T(F(y.g),F(y.h));if(j(y))return y=P(E,F(y)),new T(F(y.g),y.h);if(30<E.g.length){if(j(E)||j(y))throw Error("slowDivide_ only works with positive integers.");for(var x=w,I=y;0>=I.l(E);)x=O(x),I=O(I);var R=H(x,1),N=H(I,1);for(I=H(I,2),x=H(x,2);!M(I);){var A=N.add(I);0>=A.l(E)&&(R=R.add(x),N=A),I=H(I,1),x=H(x,1)}return y=S(E,R.j(y)),new T(R,y)}for(R=m;0<=E.l(y);){for(x=Math.max(1,Math.floor(E.m()/y.m())),I=Math.ceil(Math.log(x)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),N=h(x),A=N.j(y);j(A)||0<A.l(E);)x-=I,N=h(x),A=N.j(y);M(N)&&(N=w),R=R.add(N),E=S(E,A)}return new T(R,E)}t.A=function(E){return P(this,E).h},t.and=function(E){for(var y=Math.max(this.g.length,E.g.length),x=[],I=0;I<y;I++)x[I]=this.i(I)&E.i(I);return new o(x,this.h&E.h)},t.or=function(E){for(var y=Math.max(this.g.length,E.g.length),x=[],I=0;I<y;I++)x[I]=this.i(I)|E.i(I);return new o(x,this.h|E.h)},t.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),x=[],I=0;I<y;I++)x[I]=this.i(I)^E.i(I);return new o(x,this.h^E.h)};function O(E){for(var y=E.g.length+1,x=[],I=0;I<y;I++)x[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(x,E.h)}function H(E,y){var x=y>>5;y%=32;for(var I=E.g.length-x,R=[],N=0;N<I;N++)R[N]=0<y?E.i(N+x)>>>y|E.i(N+x+1)<<32-y:E.i(N+x);return new o(R,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,W_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,Ws=o}).apply(typeof Bg<"u"?Bg:typeof self<"u"?self:typeof window<"u"?window:{});var Bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var H_,Qo,q_,hu,Oh,G_,K_,Q_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,f){return a==Array.prototype||a==Object.prototype||(a[d]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bl=="object"&&Bl];for(var d=0;d<a.length;++d){var f=a[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(a,d){if(d)e:{var f=r;a=a.split(".");for(var v=0;v<a.length-1;v++){var L=a[v];if(!(L in f))break e;f=f[L]}a=a[a.length-1],v=f[a],d=d(v),d!=v&&d!=null&&e(f,a,{configurable:!0,writable:!0,value:d})}}function i(a,d){a instanceof String&&(a+="");var f=0,v=!1,L={next:function(){if(!v&&f<a.length){var U=f++;return{value:d(U,a[U]),done:!1}}return v=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(a){return a||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function h(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function p(a,d,f){return a.call.apply(a.bind,arguments)}function m(a,d,f){if(!a)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,v),a.apply(d,L)}}return function(){return a.apply(d,arguments)}}function w(a,d,f){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,w.apply(null,arguments)}function C(a,d){var f=Array.prototype.slice.call(arguments,1);return function(){var v=f.slice();return v.push.apply(v,arguments),a.apply(this,v)}}function M(a,d){function f(){}f.prototype=d.prototype,a.aa=d.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(v,L,U){for(var J=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)J[Fe-2]=arguments[Fe];return d.prototype[L].apply(v,J)}}function j(a){const d=a.length;if(0<d){const f=Array(d);for(let v=0;v<d;v++)f[v]=a[v];return f}return[]}function F(a,d){for(let f=1;f<arguments.length;f++){const v=arguments[f];if(u(v)){const L=a.length||0,U=v.length||0;a.length=L+U;for(let J=0;J<U;J++)a[L+J]=v[J]}else a.push(v)}}class S{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function k(a){return/^[\s\xa0]*$/.test(a)}function T(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function P(a){return P[" "](a),a}P[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function H(a,d,f){for(const v in a)d.call(f,a[v],v,a)}function E(a,d){for(const f in a)d.call(void 0,a[f],f,a)}function y(a){const d={};for(const f in a)d[f]=a[f];return d}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,d){let f,v;for(let L=1;L<arguments.length;L++){v=arguments[L];for(f in v)a[f]=v[f];for(let U=0;U<x.length;U++)f=x[U],Object.prototype.hasOwnProperty.call(v,f)&&(a[f]=v[f])}}function R(a){var d=1;a=a.split(":");const f=[];for(;0<d&&a.length;)f.push(a.shift()),d--;return a.length&&f.push(a.join(":")),f}function N(a){l.setTimeout(()=>{throw a},0)}function A(){var a=B;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class fe{constructor(){this.h=this.g=null}add(d,f){const v=tt.get();v.set(d,f),this.h?this.h.next=v:this.g=v,this.h=v}}var tt=new S(()=>new on,a=>a.reset());class on{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Lt,ee=!1,B=new fe,de=()=>{const a=l.Promise.resolve(void 0);Lt=()=>{a.then(le)}};var le=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(f){N(f)}var d=tt;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}ee=!1};function Ce(){this.s=this.s,this.C=this.C}Ce.prototype.s=!1,Ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function he(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}he.prototype.h=function(){this.defaultPrevented=!0};var Qt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return a}();function Xt(a,d){if(he.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,v=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(O){e:{try{P(d.nodeName);var L=!0;break e}catch{}L=!1}L||(d=null)}}else f=="mouseover"?d=a.fromElement:f=="mouseout"&&(d=a.toElement);this.relatedTarget=d,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:bn[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Xt.aa.h.call(this)}}M(Xt,he);var bn={2:"touch",3:"pen",4:"mouse"};Xt.prototype.h=function(){Xt.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var kt="closure_listenable_"+(1e6*Math.random()|0),_o=0;function gn(a,d,f,v,L){this.listener=a,this.proxy=null,this.src=d,this.type=f,this.capture=!!v,this.ha=L,this.key=++_o,this.da=this.fa=!1}function sr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Cn(a){this.src=a,this.g={},this.h=0}Cn.prototype.add=function(a,d,f,v,L){var U=a.toString();a=this.g[U],a||(a=this.g[U]=[],this.h++);var J=Rn(a,d,v,L);return-1<J?(d=a[J],f||(d.fa=!1)):(d=new gn(d,this.src,U,!!v,L),d.fa=f,a.push(d)),d};function ot(a,d){var f=d.type;if(f in a.g){var v=a.g[f],L=Array.prototype.indexOf.call(v,d,void 0),U;(U=0<=L)&&Array.prototype.splice.call(v,L,1),U&&(sr(d),a.g[f].length==0&&(delete a.g[f],a.h--))}}function Rn(a,d,f,v){for(var L=0;L<a.length;++L){var U=a[L];if(!U.da&&U.listener==d&&U.capture==!!f&&U.ha==v)return L}return-1}var $n="closure_lm_"+(1e6*Math.random()|0),Yt={};function wo(a,d,f,v,L){if(Array.isArray(d)){for(var U=0;U<d.length;U++)wo(a,d[U],f,v,L);return null}return f=ai(f),a&&a[kt]?a.K(d,f,h(v)?!!v.capture:!1,L):al(a,d,f,!1,v,L)}function al(a,d,f,v,L,U){if(!d)throw Error("Invalid event type");var J=h(L)?!!L.capture:!!L,Fe=Pn(a);if(Fe||(a[$n]=Fe=new Cn(a)),f=Fe.add(d,f,v,J,U),f.proxy)return f;if(v=ye(),f.proxy=v,v.src=a,v.listener=f,a.addEventListener)Qt||(L=J),L===void 0&&(L=!1),a.addEventListener(d.toString(),v,L);else if(a.attachEvent)a.attachEvent(yn(d.toString()),v);else if(a.addListener&&a.removeListener)a.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return f}function ye(){function a(f){return d.call(a.src,a.listener,f)}const d=Hr;return a}function Ge(a,d,f,v,L){if(Array.isArray(d))for(var U=0;U<d.length;U++)Ge(a,d[U],f,v,L);else v=h(v)?!!v.capture:!!v,f=ai(f),a&&a[kt]?(a=a.i,d=String(d).toString(),d in a.g&&(U=a.g[d],f=Rn(U,f,v,L),-1<f&&(sr(U[f]),Array.prototype.splice.call(U,f,1),U.length==0&&(delete a.g[d],a.h--)))):a&&(a=Pn(a))&&(d=a.g[d.toString()],a=-1,d&&(a=Rn(d,f,v,L)),(f=-1<a?d[a]:null)&&an(f))}function an(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[kt])ot(d.i,a);else{var f=a.type,v=a.proxy;d.removeEventListener?d.removeEventListener(f,v,a.capture):d.detachEvent?d.detachEvent(yn(f),v):d.addListener&&d.removeListener&&d.removeListener(v),(f=Pn(d))?(ot(f,a),f.h==0&&(f.src=null,d[$n]=null)):sr(a)}}}function yn(a){return a in Yt?Yt[a]:Yt[a]="on"+a}function Hr(a,d){if(a.da)a=!0;else{d=new Xt(d,this);var f=a.listener,v=a.ha||a.src;a.fa&&an(a),a=f.call(v,d)}return a}function Pn(a){return a=a[$n],a instanceof Cn?a:null}var Bn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ai(a){return typeof a=="function"?a:(a[Bn]||(a[Bn]=function(d){return a.handleEvent(d)}),a[Bn])}function je(){Ce.call(this),this.i=new Cn(this),this.M=this,this.F=null}M(je,Ce),je.prototype[kt]=!0,je.prototype.removeEventListener=function(a,d,f,v){Ge(this,a,d,f,v)};function Ke(a,d){var f,v=a.F;if(v)for(f=[];v;v=v.F)f.push(v);if(a=a.M,v=d.type||d,typeof d=="string")d=new he(d,a);else if(d instanceof he)d.target=d.target||a;else{var L=d;d=new he(v,a),I(d,L)}if(L=!0,f)for(var U=f.length-1;0<=U;U--){var J=d.g=f[U];L=vn(J,v,!0,d)&&L}if(J=d.g=a,L=vn(J,v,!0,d)&&L,L=vn(J,v,!1,d)&&L,f)for(U=0;U<f.length;U++)J=d.g=f[U],L=vn(J,v,!1,d)&&L}je.prototype.N=function(){if(je.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var f=a.g[d],v=0;v<f.length;v++)sr(f[v]);delete a.g[d],a.h--}}this.F=null},je.prototype.K=function(a,d,f,v){return this.i.add(String(a),d,!1,f,v)},je.prototype.L=function(a,d,f,v){return this.i.add(String(a),d,!0,f,v)};function vn(a,d,f,v){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var L=!0,U=0;U<d.length;++U){var J=d[U];if(J&&!J.da&&J.capture==f){var Fe=J.listener,bt=J.ha||J.src;J.fa&&ot(a.i,J),L=Fe.call(bt,v)!==!1&&L}}return L&&!v.defaultPrevented}function ll(a,d,f){if(typeof a=="function")f&&(a=w(a,f));else if(a&&typeof a.handleEvent=="function")a=w(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function li(a){a.g=ll(()=>{a.g=null,a.i&&(a.i=!1,li(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class Up extends Ce{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:li(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nn(a){Ce.call(this),this.h=a,this.g={}}M(Nn,Ce);var xo=[];function ul(a){H(a.g,function(d,f){this.g.hasOwnProperty(f)&&an(d)},a),a.g={}}Nn.prototype.N=function(){Nn.aa.N.call(this),ul(this)},Nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ui=l.JSON.stringify,Lc=l.JSON.parse,cl=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function ir(){}ir.prototype.h=null;function Eo(a){return a.h||(a.h=a.i())}function dl(){}var qr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ie(){he.call(this,"d")}M(Ie,he);function Le(){he.call(this,"c")}M(Le,he);var Ot={},Oc=null;function Rs(){return Oc=Oc||new je}Ot.La="serverreachability";function Gr(a){he.call(this,Ot.La,a)}M(Gr,he);function Jt(a){const d=Rs();Ke(d,new Gr(d))}Ot.STAT_EVENT="statevent";function Kr(a,d){he.call(this,Ot.STAT_EVENT,a),this.stat=d}M(Kr,he);function nt(a){const d=Rs();Ke(d,new Kr(d,a))}Ot.Ma="timingevent";function ci(a,d){he.call(this,Ot.Ma,a),this.size=d}M(ci,he);function Qr(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function Zt(){this.g=!0}Zt.prototype.xa=function(){this.g=!1};function St(a,d,f,v,L,U){a.info(function(){if(a.g)if(U)for(var J="",Fe=U.split("&"),bt=0;bt<Fe.length;bt++){var Pe=Fe[bt].split("=");if(1<Pe.length){var Vt=Pe[0];Pe=Pe[1];var Ft=Vt.split("_");J=2<=Ft.length&&Ft[1]=="type"?J+(Vt+"="+Pe+"&"):J+(Vt+"=redacted&")}}else J=null;else J=U;return"XMLHTTP REQ ("+v+") [attempt "+L+"]: "+d+`
`+f+`
`+J})}function rt(a,d,f,v,L,U,J){a.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+L+"]: "+d+`
`+f+`
`+U+" "+J})}function ut(a,d,f,v){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+_n(a,f)+(v?" "+v:"")})}function Vc(a,d){a.info(function(){return"TIMEOUT: "+d})}Zt.prototype.info=function(){};function _n(a,d){if(!a.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var v=f[a];if(!(2>v.length)){var L=v[1];if(Array.isArray(L)&&!(1>L.length)){var U=L[0];if(U!="noop"&&U!="stop"&&U!="close")for(var J=1;J<L.length;J++)L[J]=""}}}}return ui(f)}catch{return d}}var Dn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},hl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Io;function Ps(){}M(Ps,ir),Ps.prototype.g=function(){return new XMLHttpRequest},Ps.prototype.i=function(){return{}},Io=new Ps;function Wn(a,d,f,v){this.j=a,this.i=d,this.l=f,this.R=v||1,this.U=new Nn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fl}function fl(){this.i=null,this.g="",this.h=!1}var pl={},To={};function di(a,d,f){a.L=1,a.v=D(Gn(d)),a.m=f,a.P=!0,ml(a,null)}function ml(a,d){a.F=Date.now(),hi(a),a.A=Gn(a.v);var f=a.A,v=a.R;Array.isArray(v)||(v=[String(v)]),Be(f.i,"t",v),a.C=0,f=a.j.J,a.h=new fl,a.g=Zp(a.j,f?d:null,!a.m),0<a.O&&(a.M=new Up(w(a.Y,a,a.g),a.O)),d=a.U,f=a.g,v=a.ca;var L="readystatechange";Array.isArray(L)||(L&&(xo[0]=L.toString()),L=xo);for(var U=0;U<L.length;U++){var J=wo(f,L[U],v||d.handleEvent,!1,d.h||d);if(!J)break;d.g[J.key]=J}d=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),Jt(),St(a.i,a.u,a.A,a.l,a.R,a.m)}Wn.prototype.ca=function(a){a=a.target;const d=this.M;d&&Er(a)==3?d.j():this.Y(a)},Wn.prototype.Y=function(a){try{if(a==this.g)e:{const Ft=Er(this.g);var d=this.g.Ba();const gi=this.g.Z();if(!(3>Ft)&&(Ft!=3||this.g&&(this.h.h||this.g.oa()||$p(this.g)))){this.J||Ft!=4||d==7||(d==8||0>=gi?Jt(3):Jt(2)),ko(this);var f=this.g.Z();this.X=f;t:if(Ns(this)){var v=$p(this.g);a="";var L=v.length,U=Er(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){or(this),Hn(this);var J="";break t}this.h.i=new l.TextDecoder}for(d=0;d<L;d++)this.h.h=!0,a+=this.h.i.decode(v[d],{stream:!(U&&d==L-1)});v.length=0,this.h.g+=a,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=f==200,rt(this.i,this.u,this.A,this.l,this.R,Ft,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,bt=this.g;if((Fe=bt.g?bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Fe)){var Pe=Fe;break t}}Pe=null}if(f=Pe)ut(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,So(this,f);else{this.o=!1,this.s=3,nt(12),or(this),Hn(this);break e}}if(this.P){f=!0;let Kn;for(;!this.J&&this.C<J.length;)if(Kn=Fc(this,J),Kn==To){Ft==4&&(this.s=4,nt(14),f=!1),ut(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==pl){this.s=4,nt(15),ut(this.i,this.l,J,"[Invalid Chunk]"),f=!1;break}else ut(this.i,this.l,Kn,null),So(this,Kn);if(Ns(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||J.length!=0||this.h.h||(this.s=1,nt(16),f=!1),this.o=this.o&&f,!f)ut(this.i,this.l,J,"[Invalid Chunked Response]"),or(this),Hn(this);else if(0<J.length&&!this.W){this.W=!0;var Vt=this.j;Vt.g==this&&Vt.ba&&!Vt.M&&(Vt.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Hc(Vt),Vt.M=!0,nt(11))}}else ut(this.i,this.l,J,null),So(this,J);Ft==4&&or(this),this.o&&!this.J&&(Ft==4?Qp(this.j,this):(this.o=!1,hi(this)))}else fw(this.g),f==400&&0<J.indexOf("Unknown SID")?(this.s=3,nt(12)):(this.s=0,nt(13)),or(this),Hn(this)}}}catch{}finally{}};function Ns(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Fc(a,d){var f=a.C,v=d.indexOf(`
`,f);return v==-1?To:(f=Number(d.substring(f,v)),isNaN(f)?pl:(v+=1,v+f>d.length?To:(d=d.slice(v,v+f),a.C=v+f,d)))}Wn.prototype.cancel=function(){this.J=!0,or(this)};function hi(a){a.S=Date.now()+a.I,gl(a,a.I)}function gl(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Qr(w(a.ba,a),d)}function ko(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Wn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Vc(this.i,this.A),this.L!=2&&(Jt(),nt(17)),or(this),this.s=2,Hn(this)):gl(this,this.S-a)};function Hn(a){a.j.G==0||a.J||Qp(a.j,a)}function or(a){ko(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,ul(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function So(a,d){try{var f=a.j;if(f.G!=0&&(f.g==a||Co(f.h,a))){if(!a.K&&Co(f.h,a)&&f.G==3){try{var v=f.Da.g.parse(d)}catch{v=null}if(Array.isArray(v)&&v.length==3){var L=v;if(L[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)El(f),wl(f);else break e;Wc(f),nt(18)}}else f.za=L[1],0<f.za-f.T&&37500>L[2]&&f.F&&f.v==0&&!f.C&&(f.C=Qr(w(f.Za,f),6e3));if(1>=bo(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ms(f,11)}else if((a.K||f.g==a)&&El(f),!k(d))for(L=f.Da.g.parse(d),d=0;d<L.length;d++){let Pe=L[d];if(f.T=Pe[0],Pe=Pe[1],f.G==2)if(Pe[0]=="c"){f.K=Pe[1],f.ia=Pe[2];const Vt=Pe[3];Vt!=null&&(f.la=Vt,f.j.info("VER="+f.la));const Ft=Pe[4];Ft!=null&&(f.Aa=Ft,f.j.info("SVER="+f.Aa));const gi=Pe[5];gi!=null&&typeof gi=="number"&&0<gi&&(v=1.5*gi,f.L=v,f.j.info("backChannelRequestTimeoutMs_="+v)),v=f;const Kn=a.g;if(Kn){const Tl=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tl){var U=v.h;U.g||Tl.indexOf("spdy")==-1&&Tl.indexOf("quic")==-1&&Tl.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(Ro(U,U.h),U.h=null))}if(v.D){const qc=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;qc&&(v.ya=qc,b(v.I,v.D,qc))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),v=f;var J=a;if(v.qa=Jp(v,v.J?v.ia:null,v.W),J.K){yl(v.h,J);var Fe=J,bt=v.L;bt&&(Fe.I=bt),Fe.B&&(ko(Fe),hi(Fe)),v.g=J}else Gp(v);0<f.i.length&&xl(f)}else Pe[0]!="stop"&&Pe[0]!="close"||Ms(f,7);else f.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?Ms(f,7):Bc(f):Pe[0]!="noop"&&f.l&&f.l.ta(Pe),f.v=0)}}Jt(4)}catch{}}var Uc=class{constructor(a,d){this.g=a,this.map=d}};function Ao(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fi(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function bo(a){return a.h?1:a.g?a.g.size:0}function Co(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function Ro(a,d){a.g?a.g.add(d):a.h=d}function yl(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Ao.prototype.cancel=function(){if(this.i=vl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function vl(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const f of a.g.values())d=d.concat(f.D);return d}return j(a.i)}function zc(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var d=[],f=a.length,v=0;v<f;v++)d.push(a[v]);return d}d=[],f=0;for(v in a)d[f++]=a[v];return d}function Qe(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var d=[];a=a.length;for(var f=0;f<a;f++)d.push(f);return d}d=[],f=0;for(const v in a)d[f++]=v;return d}}}function qn(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var f=Qe(a),v=zc(a),L=v.length,U=0;U<L;U++)d.call(void 0,v[U],f&&f[U],a)}var wn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $c(a,d){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var v=a[f].indexOf("="),L=null;if(0<=v){var U=a[f].substring(0,v);L=a[f].substring(v+1)}else U=a[f];d(U,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function wr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof wr){this.h=a.h,Ds(this,a.j),this.o=a.o,this.g=a.g,g(this,a.s),this.l=a.l;var d=a.i,f=new re;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),_(this,f),this.m=a.m}else a&&(d=String(a).match(wn))?(this.h=!1,Ds(this,d[1]||"",!0),this.o=V(d[2]||""),this.g=V(d[3]||"",!0),g(this,d[4]),this.l=V(d[5]||"",!0),_(this,d[6]||"",!0),this.m=V(d[7]||"")):(this.h=!1,this.i=new re(null,this.h))}wr.prototype.toString=function(){var a=[],d=this.j;d&&a.push($(d,G,!0),":");var f=this.g;return(f||d=="file")&&(a.push("//"),(d=this.o)&&a.push($(d,G,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push($(f,f.charAt(0)=="/"?oe:z,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",$(f,q)),a.join("")};function Gn(a){return new wr(a)}function Ds(a,d,f){a.j=f?V(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function g(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function _(a,d,f){d instanceof re?(a.i=d,ct(a.i,a.h)):(f||(d=$(d,te)),a.i=new re(d,a.h))}function b(a,d,f){a.i.set(d,f)}function D(a){return b(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function V(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function $(a,d,f){return typeof a=="string"?(a=encodeURI(a).replace(d,Y),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Y(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var G=/[#\/\?@]/g,z=/[#\?:]/g,oe=/[#\?]/g,te=/[#\?@]/g,q=/#/g;function re(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function ae(a){a.g||(a.g=new Map,a.h=0,a.i&&$c(a.i,function(d,f){a.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=re.prototype,t.add=function(a,d){ae(this),this.i=null,a=mt(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(d),this.h+=1,this};function xe(a,d){ae(a),d=mt(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function st(a,d){return ae(a),d=mt(a,d),a.g.has(d)}t.forEach=function(a,d){ae(this),this.g.forEach(function(f,v){f.forEach(function(L){a.call(d,L,v,this)},this)},this)},t.na=function(){ae(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let v=0;v<d.length;v++){const L=a[v];for(let U=0;U<L.length;U++)f.push(d[v])}return f},t.V=function(a){ae(this);let d=[];if(typeof a=="string")st(this,a)&&(d=d.concat(this.g.get(mt(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)d=d.concat(a[f])}return d},t.set=function(a,d){return ae(this),this.i=null,a=mt(this,a),st(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function Be(a,d,f){xe(a,d),0<f.length&&(a.i=null,a.g.set(mt(a,d),j(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var v=d[f];const U=encodeURIComponent(String(v)),J=this.V(v);for(v=0;v<J.length;v++){var L=U;J[v]!==""&&(L+="="+encodeURIComponent(String(J[v]))),a.push(L)}}return this.i=a.join("&")};function mt(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function ct(a,d){d&&!a.j&&(ae(a),a.i=null,a.g.forEach(function(f,v){var L=v.toLowerCase();v!=L&&(xe(this,v),Be(this,L,f))},a)),a.j=d}function At(a,d){const f=new Zt;if(l.Image){const v=new Image;v.onload=C(Z,f,"TestLoadImage: loaded",!0,d,v),v.onerror=C(Z,f,"TestLoadImage: error",!1,d,v),v.onabort=C(Z,f,"TestLoadImage: abort",!1,d,v),v.ontimeout=C(Z,f,"TestLoadImage: timeout",!1,d,v),l.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=a}else d(!1)}function dt(a,d){const f=new Zt,v=new AbortController,L=setTimeout(()=>{v.abort(),Z(f,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:v.signal}).then(U=>{clearTimeout(L),U.ok?Z(f,"TestPingServer: ok",!0,d):Z(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(L),Z(f,"TestPingServer: error",!1,d)})}function Z(a,d,f,v,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),v(f)}catch{}}function we(){this.g=new cl}function Ue(a,d,f){const v=f||"";try{qn(a,function(L,U){let J=L;h(L)&&(J=ui(L)),d.push(v+U+"="+encodeURIComponent(J))})}catch(L){throw d.push(v+"type="+encodeURIComponent("_badmap")),L}}function Oe(a){this.l=a.Ub||null,this.j=a.eb||!1}M(Oe,ir),Oe.prototype.g=function(){return new Ae(this.l,this.j)},Oe.prototype.i=function(a){return function(){return a}}({});function Ae(a,d){je.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}M(Ae,je),t=Ae.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,en(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ze(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,en(this)),this.g&&(this.readyState=3,en(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ve(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ve(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?ze(this):en(this),this.readyState==3&&Ve(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ze(this))},t.Qa=function(a){this.g&&(this.response=a,ze(this))},t.ga=function(){this.g&&ze(this)};function ze(a){a.readyState=4,a.l=null,a.j=null,a.v=null,en(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=d.next();return a.join(`\r
`)};function en(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ae.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Mn(a){let d="";return H(a,function(f,v){d+=v,d+=":",d+=f,d+=`\r
`}),d}function xr(a,d,f){e:{for(v in f){var v=!1;break e}v=!0}v||(f=Mn(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):b(a,d,f))}function Ee(a){je.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}M(Ee,je);var _t=/^https?$/i,pi=["POST","PUT"];t=Ee.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,f,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Io.g(),this.v=this.o?Eo(this.o):Eo(Io),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(U){Po(this,U);return}if(a=f||"",f=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var L in v)f.set(L,v[L]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const U of v.keys())f.set(U,v.get(U));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(f.keys()).find(U=>U.toLowerCase()=="content-type"),L=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(pi,d,void 0))||v||L||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,J]of f)this.g.setRequestHeader(U,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zp(this),this.u=!0,this.g.send(a),this.u=!1}catch(U){Po(this,U)}};function Po(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,No(a),_l(a)}function No(a){a.A||(a.A=!0,Ke(a,"complete"),Ke(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ke(this,"complete"),Ke(this,"abort"),_l(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_l(this,!0)),Ee.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Do(this):this.bb())},t.bb=function(){Do(this)};function Do(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Er(a)!=4||a.Z()!=2)){if(a.u&&Er(a)==4)ll(a.Ea,0,a);else if(Ke(a,"readystatechange"),Er(a)==4){a.h=!1;try{const J=a.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var v;if(v=J===0){var L=String(a.D).match(wn)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),v=!_t.test(L?L.toLowerCase():"")}f=v}if(f)Ke(a,"complete"),Ke(a,"success");else{a.m=6;try{var U=2<Er(a)?a.g.statusText:""}catch{U=""}a.l=U+" ["+a.Z()+"]",No(a)}}finally{_l(a)}}}}function _l(a,d){if(a.g){zp(a);const f=a.g,v=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||Ke(a,"ready");try{f.onreadystatechange=v}catch{}}}function zp(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Er(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Er(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),Lc(d)}};function $p(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function fw(a){const d={};a=(a.g&&2<=Er(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<a.length;v++){if(k(a[v]))continue;var f=R(a[v]);const L=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const U=d[L]||[];d[L]=U,U.push(f)}E(d,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mo(a,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||d}function Bp(a){this.Aa=0,this.i=[],this.j=new Zt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mo("baseRetryDelayMs",5e3,a),this.cb=Mo("retryDelaySeedMs",1e4,a),this.Wa=Mo("forwardChannelMaxRetries",2,a),this.wa=Mo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Ao(a&&a.concurrentRequestLimit),this.Da=new we,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Bp.prototype,t.la=8,t.G=1,t.connect=function(a,d,f,v){nt(0),this.W=a,this.H=d||{},f&&v!==void 0&&(this.H.OSID=f,this.H.OAID=v),this.F=this.X,this.I=Jp(this,null,this.W),xl(this)};function Bc(a){if(Wp(a),a.G==3){var d=a.U++,f=Gn(a.I);if(b(f,"SID",a.K),b(f,"RID",d),b(f,"TYPE","terminate"),jo(a,f),d=new Wn(a,a.j,d),d.L=2,d.v=D(Gn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=Zp(d.j,null),d.g.ea(d.v)),d.F=Date.now(),hi(d)}Yp(a)}function wl(a){a.g&&(Hc(a),a.g.cancel(),a.g=null)}function Wp(a){wl(a),a.u&&(l.clearTimeout(a.u),a.u=null),El(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function xl(a){if(!fi(a.h)&&!a.s){a.s=!0;var d=a.Ga;Lt||de(),ee||(Lt(),ee=!0),B.add(d,a),a.B=0}}function pw(a,d){return bo(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Qr(w(a.Ga,a,d),Xp(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const L=new Wn(this,this.j,a);let U=this.o;if(this.S&&(U?(U=y(U),I(U,this.S)):U=this.S),this.m!==null||this.O||(L.H=U,U=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var v=this.i[f];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(d+=v,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=qp(this,L,d),f=Gn(this.I),b(f,"RID",a),b(f,"CVER",22),this.D&&b(f,"X-HTTP-Session-Id",this.D),jo(this,f),U&&(this.O?d="headers="+encodeURIComponent(String(Mn(U)))+"&"+d:this.m&&xr(f,this.m,U)),Ro(this.h,L),this.Ua&&b(f,"TYPE","init"),this.P?(b(f,"$req",d),b(f,"SID","null"),L.T=!0,di(L,f,null)):di(L,f,d),this.G=2}}else this.G==3&&(a?Hp(this,a):this.i.length==0||fi(this.h)||Hp(this))};function Hp(a,d){var f;d?f=d.l:f=a.U++;const v=Gn(a.I);b(v,"SID",a.K),b(v,"RID",f),b(v,"AID",a.T),jo(a,v),a.m&&a.o&&xr(v,a.m,a.o),f=new Wn(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),d&&(a.i=d.D.concat(a.i)),d=qp(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ro(a.h,f),di(f,v,d)}function jo(a,d){a.H&&H(a.H,function(f,v){b(d,v,f)}),a.l&&qn({},function(f,v){b(d,v,f)})}function qp(a,d,f){f=Math.min(a.i.length,f);var v=a.l?w(a.l.Na,a.l,a):null;e:{var L=a.i;let U=-1;for(;;){const J=["count="+f];U==-1?0<f?(U=L[0].g,J.push("ofs="+U)):U=0:J.push("ofs="+U);let Fe=!0;for(let bt=0;bt<f;bt++){let Pe=L[bt].g;const Vt=L[bt].map;if(Pe-=U,0>Pe)U=Math.max(0,L[bt].g-100),Fe=!1;else try{Ue(Vt,J,"req"+Pe+"_")}catch{v&&v(Vt)}}if(Fe){v=J.join("&");break e}}}return a=a.i.splice(0,f),d.D=a,v}function Gp(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;Lt||de(),ee||(Lt(),ee=!0),B.add(d,a),a.v=0}}function Wc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Qr(w(a.Fa,a),Xp(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Kp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Qr(w(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nt(10),wl(this),Kp(this))};function Hc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Kp(a){a.g=new Wn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=Gn(a.qa);b(d,"RID","rpc"),b(d,"SID",a.K),b(d,"AID",a.T),b(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&b(d,"TO",a.ja),b(d,"TYPE","xmlhttp"),jo(a,d),a.m&&a.o&&xr(d,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=D(Gn(d)),f.m=null,f.P=!0,ml(f,a)}t.Za=function(){this.C!=null&&(this.C=null,wl(this),Wc(this),nt(19))};function El(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Qp(a,d){var f=null;if(a.g==d){El(a),Hc(a),a.g=null;var v=2}else if(Co(a.h,d))f=d.D,yl(a.h,d),v=1;else return;if(a.G!=0){if(d.o)if(v==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var L=a.B;v=Rs(),Ke(v,new ci(v,f)),xl(a)}else Gp(a);else if(L=d.s,L==3||L==0&&0<d.X||!(v==1&&pw(a,d)||v==2&&Wc(a)))switch(f&&0<f.length&&(d=a.h,d.i=d.i.concat(f)),L){case 1:Ms(a,5);break;case 4:Ms(a,10);break;case 3:Ms(a,6);break;default:Ms(a,2)}}}function Xp(a,d){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*d}function Ms(a,d){if(a.j.info("Error code "+d),d==2){var f=w(a.fb,a),v=a.Xa;const L=!v;v=new wr(v||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Ds(v,"https"),D(v),L?At(v.toString(),f):dt(v.toString(),f)}else nt(2);a.G=0,a.l&&a.l.sa(d),Yp(a),Wp(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),nt(2)):(this.j.info("Failed to ping google.com"),nt(1))};function Yp(a){if(a.G=0,a.ka=[],a.l){const d=vl(a.h);(d.length!=0||a.i.length!=0)&&(F(a.ka,d),F(a.ka,a.i),a.h.i.length=0,j(a.i),a.i.length=0),a.l.ra()}}function Jp(a,d,f){var v=f instanceof wr?Gn(f):new wr(f);if(v.g!="")d&&(v.g=d+"."+v.g),g(v,v.s);else{var L=l.location;v=L.protocol,d=d?d+"."+L.hostname:L.hostname,L=+L.port;var U=new wr(null);v&&Ds(U,v),d&&(U.g=d),L&&g(U,L),f&&(U.l=f),v=U}return f=a.D,d=a.ya,f&&d&&b(v,f,d),b(v,"VER",a.la),jo(a,v),v}function Zp(a,d,f){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new Ee(new Oe({eb:f})):new Ee(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function em(){}t=em.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Il(){}Il.prototype.g=function(a,d){return new xn(a,d)};function xn(a,d){je.call(this),this.g=new Bp(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!k(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!k(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new mi(this)}M(xn,je),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Bc(this.g)},xn.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=ui(a),a=f);d.i.push(new Uc(d.Ya++,a)),d.G==3&&xl(d)},xn.prototype.N=function(){this.g.l=null,delete this.j,Bc(this.g),delete this.g,xn.aa.N.call(this)};function tm(a){Ie.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const f in d){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}M(tm,Ie);function nm(){Le.call(this),this.status=1}M(nm,Le);function mi(a){this.g=a}M(mi,em),mi.prototype.ua=function(){Ke(this.g,"a")},mi.prototype.ta=function(a){Ke(this.g,new tm(a))},mi.prototype.sa=function(a){Ke(this.g,new nm)},mi.prototype.ra=function(){Ke(this.g,"b")},Il.prototype.createWebChannel=Il.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Q_=function(){return new Il},K_=function(){return Rs()},G_=Ot,Oh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Dn.NO_ERROR=0,Dn.TIMEOUT=8,Dn.HTTP_ERROR=6,hu=Dn,hl.COMPLETE="complete",q_=hl,dl.EventType=qr,qr.OPEN="a",qr.CLOSE="b",qr.ERROR="c",qr.MESSAGE="d",je.prototype.listen=je.prototype.K,Qo=dl,Ee.prototype.listenOnce=Ee.prototype.L,Ee.prototype.getLastError=Ee.prototype.Ka,Ee.prototype.getLastErrorCode=Ee.prototype.Ba,Ee.prototype.getStatus=Ee.prototype.Z,Ee.prototype.getResponseJson=Ee.prototype.Oa,Ee.prototype.getResponseText=Ee.prototype.oa,Ee.prototype.send=Ee.prototype.ea,Ee.prototype.setWithCredentials=Ee.prototype.Ha,H_=Ee}).apply(typeof Bl<"u"?Bl:typeof self<"u"?self:typeof window<"u"?window:{});const Wg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let po="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=new Qf("@firebase/firestore");function Wo(){return ei.logLevel}function se(t,...e){if(ei.logLevel<=Se.DEBUG){const n=e.map(lp);ei.debug(`Firestore (${po}): ${t}`,...n)}}function zr(t,...e){if(ei.logLevel<=Se.ERROR){const n=e.map(lp);ei.error(`Firestore (${po}): ${t}`,...n)}}function eo(t,...e){if(ei.logLevel<=Se.WARN){const n=e.map(lp);ei.warn(`Firestore (${po}): ${t}`,...n)}}function lp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(t="Unexpected state"){const e=`FIRESTORE (${po}) INTERNAL ASSERTION FAILED: `+t;throw zr(e),new Error(e)}function Me(t,e){t||ge()}function _e(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Wr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Wt.UNAUTHENTICATED))}shutdown(){}}class uS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cS{constructor(e){this.t=e,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Me(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Hs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Hs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Hs)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Me(typeof r.accessToken=="string"),new X_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new Wt(e)}}class dS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class hS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new dS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Me(this.o===void 0);const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Me(typeof n.token=="string"),this.R=n.token,new fS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=mS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function to(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ie(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ie(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ie(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new vt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new vt(0,0))}static max(){return new ve(new vt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,r){n===void 0?n=0:n>e.length&&ge(),r===void 0?r=e.length-n:r>e.length-n&&ge(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ma.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ma?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class He extends Ma{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const gS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pt extends Ma{construct(e,n,r){return new Pt(e,n,r)}static isValidIdentifier(e){return gS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ie(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new ie(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ie(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new ie(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pt(n)}static emptyPath(){return new Pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.path=e}static fromPath(e){return new ue(He.fromString(e))}static fromName(e){return new ue(He.fromString(e).popFirst(5))}static empty(){return new ue(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new He(e.slice()))}}function yS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new vt(n+1,0):new vt(n,r));return new Ts(s,ue.empty(),e)}function vS(t){return new Ts(t.readTime,t.key,-1)}class Ts{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ts(ve.min(),ue.empty(),-1)}static max(){return new Ts(ve.max(),ue.empty(),-1)}}function _S(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ue.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(t){if(t.code!==W.FAILED_PRECONDITION||t.message!==wS)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(s=>s?K.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new K((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{o[h]=p,++l,l===i&&r(o)},p=>s(p))}})}static doWhile(e,n){return new K((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function ES(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function tl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}up.oe=-1;function kc(t){return t==null}function Qu(t){return t===0&&1/t==-1/0}function IS(t){return typeof t=="number"&&Number.isInteger(t)&&!Qu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function mo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function J_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n){this.comparator=e,this.root=n||Rt.EMPTY}insert(e,n){return new et(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wl(this.root,e,this.comparator,!0)}}class Wl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Rt.RED,this.left=s??Rt.EMPTY,this.right=i??Rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.comparator=e,this.data=new et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qg(this.data.getIterator())}getIteratorFrom(e){return new qg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Dt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Dt(this.comparator);return n.data=e,n}}class qg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.fields=e,e.sort(Pt.comparator)}static empty(){return new Zn([])}unionWith(e){let n=new Dt(Pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Zn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return to(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Z_("Invalid base64 string: "+i):i}}(e);return new jt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new jt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jt.EMPTY_BYTE_STRING=new jt("");const TS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(t){if(Me(!!t),typeof t=="string"){let e=0;const n=TS.exec(t);if(Me(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:at(t.seconds),nanos:at(t.nanos)}}function at(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ti(t){return typeof t=="string"?jt.fromBase64String(t):jt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function dp(t){const e=t.mapValue.fields.__previous_value__;return cp(e)?dp(e):e}function ja(t){const e=ks(t.mapValue.fields.__local_write_time__.timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n,r,s,i,o,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class La{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new La("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof La&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl={mapValue:{}};function ni(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cp(t)?4:AS(t)?9007199254740991:SS(t)?10:11:ge()}function _r(t,e){if(t===e)return!0;const n=ni(t);if(n!==ni(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ja(t).isEqual(ja(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ks(s.timestampValue),l=ks(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ti(s.bytesValue).isEqual(ti(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return at(s.geoPointValue.latitude)===at(i.geoPointValue.latitude)&&at(s.geoPointValue.longitude)===at(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return at(s.integerValue)===at(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=at(s.doubleValue),l=at(i.doubleValue);return o===l?Qu(o)===Qu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return to(t.arrayValue.values||[],e.arrayValue.values||[],_r);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Hg(o)!==Hg(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!_r(o[u],l[u])))return!1;return!0}(t,e);default:return ge()}}function Oa(t,e){return(t.values||[]).find(n=>_r(n,e))!==void 0}function no(t,e){if(t===e)return 0;const n=ni(t),r=ni(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=at(i.integerValue||i.doubleValue),u=at(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Gg(t.timestampValue,e.timestampValue);case 4:return Gg(ja(t),ja(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ti(i),u=ti(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=Ne(l[h],u[h]);if(p!==0)return p}return Ne(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ne(at(i.latitude),at(o.latitude));return l!==0?l:Ne(at(i.longitude),at(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Kg(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,h,p;const m=i.fields||{},w=o.fields||{},C=(l=m.value)===null||l===void 0?void 0:l.arrayValue,M=(u=w.value)===null||u===void 0?void 0:u.arrayValue,j=Ne(((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0,((p=M==null?void 0:M.values)===null||p===void 0?void 0:p.length)||0);return j!==0?j:Kg(C,M)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Hl.mapValue&&o===Hl.mapValue)return 0;if(i===Hl.mapValue)return 1;if(o===Hl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=o.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let m=0;m<u.length&&m<p.length;++m){const w=Ne(u[m],p[m]);if(w!==0)return w;const C=no(l[u[m]],h[p[m]]);if(C!==0)return C}return Ne(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ge()}}function Gg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=ks(t),r=ks(e),s=Ne(n.seconds,r.seconds);return s!==0?s:Ne(n.nanos,r.nanos)}function Kg(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=no(n[s],r[s]);if(i)return i}return Ne(n.length,r.length)}function ro(t){return Vh(t)}function Vh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ks(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ti(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ue.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Vh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Vh(n.fields[o])}`;return s+"}"}(t.mapValue):ge()}function Qg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Fh(t){return!!t&&"integerValue"in t}function hp(t){return!!t&&"arrayValue"in t}function Xg(t){return!!t&&"nullValue"in t}function Yg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function fu(t){return!!t&&"mapValue"in t}function SS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ca(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return mo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ca(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ca(t.arrayValue.values[n]);return e}return Object.assign({},t)}function AS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.value=e}static empty(){return new On({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!fu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ca(n)}setAll(e){let n=Pt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ca(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());fu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _r(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];fu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){mo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new On(ca(this.value))}}function e1(t){const e=[];return mo(t.fields,(n,r)=>{const s=new Pt([n]);if(fu(r)){const i=e1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new qt(e,0,ve.min(),ve.min(),ve.min(),On.empty(),0)}static newFoundDocument(e,n,r,s){return new qt(e,1,n,ve.min(),r,s,0)}static newNoDocument(e,n){return new qt(e,2,n,ve.min(),ve.min(),On.empty(),0)}static newUnknownDocument(e,n){return new qt(e,3,n,ve.min(),ve.min(),On.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n){this.position=e,this.inclusive=n}}function Jg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ue.comparator(ue.fromName(o.referenceValue),n.key):r=no(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_r(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,n="asc"){this.field=e,this.dir=n}}function bS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{}class pt extends t1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new RS(e,n,r):n==="array-contains"?new DS(e,r):n==="in"?new MS(e,r):n==="not-in"?new jS(e,r):n==="array-contains-any"?new LS(e,r):new pt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new PS(e,r):new NS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(no(n,this.value)):n!==null&&ni(this.value)===ni(n)&&this.matchesComparison(no(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rr extends t1{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new rr(e,n)}matches(e){return n1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function n1(t){return t.op==="and"}function r1(t){return CS(t)&&n1(t)}function CS(t){for(const e of t.filters)if(e instanceof rr)return!1;return!0}function Uh(t){if(t instanceof pt)return t.field.canonicalString()+t.op.toString()+ro(t.value);if(r1(t))return t.filters.map(e=>Uh(e)).join(",");{const e=t.filters.map(n=>Uh(n)).join(",");return`${t.op}(${e})`}}function s1(t,e){return t instanceof pt?function(r,s){return s instanceof pt&&r.op===s.op&&r.field.isEqual(s.field)&&_r(r.value,s.value)}(t,e):t instanceof rr?function(r,s){return s instanceof rr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&s1(o,s.filters[l]),!0):!1}(t,e):void ge()}function i1(t){return t instanceof pt?function(n){return`${n.field.canonicalString()} ${n.op} ${ro(n.value)}`}(t):t instanceof rr?function(n){return n.op.toString()+" {"+n.getFilters().map(i1).join(" ,")+"}"}(t):"Filter"}class RS extends pt{constructor(e,n,r){super(e,n,r),this.key=ue.fromName(r.referenceValue)}matches(e){const n=ue.comparator(e.key,this.key);return this.matchesComparison(n)}}class PS extends pt{constructor(e,n){super(e,"in",n),this.keys=o1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class NS extends pt{constructor(e,n){super(e,"not-in",n),this.keys=o1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function o1(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ue.fromName(r.referenceValue))}class DS extends pt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return hp(n)&&Oa(n.arrayValue,this.value)}}class MS extends pt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Oa(this.value.arrayValue,n)}}class jS extends pt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Oa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Oa(this.value.arrayValue,n)}}class LS extends pt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!hp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Oa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function ey(t,e=null,n=[],r=[],s=null,i=null,o=null){return new OS(t,e,n,r,s,i,o)}function fp(t){const e=_e(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Uh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),kc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ro(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ro(r)).join(",")),e.ue=n}return e.ue}function pp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!bS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!s1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zg(t.startAt,e.startAt)&&Zg(t.endAt,e.endAt)}function zh(t){return ue.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function VS(t,e,n,r,s,i,o,l){return new nl(t,e,n,r,s,i,o,l)}function mp(t){return new nl(t)}function ty(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function a1(t){return t.collectionGroup!==null}function da(t){const e=_e(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Dt(Pt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Yu(i,r))}),n.has(Pt.keyField().canonicalString())||e.ce.push(new Yu(Pt.keyField(),r))}return e.ce}function gr(t){const e=_e(t);return e.le||(e.le=FS(e,da(t))),e.le}function FS(t,e){if(t.limitType==="F")return ey(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Yu(s.field,i)});const n=t.endAt?new Xu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Xu(t.startAt.position,t.startAt.inclusive):null;return ey(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $h(t,e){const n=t.filters.concat([e]);return new nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Bh(t,e,n){return new nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sc(t,e){return pp(gr(t),gr(e))&&t.limitType===e.limitType}function l1(t){return`${fp(gr(t))}|lt:${t.limitType}`}function vi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>i1(s)).join(", ")}]`),kc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ro(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ro(s)).join(",")),`Target(${r})`}(gr(t))}; limitType=${t.limitType})`}function Ac(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ue.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of da(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const h=Jg(o,l,u);return o.inclusive?h<=0:h<0}(r.startAt,da(r),s)||r.endAt&&!function(o,l,u){const h=Jg(o,l,u);return o.inclusive?h>=0:h>0}(r.endAt,da(r),s))}(t,e)}function US(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function u1(t){return(e,n)=>{let r=!1;for(const s of da(t)){const i=zS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function zS(t,e,n){const r=t.field.isKeyField()?ue.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),h=l.data.field(i);return u!==null&&h!==null?no(u,h):ge()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){mo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return J_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=new et(ue.comparator);function $r(){return $S}const c1=new et(ue.comparator);function Xo(...t){let e=c1;for(const n of t)e=e.insert(n.key,n);return e}function d1(t){let e=c1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function zs(){return ha()}function h1(){return ha()}function ha(){return new go(t=>t.toString(),(t,e)=>t.isEqual(e))}const BS=new et(ue.comparator),WS=new Dt(ue.comparator);function ke(...t){let e=WS;for(const n of t)e=e.add(n);return e}const HS=new Dt(Ne);function qS(){return HS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qu(e)?"-0":e}}function f1(t){return{integerValue:""+t}}function GS(t,e){return IS(e)?f1(e):gp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(){this._=void 0}}function KS(t,e,n){return t instanceof Ju?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&cp(i)&&(i=dp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Va?m1(t,e):t instanceof Fa?g1(t,e):function(s,i){const o=p1(s,i),l=ny(o)+ny(s.Pe);return Fh(o)&&Fh(s.Pe)?f1(l):gp(s.serializer,l)}(t,e)}function QS(t,e,n){return t instanceof Va?m1(t,e):t instanceof Fa?g1(t,e):n}function p1(t,e){return t instanceof Zu?function(r){return Fh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ju extends bc{}class Va extends bc{constructor(e){super(),this.elements=e}}function m1(t,e){const n=y1(e);for(const r of t.elements)n.some(s=>_r(s,r))||n.push(r);return{arrayValue:{values:n}}}class Fa extends bc{constructor(e){super(),this.elements=e}}function g1(t,e){let n=y1(e);for(const r of t.elements)n=n.filter(s=>!_r(s,r));return{arrayValue:{values:n}}}class Zu extends bc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function ny(t){return at(t.integerValue||t.doubleValue)}function y1(t){return hp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function XS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Va&&s instanceof Va||r instanceof Fa&&s instanceof Fa?to(r.elements,s.elements,_r):r instanceof Zu&&s instanceof Zu?_r(r.Pe,s.Pe):r instanceof Ju&&s instanceof Ju}(t.transform,e.transform)}class YS{constructor(e,n){this.version=e,this.transformResults=n}}class yr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yr}static exists(e){return new yr(void 0,e)}static updateTime(e){return new yr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Cc{}function v1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yp(t.key,yr.none()):new rl(t.key,t.data,yr.none());{const n=t.data,r=On.empty();let s=new Dt(Pt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ii(t.key,r,new Zn(s.toArray()),yr.none())}}function JS(t,e,n){t instanceof rl?function(s,i,o){const l=s.value.clone(),u=sy(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ii?function(s,i,o){if(!pu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=sy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(_1(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function fa(t,e,n,r){return t instanceof rl?function(i,o,l,u){if(!pu(i.precondition,o))return l;const h=i.value.clone(),p=iy(i.fieldTransforms,u,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof ii?function(i,o,l,u){if(!pu(i.precondition,o))return l;const h=iy(i.fieldTransforms,u,o),p=o.data;return p.setAll(_1(i)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return pu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function ZS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=p1(r.transform,s||null);i!=null&&(n===null&&(n=On.empty()),n.set(r.field,i))}return n||null}function ry(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&to(r,s,(i,o)=>XS(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rl extends Cc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ii extends Cc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _1(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function sy(t,e,n){const r=new Map;Me(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,QS(o,l,n[s]))}return r}function iy(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,KS(i,o,e))}return r}class yp extends Cc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eA extends Cc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&JS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=h1();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=v1(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&to(this.mutations,e.mutations,(n,r)=>ry(n,r))&&to(this.baseMutations,e.baseMutations,(n,r)=>ry(n,r))}}class vp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Me(e.mutations.length===r.length);let s=function(){return BS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new vp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,be;function sA(t){switch(t){default:return ge();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function w1(t){if(t===void 0)return zr("GRPC error has no .code"),W.UNKNOWN;switch(t){case ht.OK:return W.OK;case ht.CANCELLED:return W.CANCELLED;case ht.UNKNOWN:return W.UNKNOWN;case ht.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case ht.INTERNAL:return W.INTERNAL;case ht.UNAVAILABLE:return W.UNAVAILABLE;case ht.UNAUTHENTICATED:return W.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case ht.NOT_FOUND:return W.NOT_FOUND;case ht.ALREADY_EXISTS:return W.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return W.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case ht.ABORTED:return W.ABORTED;case ht.OUT_OF_RANGE:return W.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return W.UNIMPLEMENTED;case ht.DATA_LOSS:return W.DATA_LOSS;default:return ge()}}(be=ht||(ht={}))[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=new Ws([4294967295,4294967295],0);function oy(t){const e=iA().encode(t),n=new W_;return n.update(e),new Uint8Array(n.digest())}function ay(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ws([n,r],0),new Ws([s,i],0)]}class _p{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Yo(`Invalid padding: ${n}`);if(r<0)throw new Yo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Yo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Yo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ws.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ws.fromNumber(r)));return s.compare(oA)===1&&(s=new Ws([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=oy(e),[r,s]=ay(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new _p(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=oy(e),[r,s]=ay(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Yo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,sl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Rc(ve.min(),s,new et(Ne),$r(),ke())}}class sl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sl(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class x1{constructor(e,n){this.targetId=e,this.me=n}}class E1{constructor(e,n,r=jt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ly{constructor(){this.fe=0,this.ge=cy(),this.pe=jt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ke(),n=ke(),r=ke();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ge()}}),new sl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=cy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Me(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class aA{constructor(e){this.Le=e,this.Be=new Map,this.ke=$r(),this.qe=uy(),this.Qe=new et(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ge()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(zh(i))if(r===0){const o=new ue(i.path);this.Ue(n,o,qt.newNoDocument(o,ve.min()))}else Me(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ti(r).toUint8Array()}catch(u){if(u instanceof Z_)return eo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new _p(o,s,i)}catch(u){return eo(u instanceof Yo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&zh(l.target)){const u=new ue(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,qt.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=ke();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Rc(e,n,this.Qe,this.ke,r);return this.ke=$r(),this.qe=uy(),this.Qe=new et(Ne),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new ly,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Dt(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||se("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ly),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function uy(){return new et(ue.comparator)}function cy(){return new et(ue.comparator)}const lA={asc:"ASCENDING",desc:"DESCENDING"},uA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cA={and:"AND",or:"OR"};class dA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wh(t,e){return t.useProto3Json||kc(e)?e:{value:e}}function ec(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function I1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function hA(t,e){return ec(t,e.toTimestamp())}function vr(t){return Me(!!t),ve.fromTimestamp(function(n){const r=ks(n);return new vt(r.seconds,r.nanos)}(t))}function wp(t,e){return Hh(t,e).canonicalString()}function Hh(t,e){const n=function(s){return new He(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function T1(t){const e=He.fromString(t);return Me(C1(e)),e}function qh(t,e){return wp(t.databaseId,e.path)}function Sd(t,e){const n=T1(e);if(n.get(1)!==t.databaseId.projectId)throw new ie(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ie(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ue(S1(n))}function k1(t,e){return wp(t.databaseId,e)}function fA(t){const e=T1(t);return e.length===4?He.emptyPath():S1(e)}function Gh(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function S1(t){return Me(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function dy(t,e,n){return{name:qh(t,e),fields:n.value.mapValue.fields}}function pA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Me(p===void 0||typeof p=="string"),jt.fromBase64String(p||"")):(Me(p===void 0||p instanceof Buffer||p instanceof Uint8Array),jt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const p=h.code===void 0?W.UNKNOWN:w1(h.code);return new ie(p,h.message||"")}(o);n=new E1(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Sd(t,r.document.name),i=vr(r.document.updateTime),o=r.document.createTime?vr(r.document.createTime):ve.min(),l=new On({mapValue:{fields:r.document.fields}}),u=qt.newFoundDocument(s,i,o,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new mu(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Sd(t,r.document),i=r.readTime?vr(r.readTime):ve.min(),o=qt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new mu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Sd(t,r.document),i=r.removedTargetIds||[];n=new mu([],i,s,null)}else{if(!("filter"in e))return ge();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new rA(s,i),l=r.targetId;n=new x1(l,o)}}return n}function mA(t,e){let n;if(e instanceof rl)n={update:dy(t,e.key,e.value)};else if(e instanceof yp)n={delete:qh(t,e.key)};else if(e instanceof ii)n={update:dy(t,e.key,e.data),updateMask:TA(e.fieldMask)};else{if(!(e instanceof eA))return ge();n={verify:qh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Ju)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Va)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Zu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ge()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:hA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ge()}(t,e.precondition)),n}function gA(t,e){return t&&t.length>0?(Me(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?vr(s.updateTime):vr(i);return o.isEqual(ve.min())&&(o=vr(i)),new YS(o,s.transformResults||[])}(n,e))):[]}function yA(t,e){return{documents:[k1(t,e.path)]}}function vA(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=k1(t,s);const i=function(h){if(h.length!==0)return b1(rr.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(p=>function(w){return{field:_i(w.field),direction:xA(w.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Wh(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function _A(t){let e=fA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Me(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(m){const w=A1(m);return w instanceof rr&&r1(w)?w.getFilters():[w]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(w=>function(M){return new Yu(wi(M.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(M.direction))}(w))}(n.orderBy));let l=null;n.limit&&(l=function(m){let w;return w=typeof m=="object"?m.value:m,kc(w)?null:w}(n.limit));let u=null;n.startAt&&(u=function(m){const w=!!m.before,C=m.values||[];return new Xu(C,w)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const w=!m.before,C=m.values||[];return new Xu(C,w)}(n.endAt)),VS(e,s,o,i,l,"F",u,h)}function wA(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function A1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=wi(n.unaryFilter.field);return pt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=wi(n.unaryFilter.field);return pt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=wi(n.unaryFilter.field);return pt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=wi(n.unaryFilter.field);return pt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(t):t.fieldFilter!==void 0?function(n){return pt.create(wi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return rr.create(n.compositeFilter.filters.map(r=>A1(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ge()}}(n.compositeFilter.op))}(t):ge()}function xA(t){return lA[t]}function EA(t){return uA[t]}function IA(t){return cA[t]}function _i(t){return{fieldPath:t.canonicalString()}}function wi(t){return Pt.fromServerFormat(t.fieldPath)}function b1(t){return t instanceof pt?function(n){if(n.op==="=="){if(Yg(n.value))return{unaryFilter:{field:_i(n.field),op:"IS_NAN"}};if(Xg(n.value))return{unaryFilter:{field:_i(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Yg(n.value))return{unaryFilter:{field:_i(n.field),op:"IS_NOT_NAN"}};if(Xg(n.value))return{unaryFilter:{field:_i(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_i(n.field),op:EA(n.op),value:n.value}}}(t):t instanceof rr?function(n){const r=n.getFilters().map(s=>b1(s));return r.length===1?r[0]:{compositeFilter:{op:IA(n.op),filters:r}}}(t):ge()}function TA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function C1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r,s,i=ve.min(),o=ve.min(),l=jt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new us(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.ct=e}}function SA(t){const e=_A({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(){this.un=new bA}addToCollectionParentIndex(e,n){return this.un.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve(Ts.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve(Ts.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class bA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Dt(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Dt(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new so(0)}static kn(){return new so(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.changes=new go(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,qt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&fa(r.mutation,s,Zn.empty(),vt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const s=zs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Xo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=zs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=$r();const o=ha(),l=function(){return ha()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof ii)?i=i.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),fa(p.mutation,h,p.mutation.getFieldMask(),vt.now())):o.set(h.key,Zn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>o.set(h,p)),n.forEach((h,p)=>{var m;return l.set(h,new RA(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ha();let s=new et((o,l)=>o-l),i=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||Zn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const m=(s.get(l.batchId)||ke()).add(u);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,m=h1();p.forEach(w=>{if(!i.has(w)){const C=v1(n.get(w),r.get(w));C!==null&&m.set(w,C),i=i.add(w)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ue.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):a1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):K.resolve(zs());let l=-1,u=i;return o.next(h=>K.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(p)?K.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{u=u.insert(p,w)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,ke())).next(p=>({batchId:l,changes:d1(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ue(n)).next(r=>{let s=Xo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Xo();return this.indexManager.getCollectionParents(e,i).next(l=>K.forEach(l,u=>{const h=function(m,w){return new nl(w,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((m,w)=>{o=o.insert(m,w)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,qt.newInvalidDocument(p)))});let l=Xo();return o.forEach((u,h)=>{const p=i.get(u);p!==void 0&&fa(p.mutation,h,Zn.empty(),vt.now()),Ac(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return K.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:vr(s.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:SA(s.bundledQuery),readTime:vr(s.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(){this.overlays=new et(ue.comparator),this.Ir=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=zs();return K.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const s=zs(),i=n.length+1,o=new ue(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new et((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=zs(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=zs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return K.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nA(n,r));let i=this.Ir.get(n);i===void 0&&(i=ke(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.sessionToken=jt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(){this.Tr=new Dt(xt.Er),this.dr=new Dt(xt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new xt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new xt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ue(new He([])),r=new xt(n,e),s=new xt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ue(new He([])),r=new xt(n,e),s=new xt(n,e+1);let i=ke();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ue.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||ue.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Dt(xt.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new tA(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new xt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xt(n,0),s=new xt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Dt(Ne);return n.forEach(s=>{const i=new xt(s,0),o=new xt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),K.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ue.isDocumentKey(i)||(i=i.child(""));const o=new xt(new ue(i),0);let l=new Dt(Ne);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},o),K.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Me(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return K.forEach(n.mutations,s=>{const i=new xt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new xt(n,0),s=this.br.firstAfterOrEqual(r);return K.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e){this.Mr=e,this.docs=function(){return new et(ue.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():qt.newInvalidDocument(n))}getEntries(e,n){let r=$r();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():qt.newInvalidDocument(s))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$r();const o=n.path,l=new ue(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||_S(vS(p),r)<=0||(s.has(p.key)||Ac(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ge()}Or(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new OA(this)}getSize(e){return K.resolve(this.size)}}class OA extends CA{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.persistence=e,this.Nr=new go(n=>fp(n),pp),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new xp,this.targetCount=0,this.kr=so.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),K.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new so(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.Kn(n),K.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,n){this.qr={},this.overlays={},this.Qr=new up(0),this.Kr=!1,this.Kr=!0,this.$r=new MA,this.referenceDelegate=e(this),this.Ur=new VA(this),this.indexManager=new AA,this.remoteDocumentCache=function(s){return new LA(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new kA(n),this.Gr=new NA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new DA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new jA(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){se("MemoryPersistence","Starting transaction:",e);const s=new UA(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return K.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class UA extends xS{constructor(e){super(),this.currentSequenceNumber=e}}class Ep{constructor(e){this.persistence=e,this.Jr=new xp,this.Yr=null}static Zr(e){return new Ep(e)}get Xr(){if(this.Yr)return this.Yr;throw ge()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),K.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,r=>{const s=ue.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return K.or([()=>K.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ke(),s=ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ip(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return zI()?8:ES(Kt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new zA;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Wo()<=Se.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",vi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(Wo()<=Se.DEBUG&&se("QueryEngine","Query:",vi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Wo()<=Se.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",vi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gr(n))):K.resolve())}Yi(e,n){if(ty(n))return K.resolve(null);let r=gr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Bh(n,null,"F"),r=gr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ke(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,o,u.readTime)?this.Yi(e,Bh(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return ty(n)||s.isEqual(ve.min())?K.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?K.resolve(null):(Wo()<=Se.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),vi(n)),this.rs(e,o,n,yS(s,-1)).next(l=>l))})}ts(e,n){let r=new Dt(u1(e));return n.forEach((s,i)=>{Ac(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Wo()<=Se.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",vi(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ts.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new et(Ne),this._s=new go(i=>fp(i),pp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function WA(t,e,n,r){return new BA(t,e,n,r)}async function R1(t,e){const n=_e(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ke();for(const h of s){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function HA(t,e){const n=_e(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const m=h.batch,w=m.keys();let C=K.resolve();return w.forEach(M=>{C=C.next(()=>p.getEntry(u,M)).next(j=>{const F=h.docVersions.get(M);Me(F!==null),j.version.compareTo(F)<0&&(m.applyToRemoteDocument(j,h),j.isValidDocument()&&(j.setReadTime(h.commitVersion),p.addEntry(j)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ke();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function P1(t){const e=_e(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function qA(t,e){const n=_e(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,m)=>{const w=s.get(m);if(!w)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,m)));let C=w.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?C=C.withResumeToken(jt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),s=s.insert(m,C),function(j,F,S){return j.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(w,C,p)&&l.push(n.Ur.updateTargetData(i,C))});let u=$r(),h=ke();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(GA(i,o,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ve.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return K.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function GA(t,e,n){let r=ke(),s=ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$r();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ve.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):se("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function KA(t,e){const n=_e(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function QA(t,e){const n=_e(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,K.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new us(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Kh(t,e,n){const r=_e(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!tl(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function hy(t,e,n){const r=_e(t);let s=ve.min(),i=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,p){const m=_e(u),w=m._s.get(p);return w!==void 0?K.resolve(m.os.get(w)):m.Ur.getTargetData(h,p)}(r,o,gr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ve.min(),n?i:ke())).next(l=>(XA(r,US(e),l),{documents:l,Ts:i})))}function XA(t,e,n){let r=t.us.get(e)||ve.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class fy{constructor(){this.activeTargetIds=qS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YA{constructor(){this.so=new fy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new fy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ql=null;function Ad(){return ql===null?ql=function(){return 268435456+Math.round(2147483648*Math.random())}():ql++,"0x"+ql.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t="WebChannelConnection";class tb extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Ad(),u=this.xo(n,r.toUriEncodedString());se("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,o),this.No(n,u,h,s).then(p=>(se("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw eo("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+po}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=ZA[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Ad();return new Promise((o,l)=>{const u=new H_;u.setWithCredentials(!0),u.listenOnce(q_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case hu.NO_ERROR:const p=u.getResponseJson();se($t,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),o(p);break;case hu.TIMEOUT:se($t,`RPC '${e}' ${i} timed out`),l(new ie(W.DEADLINE_EXCEEDED,"Request time out"));break;case hu.HTTP_ERROR:const m=u.getStatus();if(se($t,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=w==null?void 0:w.error;if(C&&C.status&&C.message){const M=function(F){const S=F.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(S)>=0?S:W.UNKNOWN}(C.status);l(new ie(M,C.message))}else l(new ie(W.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ie(W.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{se($t,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);se($t,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Ad(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Q_(),l=K_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");se($t,`Creating RPC '${e}' stream ${s}: ${p}`,u);const m=o.createWebChannel(p,u);let w=!1,C=!1;const M=new eb({Io:F=>{C?se($t,`Not sending because RPC '${e}' stream ${s} is closed:`,F):(w||(se($t,`Opening RPC '${e}' stream ${s} transport.`),m.open(),w=!0),se($t,`RPC '${e}' stream ${s} sending:`,F),m.send(F))},To:()=>m.close()}),j=(F,S,k)=>{F.listen(S,T=>{try{k(T)}catch(P){setTimeout(()=>{throw P},0)}})};return j(m,Qo.EventType.OPEN,()=>{C||(se($t,`RPC '${e}' stream ${s} transport opened.`),M.yo())}),j(m,Qo.EventType.CLOSE,()=>{C||(C=!0,se($t,`RPC '${e}' stream ${s} transport closed`),M.So())}),j(m,Qo.EventType.ERROR,F=>{C||(C=!0,eo($t,`RPC '${e}' stream ${s} transport errored:`,F),M.So(new ie(W.UNAVAILABLE,"The operation could not be completed")))}),j(m,Qo.EventType.MESSAGE,F=>{var S;if(!C){const k=F.data[0];Me(!!k);const T=k,P=T.error||((S=T[0])===null||S===void 0?void 0:S.error);if(P){se($t,`RPC '${e}' stream ${s} received error:`,P);const O=P.status;let H=function(x){const I=ht[x];if(I!==void 0)return w1(I)}(O),E=P.message;H===void 0&&(H=W.INTERNAL,E="Unknown error status: "+O+" with message "+P.message),C=!0,M.So(new ie(H,E)),m.close()}else se($t,`RPC '${e}' stream ${s} received:`,k),M.bo(k)}}),j(l,G_.STAT_EVENT,F=>{F.stat===Oh.PROXY?se($t,`RPC '${e}' stream ${s} detected buffering proxy`):F.stat===Oh.NOPROXY&&se($t,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{M.wo()},0),M}}function bd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){return new dA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new N1(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===W.RESOURCE_EXHAUSTED?(zr(n.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new ie(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nb extends D1{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=pA(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?vr(o.readTime):ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Gh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=zh(u)?{documents:yA(i,u)}:{query:vA(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=I1(i,o.resumeToken);const h=Wh(i,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(ve.min())>0){l.readTime=ec(i,o.snapshotVersion.toTimestamp());const h=Wh(i,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=wA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Gh(this.serializer),n.removeTarget=e,this.a_(n)}}class rb extends D1{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Me(!!e.streamToken),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=gA(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Gh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ie(W.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Hh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ie(W.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Hh(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(W.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class ib{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(zr(n),this.D_=!1):se("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{oi(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=_e(u);h.L_.add(4),await il(h),h.q_.set("Unknown"),h.L_.delete(4),await Nc(h)}(this))})}),this.q_=new ib(r,s)}}async function Nc(t){if(oi(t))for(const e of t.B_)await e(!0)}async function il(t){for(const e of t.B_)await e(!1)}function M1(t,e){const n=_e(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ap(n)?Sp(n):yo(n).r_()&&kp(n,e))}function Tp(t,e){const n=_e(t),r=yo(n);n.N_.delete(e),r.r_()&&j1(n,e),n.N_.size===0&&(r.r_()?r.o_():oi(n)&&n.q_.set("Unknown"))}function kp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}yo(t).A_(e)}function j1(t,e){t.Q_.xe(e),yo(t).R_(e)}function Sp(t){t.Q_=new aA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),yo(t).start(),t.q_.v_()}function Ap(t){return oi(t)&&!yo(t).n_()&&t.N_.size>0}function oi(t){return _e(t).L_.size===0}function L1(t){t.Q_=void 0}async function ab(t){t.q_.set("Online")}async function lb(t){t.N_.forEach((e,n)=>{kp(t,e)})}async function ub(t,e){L1(t),Ap(t)?(t.q_.M_(e),Sp(t)):t.q_.set("Unknown")}async function cb(t,e,n){if(t.q_.set("Online"),e instanceof E1&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await tc(t,r)}else if(e instanceof mu?t.Q_.Ke(e):e instanceof x1?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ve.min()))try{const r=await P1(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(jt.EMPTY_BYTE_STRING,p.snapshotVersion)),j1(i,u);const m=new us(p.target,u,h,p.sequenceNumber);kp(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await tc(t,r)}}async function tc(t,e,n){if(!tl(e))throw e;t.L_.add(1),await il(t),t.q_.set("Offline"),n||(n=()=>P1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Nc(t)})}function O1(t,e){return e().catch(n=>tc(t,n,e))}async function Dc(t){const e=_e(t),n=Ss(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;db(e);)try{const s=await KA(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,hb(e,s)}catch(s){await tc(e,s)}V1(e)&&F1(e)}function db(t){return oi(t)&&t.O_.length<10}function hb(t,e){t.O_.push(e);const n=Ss(t);n.r_()&&n.V_&&n.m_(e.mutations)}function V1(t){return oi(t)&&!Ss(t).n_()&&t.O_.length>0}function F1(t){Ss(t).start()}async function fb(t){Ss(t).p_()}async function pb(t){const e=Ss(t);for(const n of t.O_)e.m_(n.mutations)}async function mb(t,e,n){const r=t.O_.shift(),s=vp.from(r,e,n);await O1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Dc(t)}async function gb(t,e){e&&Ss(t).V_&&await async function(r,s){if(function(o){return sA(o)&&o!==W.ABORTED}(s.code)){const i=r.O_.shift();Ss(r).s_(),await O1(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Dc(r)}}(t,e),V1(t)&&F1(t)}async function my(t,e){const n=_e(t);n.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=oi(n);n.L_.add(3),await il(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Nc(n)}async function yb(t,e){const n=_e(t);e?(n.L_.delete(2),await Nc(n)):e||(n.L_.add(2),await il(n),n.q_.set("Unknown"))}function yo(t){return t.K_||(t.K_=function(n,r,s){const i=_e(n);return i.w_(),new nb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:ab.bind(null,t),Ro:lb.bind(null,t),mo:ub.bind(null,t),d_:cb.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ap(t)?Sp(t):t.q_.set("Unknown")):(await t.K_.stop(),L1(t))})),t.K_}function Ss(t){return t.U_||(t.U_=function(n,r,s){const i=_e(n);return i.w_(),new rb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fb.bind(null,t),mo:gb.bind(null,t),f_:pb.bind(null,t),g_:mb.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Dc(t)):(await t.U_.stop(),t.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new bp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cp(t,e){if(zr("AsyncQueue",`${e}: ${t}`),tl(t))return new ie(W.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ue.comparator(n.key,r.key):(n,r)=>ue.comparator(n.key,r.key),this.keyedMap=Xo(),this.sortedSet=new et(this.comparator)}static emptySet(e){return new Wi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Wi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Wi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(){this.W_=new et(ue.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ge():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class io{constructor(e,n,r,s,i,o,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new io(e,n,Wi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _b{constructor(){this.queries=yy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=_e(n),i=s.queries;s.queries=yy(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new ie(W.ABORTED,"Firestore shutting down"))}}function yy(){return new go(t=>l1(t),Sc)}async function wb(t,e){const n=_e(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new vb,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Cp(o,`Initialization of query '${vi(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Rp(n)}async function xb(t,e){const n=_e(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Eb(t,e){const n=_e(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Rp(n)}function Ib(t,e,n){const r=_e(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Rp(t){t.Y_.forEach(e=>{e.next()})}var Qh,vy;(vy=Qh||(Qh={})).ea="default",vy.Cache="cache";class Tb{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new io(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=io.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this.key=e}}class z1{constructor(e){this.key=e}}class kb{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ke(),this.mutatedKeys=ke(),this.Aa=u1(e),this.Ra=new Wi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new gy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,m)=>{const w=s.get(p),C=Ac(this.query,m)?m:null,M=!!w&&this.mutatedKeys.has(w.key),j=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let F=!1;w&&C?w.data.isEqual(C.data)?M!==j&&(r.track({type:3,doc:C}),F=!0):this.ga(w,C)||(r.track({type:2,doc:C}),F=!0,(u&&this.Aa(C,u)>0||h&&this.Aa(C,h)<0)&&(l=!0)):!w&&C?(r.track({type:0,doc:C}),F=!0):w&&!C&&(r.track({type:1,doc:w}),F=!0,(u||h)&&(l=!0)),F&&(C?(o=o.add(C),i=j?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,m)=>function(C,M){const j=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return j(C)-j(M)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new io(this.query,e.Ra,i,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new gy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new z1(r))}),this.da.forEach(r=>{e.has(r)||n.push(new U1(r))}),n}ba(e){this.Ta=e.Ts,this.da=ke();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return io.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Sb{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Ab{constructor(e){this.key=e,this.va=!1}}class bb{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new go(l=>l1(l),Sc),this.Ma=new Map,this.xa=new Set,this.Oa=new et(ue.comparator),this.Na=new Map,this.La=new xp,this.Ba={},this.ka=new Map,this.qa=so.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Cb(t,e,n=!0){const r=G1(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await $1(r,e,n,!0),s}async function Rb(t,e){const n=G1(t);await $1(n,e,!0,!1)}async function $1(t,e,n,r){const s=await QA(t.localStore,gr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Pb(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&M1(t.remoteStore,s),l}async function Pb(t,e,n,r,s){t.Ka=(m,w,C)=>async function(j,F,S,k){let T=F.view.ma(S);T.ns&&(T=await hy(j.localStore,F.query,!1).then(({documents:E})=>F.view.ma(E,T)));const P=k&&k.targetChanges.get(F.targetId),O=k&&k.targetMismatches.get(F.targetId)!=null,H=F.view.applyChanges(T,j.isPrimaryClient,P,O);return wy(j,F.targetId,H.wa),H.snapshot}(t,m,w,C);const i=await hy(t.localStore,e,!0),o=new kb(e,i.Ts),l=o.ma(i.documents),u=sl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(l,t.isPrimaryClient,u);wy(t,n,h.wa);const p=new Sb(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function Nb(t,e,n){const r=_e(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Sc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Kh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Tp(r.remoteStore,s.targetId),Xh(r,s.targetId)}).catch(el)):(Xh(r,s.targetId),await Kh(r.localStore,s.targetId,!0))}async function Db(t,e){const n=_e(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Tp(n.remoteStore,r.targetId))}async function Mb(t,e,n){const r=zb(t);try{const s=await function(o,l){const u=_e(o),h=vt.now(),p=l.reduce((C,M)=>C.add(M.key),ke());let m,w;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let M=$r(),j=ke();return u.cs.getEntries(C,p).next(F=>{M=F,M.forEach((S,k)=>{k.isValidDocument()||(j=j.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,M)).next(F=>{m=F;const S=[];for(const k of l){const T=ZS(k,m.get(k.key).overlayedDocument);T!=null&&S.push(new ii(k.key,T,e1(T.value.mapValue),yr.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,S,l)}).next(F=>{w=F;const S=F.applyToLocalDocumentSet(m,j);return u.documentOverlayCache.saveOverlays(C,F.batchId,S)})}).then(()=>({batchId:w.batchId,changes:d1(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new et(Ne)),h=h.insert(l,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await ol(r,s.changes),await Dc(r.remoteStore)}catch(s){const i=Cp(s,"Failed to persist write");n.reject(i)}}async function B1(t,e){const n=_e(t);try{const r=await qA(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Me(o.va):s.removedDocuments.size>0&&(Me(o.va),o.va=!1))}),await ol(n,r,e)}catch(r){await el(r)}}function _y(t,e,n){const r=_e(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=_e(o);u.onlineState=l;let h=!1;u.queries.forEach((p,m)=>{for(const w of m.j_)w.Z_(l)&&(h=!0)}),h&&Rp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jb(t,e,n){const r=_e(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new et(ue.comparator);o=o.insert(i,qt.newNoDocument(i,ve.min()));const l=ke().add(i),u=new Rc(ve.min(),new Map,new et(Ne),o,l);await B1(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Pp(r)}else await Kh(r.localStore,e,!1).then(()=>Xh(r,e,n)).catch(el)}async function Lb(t,e){const n=_e(t),r=e.batch.batchId;try{const s=await HA(n.localStore,e);H1(n,r,null),W1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ol(n,s)}catch(s){await el(s)}}async function Ob(t,e,n){const r=_e(t);try{const s=await function(o,l){const u=_e(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(m=>(Me(m!==null),p=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);H1(r,e,n),W1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ol(r,s)}catch(s){await el(s)}}function W1(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function H1(t,e,n){const r=_e(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Xh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||q1(t,r)})}function q1(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Tp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Pp(t))}function wy(t,e,n){for(const r of n)r instanceof U1?(t.La.addReference(r.key,e),Vb(t,r)):r instanceof z1?(se("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||q1(t,r.key)):ge()}function Vb(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(se("SyncEngine","New document in limbo: "+n),t.xa.add(r),Pp(t))}function Pp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ue(He.fromString(e)),r=t.qa.next();t.Na.set(r,new Ab(n)),t.Oa=t.Oa.insert(n,r),M1(t.remoteStore,new us(gr(mp(n.path)),r,"TargetPurposeLimboResolution",up.oe))}}async function ol(t,e,n){const r=_e(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){s.push(h);const m=Ip.Wi(u.targetId,h);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const p=_e(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>K.forEach(h,w=>K.forEach(w.$i,C=>p.persistence.referenceDelegate.addReference(m,w.targetId,C)).next(()=>K.forEach(w.Ui,C=>p.persistence.referenceDelegate.removeReference(m,w.targetId,C)))))}catch(m){if(!tl(m))throw m;se("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const w=m.targetId;if(!m.fromCache){const C=p.os.get(w),M=C.snapshotVersion,j=C.withLastLimboFreeSnapshotVersion(M);p.os=p.os.insert(w,j)}}}(r.localStore,i))}async function Fb(t,e){const n=_e(t);if(!n.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await R1(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new ie(W.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ol(n,r.hs)}}function Ub(t,e){const n=_e(t),r=n.Na.get(e);if(r&&r.va)return ke().add(r.key);{let s=ke();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function G1(t){const e=_e(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=B1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ub.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jb.bind(null,e),e.Ca.d_=Eb.bind(null,e.eventManager),e.Ca.$a=Ib.bind(null,e.eventManager),e}function zb(t){const e=_e(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Lb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ob.bind(null,e),e}class nc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return WA(this.persistence,new $A,e.initialUser,this.serializer)}Ga(e){return new FA(Ep.Zr,this.serializer)}Wa(e){return new YA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nc.provider={build:()=>new nc};class Yh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>_y(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Fb.bind(null,this.syncEngine),await yb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _b}()}createDatastore(e){const n=Pc(e.databaseInfo.databaseId),r=function(i){return new tb(i)}(e.databaseInfo);return function(i,o,l,u){return new sb(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new ob(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>_y(this.syncEngine,n,0),function(){return py.D()?new py:new JA}())}createSyncEngine(e,n){return function(s,i,o,l,u,h,p){const m=new bb(s,i,o,l,u,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=_e(s);se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await il(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Yh.provider={build:()=>new Yh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):zr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Wt.UNAUTHENTICATED,this.clientId=Y_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{se("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(se("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Cp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cd(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await R1(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function xy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Wb(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>my(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>my(e.remoteStore,s)),t._onlineComponents=e}async function Wb(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;eo("Error using user provided cache. Falling back to memory cache: "+n),await Cd(t,new nc)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await Cd(t,new nc);return t._offlineComponents}async function K1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await xy(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await xy(t,new Yh))),t._onlineComponents}function Hb(t){return K1(t).then(e=>e.syncEngine)}async function Ey(t){const e=await K1(t),n=e.eventManager;return n.onListen=Cb.bind(null,e.syncEngine),n.onUnlisten=Nb.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Rb.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Db.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(t,e,n){if(!n)throw new ie(W.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function qb(t,e,n,r){if(e===!0&&r===!0)throw new ie(W.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ty(t){if(!ue.isDocumentKey(t))throw new ie(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ky(t){if(ue.isDocumentKey(t))throw new ie(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Mc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ge()}function qs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ie(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Mc(t);throw new ie(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ie(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ie(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Q1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ie(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ie(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ie(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lS;switch(r.type){case"firstParty":return new hS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Iy.get(n);r&&(se("ComponentProvider","Removing Datastore"),Iy.delete(n),r.terminate())}(this),Promise.resolve()}}function Gb(t,e,n,r={}){var s;const i=(t=qs(t,jc))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Wt.MOCK_USER;else{l=MI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new ie(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Wt(h)}t._authCredentials=new uS(new X_(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vo(this.firestore,e,this._query)}}class pn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pn(this.firestore,e,this._key)}}class xs extends vo{constructor(e,n,r){super(e,n,mp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pn(this.firestore,null,new ue(e))}withConverter(e){return new xs(this.firestore,e,this._path)}}function Kb(t,e,...n){if(t=mn(t),X1("collection","path",e),t instanceof jc){const r=He.fromString(e,...n);return ky(r),new xs(t,null,r)}{if(!(t instanceof pn||t instanceof xs))throw new ie(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return ky(r),new xs(t.firestore,null,r)}}function Rd(t,e,...n){if(t=mn(t),arguments.length===1&&(e=Y_.newId()),X1("doc","path",e),t instanceof jc){const r=He.fromString(e,...n);return Ty(r),new pn(t,null,new ue(r))}{if(!(t instanceof pn||t instanceof xs))throw new ie(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return Ty(r),new pn(t.firestore,t instanceof xs?t.converter:null,new ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new N1(this,"async_queue_retry"),this.Vu=()=>{const r=bd();r&&se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=bd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=bd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Hs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!tl(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw zr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=bp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ge()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function by(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ua extends jc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Ay,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ay(e),this._firestoreClient=void 0,await e}}}function Qb(t,e){const n=typeof t=="object"?t:Jf(),r=typeof t=="string"?t:"(default)",s=Yf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=NI("firestore");i&&Gb(s,...i)}return s}function Y1(t){if(t._terminated)throw new ie(W.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Xb(t),t._firestoreClient}function Xb(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new kS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Q1(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Bb(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new oo(jt.fromBase64String(e))}catch(n){throw new ie(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new oo(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ie(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ie(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ie(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=/^__.*__$/;class Jb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ii(e,this.data,this.fieldMask,n,this.fieldTransforms):new rl(e,this.data,n,this.fieldTransforms)}}function Z1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class jp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new jp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return rc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Z1(this.Cu)&&Yb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Zb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pc(e)}Qu(e,n,r,s=!1){return new jp({Cu:e,methodName:n,qu:r,path:Pt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ew(t){const e=t._freezeSettings(),n=Pc(t._databaseId);return new Zb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function eC(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);rw("Data must be an object, but it was:",o,r);const l=tw(r,o);let u,h;if(i.merge)u=new Zn(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const w=nC(e,m,n);if(!o.contains(w))throw new ie(W.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);sC(p,w)||p.push(w)}u=new Zn(p),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new Jb(new On(l),u,h)}function tC(t,e,n,r=!1){return Lp(n,t.Qu(r?4:3,e))}function Lp(t,e){if(nw(t=mn(t)))return rw("Unsupported field value:",e,t),tw(t,e);if(t instanceof J1)return function(r,s){if(!Z1(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=Lp(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=mn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return GS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=vt.fromDate(r);return{timestampValue:ec(s.serializer,i)}}if(r instanceof vt){const i=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ec(s.serializer,i)}}if(r instanceof Dp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof oo)return{bytesValue:I1(s.serializer,r._byteString)};if(r instanceof pn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:wp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Mp)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return gp(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Mc(r)}`)}(t,e)}function tw(t,e){const n={};return J_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mo(t,(r,s)=>{const i=Lp(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function nw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof Dp||t instanceof oo||t instanceof pn||t instanceof J1||t instanceof Mp)}function rw(t,e,n){if(!nw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Mc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function nC(t,e,n){if((e=mn(e))instanceof Np)return e._internalPath;if(typeof e=="string")return sw(t,e);throw rc("Field path arguments must be of type string or ",t,!1,void 0,n)}const rC=new RegExp("[~\\*/\\[\\]]");function sw(t,e,n){if(e.search(rC)>=0)throw rc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Np(...e.split("."))._internalPath}catch{throw rc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function rc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new ie(W.INVALID_ARGUMENT,l+t+u)}function sC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ow("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iC extends iw{data(){return super.data()}}function ow(t,e){return typeof e=="string"?sw(t,e):e instanceof Np?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ie(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Op{}class aC extends Op{}function lC(t,e,...n){let r=[];e instanceof Op&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Fp).length,l=i.filter(u=>u instanceof Vp).length;if(o>1||o>0&&l>0)throw new ie(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Vp extends aC{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Vp(e,n,r)}_apply(e){const n=this._parse(e);return aw(e._query,n),new vo(e.firestore,e.converter,$h(e._query,n))}_parse(e){const n=ew(e.firestore);return function(i,o,l,u,h,p,m){let w;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ie(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Ry(m,p);const C=[];for(const M of m)C.push(Cy(u,i,M));w={arrayValue:{values:C}}}else w=Cy(u,i,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Ry(m,p),w=tC(l,o,m,p==="in"||p==="not-in");return pt.create(h,p,w)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Fp extends Op{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Fp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:rr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)aw(o,u),o=$h(o,u)}(e._query,n),new vo(e.firestore,e.converter,$h(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Cy(t,e,n){if(typeof(n=mn(n))=="string"){if(n==="")throw new ie(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!a1(e)&&n.indexOf("/")!==-1)throw new ie(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(He.fromString(n));if(!ue.isDocumentKey(r))throw new ie(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qg(t,new ue(r))}if(n instanceof pn)return Qg(t,n._key);throw new ie(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mc(n)}.`)}function Ry(t,e){if(!Array.isArray(t)||t.length===0)throw new ie(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aw(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ie(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class uC{convertValue(e,n="none"){switch(ni(e)){case 0:return null;case 1:return e.booleanValue;case 2:return at(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return mo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>at(o.doubleValue));return new Mp(i)}convertGeoPoint(e){return new Dp(at(e.latitude),at(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=dp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ja(e));default:return null}}convertTimestamp(e){const n=ks(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);Me(C1(r));const s=new La(r.get(1),r.get(3)),i=new ue(r.popFirst(5));return s.isEqual(n)||zr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lw extends iw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ow("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class gu extends lw{data(e={}){return super.data(e)}}class dC{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Jo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new gu(this._firestore,this._userDataWriter,r.key,r,new Jo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ie(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new gu(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Jo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new gu(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Jo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:hC(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function hC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}class uw extends uC{constructor(e){super(),this.firestore=e}convertBytes(e){return new oo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pn(this.firestore,null,n)}}function Py(t,e,n){t=qs(t,pn);const r=qs(t.firestore,Ua),s=cC(t.converter,e,n);return cw(r,[eC(ew(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,yr.none())])}function fC(t){return cw(qs(t.firestore,Ua),[new yp(t._key,yr.none())])}function pC(t,...e){var n,r,s;t=mn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||by(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(by(e[o])){const m=e[o];e[o]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,h,p;if(t instanceof pn)h=qs(t.firestore,Ua),p=mp(t._key.path),u={next:m=>{e[o]&&e[o](mC(h,t,m))},error:e[o+1],complete:e[o+2]};else{const m=qs(t,vo);h=qs(m.firestore,Ua),p=m._query;const w=new uw(h);u={next:C=>{e[o]&&e[o](new dC(h,w,m,C))},error:e[o+1],complete:e[o+2]},oC(t._query)}return function(w,C,M,j){const F=new $b(j),S=new Tb(C,F,M);return w.asyncQueue.enqueueAndForget(async()=>wb(await Ey(w),S)),()=>{F.Za(),w.asyncQueue.enqueueAndForget(async()=>xb(await Ey(w),S))}}(Y1(h),p,l,u)}function cw(t,e){return function(r,s){const i=new Hs;return r.asyncQueue.enqueueAndForget(async()=>Mb(await Hb(r),s,i)),i.promise}(Y1(t),e)}function mC(t,e,n){const r=n.docs.get(e._key),s=new uw(t);return new lw(t,s,e._key,r,new Jo(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){po=s})(ho),Zi(new Js("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Ua(new cS(r.getProvider("auth-internal")),new pS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ie(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new La(h.options.projectId,p)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),ws(Wg,"4.7.3",e),ws(Wg,"4.7.3","esm2017")})();const It={marriage:{label:"Matrimonio",color:"#000000",lineStyle:"solid",renderType:"standard"},cohabitation:{label:"Convivenza",color:"#000000",lineStyle:"dashed",renderType:"standard"},separation:{label:"Separazione",color:"#000000",lineStyle:"solid",renderType:"oblique"},"separation-repaired":{label:"Separazione Riparata",color:"#000000",lineStyle:"solid",renderType:"x-cross"},"separation-cohab":{label:"Separazione (Conv.)",color:"#000000",lineStyle:"dashed",renderType:"oblique"},divorce:{label:"Divorzio",color:"#000000",lineStyle:"solid",renderType:"oblique-double"},"divorce-repaired":{label:"Divorzio Riparato",color:"#000000",lineStyle:"solid",renderType:"oblique-double-crossed"},"re-marriage":{label:"Risposati",color:"#000000",lineStyle:"solid",renderType:"standard"},affair:{label:"Relazione Extra/Amante",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},"one-night":{label:"Avventura",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},engagement:{label:"Fidanzamento",color:"#0000FF",lineStyle:"dashed",renderType:"standard"},"child-bio":{label:"Figlio Biologico",color:"#000000",lineStyle:"solid",renderType:"standard"},"child-adopted":{label:"Adozione",color:"#0000FF",lineStyle:"dotted",renderType:"standard"},"child-foster":{label:"Affido",color:"#000000",lineStyle:"dashed",renderType:"standard"},"twin-dizygotic":{label:"Gemelli Dizigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link"},"twin-monozygotic":{label:"Gemelli Monozigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link-bar"},pregnancy:{label:"Gravidanza",color:"#000000",lineStyle:"solid",renderType:"standard"},harmony:{label:"Armonia",color:"#008000",lineStyle:"solid",renderType:"standard"},friendship:{label:"Amicizia",color:"#008000",lineStyle:"dashed",renderType:"standard"},"best-friend":{label:"Migliore Amico",color:"#008000",lineStyle:"dotted",renderType:"double"},close:{label:"Molto Uniti",color:"#008000",lineStyle:"solid",renderType:"double"},fusion:{label:"Invischiamento (Fusione)",color:"#008000",lineStyle:"solid",renderType:"triple"},"in-love":{label:"Innamorati",color:"#008000",lineStyle:"solid",renderType:"two-circles-center"},fan:{label:"Ammiratore",color:"#008000",lineStyle:"dashed",renderType:"arrow"},spiritual:{label:"Conn. Spirituale",color:"#800080",lineStyle:"dashed",renderType:"standard"},hostile:{label:"Ostilit",color:"#FF0000",lineStyle:"dotted",renderType:"standard"},conflict:{label:"Conflitto",color:"#FF0000",lineStyle:"zigzag",renderType:"standard"},"fusion-hostile":{label:"Fusione & Conflitto",color:"#000000",lineStyle:"solid",renderType:"fusion-hostile"},"close-hostile":{label:"Uniti & Conflittuali",color:"#000000",lineStyle:"solid",renderType:"double-zigzag"},"distant-hostile":{label:"Distante & Ostile",color:"#FF0000",lineStyle:"dotted",renderType:"zigzag-overlay"},hate:{label:"Odio",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag"},violence:{label:"Violenza",color:"#FF0000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-physical":{label:"Abuso Fisico",color:"#800000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-emotional":{label:"Abuso Emotivo",color:"#800000",lineStyle:"dashed",renderType:"arrow"},"abuse-sexual":{label:"Abuso Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"arrow-double-bar-center"},neglect:{label:"Trascuratezza",color:"#808080",lineStyle:"dashed",renderType:"standard"},focused:{label:"Focalizzata Su",color:"#0000FF",lineStyle:"solid",renderType:"arrow-open"},manipulative:{label:"Manipolativo",color:"#FF0000",lineStyle:"solid",renderType:"arrow-x-center"},controlling:{label:"Controllante",color:"#800080",lineStyle:"solid",renderType:"arrow-box-center"},keeper:{label:"Custode/Caregiver",color:"#008080",lineStyle:"solid",renderType:"arrow-diamond-center"},distant:{label:"Distante",color:"#808080",lineStyle:"dotted",renderType:"standard"},poor:{label:"Povera",color:"#808080",lineStyle:"solid",renderType:"standard"},cutoff:{label:"Taglio",color:"#000000",lineStyle:"solid",renderType:"cutoff"},"cutoff-repaired":{label:"Taglio Riparato",color:"#000000",lineStyle:"solid",renderType:"cutoff-circle"},custom:{label:"Personalizzata",color:"#000000",lineStyle:"solid",renderType:"standard"}},dr={Struttura:["marriage","cohabitation","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","re-marriage","engagement","affair","one-night"],Figli:["child-bio","child-adopted","child-foster","twin-dizygotic","twin-monozygotic","pregnancy"],"Legami Affettivi":["harmony","friendship","best-friend","close","fusion","in-love","fan","spiritual"],"Conflitto/Distanza":["hostile","conflict","fusion-hostile","close-hostile","distant-hostile","hate","distant","poor","cutoff","cutoff-repaired"],"Abuso/Potere":["abuse-physical","abuse-emotional","abuse-sexual","neglect","violence","manipulative","controlling","focused","keeper"],Altro:["custom"]},Ny={home:aI,heart:Kf,user:EI,users:zu,grad:rI,book:GE,briefcase:KE,folder:tI,help:oI,tag:bh},gC=[{id:"family",label:"Famiglie",color:"#3b82f6",iconKey:"home"},{id:"couple",label:"Coppie",color:"#ec4899",iconKey:"heart"},{id:"individual",label:"Individuali",color:"#10b981",iconKey:"user"},{id:"school",label:"Scolastico",color:"#f59e0b",iconKey:"grad"},{id:"exercise",label:"Esercitazioni",color:"#6366f1",iconKey:"book"},{id:"work",label:"Lavoro/Org",color:"#64748b",iconKey:"briefcase"},{id:"other",label:"Altro",color:"#94a3b8",iconKey:"folder"}],os=[{id:"light",label:"Light (Default)",type:"light",colors:{bgMain:"#f9fafb",bgPanel:"#ffffff",border:"#e5e7eb",text:"#111827",textMuted:"#6b7280",accent:"#2563eb"}},{id:"sepia",label:"Vintage Sepia",type:"light",colors:{bgMain:"#fdf6e3",bgPanel:"#eee8d5",border:"#d2b48c",text:"#433422",textMuted:"#93a1a1",accent:"#b58900"}},{id:"nordic",label:"Nordic Snow",type:"light",colors:{bgMain:"#eceff4",bgPanel:"#e5e9f0",border:"#d8dee9",text:"#2e3440",textMuted:"#4c566a",accent:"#5e81ac"}},{id:"dark",label:"Dark (Classic)",type:"dark",colors:{bgMain:"#111827",bgPanel:"#1f2937",border:"#374151",text:"#f9fafb",textMuted:"#9ca3af",accent:"#3b82f6"}},{id:"onedark",label:"One Dark Pro",type:"dark",colors:{bgMain:"#282c34",bgPanel:"#21252b",border:"#3e4451",text:"#abb2bf",textMuted:"#5c6370",accent:"#61afef"}},{id:"dracula",label:"Dracula",type:"dark",colors:{bgMain:"#282a36",bgPanel:"#44475a",border:"#6272a4",text:"#f8f8f2",textMuted:"#bd93f9",accent:"#ff79c6"}},{id:"nightowl",label:"Night Owl",type:"dark",colors:{bgMain:"#011627",bgPanel:"#0b2942",border:"#5f7e97",text:"#d6deeb",textMuted:"#7e57c2",accent:"#82aaff"}},{id:"forest",label:"Forest Night",type:"dark",colors:{bgMain:"#0d1117",bgPanel:"#161b22",border:"#30363d",text:"#c9d1d9",textMuted:"#8b949e",accent:"#238636"}}],ln=20,Zo=8e3,wt=Zo/2,Bt=40,Tr=40,ao=20,dw=40,yC=ao+dw,Gl=40,vC=10,pe=()=>Math.random().toString(36).substr(2,9),hw=t=>{if(!t)return null;const e=t.split(/[\/\-\.]/);if(e.length===3){const n=parseInt(e[0]),r=parseInt(e[1])-1,s=parseInt(e[2]);if(!isNaN(n)&&!isNaN(r)&&!isNaN(s)){const i=s<100?s>30?1900+s:2e3+s:s;return new Date(i,r,n)}}return/^\d{4}$/.test(t)?new Date(parseInt(t),0,1):null},za=t=>{const e=hw(t);if(!e)return"?";const n=new Date;let r=n.getFullYear()-e.getFullYear();const s=n.getMonth()-e.getMonth();return(s<0||s===0&&n.getDate()<e.getDate())&&r--,r.toString()},Kl=(t,e)=>e.find(n=>(n.fromId===t||n.toId===t)&&["marriage","cohabitation","separation","divorce","affair","re-marriage"].includes(n.type)),_C=(t,e)=>Math.max(t,e)+dw,xi=(t,e)=>{const n=e.filter(l=>t.memberIds.includes(l.id));if(!n.length)return null;const r=Math.min(...n.map(l=>l.x)),s=Math.max(...n.map(l=>l.x+Bt)),i=Math.min(...n.map(l=>l.y)),o=Math.max(...n.map(l=>l.y+Tr));return{x:r-Gl,y:i-Gl,w:s-r+Gl*2,h:o-i+Gl*2,cx:(r+s)/2,cy:(i+o)/2}},Dy=(t,e,n)=>{const r=e.find(i=>i.id===t);if(r)return{x:r.x+ao,y:r.y+ao};const s=n.find(i=>i.id===t);if(s){const i=xi(s,e);if(i)return{x:i.x+i.w/2,y:i.y+i.h/2}}return null},Pd=(t,e)=>{const n=t.x+t.w/2,r=t.y+t.h/2,s=e.x-n,i=e.y-r;if(Math.abs(s)<.1&&Math.abs(i)<.1)return{x:n,y:r};const o=t.w/2/Math.abs(s),l=t.h/2/Math.abs(i),u=Math.min(o,l);return{x:n+s*u,y:r+i*u}},Nd=(t,e,n,r,s=4,i=12)=>{const o=n-t,l=r-e,u=Math.sqrt(o*o+l*l);if(u===0)return`M ${t} ${e}`;const h=o/u,m=-(l/u),w=h;let C=`M ${t} ${e}`;const M=Math.floor(u/i);for(let j=1;j<=M;j++){const F=j/M,S=t+o*F,k=e+l*F,T=j%2===0?s:-s;C+=` L ${S+m*T} ${k+w*T}`}return C+=` L ${n} ${r}`,C},sc=t=>{if(!t)return 0;const e=t.match(/\d{4}/);return e?parseInt(e[0]):0},wC=({x:t,y:e,darkMode:n,nodes:r,edges:s})=>{const i=n?"#1f2937":"#ffffff",o=n?"#f3f4f6":"#1f2937",l=n?"#374151":"#e5e7eb",u=n?"#9ca3af":"#6b7280",h=Array.from(new Set(r.map(y=>y.gender))).sort(),p=r.some(y=>y.deceased),m=r.some(y=>y.indexPerson),w=Array.from(new Set(s.map(y=>y.type))).sort(),C=15,M=24,j=140,F=30,S=h.length+(p?1:0)+(m?1:0),k=w.length,T=S+k>8,P=T?j*2+C*3:j+C*2,O=F+C+Math.max(S,T?k:S+k)*M+(T?0:20),H=y=>{const x=o,I="none",R=1.5;return y==="M"?c.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:x,fill:I,strokeWidth:R}):y==="F"?c.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:x,fill:I,strokeWidth:R}):y==="Pet"?c.jsx("path",{d:"M8 2 L14 8 L8 14 L2 8 Z",stroke:x,fill:I,strokeWidth:R}):y==="Pregnancy"?c.jsx("path",{d:"M8 2 L14 14 L2 14 Z",stroke:x,fill:I,strokeWidth:R}):c.jsx("text",{x:"8",y:"12",textAnchor:"middle",fontSize:"10",fill:x,fontFamily:"sans-serif",children:"?"})},E=y=>{const x=It[y]||It.custom;if(!x)return null;const I=x.color==="#000000"&&n?"#ffffff":x.color;let R=c.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:I,strokeWidth:"2"});x.lineStyle==="dashed"&&(R=c.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:I,strokeWidth:"2",strokeDasharray:"4,2"})),x.lineStyle==="dotted"&&(R=c.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:I,strokeWidth:"2",strokeDasharray:"1,3"})),x.lineStyle==="zigzag"&&(R=c.jsx("path",{d:"M0 8 L5 4 L10 12 L15 4 L20 12 L25 4 L30 8",stroke:x.renderType.includes("hostile")?"red":I,fill:"none",strokeWidth:"1.5"}));let N=null;return y==="best-friend"?N=c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"5",x2:"30",y2:"5",stroke:I,strokeWidth:"1"}),c.jsx("line",{x1:"0",y1:"11",x2:"30",y2:"11",stroke:I,strokeWidth:"1"})]}):x.renderType==="double"?N=c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"5",x2:"30",y2:"5",stroke:I,strokeWidth:"1"}),c.jsx("line",{x1:"0",y1:"11",x2:"30",y2:"11",stroke:I,strokeWidth:"1"})]}):x.renderType==="triple"||x.renderType==="fusion"?N=c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"4",x2:"30",y2:"4",stroke:I,strokeWidth:"1"}),c.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:I,strokeWidth:"1"}),c.jsx("line",{x1:"0",y1:"12",x2:"30",y2:"12",stroke:I,strokeWidth:"1"})]}):x.renderType==="oblique"?N=c.jsx("line",{x1:"18",y1:"2",x2:"12",y2:"14",stroke:I,strokeWidth:"2"}):x.renderType==="oblique-double"?N=c.jsxs("g",{children:[c.jsx("line",{x1:"16",y1:"2",x2:"10",y2:"14",stroke:I,strokeWidth:"2"}),c.jsx("line",{x1:"20",y1:"2",x2:"14",y2:"14",stroke:I,strokeWidth:"2"})]}):x.renderType==="cutoff"&&(N=c.jsx("line",{x1:"15",y1:"2",x2:"15",y2:"14",stroke:I,strokeWidth:"2"})),c.jsxs("g",{transform:"translate(0, 2)",children:[R,N]})};return c.jsxs("g",{transform:`translate(${t}, ${e})`,children:[c.jsx("rect",{width:P,height:O,rx:"8",fill:i,stroke:l,strokeWidth:"1",filter:"drop-shadow(0 4px 6px rgb(0 0 0 / 0.1))"}),c.jsx("text",{x:C,y:22,fontWeight:"bold",fill:o,fontSize:"12",letterSpacing:"0.5px",fontFamily:"sans-serif",children:"LEGENDA"}),c.jsx("line",{x1:C,y1:F,x2:P-C,y2:F,stroke:l,strokeWidth:"1"}),c.jsxs("g",{transform:`translate(${C}, ${F+15})`,children:[c.jsxs("g",{children:[S>0&&c.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Persone"}),h.map((y,x)=>c.jsxs("g",{transform:`translate(0, ${x*M})`,children:[H(y),c.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:y==="M"?"Maschio":y==="F"?"Femmina":y})]},y)),p&&c.jsxs("g",{transform:`translate(0, ${h.length*M})`,children:[c.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),c.jsx("line",{x1:"2",y1:"2",x2:"14",y2:"14",stroke:o}),c.jsx("line",{x1:"14",y1:"2",x2:"2",y2:"14",stroke:o}),c.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Deceduto"})]}),m&&c.jsxs("g",{transform:`translate(0, ${(h.length+(p?1:0))*M})`,children:[c.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),c.jsx("rect",{x:"4",y:"4",width:"8",height:"8",stroke:o,fill:"none"}),c.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Paz. Designato"})]})]}),w.length>0&&c.jsxs("g",{transform:`translate(${T?j+C:0}, ${T?0:S*M+15})`,children:[c.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Relazioni"}),w.map((y,x)=>{var R;const I=((R=It[y])==null?void 0:R.label)||"Custom";return c.jsxs("g",{transform:`translate(0, ${x*M})`,children:[E(y),c.jsx("text",{x:"35",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:I})]},y)})]})]})]})},Jh=({type:t})=>{const e=It[t]||It.custom;if(!e)return null;const n=e.color;return c.jsxs("svg",{width:"50",height:"14",className:"shrink-0 mr-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 overflow-visible",children:[e.lineStyle==="dashed"&&c.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2",strokeDasharray:"4,2"}),e.lineStyle==="dotted"&&c.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2",strokeDasharray:"1,3"}),e.lineStyle==="solid"&&!["fusion","double","triple","triple-zigzag","close-hostile"].includes(e.renderType)&&c.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2"}),e.lineStyle==="zigzag"&&c.jsx("path",{d:"M0 7 L5 3 L10 11 L15 3 L20 11 L25 3 L30 11 L35 3 L40 11 L45 3 L50 7",stroke:e.renderType==="fusion-hostile"?"red":n,fill:"none",strokeWidth:"1.5"}),(e.renderType==="fusion"||e.renderType==="triple")&&c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"3",x2:"50",y2:"3",stroke:n,strokeWidth:"1.5"}),c.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"1.5"}),c.jsx("line",{x1:"0",y1:"11",x2:"50",y2:"11",stroke:n,strokeWidth:"1.5"})]}),e.renderType==="triple-zigzag"&&c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"3",x2:"50",y2:"3",stroke:n,strokeWidth:"1.5"}),c.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"1.5"}),c.jsx("line",{x1:"0",y1:"11",x2:"50",y2:"11",stroke:n,strokeWidth:"1.5"}),c.jsx("path",{d:"M0 7 L5 3 L10 11 L15 3 L20 11 L25 3 L30 11 L35 3 L40 11 L45 3 L50 7",stroke:"red",fill:"none",strokeWidth:"1.5"})]}),(e.renderType==="double"||e.renderType==="best-friend")&&c.jsxs("g",{children:[c.jsx("line",{x1:"0",y1:"4",x2:"50",y2:"4",stroke:n,strokeWidth:"1.5"}),c.jsx("line",{x1:"0",y1:"10",x2:"50",y2:"10",stroke:n,strokeWidth:"1.5"})]}),e.renderType.includes("arrow")&&c.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),e.renderType==="oblique"&&c.jsx("line",{x1:"28",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),e.renderType==="oblique-double"&&c.jsxs("g",{children:[c.jsx("line",{x1:"26",y1:"2",x2:"20",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"30",y1:"2",x2:"24",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="x-cross"&&c.jsxs("g",{children:[c.jsx("line",{x1:"28",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"22",y1:"2",x2:"28",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="oblique-double-crossed"&&c.jsxs("g",{children:[c.jsx("line",{x1:"27",y1:"2",x2:"21",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"33",y1:"2",x2:"27",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"19",y1:"2",x2:"35",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="arrow-x-center"&&c.jsxs("g",{children:[c.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),c.jsx("line",{x1:"22",y1:"4",x2:"28",y2:"10",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"22",y1:"10",x2:"28",y2:"4",stroke:n,strokeWidth:"2"})]}),e.renderType==="arrow-box-center"&&c.jsxs("g",{children:[c.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),c.jsx("rect",{x:"20",y:"2",width:"10",height:"10",stroke:n,strokeWidth:"2",fill:"white"})]}),e.renderType==="arrow-diamond-center"&&c.jsxs("g",{children:[c.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),c.jsx("polygon",{points:"25,2 30,7 25,12 20,7",stroke:n,strokeWidth:"2",fill:"none"})]}),e.renderType==="arrow-double-bar-center"&&c.jsxs("g",{children:[c.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),c.jsx("line",{x1:"22",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"26",y1:"2",x2:"26",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="cutoff-double"&&c.jsxs("g",{children:[c.jsx("line",{x1:"22",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),c.jsx("line",{x1:"28",y1:"2",x2:"28",y2:"12",stroke:n,strokeWidth:"2"})]})]})},xC=({value:t,onChange:e,className:n})=>{const[r,s]=Q.useState(!1),i=It[t]||It.custom||{label:t};return c.jsxs("div",{className:`relative ${n}`,children:[c.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between p-2 border rounded bg-white text-gray-900 dark:text-gray-100 dark:bg-gray-700 text-xs hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[c.jsxs("div",{className:"flex items-center overflow-hidden",children:[c.jsx(Jh,{type:t}),c.jsx("span",{className:"truncate",children:i.label})]}),c.jsx(Qv,{size:14,className:"opacity-50 shrink-0 ml-1"})]}),r&&c.jsxs("div",{className:"absolute top-full left-0 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded shadow-xl max-h-60 overflow-y-auto z-50 text-gray-900 dark:text-gray-100 text-left",children:[Object.entries(dr).map(([o,l])=>c.jsxs("div",{children:[c.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-900 text-[9px] font-bold uppercase text-gray-500 sticky top-0 border-b border-gray-200 dark:border-gray-700",children:o}),l.map(u=>{const h=It[u];return h?c.jsxs("button",{onClick:()=>{e(u),s(!1)},className:`w-full flex items-center p-2 text-xs hover:bg-blue-50 dark:hover:bg-blue-900/30 text-left border-b border-gray-50 dark:border-gray-700 ${t===u?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[c.jsx(Jh,{type:u}),c.jsx("span",{children:h.label})]},u):null})]},o)),c.jsx("div",{className:"p-1 sticky bottom-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:c.jsx("button",{onClick:()=>s(!1),className:"w-full py-1 text-center text-gray-400 hover:text-red-500 text-[10px]",children:"Chiudi"})})]})]})},EC=({edge:t,start:e,end:n,isSelected:r,darkMode:s,customConfig:i,onSelect:o,onAddChild:l})=>{let u=It[t.type];!u&&i&&(u=i.config),u||(u={color:"#000",lineStyle:"solid",renderType:"standard"});const h=t.color||u.color,p=u.renderType,m=r?"#3b82f6":s&&h==="#000000"?"#ffffff":h,w=["marriage","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","cohabitation","affair","re-marriage"].includes(t.type),C=_C(e.y,n.y);let M=(e.x+n.x)/2,j=(e.y+n.y)/2;w&&(j=C);let F="";w?F=`M ${e.x} ${e.y+ao} L ${e.x} ${C} L ${n.x} ${C} L ${n.x} ${n.y+ao}`:t.type.startsWith("child")||t.type.startsWith("twin")?t.type.startsWith("twin")?F=`M ${e.x} ${e.y} L ${n.x} ${n.y}`:F=`M ${e.x} ${e.y} L ${n.x} ${e.y} L ${n.x} ${n.y}`:u.lineStyle==="zigzag"?F=Nd(e.x,e.y,n.x,n.y):F=`M ${e.x} ${e.y} Q ${M} ${j} ${n.x} ${n.y}`;const S=u.lineStyle==="dashed"?"8,4":u.lineStyle==="dotted"?"2,2":"0",k=()=>{let P=M,O=j;if(t.type==="best-friend")return c.jsxs("g",{children:[c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(p==="fusion"||p==="triple")return c.jsxs("g",{children:[c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(p==="fusion-hostile")return c.jsxs("g",{children:[c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),c.jsx("path",{d:Nd(e.x,e.y,n.x,n.y),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(p==="triple-zigzag")return c.jsxs("g",{children:[c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),c.jsx("path",{d:Nd(e.x,e.y,n.x,n.y),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(p==="double"||p==="double-zigzag"||p==="best-friend")return c.jsx("path",{d:F,stroke:m,strokeWidth:1,transform:"translate(3,3)",fill:"none",strokeDasharray:S});if(p==="oblique")return c.jsx("line",{x1:P+5,y1:O-10,x2:P-5,y2:O+10,stroke:m,strokeWidth:2});if(p==="oblique-double")return c.jsxs("g",{children:[c.jsx("line",{x1:P+2,y1:O-10,x2:P-8,y2:O+10,stroke:m,strokeWidth:2}),c.jsx("line",{x1:P+8,y1:O-10,x2:P-2,y2:O+10,stroke:m,strokeWidth:2})]});if(p==="x-cross")return c.jsxs("g",{children:[c.jsx("line",{x1:P+5,y1:O-10,x2:P-5,y2:O+10,stroke:m,strokeWidth:2}),c.jsx("line",{x1:P-5,y1:O-10,x2:P+5,y2:O+10,stroke:m,strokeWidth:2})]});if(p==="oblique-double-crossed")return c.jsxs("g",{children:[c.jsx("line",{x1:P+2,y1:O-10,x2:P-8,y2:O+10,stroke:m,strokeWidth:2}),c.jsx("line",{x1:P+8,y1:O-10,x2:P-2,y2:O+10,stroke:m,strokeWidth:2}),c.jsx("line",{x1:P-8,y1:O-10,x2:P+8,y2:O+10,stroke:m,strokeWidth:2})]});if(p==="cutoff-double")return c.jsxs("g",{children:[c.jsx("line",{x1:P-3,y1:O-10,x2:P-3,y2:O+10,stroke:m,strokeWidth:2}),c.jsx("line",{x1:P+3,y1:O-10,x2:P+3,y2:O+10,stroke:m,strokeWidth:2})]});if(p==="cutoff")return c.jsx("line",{x1:P,y1:O-10,x2:P,y2:O+10,stroke:m,strokeWidth:3});const H=w?0:Math.atan2(n.y-e.y,n.x-e.x)*180/Math.PI,E=`translate(${n.x},${n.y}) rotate(${H}) translate(-25,0)`,y=`translate(${M},${j}) rotate(${H})`;return p==="arrow-x-center"?c.jsxs("g",{children:[c.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:m,transform:E}),c.jsxs("g",{transform:y,children:[c.jsx("line",{x1:"-6",y1:"-6",x2:"6",y2:"6",stroke:m,strokeWidth:2}),c.jsx("line",{x1:"-6",y1:"6",x2:"6",y2:"-6",stroke:m,strokeWidth:2})]})]}):p==="arrow-box-center"?c.jsxs("g",{children:[c.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:m,transform:E}),c.jsx("rect",{x:"-6",y:"-6",width:"12",height:"12",stroke:m,strokeWidth:2,fill:"white",transform:y})]}):p==="arrow-diamond-center"?c.jsxs("g",{children:[c.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:m,transform:E}),c.jsx("polygon",{points:"0,-6 6,0 0,6 -6,0",stroke:m,strokeWidth:2,fill:"white",transform:y})]}):p==="arrow-double-bar-center"?c.jsxs("g",{children:[c.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:m,transform:E}),c.jsxs("g",{transform:y,children:[c.jsx("line",{x1:"-3",y1:"-8",x2:"-3",y2:"8",stroke:m,strokeWidth:2}),c.jsx("line",{x1:"3",y1:"-8",x2:"3",y2:"8",stroke:m,strokeWidth:2})]})]}):p.includes("arrow")&&!p.includes("center")&&!p.includes("thick")?c.jsx("g",{children:c.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:m,transform:E})}):p==="arrow-thick"?c.jsx("polygon",{points:"-8,-8 4,0 -8,8",fill:m,transform:E}):null},T=P=>{P.stopPropagation(),P.preventDefault(),l(P,t.id)};return c.jsxs("g",{className:"group hover:opacity-80 cursor-pointer",onClick:o,children:[c.jsx("path",{d:F,stroke:"transparent",strokeWidth:20,fill:"none"}),c.jsx("path",{d:F,stroke:m,strokeWidth:r?3:2,strokeDasharray:S,fill:"none"}),c.jsx(k,{}),t.label&&c.jsx("text",{x:M,y:j-15,textAnchor:"middle",fill:m,className:"text-[10px] bg-white dark:bg-gray-800 px-1",children:t.label}),r&&w&&c.jsxs("g",{transform:`translate(${M}, ${C})`,onMouseDown:T,onTouchStart:T,children:[c.jsx("circle",{r:12,fill:"#10b981",stroke:"white"}),c.jsx(xc,{size:12,x:-6,y:-6,stroke:"white",strokeWidth:3}),c.jsx("title",{children:"Aggiungi Figlio alla Coppia"})]})]})},IC=({node:t,isSelected:e,showLabelType:n,darkMode:r,onHandleDown:s,selectionMode:i,onRename:o})=>{const[l,u]=Q.useState(!1),[h,p]=Q.useState(t.name),m=Q.useRef(null);Q.useEffect(()=>{l&&m.current&&(m.current.focus(),m.current.select())},[l]);const w=fe=>{fe.stopPropagation(),p(t.name),u(!0)},C=()=>{u(!1),h.trim()!==""&&h!==t.name&&o(t.id,h)},M=fe=>{fe.key==="Enter"&&C(),fe.key==="Escape"&&u(!1)},j=r?"#ffffff":"#000000",F=e||t.indexPerson?3:1.5,S=e?r?"#374151":"#e0f2fe":r?"#1f2937":"#ffffff",k=r?"#ffffff":"#000000",T=r?"#111827":"#ffffff",P=Bt,O=Tr,H=ao;let E;switch(t.gender){case"M":E=c.jsx("rect",{x:0,y:0,width:P,height:O,stroke:j,strokeWidth:F,fill:S});break;case"F":E=c.jsx("circle",{cx:P/2,cy:O/2,r:P/2,stroke:j,strokeWidth:F,fill:S});break;case"TransWoman":E=c.jsxs("g",{children:[c.jsx("rect",{x:0,y:0,width:P,height:O,stroke:j,strokeWidth:F,fill:S}),c.jsx("circle",{cx:P/2,cy:O/2,r:P/3,stroke:j,strokeWidth:1,fill:"none"})]});break;case"TransMan":E=c.jsxs("g",{children:[c.jsx("circle",{cx:P/2,cy:O/2,r:P/2,stroke:j,strokeWidth:F,fill:S}),c.jsx("rect",{x:10,y:10,width:P-20,height:O-20,stroke:j,strokeWidth:1,fill:"none"})]});break;case"NonBinary":E=c.jsx("polygon",{points:`${P/2},0 ${P},${O/2} ${P/2},${O} 0,${O/2}`,stroke:j,strokeWidth:F,fill:S});break;case"Pet":E=c.jsx("path",{d:`M${P/2} 0 L${P} ${O/2} L${P/2} ${O} L0 ${O/2} Z`,stroke:j,strokeWidth:F,fill:S});break;case"Pregnancy":E=c.jsx("path",{d:`M${P/2} 0 L${P} ${O} L0 ${O} Z`,stroke:j,strokeWidth:F,fill:S});break;case"Miscarriage":E=c.jsx("circle",{cx:P/2,cy:O/2,r:8,fill:j});break;case"Abortion":E=c.jsx("g",{children:c.jsx("path",{d:`M5 5 L${P-5} ${O-5} M${P-5} 5 L5 ${O-5}`,stroke:j,strokeWidth:2})});break;case"Stillbirth":E=c.jsxs("g",{children:[c.jsx("rect",{x:0,y:0,width:P,height:O,stroke:j,strokeWidth:F,fill:S}),c.jsx("path",{d:`M0 0 L${P} ${O} M${P} 0 L0 ${O}`,stroke:j,strokeWidth:1})]});break;default:E=c.jsx("rect",{x:5,y:5,width:P-10,height:O-10,stroke:j,strokeWidth:F,fill:S,strokeDasharray:"4 2"});break}const y=()=>c.jsxs("g",{className:"pointer-events-none",children:[t.substanceAbuse&&(t.gender==="M"?c.jsx("rect",{x:0,y:O/2,width:P,height:O/2,fill:"#f97316",fillOpacity:"0.8",stroke:"none"}):c.jsx("path",{d:`M 0 ${O/2} A ${H} ${H} 0 0 0 ${P} ${O/2} Z`,fill:"#f97316",fillOpacity:"0.8",stroke:"none"})),t.mentalIssue&&(t.gender==="M"?c.jsx("rect",{x:0,y:0,width:P/3,height:O,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"}):c.jsx("path",{d:`M ${H} 0 A ${H} ${H} 0 0 0 ${H} ${O} Z`,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"})),t.gayLesbian&&c.jsx("path",{d:`M ${P/2-7} ${O-12} L ${P/2+7} ${O-12} L ${P/2} ${O} Z`,fill:"#ec4899",stroke:S,strokeWidth:1})]}),x=t.deceased?c.jsxs("g",{stroke:j,strokeWidth:1.5,children:[c.jsx("line",{x1:0,y1:0,x2:P,y2:O}),c.jsx("line",{x1:P,y1:0,x2:0,y2:O})]}):null,I=t.indexPerson?t.gender==="M"?c.jsx("rect",{x:6,y:6,width:P-12,height:O-12,stroke:j,strokeWidth:1.5,fill:"none"}):c.jsx("circle",{cx:P/2,cy:O/2,r:P/2-6,stroke:j,strokeWidth:1.5,fill:"none"}):null;let R="";if(n==="age"&&(R=za(t.birthDate)),n==="year"){const fe=hw(t.birthDate);fe&&(R=fe.getFullYear().toString())}const N=(fe,tt)=>{fe.stopPropagation(),fe.preventDefault(),s(fe,tt,t.id)},A=({y:fe,text:tt,size:on,bold:Lt})=>{if(!tt)return null;const ee=on*.65,B=tt.length*ee+8,de=on+4;return c.jsxs("g",{pointerEvents:"none",children:[c.jsx("rect",{x:P/2-B/2,y:fe-de/2,width:B,height:de,fill:T,fillOpacity:"0.9",rx:"3"}),c.jsx("text",{x:P/2,y:fe,dominantBaseline:"middle",textAnchor:"middle",fill:k,className:`text-[${on}px] font-sans ${Lt?"font-bold":""} select-none`,style:{fontSize:on},children:tt})]})};return c.jsxs("g",{transform:`translate(${t.x},${t.y})`,className:"cursor-pointer group",onDoubleClick:w,children:[E," ",c.jsx(y,{})," ",I," ",x,l?c.jsx("foreignObject",{x:-40,y:-30,width:120,height:30,children:c.jsx("input",{ref:m,value:h,onChange:fe=>p(fe.target.value),onBlur:C,onKeyDown:M,style:{width:"100%",height:"100%",border:"1px solid #3b82f6",borderRadius:"4px",padding:"2px",fontSize:"12px",textAlign:"center",background:T,color:k,outline:"none"}})}):c.jsx(A,{y:-10,text:t.name,size:11,bold:!0}),c.jsx(A,{y:O+12,text:R,size:10,bold:!0}),t.label&&c.jsx(A,{y:O+26,text:t.label,size:9}),t.notes&&t.notes.length>0&&c.jsx("circle",{cx:P+5,cy:0,r:4,fill:"#ef4444",stroke:"white",strokeWidth:1}),e&&!i&&!l&&c.jsxs("g",{children:[c.jsxs("g",{transform:`translate(${P+20}, ${H})`,onMouseDown:fe=>N(fe,"spouse"),onTouchStart:fe=>N(fe,"spouse"),className:"cursor-crosshair hover:opacity-80",children:[c.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#db2777",strokeWidth:2}),c.jsx(Kf,{size:14,x:-7,y:-7,fill:"#db2777",stroke:"#db2777"}),c.jsx("title",{children:"Coniuge"})]}),c.jsxs("g",{transform:`translate(${H}, ${O+25})`,onMouseDown:fe=>N(fe,"child"),onTouchStart:fe=>N(fe,"child"),className:"cursor-crosshair hover:opacity-80",children:[c.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#10b981",strokeWidth:2}),c.jsx(xc,{size:14,x:-7,y:-7,color:"#10b981",strokeWidth:3}),c.jsx("title",{children:"Figlio"})]}),c.jsxs("g",{transform:`translate(${H}, -25)`,onMouseDown:fe=>N(fe,"parents"),onTouchStart:fe=>N(fe,"parents"),className:"cursor-crosshair hover:opacity-80",children:[c.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#8b5cf6",strokeWidth:2}),c.jsx(zu,{size:14,x:-7,y:-7,color:"#8b5cf6"}),c.jsx("title",{children:"Genitori"})]}),c.jsxs("g",{transform:`translate(-20, ${H})`,onMouseDown:fe=>N(fe,"link"),onTouchStart:fe=>N(fe,"link"),className:"cursor-alias hover:opacity-80",children:[c.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:1}),c.jsx(e_,{size:12,x:-6,y:-6,color:"white"}),c.jsx("title",{children:"Relazione"})]})]})]})},TC=({x:t,y:e,mode:n,customPresets:r,onSelect:s,onClose:i})=>{let o=[];n==="child"||n==="parents"?o=dr.Figli||[]:n==="spouse"?o=dr.Struttura||[]:o=["Legami Affettivi","Conflitto/Distanza","Abuso/Potere"].flatMap(h=>dr[h]);const l=[...o.map(h=>{const p=It[h];return p?{type:h,label:p.label}:null}).filter(Boolean),...r.map(h=>({type:h.id,label:h.name}))],u={left:t,top:e};return t>window.innerWidth-260&&(u.left=t-260),e>window.innerHeight-300&&(u.top=e-300),c.jsxs("div",{className:"fixed theme-panel shadow-2xl rounded-lg p-2 w-64 border theme-border z-[9999] flex flex-col max-h-80",style:u,children:[c.jsxs("div",{className:"text-[10px] font-bold opacity-50 uppercase px-2 py-1 rounded sticky top-0 flex justify-between items-center z-10 mb-1",style:{backgroundColor:"rgba(127,127,127,0.1)"},children:[c.jsx("span",{children:"Seleziona Tipo"}),c.jsx("button",{onClick:i,className:"hover:text-red-500",children:c.jsx(Ji,{size:12})})]}),c.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:l.map(h=>h&&c.jsxs("button",{onClick:()=>s(h.type),className:"w-full flex items-center gap-2 p-2 text-xs theme-hover text-left border-b theme-border last:border-0",children:[c.jsx("div",{className:"shrink-0",children:c.jsx(Jh,{type:h.type})}),c.jsx("span",{className:"truncate",children:h.label})]},h.type))})]})},Dd=({notes:t,onChange:e})=>{const[n,r]=Q.useState(""),[s,i]=Q.useState(""),[o,l]=Q.useState(null),u=Q.useMemo(()=>[...t].sort((m,w)=>{const C=sc(m.date);return sc(w.date)-C}),[t]),h=()=>{if(!n.trim())return;const m=s||new Date().toLocaleDateString();o?(e(t.map(w=>w.id===o?{...w,text:n,date:m}:w)),l(null)):e([...t,{id:pe(),text:n,date:m}]),r(""),i("")},p=m=>{l(m.id),r(m.text),i(m.date)};return c.jsxs("div",{className:"border-t theme-border pt-2 mt-2",children:[c.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1 theme-text",children:"Diario Clinico / Note"}),c.jsx("div",{className:"space-y-1 mb-2 max-h-32 overflow-y-auto custom-scrollbar",children:u.map(m=>c.jsxs("div",{className:"p-2 rounded text-xs relative group border theme-border bg-yellow-50/10 border-yellow-200/50 dark:border-yellow-900/30",children:[c.jsx("div",{className:"absolute inset-0 bg-yellow-500 opacity-10 rounded pointer-events-none"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("div",{className:"font-bold opacity-50 text-[10px] theme-text",children:m.date||"Senza data"}),c.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>p(m),className:"theme-text hover:bg-black/10 dark:hover:bg-white/10 rounded p-0.5",children:c.jsx(Jv,{size:10})}),c.jsx("button",{onClick:()=>e(t.filter(w=>w.id!==m.id)),className:"text-red-500 hover:bg-red-100 rounded p-0.5",children:c.jsx(Ji,{size:10})})]})]}),c.jsx("div",{className:"whitespace-pre-wrap theme-text",children:m.text})]})]},m.id))}),c.jsxs("div",{className:"flex flex-col gap-1 border theme-border p-1 rounded bg-black/5 dark:bg-white/5",children:[c.jsx("input",{type:"text",className:"w-full text-[10px] border-b theme-border bg-transparent p-1 outline-none theme-text placeholder-opacity-50 placeholder-current",value:s,onChange:m=>i(m.target.value),placeholder:"Data (es. Gennaio 2025, 12/05/98)"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("textarea",{className:"flex-1 border-none bg-transparent text-xs p-1 outline-none resize-none h-12 theme-text placeholder-opacity-50 placeholder-current",value:n,onChange:m=>r(m.target.value),placeholder:o?"Modifica nota...":"Nuova nota...",onKeyDown:m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),h())}}),c.jsx("button",{onClick:h,className:"bg-blue-600 text-white p-1 rounded self-end hover:bg-blue-700",children:o?c.jsx(QE,{size:14}):c.jsx(xc,{size:14})}),o&&c.jsx("button",{onClick:()=>{l(null),r(""),i("")},className:"bg-gray-200 text-gray-600 p-1 rounded self-end hover:bg-gray-300",children:c.jsx(Ji,{size:14})})]})]})]})},kC=({onClose:t,nodes:e,edges:n,groups:r})=>{const[s,i]=Q.useState(null),[o,l]=Q.useState(""),u=Q.useMemo(()=>{if(!s)return null;const p=e.find(T=>T.id===s);if(!p)return null;const w=n.filter(T=>(T.fromId===s||T.toId===s)&&dr.Struttura.includes(T.type)).map(T=>{const P=T.fromId===s?T.toId:T.fromId,O=e.find(E=>E.id===P),H=It[T.type];return{name:O?O.name:"Sconosciuto",type:H?H.label:T.type}}),M=n.filter(T=>T.fromId===s||T.toId===s).map(T=>{if(dr.Struttura.includes(T.type))return null;const P=T.fromId===s?T.toId:T.fromId;let O="Sconosciuto";const H=e.find(y=>y.id===P);if(H)O=H.name;else{const y=r.find(x=>x.id===P);if(y){const x=e.filter(I=>y.memberIds.includes(I.id)).map(I=>I.name).join(", ");O=`Gruppo: ${y.label} (Membri: ${x})`}}const E=It[T.type];return{id:T.id,with:O,type:E?E.label:T.type,notes:T.notes}}).filter(Boolean),F=n.filter(T=>T.toId===s&&T.type.startsWith("child")).map(T=>{const P=e.find(O=>O.id===T.fromId);return P?P.name:"Ignoto"}),k=n.filter(T=>T.fromId===s&&T.type.startsWith("child")).map(T=>{const P=e.find(O=>O.id===T.toId);return P?P.name:"Ignoto"});return{person:p,relations:M,parents:F,children:k,spouses:w}},[s,e,n,r]),h=e.filter(p=>p.name.toLowerCase().includes(o.toLowerCase()));return c.jsx("div",{className:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex overflow-hidden text-black dark:text-white",children:[c.jsxs("div",{className:"w-1/3 border-r dark:border-gray-700 flex flex-col",children:[c.jsxs("div",{className:"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[c.jsxs("h2",{className:"font-bold flex items-center gap-2",children:[c.jsx(au,{})," Report"]}),c.jsxs("div",{className:"relative mt-2",children:[c.jsx(Ah,{className:"absolute left-2 top-2.5 opacity-50",size:14}),c.jsx("input",{className:"w-full pl-8 p-2 text-sm border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"Cerca persona...",value:o,onChange:p=>l(p.target.value)})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:h.map(p=>c.jsxs("button",{onClick:()=>i(p.id),className:`w-full text-left p-3 border-b dark:border-gray-700 hover:bg-blue-50 dark:hover:bg-gray-700 ${s===p.id?"bg-blue-100 dark:bg-blue-900/30":""}`,children:[c.jsx("div",{className:"font-bold text-sm",children:p.name}),c.jsxs("div",{className:"text-xs opacity-50",children:[p.gender,"  ",za(p.birthDate)," anni"]})]},p.id))})]}),c.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 dark:bg-gray-900",children:[c.jsxs("div",{className:"p-4 flex justify-between items-center bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:[c.jsx("h3",{className:"font-bold",children:"Dettagli Scheda"}),c.jsx("button",{onClick:t,children:c.jsx(Ji,{})})]}),c.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:u?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsx("div",{className:`w-16 h-16 flex items-center justify-center rounded-full text-2xl font-bold ${["M","TransMan"].includes(u.person.gender)?"bg-blue-100 text-blue-600":["F","TransWoman"].includes(u.person.gender)?"bg-pink-100 text-pink-600":"bg-green-100 text-green-600"}`,children:u.person.name.charAt(0)}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold",children:u.person.name}),c.jsxs("div",{className:"text-sm opacity-70",children:["Nato/a: ",u.person.birthDate||"?","  Et: ",za(u.person.birthDate)]})]})]}),u.spouses.length>0&&c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded shadow-sm border border-blue-100 dark:border-blue-900",children:[c.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 text-blue-800 dark:text-blue-300",children:"Partner / Coniugi"}),u.spouses.map((p,m)=>c.jsxs("div",{className:"font-medium",children:[" ",p.name," ",c.jsxs("span",{className:"opacity-60 text-xs",children:["(",p.type,")"]})]},m))]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow-sm",children:[c.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50",children:"Genitori"}),u.parents.length?u.parents.map((p,m)=>c.jsxs("div",{children:[" ",p]},m)):"-"]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow-sm",children:[c.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50",children:"Figli"}),u.children.length?u.children.map((p,m)=>c.jsxs("div",{children:[" ",p]},m)):"-"]})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow-sm",children:[c.jsxs("h4",{className:"font-bold mb-3 text-sm uppercase opacity-50",children:["Altre Relazioni (",u.relations.length,")"]}),c.jsxs("div",{className:"space-y-2",children:[u.relations.map(p=>c.jsxs("div",{className:"flex justify-between items-center p-2 border rounded hover:bg-gray-50 dark:hover:bg-gray-700",children:[c.jsxs("span",{className:"font-medium",children:[p.type," ",c.jsx("span",{className:"font-normal opacity-70",children:"con"})," ",p.with]}),p.notes.length>0&&c.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:"Note"})]},p.id)),u.relations.length===0&&c.jsx("div",{className:"text-sm opacity-50",children:"Nessuna altra relazione registrata"})]})]})]}):c.jsx("div",{className:"opacity-50 text-center mt-20",children:"Seleziona una persona per vedere il report"})})]})]})})},SC=({onClose:t,onExport:e,onImport:n,setCustomUser:r,customUser:s,setFirebaseConfig:i,firebaseConfig:o})=>c.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:c.jsxs("div",{className:"theme-panel p-6 rounded-lg shadow-xl w-96 space-y-4 border theme-border",children:[c.jsxs("h2",{className:"font-bold text-lg flex justify-between items-center",children:["Impostazioni ",c.jsx("button",{onClick:t,children:c.jsx(Ji,{size:20})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"ID Utente (Opzionale)"}),c.jsx("input",{className:"w-full border theme-border p-2 rounded bg-transparent text-sm",value:s,onChange:l=>r(l.target.value),placeholder:"Tuo ID univoco per sync"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Configurazione Firebase (JSON)"}),c.jsx("textarea",{className:"w-full border theme-border p-2 rounded bg-transparent text-[10px] h-24 font-mono",value:o,onChange:l=>i(l.target.value),placeholder:'{"apiKey": "...", ...}'})]}),c.jsxs("div",{className:"pt-4 border-t theme-border flex flex-col gap-2",children:[c.jsxs("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm flex items-center justify-center gap-2",children:[c.jsx(Xv,{size:14})," Backup Dati (JSON)"]}),c.jsxs("label",{className:"w-full border theme-border py-2 rounded text-sm flex items-center justify-center gap-2 cursor-pointer theme-hover",children:[c.jsx(wI,{size:14})," Ripristina Backup",c.jsx("input",{type:"file",onChange:n,className:"hidden",accept:".json"})]})]})]})}),AC=({onClose:t,onSave:e})=>{const[n,r]=Q.useState("Nuovo Stile"),[s,i]=Q.useState("#000000"),[o,l]=Q.useState("solid"),[u,h]=Q.useState("standard"),p=()=>{e({id:`custom-${pe()}`,name:n,type:"relationship",config:{color:s,lineStyle:o,renderType:u,decorator:""}}),t()};return c.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-96 space-y-4 text-black dark:text-white",children:[c.jsx("h3",{className:"font-bold text-lg",children:"Designer Relazioni"}),c.jsx("input",{className:"w-full border p-2 rounded dark:bg-gray-700",value:n,onChange:m=>r(m.target.value),placeholder:"Nome stile"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs block mb-1",children:"Colore"}),c.jsx("input",{type:"color",className:"w-full h-8",value:s,onChange:m=>i(m.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs block mb-1",children:"Tratteggio"}),c.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:o,onChange:m=>l(m.target.value),children:[c.jsx("option",{value:"solid",children:"Solido"}),c.jsx("option",{value:"dashed",children:"Tratteggiato"}),c.jsx("option",{value:"dotted",children:"Puntinato"}),c.jsx("option",{value:"zigzag",children:"ZigZag"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs block mb-1",children:"Decorazione"}),c.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:u,onChange:m=>h(m.target.value),children:[c.jsx("option",{value:"standard",children:"Nessuna"}),c.jsx("option",{value:"arrow",children:"Freccia Singola"}),c.jsx("option",{value:"arrow-double",children:"Freccia Doppia"}),c.jsx("option",{value:"fusion",children:"Fusione"}),c.jsx("option",{value:"cutoff",children:"Taglio"})]})]}),c.jsx("div",{className:"p-4 border rounded bg-gray-50 dark:bg-gray-900 flex justify-center items-center h-20",children:c.jsx("svg",{width:"200",height:"20",children:c.jsx("line",{x1:"0",y1:"10",x2:"200",y2:"10",stroke:s,strokeWidth:"2",strokeDasharray:o==="dashed"?"5,5":o==="dotted"?"2,2":""})})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500",children:"Annulla"}),c.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Salva Preset"})]})]})})},bC=t=>{try{if(!t)return null;let e=t.trim();const n=e.indexOf("{"),r=e.lastIndexOf("}");return n===-1||r===-1||(e=e.substring(n,r+1),e=e.replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2":'),e=e.replace(/'/g,'"'),e=e.replace(/,(\s*[}\]])/g,"$1")),JSON.parse(e)}catch(e){console.error("Errore parsing config string:",e);try{return JSON.parse(t)}catch{return null}}},My=({currentThemeId:t,onChange:e,placement:n="bottom"})=>{const[r,s]=Q.useState(!1),i=os.find(l=>l.id===t)||os[0],o=Q.useRef(null);return Q.useEffect(()=>{const l=u=>{o.current&&!o.current.contains(u.target)&&s(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),c.jsxs("div",{className:"relative w-full",ref:o,children:[c.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors border theme-border theme-panel hover:brightness-95 overflow-hidden",children:[c.jsxs("span",{className:"flex items-center gap-2 truncate min-w-0",children:[i.type==="dark"?c.jsx(Yv,{size:14,className:"shrink-0"}):c.jsx(Zv,{size:14,className:"shrink-0"}),c.jsx("span",{className:"truncate",children:i.label})]}),c.jsxs("div",{className:"flex gap-1 ml-2 shrink-0",children:[c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.bgMain}}),c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.accent}})]})]}),r&&c.jsxs("div",{className:`absolute left-0 w-64 max-h-80 overflow-y-auto theme-panel border theme-border shadow-xl rounded-lg p-1 z-[100] ${n==="top"?"bottom-full mb-2":"top-full mt-2"}`,children:[c.jsx("div",{className:"text-[10px] font-bold opacity-50 px-2 py-1 uppercase theme-text",children:"Seleziona Tema"}),os.map(l=>c.jsxs("button",{onClick:()=>{e(l.id),s(!1)},className:`w-full flex items-center justify-between p-2 rounded text-xs theme-hover mb-1 ${t===l.id?"border theme-border bg-black/5 dark:bg-white/5":""}`,children:[c.jsx("span",{className:"font-medium theme-text",children:l.label}),c.jsxs("div",{className:"flex gap-1 shrink-0",children:[c.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:l.colors.bgMain},title:"Sfondo"}),c.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:l.colors.bgPanel},title:"Pannelli"}),c.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:l.colors.accent},title:"Accento"}),c.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20 flex items-center justify-center",style:{background:l.colors.bgMain},children:c.jsx("span",{style:{color:l.colors.text,fontSize:"8px"},children:"A"})})]})]},l.id))]})]})};function CC(){var Ds;const[t,e]=Q.useState(null),[n,r]=Q.useState("dashboard"),[s,i]=Q.useState(localStorage.getItem("genopro_custom_user")||""),[o,l]=Q.useState(localStorage.getItem("genopro_firebase_config")||""),[u,h]=Q.useState(null),[p,m]=Q.useState("offline"),w=Q.useRef(!1),[C,M]=Q.useState([]),[j,F]=Q.useState(()=>{const g=localStorage.getItem("genopro_categories");return g?JSON.parse(g):gC}),[S,k]=Q.useState("ALL"),[T,P]=Q.useState("date_desc"),[O,H]=Q.useState(""),[E,y]=Q.useState(!1),{auth:x,db:I}=Q.useMemo(()=>{try{let g=null;if(o?g=bC(o):typeof window.__firebase_config<"u"&&(g=JSON.parse(window.__firebase_config)),!g||!g.apiKey)return{auth:null,db:null};const _=QT().length?Jf():u_(g);return{auth:oS(_),db:Qb(_)}}catch(g){return console.error("Firebase Init Error:",g),{auth:null,db:null}}},[o]),R=Q.useMemo(()=>C.filter(g=>{const _=g.title.toLowerCase().includes(O.toLowerCase()),b=S==="ALL"||g.category===S||S==="other"&&!j.some(D=>D.id===g.category);return _&&b}).sort((g,_)=>T==="date_desc"?_.lastModified-g.lastModified:T==="date_asc"?g.lastModified-_.lastModified:T==="name_asc"?g.title.localeCompare(_.title):0),[C,S,T,O,j]);Q.useEffect(()=>{localStorage.setItem("genopro_categories",JSON.stringify(j))},[j]),Q.useEffect(()=>{localStorage.setItem("genopro_custom_user",s)},[s]),Q.useEffect(()=>{localStorage.setItem("genopro_firebase_config",o)},[o]);const N=typeof window.__app_id<"u"?window.__app_id:"default-app-id",[A,fe]=Q.useState(null),[tt,on]=Q.useState("Nuovo Genogramma"),[Lt,ee]=Q.useState("family"),[B,de]=Q.useState([]),[le,Ce]=Q.useState([]),[he,Qt]=Q.useState([]),[Xt,bn]=Q.useState([]),[kt,_o]=Q.useState([]),[gn,sr]=Q.useState(-1),Cn=Q.useCallback((g,_,b)=>{const D=JSON.stringify({nodes:g,edges:_,groups:b});_o(V=>[...V.slice(0,gn+1),D]),sr(V=>V+1)},[gn]),ot=g=>{const _=typeof g=="function"?g(B):g;de(_),Cn(_,le,he)},Rn=g=>{const _=typeof g=="function"?g(le):g;Ce(_),Cn(B,_,he)},$n=g=>{const _=typeof g=="function"?g(he):g;Qt(_),Cn(B,le,_)},Yt=(g,_,b)=>{de(g),Ce(_),Qt(b),Cn(g,_,b)},wo=()=>{if(gn>0){const g=gn-1,_=JSON.parse(kt[g]);de(_.nodes),Ce(_.edges),Qt(_.groups),sr(g)}},al=()=>{if(gn<kt.length-1){const g=gn+1,_=JSON.parse(kt[g]);de(_.nodes),Ce(_.edges),Qt(_.groups),sr(g)}};Q.useEffect(()=>{kt.length===0&&n==="editor"&&Cn(B,le,he)},[n]);const[ye,Ge]=Q.useState([]),[an,yn]=Q.useState([]),[Hr,Pn]=Q.useState([]),[Bn,ai]=Q.useState(()=>localStorage.getItem("genopro_theme_id")||"light"),je=Q.useMemo(()=>os.find(g=>g.id===Bn)||os[0],[Bn]),Ke=je.type==="dark";Q.useEffect(()=>{localStorage.setItem("genopro_theme_id",Bn)},[Bn]);const[vn,ll]=Q.useState(()=>localStorage.getItem("genopro_snap")!=="false"),[li,Up]=Q.useState(()=>localStorage.getItem("genopro_labels")||"age"),[Nn,xo]=Q.useState(()=>localStorage.getItem("genopro_legend")==="true");Q.useEffect(()=>{localStorage.setItem("genopro_snap",String(vn))},[vn]),Q.useEffect(()=>{localStorage.setItem("genopro_labels",li)},[li]),Q.useEffect(()=>{localStorage.setItem("genopro_legend",String(Nn))},[Nn]);const[ul,ui]=Q.useState(!1),[Lc,cl]=Q.useState(!1),[ir,Eo]=Q.useState(!1),[dl,qr]=Q.useState(!1),Ie=Q.useRef(null),[Le,Ot]=Q.useState(null),[Oc,Rs]=Q.useState(null),[Gr,Jt]=Q.useState(null),[Kr,nt]=Q.useState(1),[ci,Qr]=Q.useState(4);Q.useEffect(()=>{if(n!=="editor")return;if(!t||!I||!A){m("offline");return}if(w.current){w.current=!1;return}const g=s||t.uid;if(!g){m("error");return}m("syncing");const b=setTimeout(async()=>{try{const D=Rd(I,"artifacts",N,"users",g,"genograms",A);await Py(D,{id:A,title:tt,category:Lt,lastModified:Date.now(),data:{nodes:B,edges:le,groups:he,presets:Xt}},{merge:!0}),m("synced")}catch(D){console.error("Errore Salvataggio:",D),m("error")}},1500);return()=>clearTimeout(b)},[B,le,he,tt,Lt,Xt,s,t,I,n,A]),Q.useEffect(()=>{const g=_=>{_.key==="i"&&!["INPUT","TEXTAREA"].includes(_.target.tagName)&&xo(b=>!b)};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[]);const Zt=Q.useRef(null),St=Q.useRef(null);Q.useEffect(()=>{const g=$=>{if($.ctrlKey){$.preventDefault();const G=-$.deltaY*.008;nt(z=>{const oe=z+G;return Math.min(3,Math.max(.2,oe))})}},_=$=>{$.preventDefault()},b=$=>{$.preventDefault();const G=($.scale-1)*.05;nt(z=>Math.min(3,Math.max(.2,z+G)))},D=$=>$.preventDefault(),V={passive:!1};return document.addEventListener("wheel",g,V),document.addEventListener("gesturestart",_,V),document.addEventListener("gesturechange",b,V),document.addEventListener("gestureend",D,V),()=>{document.removeEventListener("wheel",g),document.removeEventListener("gesturestart",_),document.removeEventListener("gesturechange",b),document.removeEventListener("gestureend",D)}},[]);const rt=Q.useRef(B);Q.useEffect(()=>{rt.current=B},[B]);const ut=Q.useRef(le);Q.useEffect(()=>{ut.current=le},[le]);const Vc=Q.useRef(ye);Q.useEffect(()=>{Vc.current=ye},[ye]);const _n=Q.useRef(he);Q.useEffect(()=>{_n.current=he},[he]),Q.useEffect(()=>{const g=_=>{if(!["INPUT","TEXTAREA","SELECT"].includes(_.target.tagName)){if((_.ctrlKey||_.metaKey)&&_.key.toLowerCase()==="z"){_.preventDefault(),wo();return}if((_.ctrlKey||_.metaKey)&&_.key.toLowerCase()==="y"){_.preventDefault(),al();return}if((_.ctrlKey||_.metaKey)&&_.key==="s"){_.preventDefault(),To();return}if(_.key==="Backspace"||_.key==="Delete")if(ye.length>0){const b=rt.current.filter(V=>!ye.includes(V.id)),D=ut.current.filter(V=>!ye.includes(V.fromId)&&!ye.includes(V.toId));Yt(b,D,_n.current),Ge([])}else an.length>0?(Rn(b=>b.filter(D=>!an.includes(D.id))),yn([])):Hr.length>0&&($n(b=>b.filter(D=>!Hr.includes(D.id))),Pn([]));if(_.key==="Escape"&&(Ge([]),yn([]),Pn([]),Jt(null),Eo(!1)),_.key.toLowerCase()==="m"&&ye.length===0&&Ns("M"),_.key.toLowerCase()==="f"&&ye.length===0&&Ns("F"),ye.length===1){const b=ye[0],D=rt.current.find(V=>V.id===b);if(D){if(_.key.toLowerCase()==="s"){const V=pe(),$={id:V,x:D.x+150,y:D.y,gender:D.gender==="M"?"F":"M",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},Y={id:pe(),fromId:b,toId:V,type:"marriage",label:"",notes:[]};Yt([...rt.current,$],[...ut.current,Y],_n.current),Ge([V])}if(_.key.toLowerCase()==="c"){const V=Kl(b,ut.current),$=pe(),Y={id:$,x:D.x,y:D.y+150,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};let G=[];if(V){const z=V.fromId===b?V.toId:V.fromId,oe=rt.current.find(te=>te.id===z);oe&&(Y.x=(D.x+oe.x)/2),G.push({id:pe(),fromId:b,toId:$,type:"child-bio",label:"",notes:[]}),G.push({id:pe(),fromId:z,toId:$,type:"child-bio",label:"",notes:[]})}else G.push({id:pe(),fromId:b,toId:$,type:"child-bio",label:"",notes:[]});Yt([...rt.current,Y],[...ut.current,...G],_n.current),Ge([$])}if(_.key.toLowerCase()==="p"){const V=pe(),$=pe(),Y={id:V,x:D.x-60,y:D.y-150,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},G={id:$,x:D.x+60,y:D.y-150,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},z=[{id:pe(),fromId:V,toId:$,type:"marriage",label:"",notes:[]},{id:pe(),fromId:V,toId:b,type:"child-bio",label:"",notes:[]},{id:pe(),fromId:$,toId:b,type:"child-bio",label:"",notes:[]}];Yt([...rt.current,Y,G],[...ut.current,...z],_n.current),Ge([V,$])}}}if(an.length===1&&_.key.toLowerCase()==="c"){const b=ut.current.find(D=>D.id===an[0]);if(b&&["marriage","cohabitation","separation","divorce"].includes(b.type)){const D=pe(),V=rt.current.find(q=>q.id===b.fromId),$=rt.current.find(q=>q.id===b.toId),Y=V&&$?(V.x+$.x)/2:0,G=V&&$?Math.max(V.y,$.y)+150:0,z={id:D,x:Y,y:G,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},oe={id:pe(),fromId:b.fromId,toId:D,type:"child-bio",label:"",notes:[]},te={id:pe(),fromId:b.toId,toId:D,type:"child-bio",label:"",notes:[]};Yt([...rt.current,z],[...ut.current,oe,te],_n.current),Ge([D]),yn([])}}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(_.key)&&ye.length>0){_.preventDefault();const b=_.shiftKey?10:1,D=_.key==="ArrowLeft"?-b:_.key==="ArrowRight"?b:0,V=_.key==="ArrowUp"?-b:_.key==="ArrowDown"?b:0;ot($=>$.map(Y=>ye.includes(Y.id)?{...Y,x:Y.x+D,y:Y.y+V}:Y))}}};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[ye,an,Hr,gn,kt]);const Dn=g=>{let _,b;if(g.touches?(_=g.touches[0].clientX,b=g.touches[0].clientY):g.changedTouches?(_=g.changedTouches[0].clientX,b=g.changedTouches[0].clientY):(_=g.clientX,b=g.clientY),!Zt.current)return{x:0,y:0,cx:_,cy:b};const D=Zt.current.getBoundingClientRect(),V=_-D.left,$=b-D.top;return{x:(V-wt)/Kr+wt,y:($-wt)/Kr+wt,cx:_,cy:b}},hl=(g,_,b)=>{const{x:D,y:V}=Dn(g);Ie.current={active:!0,type:_,sourceId:b,startX:D,startY:V,currX:D,currY:V},Ot({...Ie.current}),Jt(null)},Io=(g,_)=>{const{x:b,y:D}=Dn(g),V=ut.current.find($=>$.id===_);if(V){const $=pe(),Y=b-Bt/2,G=D+50,z={id:$,x:Y,y:G,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},oe={id:pe(),fromId:V.fromId,toId:$,type:"child-bio",label:"",notes:[]},te={id:pe(),fromId:V.toId,toId:$,type:"child-bio",label:"",notes:[]};Yt([...rt.current,z],[...ut.current,oe,te],_n.current),Jt({x:g.clientX,y:g.clientY,edgeId:$,mode:"child"})}},Ps=g=>{var G,z;if(g.target.tagName!=="svg")return;const{x:_,y:b,cx:D,cy:V}=Dn(g),Y=g.type.startsWith("touch")&&!ir?"pan":"box";Y==="box"&&!g.shiftKey&&!ir&&(Ge([]),yn([]),Pn([])),Ie.current={active:!0,type:Y,sourceId:"",startX:_,startY:b,currX:_,currY:b,clientStartX:D,clientStartY:V,initialScrollLeft:((G=St.current)==null?void 0:G.scrollLeft)||0,initialScrollTop:((z=St.current)==null?void 0:z.scrollTop)||0},Ot({...Ie.current}),Jt(null)},Wn=(g,_)=>{g.stopPropagation();const{x:b,y:D}=Dn(g),V=g.shiftKey||ir;let $=ye;V?$=ye.includes(_)?ye.filter(G=>G!==_):[...ye,_]:ye.includes(_)||($=[_],yn([]),Pn([])),Ge($);const Y={};rt.current.forEach(G=>{$.includes(G.id)&&(Y[G.id]={x:G.x,y:G.y})}),Ie.current={active:!0,type:"move",sourceId:_,startX:b,startY:D,currX:b,currY:D,initialNodePositions:Y},Ot({...Ie.current}),Jt(null)},fl=(g,_)=>{g.stopPropagation(),g.preventDefault();const{x:b,y:D}=Dn(g);Ie.current={active:!0,type:"link",sourceId:_,startX:b,startY:D,currX:b,currY:D},Ot({...Ie.current}),Jt(null)},pl=(g,_)=>{_.stopPropagation(),yn([g]),Ge([]);const b=le.find(D=>D.id===g);b&&["marriage","cohabitation","separation","divorce"].includes(b.type)&&Ge([b.fromId,b.toId])};Q.useEffect(()=>{const g=b=>{if(!Ie.current||!Ie.current.active)return;const{x:D,y:V,cx:$,cy:Y}=Dn(b);if(Ie.current.currX=D,Ie.current.currY=V,Ie.current.type==="pan"){const G=$-(Ie.current.clientStartX||0),z=Y-(Ie.current.clientStartY||0);St.current&&(St.current.scrollLeft=(Ie.current.initialScrollLeft||0)-G,St.current.scrollTop=(Ie.current.initialScrollTop||0)-z)}else if(Ie.current.type==="box")Ot({...Ie.current}),Rs({startX:Ie.current.startX,startY:Ie.current.startY,curX:D,curY:V});else if(Ie.current.type==="move"&&Ie.current.initialNodePositions){Ot({...Ie.current});const G=D-Ie.current.startX,z=V-Ie.current.startY;de(oe=>oe.map(te=>{var re,ae;const q=(ae=(re=Ie.current)==null?void 0:re.initialNodePositions)==null?void 0:ae[te.id];if(q){let xe=q.x+G,st=q.y+z;return vn&&(xe=Math.round(xe/ln)*ln,st=Math.round(st/ln)*ln),{...te,x:xe,y:st}}return te}))}else Ot({...Ie.current})},_=b=>{if(!Ie.current||!Ie.current.active)return;const{type:D,sourceId:V,startX:$,startY:Y,currX:G,currY:z}=Ie.current,oe=Math.sqrt(Math.pow(G-$,2)+Math.pow(z-Y,2)),te=oe<10;let q=G,re=z;vn&&(q=Math.round(q/ln)*ln,re=Math.round(re/ln)*ln);let ae=null,xe=D,st=!1;if(D==="box"){const Be=Math.min($,G),mt=Math.max($,G),ct=Math.min(Y,z),At=Math.max(Y,z),dt=rt.current.filter(Z=>Z.x+Bt/2>=Be&&Z.x+Bt/2<=mt&&Z.y+Tr/2>=ct&&Z.y+Tr/2<=At).map(Z=>Z.id);Ge(Z=>[...new Set([...Z,...dt])])}else if(D==="move"&&oe>5)st=!0;else{const Be=rt.current.find(ct=>ct.id===V);b.type;const mt=te||oe>5;if((Be||_n.current.some(ct=>ct.id===V))&&mt){if(Be){const ct=pe();let At=null,dt=[];const Z=oe>5?q-Bt/2:Be.x+(D==="spouse"?120:0),we=oe>5?re-Tr/2:Be.y+(D==="child"?120:D==="parents"?-120:0);if(D==="spouse")At={id:ct,x:Z,y:we,gender:Be.gender==="M"?"F":"M",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},ae=pe(),dt.push({id:ae,fromId:V,toId:ct,type:"marriage",label:"",notes:[]});else if(D==="child"){const Ue=Kl(V,ut.current);if(At={id:ct,x:Z,y:we,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},Ue){const Oe=Ue.fromId===V?Ue.toId:Ue.fromId;dt.push({id:pe(),fromId:V,toId:ct,type:"child-bio",label:"",notes:[]}),dt.push({id:pe(),fromId:Oe,toId:ct,type:"child-bio",label:"",notes:[]}),ae=dt[0].id}else ae=pe(),dt.push({id:ae,fromId:V,toId:ct,type:"child-bio",label:"",notes:[]})}else if(D==="parents"){const Ue=pe(),Oe=pe(),Ae={id:Ue,x:Z-60,y:we,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},Ve={id:Oe,x:Z+60,y:we,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};At=[Ae,Ve],dt.push({id:pe(),fromId:Ue,toId:Oe,type:"marriage",label:"",notes:[]}),dt.push({id:pe(),fromId:Ue,toId:V,type:"child-bio",label:"",notes:[]}),dt.push({id:pe(),fromId:Oe,toId:V,type:"child-bio",label:"",notes:[]})}if(At||dt.length>0){const Ue=Array.isArray(At)?[...rt.current,...At]:At?[...rt.current,At]:rt.current,Oe=[...ut.current,...dt];Yt(Ue,Oe,_n.current)}}if(D==="link"){const ct=rt.current.find(Z=>q>=Z.x-20&&q<=Z.x+Bt+20&&re>=Z.y-20&&re<=Z.y+Tr+20),At=ct?null:_n.current.find(Z=>{const we=xi(Z,rt.current);return we&&Pd(we,{x:q,y:re})}),dt=ct?ct.id:At?At.id:null;if(dt&&dt!==V){ae=pe();const Z={id:ae,fromId:V,toId:dt,type:"harmony",label:"",notes:[]};Rn(we=>[...we,Z]),st=!0}}}}if(st&&Cn(rt.current,ut.current,_n.current),ae){let{cx:Be,cy:mt}=Dn(b);setTimeout(()=>{Jt({x:Be,y:mt,edgeId:ae,mode:xe}),yn([ae]),Ge([])},50)}Ie.current={active:!1,type:"move",sourceId:"",startX:0,startY:0,currX:0,currY:0},Ot(null),Rs(null)};return window.addEventListener("mousemove",g),window.addEventListener("mouseup",_),window.addEventListener("touchmove",g,{passive:!1}),window.addEventListener("touchend",_),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",_),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",_)}},[vn,Kr,Cn]),Q.useEffect(()=>x?((async()=>{const _=window.__initial_auth_token;_?await q2(x,_).catch(b=>console.error("Token Auth Error:",b)):await z2(x).catch(b=>console.error("Anon Auth Error:",b))})(),Q2(x,_=>{e(_)})):void 0,[x]),Q.useEffect(()=>{const g=localStorage.getItem("genopro_local_index"),_=g?JSON.parse(g):[];if(!t||!I){M(_);return}const b=s||t.uid;if(!b){M(_);return}try{const D=lC(Kb(I,"artifacts",N,"users",b,"genograms")),V=pC(D,$=>{const Y=[];$.forEach(z=>Y.push({id:z.id,...z.data()}));const G=new Map;_.forEach(z=>G.set(z.id,z)),Y.forEach(z=>G.set(z.id,z)),M(Array.from(G.values()))},$=>{console.error("Dashboard offline, uso cache locale"),M(_)});return()=>V()}catch{M(_)}},[t,I,s]),Q.useLayoutEffect(()=>{n==="editor"&&St.current&&setTimeout(()=>{St.current&&St.current.scrollTo(wt-St.current.clientWidth/2,wt-St.current.clientHeight/2)},100)},[n]);const To=async()=>{if(!t||!A||!I)return;const g=s||t.uid;await Py(Rd(I,"artifacts",N,"users",g,"genograms",A),{id:A,title:tt,category:Lt,lastModified:Date.now(),data:{nodes:B,edges:le,groups:he,presets:Xt}}),alert("Salvato!")},di=(g,_,b)=>{de(g),Ce(_),Qt(b),_o([]),sr(-1),setTimeout(()=>{const D=JSON.stringify({nodes:g,edges:_,groups:b});_o([D]),sr(0)},0)},ml=()=>{fe(pe()),on("Nuovo Genogramma"),ee("family"),di([],[],[]),r("editor")},Ns=g=>{const _={id:pe(),x:wt,y:wt,gender:g,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};ot(b=>[...b,_]),Ge([_.id])},Fc=()=>{if(ye.length===0)return alert("Seleziona nodi");const g={id:pe(),memberIds:[...ye],type:"household",label:"Nuovo Gruppo",color:"#000000",notes:[]};$n(_=>[..._,g]),Pn([g.id]),Ge([])},hi=()=>{if(ye.length!==1)return alert("Seleziona una persona");const g=ye[0],_=B.find(G=>G.id===g);if(!_)return;const b=pe(),D=pe(),V={id:b,x:_.x-80,y:_.y-150,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},$={id:D,x:_.x+80,y:_.y-150,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},Y=[{id:pe(),fromId:b,toId:D,type:"marriage",label:"",notes:[]},{id:pe(),fromId:b,toId:g,type:"child-bio",label:"",notes:[]},{id:pe(),fromId:D,toId:g,type:"child-bio",label:"",notes:[]}];Yt([...B,V,$],[...le,...Y],he),Ge([b,D])},gl=()=>{if(ye.length!==1)return alert("Seleziona una persona");const g=ye[0],_=B.find($=>$.id===g);if(!_)return;const b=pe(),D={id:b,x:_.x+120,y:_.y,gender:_.gender==="M"?"F":"M",name:"Partner",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},V={id:pe(),fromId:g,toId:b,type:"marriage",label:"",notes:[]};Yt([...B,D],[...le,V],he),Ge([b])},ko=()=>{if(an.length===1){const g=le.find(_=>_.id===an[0]);if(g&&dr.Struttura.includes(g.type)){const _=B.find(G=>G.id===g.fromId),b=B.find(G=>G.id===g.toId);if(!_||!b)return;const D=pe(),V={id:D,x:(_.x+b.x)/2,y:Math.max(_.y,b.y)+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},$={id:pe(),fromId:g.fromId,toId:D,type:"child-bio",label:"",notes:[]},Y={id:pe(),fromId:g.toId,toId:D,type:"child-bio",label:"",notes:[]};Yt([...B,V],[...le,$,Y],he),Ge([D]),yn([]);return}}if(ye.length===1){const g=ye[0],_=B.find(Y=>Y.id===g);if(!_)return;const b=Kl(g,le),D=pe(),V={id:D,x:_.x,y:_.y+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},$=[{id:pe(),fromId:g,toId:D,type:"child-bio",label:"",notes:[]}];if(b){const Y=b.fromId===g?b.toId:b.fromId;$.push({id:pe(),fromId:Y,toId:D,type:"child-bio",label:"",notes:[]})}Yt([...B,V],[...le,...$],he),Ge([D])}else alert("Seleziona una coppia o un genitore")},Hn=g=>{if(ye.length===0)return;const _=B.filter(G=>ye.includes(G.id)),b=_.reduce((G,z)=>G+z.x,0)/_.length,D=_.reduce((G,z)=>G+z.y,0)/_.length,V=[..._];g==="circle"?V.sort((G,z)=>{const oe=Math.atan2(G.y-D,G.x-b),te=Math.atan2(z.y-D,z.x-b);return oe-te}):g==="h"?V.sort((G,z)=>G.x-z.x):g==="v"?V.sort((G,z)=>G.y-z.y):g==="diagonal"?V.sort((G,z)=>G.x+G.y-(z.x+z.y)):g==="grid"&&V.sort((G,z)=>Math.abs(G.y-z.y)>40?G.y-z.y:G.x-z.x);const $=_.reduce((G,z)=>G+Math.hypot(z.x-b,z.y-D),0)/_.length,Y=Math.max($,100);ot(G=>G.map(z=>{if(!ye.includes(z.id))return z;const oe=V.findIndex(te=>te.id===z.id);if(g==="h")return{...z,y:Math.round(D/20)*20};if(g==="v")return{...z,x:Math.round(b/20)*20};if(g==="circle"){if(_.length<2)return z;const te=2*Math.PI/_.length,re=-Math.PI/2+te*oe;return{...z,x:Math.round((b+Y*Math.cos(re))/20)*20,y:Math.round((D+Y*Math.sin(re))/20)*20}}if(g==="grid"){const te=Math.ceil(Math.sqrt(_.length)),q=Math.floor(oe/te),re=oe%te,ae=(te-1)*120,xe=(Math.ceil(_.length/te)-1)*120,st=b-ae/2,Be=D-xe/2;return{...z,x:Math.round((st+re*120)/20)*20,y:Math.round((Be+q*120)/20)*20}}if(g==="diagonal"){const te=(oe-(_.length-1)/2)*80;return{...z,x:Math.round((b+te)/20)*20,y:Math.round((D+te)/20)*20}}return z}))},or=g=>{const _=B.filter(oe=>ye.includes(oe.id));if(_.length<2)return;const b=[..._].sort((oe,te)=>oe.y-te.y),D=[];let V=[b[0]];for(let oe=1;oe<b.length;oe++){const te=b[oe],q=b[oe-1];Math.abs(te.y-q.y)<50?V.push(te):(D.push(V),V=[te])}if(D.push(V),D.length<2)return alert("Seleziona persone di almeno due generazioni diverse");const $=D[0],Y=D[D.length-1];$.sort((oe,te)=>oe.x-te.x),Y.sort((oe,te)=>oe.x-te.x);const G=40,z=Bt+G;ot(oe=>oe.map(te=>{if(!ye.includes(te.id))return te;if(g==="align-children"&&Y.some(q=>q.id===te.id)){const q=$[0].x,re=$[$.length-1].x+Bt,ae=(q+re)/2,xe=Y.length*Bt+(Y.length-1)*G,st=ae-xe/2,Be=Y.findIndex(mt=>mt.id===te.id);return{...te,x:st+Be*z,y:$[0].y+180}}if(g==="align-parents"&&$.some(q=>q.id===te.id)){const q=Y[0].x,re=Y[Y.length-1].x+Bt,ae=(q+re)/2,xe=$.length*Bt+($.length-1)*G,st=ae-xe/2,Be=$.findIndex(mt=>mt.id===te.id);return{...te,x:st+Be*z}}return te}))},So=()=>{const g=ye.length>0?B.filter(Z=>ye.includes(Z.id)):B;if(g.length===0)return;const _=JSON.parse(JSON.stringify(B)),b=new Map(_.map(Z=>[Z.id,Z])),D=180,V=60,$=80,Y=100,G=250,z=Z=>le.filter(we=>(we.fromId===Z||we.toId===Z)&&dr.Struttura.includes(we.type)).map(we=>we.fromId===Z?we.toId:we.fromId),oe=Z=>{const we=le.filter(Ue=>Ue.toId===Z&&Ue.type.startsWith("child"));return[...new Set(we.map(Ue=>Ue.fromId))]},te=Z=>{const we=le.filter(Oe=>Z.includes(Oe.fromId)&&Oe.type.startsWith("child"));return[...new Set(we.map(Oe=>Oe.toId))]},q=new Map;g.forEach(Z=>q.set(Z.id,-1));const re=(Z,we=new Set)=>{if(we.has(Z))return 0;if(q.get(Z)!==-1)return q.get(Z);we.add(Z);const Ue=te([Z]),Oe=z(Z);let Ae=-1;const Ve=new Set(Ue);if(Oe.forEach(en=>te([en]).forEach(Mn=>Ve.add(Mn))),Ve.size>0){const en=Array.from(Ve).map(Mn=>re(Mn,new Set(we)));Ae=Math.max(...en)}const ze=Ae+1;return q.set(Z,ze),ze};g.forEach(Z=>re(Z.id));let ae=!0;for(;ae;)ae=!1,g.forEach(Z=>{const we=q.get(Z.id)||0;z(Z.id).forEach(Ue=>{const Oe=q.get(Ue)||0;if(we!==Oe){const Ae=Math.max(we,Oe);q.set(Z.id,Ae),q.set(Ue,Ae),ae=!0}})});const xe=Math.max(...Array.from(q.values())),st=new Map;q.forEach((Z,we)=>st.set(we,xe-Z)),[...g].sort((Z,we)=>sc(Z.birthDate||"")-sc(we.birthDate||"")).forEach((Z,we)=>{Z.x=we*(V+20)});for(let Z=0;Z<G;Z++){const we=new Map;g.forEach(Ae=>{let Ve=0,ze=0;if(oe(Ae.id).forEach(Ee=>{const _t=b.get(Ee);_t&&(Ve+=_t.x,ze++)}),te([Ae.id]).forEach(Ee=>{const _t=b.get(Ee);_t&&(Ve+=_t.x,ze++)}),z(Ae.id).forEach(Ee=>{const _t=b.get(Ee);_t&&(Ve+=_t.x,ze++)}),ze>0){const Ee=Ve/ze,_t=.5*(1-Z/G);we.set(Ae.id,(Ee-Ae.x)*_t)}}),g.forEach(Ae=>{we.has(Ae.id)&&(Ae.x+=we.get(Ae.id))});const Ue=new Set;g.forEach(Ae=>{if(Ue.has(Ae.id))return;const Ve=z(Ae.id);if(Ve.length>0){const ze=[Ae.id,...Ve];ze.forEach(Ee=>Ue.add(Ee)),ze.sort((Ee,_t)=>{var No,Do;const pi=(No=b.get(Ee))==null?void 0:No.gender,Po=(Do=b.get(_t))==null?void 0:Do.gender;return pi==="M"&&Po!=="M"?-1:pi!=="M"&&Po==="M"?1:0});const en=ze.reduce((Ee,_t)=>Ee+b.get(_t).x,0)/ze.length,Mn=(ze.length-1)*$;let xr=en-Mn/2;ze.forEach((Ee,_t)=>{const pi=b.get(Ee);pi.x=xr+_t*$})}});const Oe=new Map;g.forEach(Ae=>{const Ve=st.get(Ae.id)||0;Oe.has(Ve)||Oe.set(Ve,[]),Oe.get(Ve).push(Ae)}),Oe.forEach(Ae=>{Ae.sort((Ve,ze)=>Ve.x-ze.x);for(let Ve=0;Ve<Ae.length-1;Ve++){const ze=Ae[Ve],en=Ae[Ve+1],Mn=en.x-ze.x;if(Mn<Y){const xr=(Y-Mn)/2;ze.x-=xr,en.x+=xr}}})}const mt=g.map(Z=>Z.x),ct=Math.min(...mt),At=Math.max(...mt),dt=wt-(ct+At)/2;g.forEach(Z=>{Z.x=Math.round((Z.x+dt)/20)*20;const we=st.get(Z.id)||0;Z.y=Math.round((wt+we*D)/20)*20}),ot(_)},Uc=()=>{nt(1),St.current&&St.current.scrollTo({left:wt-St.current.clientWidth/2,top:wt-St.current.clientHeight/2,behavior:"smooth"})},Ao=Q.useCallback(()=>{let g=1/0,_=1/0,b=-1/0,D=-1/0;return B.length===0?{minX:wt-400,minY:wt-300,maxX:wt+400,maxY:wt+300}:(B.forEach(V=>{g=Math.min(g,V.x),_=Math.min(_,V.y),b=Math.max(b,V.x+Bt),D=Math.max(D,V.y+Tr)}),he.forEach(V=>{const $=xi(V,B);$&&(g=Math.min(g,$.x),_=Math.min(_,$.y),b=Math.max(b,$.x+$.w),D=Math.max(D,$.y+$.h))}),{minX:g,minY:_,maxX:b,maxY:D})},[B,he]),fi=()=>{let{minX:g,minY:_,maxX:b,maxY:D}=Ao();if(Nn){const Y=new Set(B.map(q=>q.gender)).size+(B.some(q=>q.deceased)?1:0)+(B.some(q=>q.indexPerson)?1:0),G=new Set(le.map(q=>q.type)).size,z=80+Math.max(Y,G)*24+20,oe=g-220-50,te=_;g=Math.min(g,oe),_=Math.min(_,te),b=Math.max(b,g+220+(b-g)),D=Math.max(D,te+z)}const V=100;return{x:g-V,y:_-V,w:b-g+V*2,h:D-_+V*2}},bo=g=>{if(!Zt.current)return;const _=fi(),b=ci,D=Zt.current.cloneNode(!0),V=D.querySelector("g");V&&(V.setAttribute("transform",""),V.style.transform=""),D.setAttribute("viewBox",`${_.x} ${_.y} ${_.w} ${_.h}`),D.setAttribute("width",`${_.w*b}`),D.setAttribute("height",`${_.h*b}`),D.style.fontFamily="sans-serif";const $=new XMLSerializer().serializeToString(D),Y=document.createElement("canvas"),G=Y.getContext("2d"),z=new Image,oe=new Blob([$],{type:"image/svg+xml;charset=utf-8"}),te=URL.createObjectURL(oe),q=new Date,re=q.toISOString().slice(0,10),ae=q.toTimeString().slice(0,5).replace(":","-"),xe=`${tt.replace(/\s+/g,"_")}_${re}_${ae}`;z.onload=()=>{if(Y.width=_.w*b,Y.height=_.h*b,G){G.font="12px sans-serif",g==="jpeg"&&(G.fillStyle=Ke?"#111827":"#ffffff",G.fillRect(0,0,Y.width,Y.height)),G.drawImage(z,0,0);const st=Y.toDataURL(`image/${g}`,1),Be=document.createElement("a");Be.href=st,Be.download=`${xe}.${g}`,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be)}URL.revokeObjectURL(te)},z.src=te},Co=()=>{const g=window.open("","_blank");if(g&&Zt.current){const _=fi(),b=Zt.current.cloneNode(!0),D=Ke?"#111827":"#ffffff",V=document.createElementNS("http://www.w3.org/2000/svg","rect");V.setAttribute("x",String(_.x)),V.setAttribute("y",String(_.y)),V.setAttribute("width",String(_.w)),V.setAttribute("height",String(_.h)),V.setAttribute("fill",D),b.firstChild?b.insertBefore(V,b.firstChild):b.appendChild(V),b.setAttribute("viewBox",`${_.x} ${_.y} ${_.w} ${_.h}`),b.setAttribute("width",`${_.w}px`),b.setAttribute("height",`${_.h}px`);const $=b.querySelector("g");$&&($.setAttribute("transform",""),$.style.transform=""),b.style.display="block",b.style.overflow="visible";const Y=new XMLSerializer().serializeToString(b);g.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${tt} - Vettoriale</title>
                    <style>
                        @page { 
                            size: ${_.w}px ${_.h}px; 
                            margin: 0; 
                        }
                        body { 
                            margin: 0; 
                            padding: 0; 
                            width: ${_.w}px;
                            height: ${_.h}px;
                            overflow: hidden;
                            background-color: ${D};
                            /* FORZA STAMPA COLORI SFONDO */
                            -webkit-print-color-adjust: exact; 
                            print-color-adjust: exact;
                        }
                        svg { 
                            width: 100%; 
                            height: 100%; 
                            display: block;
                        }
                        /* FIX FONT */
                        text { 
                            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important; 
                        }
                    </style>
                </head>
                <body>
                    ${Y}
                </body>
                </html>
            `),g.document.close(),g.onload=()=>{setTimeout(()=>{g.focus(),g.print()},500)}}},Ro=(g,_,b)=>g.map(D=>{const V=_.filter(z=>(z.fromId===D.id||z.toId===D.id)&&dr.Struttura.includes(z.type)).map(z=>{const oe=z.fromId===D.id?z.toId:z.fromId,te=g.find(re=>re.id===oe),q=It[z.type];return te?`<b>${te.name}</b> (${q.label})`:null}).filter(Boolean).join(", "),$=_.filter(z=>z.fromId===D.id&&z.type.startsWith("child")).map(z=>{const oe=g.find(te=>te.id===z.toId);return oe?oe.name:null}).filter(Boolean).join(", "),Y=_.filter(z=>(z.fromId===D.id||z.toId===D.id)&&!dr.Struttura.includes(z.type)&&!z.type.startsWith("child")).map(z=>{const oe=z.fromId===D.id?z.toId:z.fromId,te=g.find(xe=>xe.id===oe),q=te?null:b.find(xe=>xe.id===oe),re=te?te.name:q?`Gruppo: ${q.label}`:"Sconosciuto";return`<li>${(It[z.type]||{label:z.type}).label} con <b>${re}</b>${z.notes.length?` (Note: ${z.notes.map(xe=>xe.text).join("; ")})`:""}</li>`}).join(""),G=b.filter(z=>z.memberIds.includes(D.id)).map(z=>z.label).join(", ");return`
            <div class="person-card">
                <h3>${D.name} <small>(${D.gender}, ${za(D.birthDate)} anni)</small></h3>
                ${G?`<p><strong>Gruppi:</strong> ${G}</p>`:""}
                ${V?`<p><strong>Partner:</strong> ${V}</p>`:""}
                ${$?`<p><strong>Figli:</strong> ${$}</p>`:""}
                ${Y?`<p><strong>Altre Relazioni:</strong></p><ul>${Y}</ul>`:""}
                ${D.notes.length>0?`<div class="notes-section"><strong>Diario Clinico:</strong><ul>${D.notes.map(z=>`<li><span class="note-date">${z.date}</span>: ${z.text}</li>`).join("")}</ul></div>`:""}
            </div>
          `}).join(""),yl=()=>{const g=window.open("","_blank");if(g&&Zt.current){const _=fi(),b=Zt.current.cloneNode(!0),D=b.querySelector("g");D&&D.setAttribute("transform",""),b.setAttribute("viewBox",`${_.x} ${_.y} ${_.w} ${_.h}`),b.setAttribute("width","100%"),b.setAttribute("height","50vh");const V=new XMLSerializer().serializeToString(b),$=Ro(B,le,he),Y=Array.from(new Set(le.map(q=>q.type))),G=Array.from(new Set(B.map(q=>q.gender))),z=q=>{const re=It[q]||It.custom;if(!re)return"";const ae=re.color||"#000";let xe="";return re.lineStyle==="dashed"?xe=`<line x1="0" y1="10" x2="40" y2="10" stroke="${ae}" stroke-width="2" stroke-dasharray="4,2"/>`:re.lineStyle==="dotted"?xe=`<line x1="0" y1="10" x2="40" y2="10" stroke="${ae}" stroke-width="2" stroke-dasharray="1,3"/>`:re.lineStyle==="zigzag"?xe=`<path d="M0 10 L5 5 L10 15 L15 5 L20 15 L25 5 L30 15 L35 5 L40 10" stroke="${re.renderType.includes("hostile")?"red":ae}" fill="none" stroke-width="1.5"/>`:xe=`<line x1="0" y1="10" x2="40" y2="10" stroke="${ae}" stroke-width="2"/>`,re.renderType==="double"&&(xe+=`<line x1="0" y1="6" x2="40" y2="6" stroke="${ae}" stroke-width="1.5"/><line x1="0" y1="14" x2="40" y2="14" stroke="${ae}" stroke-width="1.5"/>`),re.renderType==="cutoff"&&(xe+=`<line x1="20" y1="0" x2="20" y2="20" stroke="${ae}" stroke-width="3"/>`),re.renderType==="oblique"&&(xe+=`<line x1="25" y1="5" x2="15" y2="15" stroke="${ae}" stroke-width="2"/>`),re.renderType==="oblique-double"&&(xe+=`<line x1="23" y1="5" x2="13" y2="15" stroke="${ae}" stroke-width="2"/><line x1="27" y1="5" x2="17" y2="15" stroke="${ae}" stroke-width="2"/>`),`<svg width="40" height="20" style="vertical-align:middle; margin-right:8px">${xe}</svg>`},oe=q=>{let re="";const ae="black";return q==="M"?re=`<rect x="2" y="2" width="16" height="16" stroke="${ae}" fill="white" stroke-width="2"/>`:q==="F"?re=`<circle cx="10" cy="10" r="8" stroke="${ae}" fill="white" stroke-width="2"/>`:q==="Pregnancy"?re=`<path d="M10 2 L18 18 L2 18 Z" stroke="${ae}" fill="white" stroke-width="2"/>`:q==="Pet"?re=`<path d="M10 2 L18 10 L10 18 L2 10 Z" stroke="${ae}" fill="white" stroke-width="2"/>`:re='<text x="10" y="15" text-anchor="middle" font-size="14">?</text>',`<svg width="20" height="20" style="vertical-align:middle; margin-right:8px">${re}</svg>`},te=`
                <div style="margin-top: 30px; border: 1px solid #eee; padding: 15px; border-radius: 8px; background: #fcfcfc; page-break-inside: avoid;">
                    <h3 style="margin-top:0; border-bottom:1px solid #ddd; padding-bottom:5px;">Legenda Simboli Usati</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 30px;">
                        <div>
                            <strong style="display:block; margin-bottom:10px; font-size:12px; text-transform:uppercase; color:#666;">Persone</strong>
                            ${G.map(q=>{const re=q==="M"?"Maschio":q==="F"?"Femmina":q;return`<div style="margin-bottom:5px; font-size:13px;">${oe(q)} ${re}</div>`}).join("")}
                            <div style="margin-bottom:5px; font-size:13px;">
                                <svg width="20" height="20" style="vertical-align:middle; margin-right:8px"><rect x="2" y="2" width="16" height="16" stroke="black" fill="none"/><line x1="2" y1="2" x2="18" y2="18" stroke="black"/><line x1="18" y1="2" x2="2" y2="18" stroke="black"/></svg> Deceduto
                            </div>
                        </div>
                        <div>
                            <strong style="display:block; margin-bottom:10px; font-size:12px; text-transform:uppercase; color:#666;">Relazioni</strong>
                            ${Y.map(q=>{const re=It[q];return re?`<div style="margin-bottom:5px; font-size:13px;">${z(q)} ${re.label}</div>`:""}).join("")}
                        </div>
                    </div>
                </div>
            `;g.document.write(`
                <html>
                <head>
                    <title>${tt} - Report Clinico</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; color: #333; max-width: 1200px; margin: 0 auto; background: white; }
                        h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; color: #111; }
                        h2 { margin-top: 30px; color: #444; border-bottom: 1px solid #eee; padding-bottom: 5px; }
                        .diagram-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; margin-bottom: 30px; text-align: center; background: white; }
                        .person-card { background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3b82f6; page-break-inside: avoid; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
                        .person-card h3 { margin: 0 0 10px 0; font-size: 1.2em; color: #1e293b; }
                        .notes-section { margin-top: 10px; padding-top: 10px; border-top: 1px dashed #cbd5e1; font-size: 0.9em; }
                        .note-date { font-weight: bold; color: #64748b; }
                        
                        /* FIX FONT GRAFICO */
                        svg text { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important; 
                        }

                        @media print { body { padding: 0; } }
                    </style>
                </head>
                <body>
                    <h1>${tt}</h1>
                    <p style="color:#666">Generato il ${new Date().toLocaleDateString()}</p>
                    
                    <div class="diagram-container">
                        ${V}
                    </div>
                    
                    ${te}
                    
                    <h2>Dettaglio Clinico</h2>
                    ${$}
                </body>
                </html>
            `),g.document.close(),setTimeout(()=>g.print(),500)}},vl=g=>{var D;const _=(D=g.target.files)==null?void 0:D[0];if(!_)return;const b=new FileReader;b.onload=V=>{var $;try{const Y=JSON.parse(($=V.target)==null?void 0:$.result);Array.isArray(Y)&&(M(G=>[...G,...Y]),alert("Importazione completata!"))}catch{alert("Errore file")}},b.readAsText(_)},zc=()=>{const g=new Blob([JSON.stringify(C)],{type:"application/json"}),_=URL.createObjectURL(g),b=document.createElement("a");b.href=_,b.download="backup_genopro.json",b.click()},Qe=ye.length===1?B.find(g=>g.id===ye[0]):null,qn=le.find(g=>g.id===an[0]),wn=he.find(g=>g.id===Hr[0]);if(n==="dashboard")return c.jsxs("div",{className:`h-screen flex flex-col ${Ke?"dark bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:[ul&&c.jsx(SC,{onClose:()=>ui(!1),onExport:zc,onImport:vl,setCustomUser:i,customUser:s,setFirebaseConfig:l,firebaseConfig:o}),c.jsxs("div",{className:"flex h-full",children:[c.jsxs("div",{className:`w-64 border-r p-4 flex flex-col gap-4 ${Ke?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[c.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl text-blue-600 mb-2",children:[c.jsx(WE,{})," GenoPro"]}),c.jsxs("button",{onClick:ml,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center justify-center gap-2 font-medium transition-colors shadow-sm",children:[c.jsx(xc,{size:18})," Nuovo"]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("h3",{className:"text-xs font-bold uppercase opacity-50 mb-2 mt-4 px-2",children:"Categorie"}),c.jsxs("button",{onClick:()=>k("ALL"),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${S==="ALL"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx(mg,{size:16})," Tutti"]}),c.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 px-1.5 py-0.5 rounded text-[10px]",children:C.length})]}),j.map(g=>{const _=Ny[g.iconKey]||bh,b=C.filter(D=>D.category===g.id).length;return c.jsxs("button",{onClick:()=>k(g.id),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${S===g.id?"bg-gray-100 dark:bg-gray-700 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[c.jsxs("span",{className:"flex items-center gap-2",style:{color:S===g.id?void 0:g.color},children:[c.jsx(_,{size:16,color:g.color})," ",g.label]}),b>0&&c.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-500 px-1.5 py-0.5 rounded text-[10px]",children:b})]},g.id)})]}),c.jsxs("div",{className:"mt-auto border-t dark:border-gray-700 pt-4 space-y-2",children:[c.jsx(My,{currentThemeId:Bn,onChange:ai,placement:"top"}),c.jsxs("button",{onClick:()=>ui(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[c.jsx(mI,{size:16})," Impostazioni"]})]})]}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-gray-50 dark:bg-gray-900",children:[c.jsx("div",{className:"h-16 border-b flex items-center justify-between px-8 bg-white dark:bg-gray-800 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(Ah,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Cerca genogramma...",value:O,onChange:g=>H(g.target.value)})]}),c.jsxs("div",{className:"flex items-center gap-2 border-l pl-4 dark:border-gray-600",children:[c.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold",children:"Ordina"}),c.jsx("button",{onClick:()=>P("date_desc"),className:`p-1.5 rounded ${T==="date_desc"?"bg-blue-100 text-blue-600":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Pi Recenti",children:c.jsx(fg,{className:"rotate-180",size:18})}),c.jsx("button",{onClick:()=>P("date_asc"),className:`p-1.5 rounded ${T==="date_asc"?"bg-blue-100 text-blue-600":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Pi Vecchi",children:c.jsx(fg,{size:18})}),c.jsx("button",{onClick:()=>P("name_asc"),className:`p-1.5 rounded ${T==="name_asc"?"bg-blue-100 text-blue-600":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Alfabetico",children:c.jsx(eI,{size:18})})]})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[R.map(g=>{var D;const _=j.find(V=>V.id===g.category)||j[j.length-1],b=Ny[_.iconKey]||bh;return c.jsxs("div",{onClick:()=>{fe(g.id),on(g.title),ee(g.category),bn(g.data.presets||[]),di(g.data.nodes||[],g.data.edges||[],g.data.groups||[]),r("editor")},className:"group relative ...",children:[c.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:_.color}}),c.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider",style:{color:_.color},children:[c.jsx(b,{size:12})," ",_.label]}),c.jsx("button",{onClick:V=>{V.stopPropagation(),confirm("Eliminare?")&&I&&fC(Rd(I,"artifacts",N,"users",s||(t==null?void 0:t.uid)||"anon","genograms",g.id))},className:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(vI,{size:16})})]}),c.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-1 line-clamp-2",children:g.title}),c.jsxs("div",{className:"mt-auto pt-4 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 border-t dark:border-gray-700",children:[c.jsx("span",{children:new Date(g.lastModified).toLocaleDateString()}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(zu,{size:12})," ",((D=g.data.nodes)==null?void 0:D.length)||0]})]})]})]},g.id)}),R.length===0&&c.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 text-gray-400 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-xl",children:[c.jsx(Ah,{size:48,className:"mb-4 opacity-20"}),c.jsx("p",{children:"Nessun genogramma trovato"}),O&&c.jsx("button",{onClick:()=>H(""),className:"text-blue-500 hover:underline mt-2 text-sm",children:"Pulisci ricerca"})]})]})})]})]})]});const $c=g=>{if(g.touches.length===2){const _=Math.hypot(g.touches[0].clientX-g.touches[1].clientX,g.touches[0].clientY-g.touches[1].clientY);h(_)}else Ps(g)},wr=g=>{if(g.touches.length===2&&u!==null){g.preventDefault();const _=Math.hypot(g.touches[0].clientX-g.touches[1].clientX,g.touches[0].clientY-g.touches[1].clientY),b=_-u,D=.005;nt(V=>{const $=V+b*D;return Math.max(.2,Math.min(3,$))}),h(_)}},Gn=()=>{h(null)};return c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden transition-colors duration-300",style:{backgroundColor:je.colors.bgMain,color:je.colors.text,"--theme-bg-main":je.colors.bgMain,"--theme-bg-panel":je.colors.bgPanel,"--theme-border":je.colors.border,"--theme-text":je.colors.text,"--theme-text-muted":je.colors.textMuted,"--theme-accent":je.colors.accent},children:[c.jsx("style",{children:`
         .no-scrollbar::-webkit-scrollbar { display: none; }
         .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
         
         /* Classi di utilit per i temi */
         .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
         .theme-border { border-color: var(--theme-border); }
         .theme-text { color: var(--theme-text); }
         .theme-text-muted { color: var(--theme-text-muted); }
         .theme-hover:hover { background-color: rgba(128,128,128, 0.1); }
       `}),dl&&c.jsx(AC,{onClose:()=>qr(!1),onSave:g=>bn(_=>[..._,g])}),Lc&&c.jsx(kC,{onClose:()=>cl(!1),nodes:B,edges:le,groups:he}),Gr&&c.jsx(TC,{x:Gr.x,y:Gr.y,mode:Gr.mode,customPresets:Xt,onClose:()=>Jt(null),onSelect:g=>{Rn(_=>_.map(b=>b.id===Gr.edgeId?{...b,type:g}:b)),Jt(null)}}),E&&c.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>y(!1)}),c.jsxs("div",{className:"h-14 border-b flex items-center px-2 md:px-4 justify-between shrink-0 gap-2 relative z-50 overflow-visible theme-panel border-b theme-border",children:[c.jsxs("div",{className:"flex gap-2 md:gap-3 items-center shrink-0",children:[c.jsx("button",{onClick:()=>r("dashboard"),className:"p-2 theme-hover rounded",children:c.jsx(mg,{size:20})}),c.jsxs("div",{className:"flex flex-col ml-1",children:[c.jsx("input",{value:tt,onChange:g=>on(g.target.value),className:"bg-transparent font-bold text-sm w-24 md:w-40 outline-none theme-text truncate",placeholder:"Titolo"}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>y(!E),className:"flex items-center gap-1 text-[10px] uppercase font-bold theme-text-muted hover:text-[var(--theme-accent)]",children:[(Ds=j.find(g=>g.id===Lt))==null?void 0:Ds.label," ",c.jsx(Qv,{size:10})]}),E&&c.jsx("div",{className:"absolute top-full left-0 mt-1 shadow-lg rounded-lg p-1 w-40 z-50 theme-panel border theme-border",children:j.map(g=>c.jsxs("button",{onClick:()=>{ee(g.id),y(!1)},className:"w-full text-left px-2 py-1.5 text-xs rounded theme-hover flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:g.color}})," ",g.label]},g.id))})]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"})]}),c.jsx("div",{className:"flex-1 min-w-0 flex justify-center px-2",children:c.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar w-full md:w-auto md:justify-center",children:[c.jsx("button",{onClick:()=>Ns("M"),title:"Nuovo Maschio (M)",className:"p-1.5 theme-hover rounded shrink-0",children:c.jsx(gI,{style:{color:"var(--theme-accent)"},size:20})}),c.jsx("button",{onClick:()=>Ns("F"),title:"Nuova Femmina (F)",className:"p-1.5 theme-hover rounded shrink-0",children:c.jsx(YE,{className:"text-pink-600",size:20})}),c.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),c.jsx("button",{onClick:hi,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Genitori",children:c.jsx(xI,{size:18})}),c.jsx("button",{onClick:gl,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Partner",children:c.jsx(Kf,{size:18})}),c.jsx("button",{onClick:ko,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Figlio",children:c.jsx(nI,{size:18})}),c.jsx("button",{onClick:Fc,title:"Gruppo",className:"p-1.5 theme-hover rounded shrink-0",children:c.jsx(zu,{size:20})}),c.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),c.jsx("button",{onClick:So,className:"p-1.5 theme-hover rounded shrink-0",style:{color:"var(--theme-accent)"},title:"Auto-Layout",children:c.jsx(dI,{size:18})}),c.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),c.jsx("button",{onClick:()=>Hn("h"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Orizzontale",children:c.jsx(hg,{size:18})}),c.jsx("button",{onClick:()=>Hn("v"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Verticale",children:c.jsx(hg,{className:"rotate-90",size:18})}),c.jsx("button",{onClick:()=>or("align-children"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Figli",children:c.jsx(HE,{size:18,style:{color:"var(--theme-accent)"}})}),c.jsx("button",{onClick:()=>or("align-parents"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Genitori",children:c.jsx(qE,{size:18,style:{color:"var(--theme-accent)"}})}),c.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),c.jsx("button",{onClick:()=>Hn("circle"),className:"p-1.5 theme-hover rounded shrink-0",title:"Cerchio",children:c.jsx(XE,{size:18})}),c.jsx("button",{onClick:()=>Hn("grid"),className:"p-1.5 theme-hover rounded shrink-0",title:"Griglia",children:c.jsx(sI,{size:18})}),c.jsx("button",{onClick:()=>Hn("diagonal"),className:"p-1.5 theme-hover rounded shrink-0",title:"Diagonale",children:c.jsx(_I,{size:18})}),c.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),c.jsx("button",{onClick:()=>ll(!vn),className:`p-1.5 rounded shrink-0 ${vn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Snap Griglia",children:c.jsx(iI,{size:18})}),c.jsx("button",{onClick:()=>Eo(!ir),className:`p-1.5 rounded shrink-0 ${ir?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mod. Selezione",children:c.jsx(cI,{size:18})}),c.jsx("button",{onClick:()=>qr(!0),className:"p-1.5 theme-hover rounded shrink-0",title:"Stili",children:c.jsx(Jv,{size:18})}),c.jsx("button",{onClick:()=>xo(!Nn),className:`p-1.5 rounded shrink-0 ${Nn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mostra Legenda",children:c.jsx(uI,{size:18})})]})}),c.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[c.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm mr-2 theme-border theme-panel",title:"Stato Sync",children:[p==="synced"&&c.jsx(JE,{className:"text-green-500",size:16}),p==="syncing"&&c.jsx(hI,{className:"text-orange-500 animate-spin",size:16}),p==="error"&&c.jsx(pg,{className:"text-red-500",size:16}),p==="offline"&&c.jsx(pg,{className:"opacity-50",size:16}),c.jsx("span",{className:`text-[10px] font-bold uppercase ${p==="synced"?"text-green-600":"opacity-50"}`,children:p==="synced"?"SYNC":p==="syncing"?"SAVING":"OFFLINE"})]}),c.jsx("button",{onClick:wo,disabled:gn<=0,className:`p-1.5 rounded ${gn<=0?"opacity-30":"theme-hover"}`,title:"Annulla",children:c.jsx(fI,{size:18})}),c.jsx("button",{onClick:al,disabled:gn>=kt.length-1,className:`p-1.5 rounded ${gn>=kt.length-1?"opacity-30":"theme-hover"}`,title:"Ripristina",children:c.jsx(pI,{size:18})}),c.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"}),c.jsx("button",{onClick:Uc,className:"p-1.5 theme-hover rounded hidden md:block",title:"Ricentra",children:c.jsx(yI,{size:18})}),c.jsx("button",{onClick:()=>nt(g=>Math.max(.2,g-.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:c.jsx(TI,{size:18})}),c.jsxs("span",{className:"text-xs w-8 text-center hidden md:block",children:[Math.round(Kr*100),"%"]}),c.jsx("button",{onClick:()=>nt(g=>Math.min(3,g+.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:c.jsx(II,{size:18})}),c.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1"}),c.jsxs("div",{className:"w-10 md:w-32",children:[c.jsx("div",{className:"hidden md:block",children:c.jsx(My,{currentThemeId:Bn,onChange:ai,placement:"bottom"})}),c.jsx("div",{className:"md:hidden",children:c.jsx("button",{onClick:()=>{const g=os.findIndex(b=>b.id===Bn),_=os[(g+1)%os.length];ai(_.id)},className:"p-1.5 theme-hover rounded",children:je.type==="dark"?c.jsx(Yv,{size:18}):c.jsx(Zv,{size:18})})})]}),c.jsx("button",{onClick:()=>cl(!0),className:"p-1.5 theme-hover rounded hidden sm:block",style:{color:"var(--theme-accent)"},title:"Report",children:c.jsx(au,{size:20})}),c.jsxs("div",{className:"relative group z-50",children:[c.jsx("button",{className:"p-1.5 theme-hover rounded font-bold",style:{color:"var(--theme-accent)"},title:"Esporta",children:c.jsx(Xv,{size:20})}),c.jsxs("div",{className:"absolute right-0 top-full theme-panel border theme-border shadow-lg rounded p-3 hidden group-hover:block w-64 z-[70]",children:[c.jsxs("div",{className:"mb-3 pb-3 border-b theme-border",children:[c.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-2",children:"Qualit Immagine"}),c.jsxs("div",{className:"flex bg-black/5 dark:bg-white/5 rounded p-1 gap-1 items-center",children:[[1,2,4,6].map(g=>c.jsxs("button",{onClick:_=>{_.stopPropagation(),Qr(g)},className:`flex-1 text-[10px] py-1.5 rounded transition-all font-medium ${ci===g?"theme-panel shadow text-[var(--theme-accent)]":"opacity-50"}`,children:[g,"x"]},g)),c.jsx("div",{className:"w-px h-4 bg-gray-300 opacity-30 mx-0.5"}),c.jsx("div",{className:"relative group/input",children:c.jsx("input",{type:"number",min:"1",max:"12",value:ci,onClick:g=>g.stopPropagation(),onChange:g=>{const _=parseInt(g.target.value);isNaN(_)||Qr(Math.max(1,Math.min(12,_)))},className:"w-10 text-[10px] py-1 rounded border-none bg-transparent text-center outline-none font-bold text-[var(--theme-accent)]",placeholder:"#"})})]})]}),c.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Immagini"}),c.jsxs("button",{onClick:()=>bo("png"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[c.jsx(lI,{size:14})," Scarica PNG"]}),c.jsxs("button",{onClick:()=>bo("jpeg"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[c.jsx(ZE,{size:14})," Scarica JPEG"]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-600 my-2 opacity-30"}),c.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Documenti"}),c.jsxs("button",{onClick:Co,className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[c.jsx(au,{size:14})," PDF Vettoriale (Solo Grafico)"]}),c.jsxs("button",{onClick:yl,className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[c.jsx(au,{size:14})," Report Clinico (Completo)"]})]})]})]})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden relative print:overflow-visible",children:[c.jsx("div",{ref:St,className:"flex-1 overflow-auto relative scroll-smooth",style:{touchAction:"none"},children:c.jsxs("div",{style:{width:Zo,height:Zo},className:"relative print:w-full print:h-full",children:[c.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none print:hidden",style:{backgroundImage:"radial-gradient(currentColor 1px, transparent 1px)",backgroundSize:`${ln}px ${ln}px`,color:"var(--theme-text-muted)"}}),c.jsx("svg",{ref:Zt,width:Zo,height:Zo,className:"block touch-none",onMouseDown:Ps,onTouchStart:$c,onTouchMove:wr,onTouchEnd:Gn,children:c.jsxs("g",{transform:`scale(${Kr})`,style:{transformOrigin:`${wt}px ${wt}px`},children:[he.map(g=>{const _=xi(g,B);if(!_)return null;const b=Hr.includes(g.id),D=g.color==="#000000"&&Ke?"#ffffff":g.color;return c.jsxs("g",{onClick:V=>{V.stopPropagation(),Pn([g.id]),Ge([])},children:[c.jsx("rect",{x:_.x,y:_.y,width:_.w,height:_.h,rx:vC,fill:D,fillOpacity:.05,stroke:D,strokeDasharray:"10,5",strokeWidth:2,className:b?"stroke-blue-500 stroke-[4px]":""}),c.jsxs("g",{transform:`translate(${_.x+_.w-10}, ${_.y+_.h+25})`,children:[c.jsx("rect",{x:-(g.label.length*7),y:"-14",width:g.label.length*7+10,height:"20",fill:je.colors.bgPanel,fillOpacity:.8,rx:"4"}),c.jsx("text",{textAnchor:"end",fill:D,className:"text-xs font-bold uppercase select-none",children:g.label})]}),b&&c.jsxs("g",{transform:`translate(${_.x}, ${_.y})`,onMouseDown:V=>{V.stopPropagation(),V.preventDefault(),fl(V,g.id)},className:"cursor-alias",children:[c.jsx("rect",{x:-5,y:-5,width:10,height:10,fill:"orange"}),c.jsx(e_,{size:10,x:-5,y:-5,color:"white"})]})]},g.id)}),le.map(g=>{const _=Dy(g.fromId,B,he),b=Dy(g.toId,B,he);if(!_||!b)return null;let D=_,V=b;const $=he.find(q=>q.id===g.toId);if($){const q=xi($,B);q&&(V=Pd(q,D))}const Y=he.find(q=>q.id===g.fromId);if(Y){const q=xi(Y,B);q&&(D=Pd(q,V))}const G=B.find(q=>q.id===g.fromId),z=B.find(q=>q.id===g.toId),oe=g.type.startsWith("twin");if((g.type.startsWith("child")||oe)&&G&&z){const q=Kl(g.fromId,le);if(q){const re=B.find(xe=>xe.id===q.fromId),ae=B.find(xe=>xe.id===q.toId);re&&ae&&(D={x:(re.x+ae.x+Bt)/2,y:Math.max(re.y,ae.y)+yC})}else D={x:G.x+Bt/2,y:G.y+Tr}}const te=Xt.find(q=>q.id===g.type);return c.jsx("g",{onClick:q=>{q.stopPropagation(),pl(g.id,q)},children:c.jsx(EC,{edge:g,start:D,end:V,isSelected:an.includes(g.id),darkMode:Ke,customConfig:te,onAddChild:(q,re)=>Io(q,re)})},g.id)}),Le&&Le.type!=="move"&&Le.type!=="box"&&Le.type!=="pan"&&c.jsx("line",{x1:Le.startX,y1:Le.startY,x2:Le.currX,y2:Le.currY,stroke:"gray",strokeDasharray:"5,5"}),Le&&Le.type==="move"&&ye.map(g=>{var G,z;if(!B.find(oe=>oe.id===g))return null;const b=(z=(G=Ie.current)==null?void 0:G.initialNodePositions)==null?void 0:z[g];if(!b)return null;const D=Le.currX-Le.startX,V=Le.currY-Le.startY;let $=b.x+D,Y=b.y+V;return vn&&($=Math.round($/ln)*ln,Y=Math.round(Y/ln)*ln),c.jsx("rect",{x:$,y:Y,width:Bt,height:Tr,fill:"none",stroke:"gray",strokeDasharray:"2,2"},g)}),B.map(g=>c.jsx("g",{onMouseDown:_=>Wn(_,g.id),onTouchStart:_=>Wn(_,g.id),children:c.jsx(IC,{node:g,isSelected:ye.includes(g.id),showLabelType:li,darkMode:Ke,onHandleDown:hl,selectionMode:ir,onRename:(_,b)=>ot(D=>D.map(V=>V.id===_?{...V,name:b}:V))})},g.id)),(()=>{if(!Nn)return null;const g=Ao();return c.jsx(wC,{x:g.minX-270,y:g.minY,darkMode:Ke,nodes:B,edges:le})})(),Le&&Le.type==="box"&&c.jsx("rect",{x:Math.min(Le.startX,Le.currX),y:Math.min(Le.startY,Le.currY),width:Math.abs(Le.currX-Le.startX),height:Math.abs(Le.currY-Le.startY),fill:"rgba(0,0,255,0.1)",stroke:"blue"})]})})]})}),(ye.length>0||an.length>0||Hr.length>0)&&c.jsxs("div",{className:"w-80 border-l p-4 overflow-y-auto theme-panel theme-border print:hidden",children:[c.jsxs("h3",{className:"font-bold mb-4 flex justify-between",children:["Propriet ",c.jsx(Ji,{className:"cursor-pointer",onClick:()=>{Ge([]),yn([]),Pn([])}})]}),Qe&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Qe.name,onChange:g=>ot(B.map(_=>_.id===Qe.id?{..._,name:g.target.value}:_)),placeholder:"Nome"}),c.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Qe.label||"",onChange:g=>ot(B.map(_=>_.id===Qe.id?{..._,label:g.target.value}:_)),placeholder:"Etichetta (es. Padre)"}),c.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Qe.birthDate,onChange:g=>ot(B.map(_=>_.id===Qe.id?{..._,birthDate:g.target.value}:_)),placeholder:"Nascita (es 1980)"}),c.jsxs("div",{className:"text-xs opacity-50",children:["Et: ",za(Qe.birthDate)]}),c.jsxs("select",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Qe.gender,onChange:g=>ot(B.map(_=>_.id===Qe.id?{..._,gender:g.target.value}:_)),children:[c.jsx("option",{value:"M",className:"text-black",children:"Maschio"}),c.jsx("option",{value:"F",className:"text-black",children:"Femmina"}),c.jsx("option",{value:"TransWoman",className:"text-black",children:"Donna Trans (MTF)"}),c.jsx("option",{value:"TransMan",className:"text-black",children:"Uomo Trans (FTM)"}),c.jsx("option",{value:"NonBinary",className:"text-black",children:"Non-Binary/Genderqueer"}),c.jsx("option",{value:"Pet",className:"text-black",children:"Animale"}),c.jsx("option",{value:"Pregnancy",className:"text-black",children:"Gravidanza"}),c.jsx("option",{value:"Miscarriage",className:"text-black",children:"Aborto Spontaneo"}),c.jsx("option",{value:"Abortion",className:"text-black",children:"Aborto Volontario"}),c.jsx("option",{value:"Stillbirth",className:"text-black",children:"Morto alla nascita"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{className:`border px-2 py-1 text-xs rounded ${Qe.deceased?"bg-red-500 text-white":"theme-border"}`,onClick:()=>ot(B.map(g=>g.id===Qe.id?{...g,deceased:!g.deceased}:g)),children:"Deceduto"}),c.jsx("button",{className:`border px-2 py-1 text-xs rounded ${Qe.indexPerson?"bg-blue-500 text-white":"theme-border"}`,onClick:()=>ot(B.map(g=>g.id===Qe.id?{...g,indexPerson:!g.indexPerson}:g)),children:"Pz. Designato"}),c.jsx("button",{className:`border px-2 py-1 text-xs rounded ${Qe.substanceAbuse?"bg-orange-500 text-white":"theme-border"}`,onClick:()=>ot(B.map(g=>g.id===Qe.id?{...g,substanceAbuse:!g.substanceAbuse}:g)),children:"Abuso Sost."}),c.jsx("button",{className:`border px-2 py-1 text-xs rounded ${Qe.mentalIssue?"bg-purple-500 text-white":"theme-border"}`,onClick:()=>ot(B.map(g=>g.id===Qe.id?{...g,mentalIssue:!g.mentalIssue}:g)),children:"Problema Psi."}),c.jsx("button",{className:`border px-2 py-1 text-xs rounded ${Qe.gayLesbian?"bg-pink-500 text-white":"theme-border"}`,onClick:()=>ot(B.map(g=>g.id===Qe.id?{...g,gayLesbian:!g.gayLesbian}:g)),children:"Omosessuale"})]}),c.jsx(Dd,{notes:Qe.notes,onChange:g=>ot(B.map(_=>_.id===Qe.id?{..._,notes:g}:_))}),c.jsx("button",{onClick:()=>{ot(B.filter(g=>!ye.includes(g.id))),Rn(le.filter(g=>!ye.includes(g.fromId)&&!ye.includes(g.toId))),Ge([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4",children:"Elimina Persona"})]}),qn&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-xs opacity-50 font-bold",children:"Tipo"}),c.jsx(xC,{value:qn.type,onChange:g=>{const _=It[g]||{};Rn(b=>b.map(D=>D.id===qn.id?{...D,type:g,color:_.color,lineStyle:_.lineStyle,decorator:_.decorator}:D))},className:"text-black"}),c.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:qn.label,onChange:g=>Rn(_=>_.map(b=>b.id===qn.id?{...b,label:g.target.value}:b)),placeholder:"Etichetta"}),c.jsx(Dd,{notes:qn.notes,onChange:g=>Rn(_=>_.map(b=>b.id===qn.id?{...b,notes:g}:b))}),c.jsx("button",{onClick:()=>{Rn(le.filter(g=>g.id!==qn.id)),yn([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200",children:"Elimina Relazione"})]}),wn&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-xs opacity-50 font-bold",children:"Tipo"}),c.jsxs("select",{className:"w-full p-2 rounded border bg-transparent theme-border",value:wn.type,onChange:g=>$n(he.map(_=>_.id===wn.id?{..._,type:g.target.value}:_)),children:[c.jsx("option",{value:"household",className:"text-black",children:"Household"}),c.jsx("option",{value:"subsystem",className:"text-black",children:"Sottosistema"})]}),c.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:wn.label,onChange:g=>$n(he.map(_=>_.id===wn.id?{..._,label:g.target.value}:_)),placeholder:"Etichetta"}),c.jsx("input",{type:"color",className:"w-full h-8",value:wn.color,onChange:g=>$n(he.map(_=>_.id===wn.id?{..._,color:g.target.value}:_))}),c.jsx(Dd,{notes:wn.notes,onChange:g=>$n(he.map(_=>_.id===wn.id?{..._,notes:g}:_))}),c.jsx("button",{onClick:()=>{$n(he.filter(g=>g.id!==wn.id)),Pn([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200",children:"Elimina Gruppo"})]})]})]})]})}class RC extends qy.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Errore Critico di Avvio:",e,n)}render(){var e,n;return this.state.hasError?c.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[c.jsx("h1",{style:{color:"#dc2626",fontSize:"1.5rem",marginBottom:"1rem"},children:"Si  verificato un errore critico"}),c.jsx("p",{style:{marginBottom:"1rem",color:"#4b5563"},children:"L'applicazione non  riuscita ad avviarsi. Ecco i dettagli tecnici:"}),c.jsxs("div",{style:{backgroundColor:"#f3f4f6",padding:"1rem",borderRadius:"0.5rem",overflow:"auto",border:"1px solid #e5e7eb"},children:[c.jsx("code",{style:{color:"#dc2626",fontSize:"0.875rem"},children:(e=this.state.error)==null?void 0:e.message}),c.jsx("pre",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"#374151"},children:(n=this.state.error)==null?void 0:n.stack})]}),c.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1.5rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontWeight:"bold"},children:"Ricarica Applicazione"})]}):this.props.children}}const jy=document.getElementById("root");jy?Md.createRoot(jy).render(c.jsx(qy.StrictMode,{children:c.jsx(RC,{children:c.jsx(CC,{})})})):document.body.innerHTML=`<div style="color: red; padding: 20px; font-weight: bold;">ERRORE FATALE: Impossibile trovare l'elemento con id="root" nel file index.html.</div>`;
