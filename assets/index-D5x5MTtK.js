(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Jw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lv={exports:{}},Cu={},cv={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=Symbol.for("react.element"),Zw=Symbol.for("react.portal"),e1=Symbol.for("react.fragment"),t1=Symbol.for("react.strict_mode"),n1=Symbol.for("react.profiler"),r1=Symbol.for("react.provider"),s1=Symbol.for("react.context"),i1=Symbol.for("react.forward_ref"),o1=Symbol.for("react.suspense"),a1=Symbol.for("react.memo"),l1=Symbol.for("react.lazy"),wm=Symbol.iterator;function c1(t){return t===null||typeof t!="object"?null:(t=wm&&t[wm]||t["@@iterator"],typeof t=="function"?t:null)}var uv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dv=Object.assign,hv={};function Mo(t,e,n){this.props=t,this.context=e,this.refs=hv,this.updater=n||uv}Mo.prototype.isReactComponent={};Mo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Mo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fv(){}fv.prototype=Mo.prototype;function If(t,e,n){this.props=t,this.context=e,this.refs=hv,this.updater=n||uv}var Sf=If.prototype=new fv;Sf.constructor=If;dv(Sf,Mo.prototype);Sf.isPureReactComponent=!0;var Em=Array.isArray,pv=Object.prototype.hasOwnProperty,Nf={current:null},mv={key:!0,ref:!0,__self:!0,__source:!0};function gv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)pv.call(e,r)&&!mv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),h=0;h<c;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:gl,type:t,key:i,ref:o,props:s,_owner:Nf.current}}function u1(t,e){return{$$typeof:gl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Af(t){return typeof t=="object"&&t!==null&&t.$$typeof===gl}function d1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bm=/\/+/g;function md(t,e){return typeof t=="object"&&t!==null&&t.key!=null?d1(""+t.key):e.toString(36)}function vc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case gl:case Zw:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+md(o,0):r,Em(s)?(n="",t!=null&&(n=t.replace(bm,"$&/")+"/"),vc(s,e,n,"",function(h){return h})):s!=null&&(Af(s)&&(s=u1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(bm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Em(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+md(i,c);o+=vc(i,e,n,u,s)}else if(u=c1(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+md(i,c++),o+=vc(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Kl(t,e,n){if(t==null)return t;var r=[],s=0;return vc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function h1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},xc={transition:null},f1={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:xc,ReactCurrentOwner:Nf};function yv(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Kl,forEach:function(t,e,n){Kl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Kl(t,function(){e++}),e},toArray:function(t){return Kl(t,function(e){return e})||[]},only:function(t){if(!Af(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_e.Component=Mo;_e.Fragment=e1;_e.Profiler=n1;_e.PureComponent=If;_e.StrictMode=t1;_e.Suspense=o1;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f1;_e.act=yv;_e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Nf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)pv.call(e,u)&&!mv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:gl,type:t.type,key:s,ref:i,props:r,_owner:o}};_e.createContext=function(t){return t={$$typeof:s1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:r1,_context:t},t.Consumer=t};_e.createElement=gv;_e.createFactory=function(t){var e=gv.bind(null,t);return e.type=t,e};_e.createRef=function(){return{current:null}};_e.forwardRef=function(t){return{$$typeof:i1,render:t}};_e.isValidElement=Af;_e.lazy=function(t){return{$$typeof:l1,_payload:{_status:-1,_result:t},_init:h1}};_e.memo=function(t,e){return{$$typeof:a1,type:t,compare:e===void 0?null:e}};_e.startTransition=function(t){var e=xc.transition;xc.transition={};try{t()}finally{xc.transition=e}};_e.unstable_act=yv;_e.useCallback=function(t,e){return tn.current.useCallback(t,e)};_e.useContext=function(t){return tn.current.useContext(t)};_e.useDebugValue=function(){};_e.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};_e.useEffect=function(t,e){return tn.current.useEffect(t,e)};_e.useId=function(){return tn.current.useId()};_e.useImperativeHandle=function(t,e,n){return tn.current.useImperativeHandle(t,e,n)};_e.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};_e.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};_e.useMemo=function(t,e){return tn.current.useMemo(t,e)};_e.useReducer=function(t,e,n){return tn.current.useReducer(t,e,n)};_e.useRef=function(t){return tn.current.useRef(t)};_e.useState=function(t){return tn.current.useState(t)};_e.useSyncExternalStore=function(t,e,n){return tn.current.useSyncExternalStore(t,e,n)};_e.useTransition=function(){return tn.current.useTransition()};_e.version="18.3.1";cv.exports=_e;var B=cv.exports;const vv=Jw(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p1=B,m1=Symbol.for("react.element"),g1=Symbol.for("react.fragment"),y1=Object.prototype.hasOwnProperty,v1=p1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x1={key:!0,ref:!0,__self:!0,__source:!0};function xv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)y1.call(e,r)&&!x1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:m1,type:t,key:i,ref:o,props:s,_owner:v1.current}}Cu.Fragment=g1;Cu.jsx=xv;Cu.jsxs=xv;lv.exports=Cu;var a=lv.exports,nh={},_v={exports:{}},Tn={},wv={exports:{}},Ev={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,de){var ue=Z.length;Z.push(de);e:for(;0<ue;){var Ae=ue-1>>>1,Te=Z[Ae];if(0<s(Te,de))Z[Ae]=de,Z[ue]=Te,ue=Ae;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var de=Z[0],ue=Z.pop();if(ue!==de){Z[0]=ue;e:for(var Ae=0,Te=Z.length,Oe=Te>>>1;Ae<Oe;){var Ft=2*(Ae+1)-1,ht=Z[Ft],er=Ft+1,Nt=Z[er];if(0>s(ht,ue))er<Te&&0>s(Nt,ht)?(Z[Ae]=Nt,Z[er]=ue,Ae=er):(Z[Ae]=ht,Z[Ft]=ue,Ae=Ft);else if(er<Te&&0>s(Nt,ue))Z[Ae]=Nt,Z[er]=ue,Ae=er;else break e}}return de}function s(Z,de){var ue=Z.sortIndex-de.sortIndex;return ue!==0?ue:Z.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,g=null,_=3,C=!1,R=!1,M=!1,F=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(Z){for(var de=n(h);de!==null;){if(de.callback===null)r(h);else if(de.startTime<=Z)r(h),de.sortIndex=de.expirationTime,e(u,de);else break;de=n(h)}}function k(Z){if(M=!1,T(Z),!R)if(n(u)!==null)R=!0,fe(O);else{var de=n(h);de!==null&&Xe(k,de.startTime-Z)}}function O(Z,de){R=!1,M&&(M=!1,A(v),v=-1),C=!0;var ue=_;try{for(T(de),g=n(u);g!==null&&(!(g.expirationTime>de)||Z&&!P());){var Ae=g.callback;if(typeof Ae=="function"){g.callback=null,_=g.priorityLevel;var Te=Ae(g.expirationTime<=de);de=t.unstable_now(),typeof Te=="function"?g.callback=Te:g===n(u)&&r(u),T(de)}else r(u);g=n(u)}if(g!==null)var Oe=!0;else{var Ft=n(h);Ft!==null&&Xe(k,Ft.startTime-de),Oe=!1}return Oe}finally{g=null,_=ue,C=!1}}var W=!1,b=null,v=-1,w=5,E=-1;function P(){return!(t.unstable_now()-E<w)}function D(){if(b!==null){var Z=t.unstable_now();E=Z;var de=!0;try{de=b(!0,Z)}finally{de?N():(W=!1,b=null)}}else W=!1}var N;if(typeof I=="function")N=function(){I(D)};else if(typeof MessageChannel<"u"){var Le=new MessageChannel,St=Le.port2;Le.port1.onmessage=D,N=function(){St.postMessage(null)}}else N=function(){F(D,0)};function fe(Z){b=Z,W||(W=!0,N())}function Xe(Z,de){v=F(function(){Z(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){R||C||(R=!0,fe(O))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Z){switch(_){case 1:case 2:case 3:var de=3;break;default:de=_}var ue=_;_=de;try{return Z()}finally{_=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,de){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ue=_;_=Z;try{return de()}finally{_=ue}},t.unstable_scheduleCallback=function(Z,de,ue){var Ae=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ae+ue:Ae):ue=Ae,Z){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ue+Te,Z={id:m++,callback:de,priorityLevel:Z,startTime:ue,expirationTime:Te,sortIndex:-1},ue>Ae?(Z.sortIndex=ue,e(h,Z),n(u)===null&&Z===n(h)&&(M?(A(v),v=-1):M=!0,Xe(k,ue-Ae))):(Z.sortIndex=Te,e(u,Z),R||C||(R=!0,fe(O))),Z},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(Z){var de=_;return function(){var ue=_;_=de;try{return Z.apply(this,arguments)}finally{_=ue}}}})(Ev);wv.exports=Ev;var _1=wv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1=B,kn=_1;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bv=new Set,$a={};function Si(t,e){go(t,e),go(t+"Capture",e)}function go(t,e){for($a[t]=e,t=0;t<e.length;t++)bv.add(e[t])}var $r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rh=Object.prototype.hasOwnProperty,E1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,km={},Tm={};function b1(t){return rh.call(Tm,t)?!0:rh.call(km,t)?!1:E1.test(t)?Tm[t]=!0:(km[t]=!0,!1)}function k1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function T1(t,e,n,r){if(e===null||typeof e>"u"||k1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ot[t]=new nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ot[e]=new nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ot[t]=new nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ot[t]=new nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ot[t]=new nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ot[t]=new nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ot[t]=new nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ot[t]=new nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ot[t]=new nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Cf=/[\-:]([a-z])/g;function Pf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Cf,Pf);Ot[e]=new nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Cf,Pf);Ot[e]=new nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Cf,Pf);Ot[e]=new nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ot[t]=new nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ot.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ot[t]=new nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function jf(t,e,n,r){var s=Ot.hasOwnProperty(e)?Ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(T1(e,n,s,r)&&(n=null),r||s===null?b1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Jr=w1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ql=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Gi=Symbol.for("react.fragment"),Rf=Symbol.for("react.strict_mode"),sh=Symbol.for("react.profiler"),kv=Symbol.for("react.provider"),Tv=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),ih=Symbol.for("react.suspense"),oh=Symbol.for("react.suspense_list"),Mf=Symbol.for("react.memo"),fs=Symbol.for("react.lazy"),Iv=Symbol.for("react.offscreen"),Im=Symbol.iterator;function la(t){return t===null||typeof t!="object"?null:(t=Im&&t[Im]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,gd;function ya(t){if(gd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);gd=e&&e[1]||""}return`
`+gd+t}var yd=!1;function vd(t,e){if(!t||yd)return"";yd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{yd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ya(t):""}function I1(t){switch(t.tag){case 5:return ya(t.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return t=vd(t.type,!1),t;case 11:return t=vd(t.type.render,!1),t;case 1:return t=vd(t.type,!0),t;default:return""}}function ah(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Gi:return"Fragment";case Hi:return"Portal";case sh:return"Profiler";case Rf:return"StrictMode";case ih:return"Suspense";case oh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Tv:return(t.displayName||"Context")+".Consumer";case kv:return(t._context.displayName||"Context")+".Provider";case Df:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Mf:return e=t.displayName||null,e!==null?e:ah(t.type)||"Memo";case fs:e=t._payload,t=t._init;try{return ah(t(e))}catch{}}return null}function S1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ah(e);case 8:return e===Rf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Os(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Sv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function N1(t){var e=Sv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yl(t){t._valueTracker||(t._valueTracker=N1(t))}function Nv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Sv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Fc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function lh(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Os(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Av(t,e){e=e.checked,e!=null&&jf(t,"checked",e,!1)}function ch(t,e){Av(t,e);var n=Os(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uh(t,e.type,n):e.hasOwnProperty("defaultValue")&&uh(t,e.type,Os(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Nm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function uh(t,e,n){(e!=="number"||Fc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var va=Array.isArray;function so(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Os(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function dh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Am(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Q(92));if(va(n)){if(1<n.length)throw Error(Q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Os(n)}}function Cv(t,e){var n=Os(e.value),r=Os(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xl,jv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xl=Xl||document.createElement("div"),Xl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ba(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Na={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},A1=["Webkit","ms","Moz","O"];Object.keys(Na).forEach(function(t){A1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Na[e]=Na[t]})});function Rv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Na.hasOwnProperty(t)&&Na[t]?(""+e).trim():e+"px"}function Dv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Rv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var C1=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fh(t,e){if(e){if(C1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function ph(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mh=null;function Lf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gh=null,io=null,oo=null;function Pm(t){if(t=xl(t)){if(typeof gh!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Mu(e),gh(t.stateNode,t.type,e))}}function Mv(t){io?oo?oo.push(t):oo=[t]:io=t}function Lv(){if(io){var t=io,e=oo;if(oo=io=null,Pm(t),e)for(t=0;t<e.length;t++)Pm(e[t])}}function Ov(t,e){return t(e)}function Vv(){}var xd=!1;function Fv(t,e,n){if(xd)return t(e,n);xd=!0;try{return Ov(t,e,n)}finally{xd=!1,(io!==null||oo!==null)&&(Vv(),Lv())}}function Wa(t,e){var n=t.stateNode;if(n===null)return null;var r=Mu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Q(231,e,typeof n));return n}var yh=!1;if($r)try{var ca={};Object.defineProperty(ca,"passive",{get:function(){yh=!0}}),window.addEventListener("test",ca,ca),window.removeEventListener("test",ca,ca)}catch{yh=!1}function P1(t,e,n,r,s,i,o,c,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(m){this.onError(m)}}var Aa=!1,zc=null,Uc=!1,vh=null,j1={onError:function(t){Aa=!0,zc=t}};function R1(t,e,n,r,s,i,o,c,u){Aa=!1,zc=null,P1.apply(j1,arguments)}function D1(t,e,n,r,s,i,o,c,u){if(R1.apply(this,arguments),Aa){if(Aa){var h=zc;Aa=!1,zc=null}else throw Error(Q(198));Uc||(Uc=!0,vh=h)}}function Ni(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function zv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function jm(t){if(Ni(t)!==t)throw Error(Q(188))}function M1(t){var e=t.alternate;if(!e){if(e=Ni(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return jm(s),t;if(i===r)return jm(s),e;i=i.sibling}throw Error(Q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?t:e}function Uv(t){return t=M1(t),t!==null?$v(t):null}function $v(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$v(t);if(e!==null)return e;t=t.sibling}return null}var Bv=kn.unstable_scheduleCallback,Rm=kn.unstable_cancelCallback,L1=kn.unstable_shouldYield,O1=kn.unstable_requestPaint,dt=kn.unstable_now,V1=kn.unstable_getCurrentPriorityLevel,Of=kn.unstable_ImmediatePriority,Wv=kn.unstable_UserBlockingPriority,$c=kn.unstable_NormalPriority,F1=kn.unstable_LowPriority,Hv=kn.unstable_IdlePriority,Pu=null,yr=null;function z1(t){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(Pu,t,void 0,(t.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:B1,U1=Math.log,$1=Math.LN2;function B1(t){return t>>>=0,t===0?32:31-(U1(t)/$1|0)|0}var Jl=64,Zl=4194304;function xa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=xa(c):(i&=o,i!==0&&(r=xa(i)))}else o=n&~s,o!==0?r=xa(o):i!==0&&(r=xa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yn(e),s=1<<n,r|=t[n],e&=~s;return r}function W1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function H1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Yn(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=W1(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function xh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Gv(){var t=Jl;return Jl<<=1,!(Jl&4194240)&&(Jl=64),t}function _d(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yn(e),t[e]=n}function G1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Yn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Vf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function qv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Kv,Ff,Qv,Yv,Xv,_h=!1,ec=[],Ts=null,Is=null,Ss=null,Ha=new Map,Ga=new Map,ms=[],q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dm(t,e){switch(t){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Ha.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ga.delete(e.pointerId)}}function ua(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=xl(e),e!==null&&Ff(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function K1(t,e,n,r,s){switch(e){case"focusin":return Ts=ua(Ts,t,e,n,r,s),!0;case"dragenter":return Is=ua(Is,t,e,n,r,s),!0;case"mouseover":return Ss=ua(Ss,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ha.set(i,ua(Ha.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ga.set(i,ua(Ga.get(i)||null,t,e,n,r,s)),!0}return!1}function Jv(t){var e=li(t.target);if(e!==null){var n=Ni(e);if(n!==null){if(e=n.tag,e===13){if(e=zv(n),e!==null){t.blockedOn=e,Xv(t.priority,function(){Qv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _c(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);mh=r,n.target.dispatchEvent(r),mh=null}else return e=xl(n),e!==null&&Ff(e),t.blockedOn=n,!1;e.shift()}return!0}function Mm(t,e,n){_c(t)&&n.delete(e)}function Q1(){_h=!1,Ts!==null&&_c(Ts)&&(Ts=null),Is!==null&&_c(Is)&&(Is=null),Ss!==null&&_c(Ss)&&(Ss=null),Ha.forEach(Mm),Ga.forEach(Mm)}function da(t,e){t.blockedOn===e&&(t.blockedOn=null,_h||(_h=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,Q1)))}function qa(t){function e(s){return da(s,t)}if(0<ec.length){da(ec[0],t);for(var n=1;n<ec.length;n++){var r=ec[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ts!==null&&da(Ts,t),Is!==null&&da(Is,t),Ss!==null&&da(Ss,t),Ha.forEach(e),Ga.forEach(e),n=0;n<ms.length;n++)r=ms[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ms.length&&(n=ms[0],n.blockedOn===null);)Jv(n),n.blockedOn===null&&ms.shift()}var ao=Jr.ReactCurrentBatchConfig,Wc=!0;function Y1(t,e,n,r){var s=De,i=ao.transition;ao.transition=null;try{De=1,zf(t,e,n,r)}finally{De=s,ao.transition=i}}function X1(t,e,n,r){var s=De,i=ao.transition;ao.transition=null;try{De=4,zf(t,e,n,r)}finally{De=s,ao.transition=i}}function zf(t,e,n,r){if(Wc){var s=wh(t,e,n,r);if(s===null)Cd(t,e,r,Hc,n),Dm(t,r);else if(K1(s,t,e,n,r))r.stopPropagation();else if(Dm(t,r),e&4&&-1<q1.indexOf(t)){for(;s!==null;){var i=xl(s);if(i!==null&&Kv(i),i=wh(t,e,n,r),i===null&&Cd(t,e,r,Hc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Cd(t,e,r,null,n)}}var Hc=null;function wh(t,e,n,r){if(Hc=null,t=Lf(r),t=li(t),t!==null)if(e=Ni(t),e===null)t=null;else if(n=e.tag,n===13){if(t=zv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hc=t,null}function Zv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(V1()){case Of:return 1;case Wv:return 4;case $c:case F1:return 16;case Hv:return 536870912;default:return 16}default:return 16}}var Es=null,Uf=null,wc=null;function e0(){if(wc)return wc;var t,e=Uf,n=e.length,r,s="value"in Es?Es.value:Es.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return wc=s.slice(t,1<r?1-r:void 0)}function Ec(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tc(){return!0}function Lm(){return!1}function In(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?tc:Lm,this.isPropagationStopped=Lm,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=tc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=tc)},persist:function(){},isPersistent:tc}),e}var Lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$f=In(Lo),vl=it({},Lo,{view:0,detail:0}),J1=In(vl),wd,Ed,ha,ju=it({},vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ha&&(ha&&t.type==="mousemove"?(wd=t.screenX-ha.screenX,Ed=t.screenY-ha.screenY):Ed=wd=0,ha=t),wd)},movementY:function(t){return"movementY"in t?t.movementY:Ed}}),Om=In(ju),Z1=it({},ju,{dataTransfer:0}),eE=In(Z1),tE=it({},vl,{relatedTarget:0}),bd=In(tE),nE=it({},Lo,{animationName:0,elapsedTime:0,pseudoElement:0}),rE=In(nE),sE=it({},Lo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iE=In(sE),oE=it({},Lo,{data:0}),Vm=In(oE),aE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cE[t])?!!e[t]:!1}function Bf(){return uE}var dE=it({},vl,{key:function(t){if(t.key){var e=aE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ec(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?lE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bf,charCode:function(t){return t.type==="keypress"?Ec(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ec(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hE=In(dE),fE=it({},ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fm=In(fE),pE=it({},vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bf}),mE=In(pE),gE=it({},Lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),yE=In(gE),vE=it({},ju,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xE=In(vE),_E=[9,13,27,32],Wf=$r&&"CompositionEvent"in window,Ca=null;$r&&"documentMode"in document&&(Ca=document.documentMode);var wE=$r&&"TextEvent"in window&&!Ca,t0=$r&&(!Wf||Ca&&8<Ca&&11>=Ca),zm=" ",Um=!1;function n0(t,e){switch(t){case"keyup":return _E.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qi=!1;function EE(t,e){switch(t){case"compositionend":return r0(e);case"keypress":return e.which!==32?null:(Um=!0,zm);case"textInput":return t=e.data,t===zm&&Um?null:t;default:return null}}function bE(t,e){if(qi)return t==="compositionend"||!Wf&&n0(t,e)?(t=e0(),wc=Uf=Es=null,qi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return t0&&e.locale!=="ko"?null:e.data;default:return null}}var kE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kE[t.type]:e==="textarea"}function s0(t,e,n,r){Mv(r),e=Gc(e,"onChange"),0<e.length&&(n=new $f("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Pa=null,Ka=null;function TE(t){m0(t,0)}function Ru(t){var e=Yi(t);if(Nv(e))return t}function IE(t,e){if(t==="change")return e}var i0=!1;if($r){var kd;if($r){var Td="oninput"in document;if(!Td){var Bm=document.createElement("div");Bm.setAttribute("oninput","return;"),Td=typeof Bm.oninput=="function"}kd=Td}else kd=!1;i0=kd&&(!document.documentMode||9<document.documentMode)}function Wm(){Pa&&(Pa.detachEvent("onpropertychange",o0),Ka=Pa=null)}function o0(t){if(t.propertyName==="value"&&Ru(Ka)){var e=[];s0(e,Ka,t,Lf(t)),Fv(TE,e)}}function SE(t,e,n){t==="focusin"?(Wm(),Pa=e,Ka=n,Pa.attachEvent("onpropertychange",o0)):t==="focusout"&&Wm()}function NE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ru(Ka)}function AE(t,e){if(t==="click")return Ru(e)}function CE(t,e){if(t==="input"||t==="change")return Ru(e)}function PE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jn=typeof Object.is=="function"?Object.is:PE;function Qa(t,e){if(Jn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!rh.call(e,s)||!Jn(t[s],e[s]))return!1}return!0}function Hm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gm(t,e){var n=Hm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hm(n)}}function a0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?a0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function l0(){for(var t=window,e=Fc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Fc(t.document)}return e}function Hf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jE(t){var e=l0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&a0(n.ownerDocument.documentElement,n)){if(r!==null&&Hf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Gm(n,i);var o=Gm(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var RE=$r&&"documentMode"in document&&11>=document.documentMode,Ki=null,Eh=null,ja=null,bh=!1;function qm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bh||Ki==null||Ki!==Fc(r)||(r=Ki,"selectionStart"in r&&Hf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ja&&Qa(ja,r)||(ja=r,r=Gc(Eh,"onSelect"),0<r.length&&(e=new $f("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ki)))}function nc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Qi={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},c0={};$r&&(c0=document.createElement("div").style,"AnimationEvent"in window||(delete Qi.animationend.animation,delete Qi.animationiteration.animation,delete Qi.animationstart.animation),"TransitionEvent"in window||delete Qi.transitionend.transition);function Du(t){if(Id[t])return Id[t];if(!Qi[t])return t;var e=Qi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in c0)return Id[t]=e[n];return t}var u0=Du("animationend"),d0=Du("animationiteration"),h0=Du("animationstart"),f0=Du("transitionend"),p0=new Map,Km="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bs(t,e){p0.set(t,e),Si(e,[t])}for(var Sd=0;Sd<Km.length;Sd++){var Nd=Km[Sd],DE=Nd.toLowerCase(),ME=Nd[0].toUpperCase()+Nd.slice(1);Bs(DE,"on"+ME)}Bs(u0,"onAnimationEnd");Bs(d0,"onAnimationIteration");Bs(h0,"onAnimationStart");Bs("dblclick","onDoubleClick");Bs("focusin","onFocus");Bs("focusout","onBlur");Bs(f0,"onTransitionEnd");go("onMouseEnter",["mouseout","mouseover"]);go("onMouseLeave",["mouseout","mouseover"]);go("onPointerEnter",["pointerout","pointerover"]);go("onPointerLeave",["pointerout","pointerover"]);Si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Si("onBeforeInput",["compositionend","keypress","textInput","paste"]);Si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LE=new Set("cancel close invalid load scroll toggle".split(" ").concat(_a));function Qm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,D1(r,e,void 0,t),t.currentTarget=null}function m0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,h=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Qm(s,c,h),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,h=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Qm(s,c,h),i=u}}}if(Uc)throw t=vh,Uc=!1,vh=null,t}function qe(t,e){var n=e[Nh];n===void 0&&(n=e[Nh]=new Set);var r=t+"__bubble";n.has(r)||(g0(e,t,2,!1),n.add(r))}function Ad(t,e,n){var r=0;e&&(r|=4),g0(n,t,r,e)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ya(t){if(!t[rc]){t[rc]=!0,bv.forEach(function(n){n!=="selectionchange"&&(LE.has(n)||Ad(n,!1,t),Ad(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[rc]||(e[rc]=!0,Ad("selectionchange",!1,e))}}function g0(t,e,n,r){switch(Zv(e)){case 1:var s=Y1;break;case 4:s=X1;break;default:s=zf}n=s.bind(null,e,n,t),s=void 0,!yh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Cd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=li(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}Fv(function(){var h=i,m=Lf(n),g=[];e:{var _=p0.get(t);if(_!==void 0){var C=$f,R=t;switch(t){case"keypress":if(Ec(n)===0)break e;case"keydown":case"keyup":C=hE;break;case"focusin":R="focus",C=bd;break;case"focusout":R="blur",C=bd;break;case"beforeblur":case"afterblur":C=bd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Om;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=eE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=mE;break;case u0:case d0:case h0:C=rE;break;case f0:C=yE;break;case"scroll":C=J1;break;case"wheel":C=xE;break;case"copy":case"cut":case"paste":C=iE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Fm}var M=(e&4)!==0,F=!M&&t==="scroll",A=M?_!==null?_+"Capture":null:_;M=[];for(var I=h,T;I!==null;){T=I;var k=T.stateNode;if(T.tag===5&&k!==null&&(T=k,A!==null&&(k=Wa(I,A),k!=null&&M.push(Xa(I,k,T)))),F)break;I=I.return}0<M.length&&(_=new C(_,R,null,n,m),g.push({event:_,listeners:M}))}}if(!(e&7)){e:{if(_=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",_&&n!==mh&&(R=n.relatedTarget||n.fromElement)&&(li(R)||R[Br]))break e;if((C||_)&&(_=m.window===m?m:(_=m.ownerDocument)?_.defaultView||_.parentWindow:window,C?(R=n.relatedTarget||n.toElement,C=h,R=R?li(R):null,R!==null&&(F=Ni(R),R!==F||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=h),C!==R)){if(M=Om,k="onMouseLeave",A="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(M=Fm,k="onPointerLeave",A="onPointerEnter",I="pointer"),F=C==null?_:Yi(C),T=R==null?_:Yi(R),_=new M(k,I+"leave",C,n,m),_.target=F,_.relatedTarget=T,k=null,li(m)===h&&(M=new M(A,I+"enter",R,n,m),M.target=T,M.relatedTarget=F,k=M),F=k,C&&R)t:{for(M=C,A=R,I=0,T=M;T;T=Ui(T))I++;for(T=0,k=A;k;k=Ui(k))T++;for(;0<I-T;)M=Ui(M),I--;for(;0<T-I;)A=Ui(A),T--;for(;I--;){if(M===A||A!==null&&M===A.alternate)break t;M=Ui(M),A=Ui(A)}M=null}else M=null;C!==null&&Ym(g,_,C,M,!1),R!==null&&F!==null&&Ym(g,F,R,M,!0)}}e:{if(_=h?Yi(h):window,C=_.nodeName&&_.nodeName.toLowerCase(),C==="select"||C==="input"&&_.type==="file")var O=IE;else if($m(_))if(i0)O=CE;else{O=NE;var W=SE}else(C=_.nodeName)&&C.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(O=AE);if(O&&(O=O(t,h))){s0(g,O,n,m);break e}W&&W(t,_,h),t==="focusout"&&(W=_._wrapperState)&&W.controlled&&_.type==="number"&&uh(_,"number",_.value)}switch(W=h?Yi(h):window,t){case"focusin":($m(W)||W.contentEditable==="true")&&(Ki=W,Eh=h,ja=null);break;case"focusout":ja=Eh=Ki=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,qm(g,n,m);break;case"selectionchange":if(RE)break;case"keydown":case"keyup":qm(g,n,m)}var b;if(Wf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else qi?n0(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(t0&&n.locale!=="ko"&&(qi||v!=="onCompositionStart"?v==="onCompositionEnd"&&qi&&(b=e0()):(Es=m,Uf="value"in Es?Es.value:Es.textContent,qi=!0)),W=Gc(h,v),0<W.length&&(v=new Vm(v,t,null,n,m),g.push({event:v,listeners:W}),b?v.data=b:(b=r0(n),b!==null&&(v.data=b)))),(b=wE?EE(t,n):bE(t,n))&&(h=Gc(h,"onBeforeInput"),0<h.length&&(m=new Vm("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:h}),m.data=b))}m0(g,e)})}function Xa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Wa(t,n),i!=null&&r.unshift(Xa(t,i,s)),i=Wa(t,e),i!=null&&r.push(Xa(t,i,s))),t=t.return}return r}function Ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ym(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,h=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&h!==null&&(c=h,s?(u=Wa(n,i),u!=null&&o.unshift(Xa(n,u,c))):s||(u=Wa(n,i),u!=null&&o.push(Xa(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var OE=/\r\n?/g,VE=/\u0000|\uFFFD/g;function Xm(t){return(typeof t=="string"?t:""+t).replace(OE,`
`).replace(VE,"")}function sc(t,e,n){if(e=Xm(e),Xm(t)!==e&&n)throw Error(Q(425))}function qc(){}var kh=null,Th=null;function Ih(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sh=typeof setTimeout=="function"?setTimeout:void 0,FE=typeof clearTimeout=="function"?clearTimeout:void 0,Jm=typeof Promise=="function"?Promise:void 0,zE=typeof queueMicrotask=="function"?queueMicrotask:typeof Jm<"u"?function(t){return Jm.resolve(null).then(t).catch(UE)}:Sh;function UE(t){setTimeout(function(){throw t})}function Pd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),qa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qa(e)}function Ns(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Oo=Math.random().toString(36).slice(2),fr="__reactFiber$"+Oo,Ja="__reactProps$"+Oo,Br="__reactContainer$"+Oo,Nh="__reactEvents$"+Oo,$E="__reactListeners$"+Oo,BE="__reactHandles$"+Oo;function li(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Br]||n[fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zm(t);t!==null;){if(n=t[fr])return n;t=Zm(t)}return e}t=n,n=t.parentNode}return null}function xl(t){return t=t[fr]||t[Br],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Mu(t){return t[Ja]||null}var Ah=[],Xi=-1;function Ws(t){return{current:t}}function Qe(t){0>Xi||(t.current=Ah[Xi],Ah[Xi]=null,Xi--)}function We(t,e){Xi++,Ah[Xi]=t.current,t.current=e}var Vs={},Qt=Ws(Vs),cn=Ws(!1),yi=Vs;function yo(t,e){var n=t.type.contextTypes;if(!n)return Vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function un(t){return t=t.childContextTypes,t!=null}function Kc(){Qe(cn),Qe(Qt)}function eg(t,e,n){if(Qt.current!==Vs)throw Error(Q(168));We(Qt,e),We(cn,n)}function y0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Q(108,S1(t)||"Unknown",s));return it({},n,r)}function Qc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vs,yi=Qt.current,We(Qt,t),We(cn,cn.current),!0}function tg(t,e,n){var r=t.stateNode;if(!r)throw Error(Q(169));n?(t=y0(t,e,yi),r.__reactInternalMemoizedMergedChildContext=t,Qe(cn),Qe(Qt),We(Qt,t)):Qe(cn),We(cn,n)}var Dr=null,Lu=!1,jd=!1;function v0(t){Dr===null?Dr=[t]:Dr.push(t)}function WE(t){Lu=!0,v0(t)}function Hs(){if(!jd&&Dr!==null){jd=!0;var t=0,e=De;try{var n=Dr;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Dr=null,Lu=!1}catch(s){throw Dr!==null&&(Dr=Dr.slice(t+1)),Bv(Of,Hs),s}finally{De=e,jd=!1}}return null}var Ji=[],Zi=0,Yc=null,Xc=0,Cn=[],Pn=0,vi=null,Mr=1,Lr="";function ii(t,e){Ji[Zi++]=Xc,Ji[Zi++]=Yc,Yc=t,Xc=e}function x0(t,e,n){Cn[Pn++]=Mr,Cn[Pn++]=Lr,Cn[Pn++]=vi,vi=t;var r=Mr;t=Lr;var s=32-Yn(r)-1;r&=~(1<<s),n+=1;var i=32-Yn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Mr=1<<32-Yn(e)+s|n<<s|r,Lr=i+t}else Mr=1<<i|n<<s|r,Lr=t}function Gf(t){t.return!==null&&(ii(t,1),x0(t,1,0))}function qf(t){for(;t===Yc;)Yc=Ji[--Zi],Ji[Zi]=null,Xc=Ji[--Zi],Ji[Zi]=null;for(;t===vi;)vi=Cn[--Pn],Cn[Pn]=null,Lr=Cn[--Pn],Cn[Pn]=null,Mr=Cn[--Pn],Cn[Pn]=null}var bn=null,En=null,Ye=!1,Kn=null;function _0(t,e){var n=Rn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ng(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,bn=t,En=Ns(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,bn=t,En=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vi!==null?{id:Mr,overflow:Lr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Rn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,bn=t,En=null,!0):!1;default:return!1}}function Ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ph(t){if(Ye){var e=En;if(e){var n=e;if(!ng(t,e)){if(Ch(t))throw Error(Q(418));e=Ns(n.nextSibling);var r=bn;e&&ng(t,e)?_0(r,n):(t.flags=t.flags&-4097|2,Ye=!1,bn=t)}}else{if(Ch(t))throw Error(Q(418));t.flags=t.flags&-4097|2,Ye=!1,bn=t}}}function rg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;bn=t}function ic(t){if(t!==bn)return!1;if(!Ye)return rg(t),Ye=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ih(t.type,t.memoizedProps)),e&&(e=En)){if(Ch(t))throw w0(),Error(Q(418));for(;e;)_0(t,e),e=Ns(e.nextSibling)}if(rg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){En=Ns(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}En=null}}else En=bn?Ns(t.stateNode.nextSibling):null;return!0}function w0(){for(var t=En;t;)t=Ns(t.nextSibling)}function vo(){En=bn=null,Ye=!1}function Kf(t){Kn===null?Kn=[t]:Kn.push(t)}var HE=Jr.ReactCurrentBatchConfig;function fa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,t))}return t}function oc(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sg(t){var e=t._init;return e(t._payload)}function E0(t){function e(A,I){if(t){var T=A.deletions;T===null?(A.deletions=[I],A.flags|=16):T.push(I)}}function n(A,I){if(!t)return null;for(;I!==null;)e(A,I),I=I.sibling;return null}function r(A,I){for(A=new Map;I!==null;)I.key!==null?A.set(I.key,I):A.set(I.index,I),I=I.sibling;return A}function s(A,I){return A=js(A,I),A.index=0,A.sibling=null,A}function i(A,I,T){return A.index=T,t?(T=A.alternate,T!==null?(T=T.index,T<I?(A.flags|=2,I):T):(A.flags|=2,I)):(A.flags|=1048576,I)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function c(A,I,T,k){return I===null||I.tag!==6?(I=Fd(T,A.mode,k),I.return=A,I):(I=s(I,T),I.return=A,I)}function u(A,I,T,k){var O=T.type;return O===Gi?m(A,I,T.props.children,k,T.key):I!==null&&(I.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===fs&&sg(O)===I.type)?(k=s(I,T.props),k.ref=fa(A,I,T),k.return=A,k):(k=Ac(T.type,T.key,T.props,null,A.mode,k),k.ref=fa(A,I,T),k.return=A,k)}function h(A,I,T,k){return I===null||I.tag!==4||I.stateNode.containerInfo!==T.containerInfo||I.stateNode.implementation!==T.implementation?(I=zd(T,A.mode,k),I.return=A,I):(I=s(I,T.children||[]),I.return=A,I)}function m(A,I,T,k,O){return I===null||I.tag!==7?(I=fi(T,A.mode,k,O),I.return=A,I):(I=s(I,T),I.return=A,I)}function g(A,I,T){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Fd(""+I,A.mode,T),I.return=A,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ql:return T=Ac(I.type,I.key,I.props,null,A.mode,T),T.ref=fa(A,null,I),T.return=A,T;case Hi:return I=zd(I,A.mode,T),I.return=A,I;case fs:var k=I._init;return g(A,k(I._payload),T)}if(va(I)||la(I))return I=fi(I,A.mode,T,null),I.return=A,I;oc(A,I)}return null}function _(A,I,T,k){var O=I!==null?I.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:c(A,I,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ql:return T.key===O?u(A,I,T,k):null;case Hi:return T.key===O?h(A,I,T,k):null;case fs:return O=T._init,_(A,I,O(T._payload),k)}if(va(T)||la(T))return O!==null?null:m(A,I,T,k,null);oc(A,T)}return null}function C(A,I,T,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return A=A.get(T)||null,c(I,A,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ql:return A=A.get(k.key===null?T:k.key)||null,u(I,A,k,O);case Hi:return A=A.get(k.key===null?T:k.key)||null,h(I,A,k,O);case fs:var W=k._init;return C(A,I,T,W(k._payload),O)}if(va(k)||la(k))return A=A.get(T)||null,m(I,A,k,O,null);oc(I,k)}return null}function R(A,I,T,k){for(var O=null,W=null,b=I,v=I=0,w=null;b!==null&&v<T.length;v++){b.index>v?(w=b,b=null):w=b.sibling;var E=_(A,b,T[v],k);if(E===null){b===null&&(b=w);break}t&&b&&E.alternate===null&&e(A,b),I=i(E,I,v),W===null?O=E:W.sibling=E,W=E,b=w}if(v===T.length)return n(A,b),Ye&&ii(A,v),O;if(b===null){for(;v<T.length;v++)b=g(A,T[v],k),b!==null&&(I=i(b,I,v),W===null?O=b:W.sibling=b,W=b);return Ye&&ii(A,v),O}for(b=r(A,b);v<T.length;v++)w=C(b,A,v,T[v],k),w!==null&&(t&&w.alternate!==null&&b.delete(w.key===null?v:w.key),I=i(w,I,v),W===null?O=w:W.sibling=w,W=w);return t&&b.forEach(function(P){return e(A,P)}),Ye&&ii(A,v),O}function M(A,I,T,k){var O=la(T);if(typeof O!="function")throw Error(Q(150));if(T=O.call(T),T==null)throw Error(Q(151));for(var W=O=null,b=I,v=I=0,w=null,E=T.next();b!==null&&!E.done;v++,E=T.next()){b.index>v?(w=b,b=null):w=b.sibling;var P=_(A,b,E.value,k);if(P===null){b===null&&(b=w);break}t&&b&&P.alternate===null&&e(A,b),I=i(P,I,v),W===null?O=P:W.sibling=P,W=P,b=w}if(E.done)return n(A,b),Ye&&ii(A,v),O;if(b===null){for(;!E.done;v++,E=T.next())E=g(A,E.value,k),E!==null&&(I=i(E,I,v),W===null?O=E:W.sibling=E,W=E);return Ye&&ii(A,v),O}for(b=r(A,b);!E.done;v++,E=T.next())E=C(b,A,v,E.value,k),E!==null&&(t&&E.alternate!==null&&b.delete(E.key===null?v:E.key),I=i(E,I,v),W===null?O=E:W.sibling=E,W=E);return t&&b.forEach(function(D){return e(A,D)}),Ye&&ii(A,v),O}function F(A,I,T,k){if(typeof T=="object"&&T!==null&&T.type===Gi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Ql:e:{for(var O=T.key,W=I;W!==null;){if(W.key===O){if(O=T.type,O===Gi){if(W.tag===7){n(A,W.sibling),I=s(W,T.props.children),I.return=A,A=I;break e}}else if(W.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===fs&&sg(O)===W.type){n(A,W.sibling),I=s(W,T.props),I.ref=fa(A,W,T),I.return=A,A=I;break e}n(A,W);break}else e(A,W);W=W.sibling}T.type===Gi?(I=fi(T.props.children,A.mode,k,T.key),I.return=A,A=I):(k=Ac(T.type,T.key,T.props,null,A.mode,k),k.ref=fa(A,I,T),k.return=A,A=k)}return o(A);case Hi:e:{for(W=T.key;I!==null;){if(I.key===W)if(I.tag===4&&I.stateNode.containerInfo===T.containerInfo&&I.stateNode.implementation===T.implementation){n(A,I.sibling),I=s(I,T.children||[]),I.return=A,A=I;break e}else{n(A,I);break}else e(A,I);I=I.sibling}I=zd(T,A.mode,k),I.return=A,A=I}return o(A);case fs:return W=T._init,F(A,I,W(T._payload),k)}if(va(T))return R(A,I,T,k);if(la(T))return M(A,I,T,k);oc(A,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,I!==null&&I.tag===6?(n(A,I.sibling),I=s(I,T),I.return=A,A=I):(n(A,I),I=Fd(T,A.mode,k),I.return=A,A=I),o(A)):n(A,I)}return F}var xo=E0(!0),b0=E0(!1),Jc=Ws(null),Zc=null,eo=null,Qf=null;function Yf(){Qf=eo=Zc=null}function Xf(t){var e=Jc.current;Qe(Jc),t._currentValue=e}function jh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function lo(t,e){Zc=t,Qf=eo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function Mn(t){var e=t._currentValue;if(Qf!==t)if(t={context:t,memoizedValue:e,next:null},eo===null){if(Zc===null)throw Error(Q(308));eo=t,Zc.dependencies={lanes:0,firstContext:t}}else eo=eo.next=t;return e}var ci=null;function Jf(t){ci===null?ci=[t]:ci.push(t)}function k0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Jf(e)):(n.next=s.next,s.next=n),e.interleaved=n,Wr(t,r)}function Wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ps=!1;function Zf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function T0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function As(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Wr(t,n)}return s=r.interleaved,s===null?(e.next=e,Jf(r)):(e.next=s.next,s.next=e),r.interleaved=e,Wr(t,n)}function bc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vf(t,n)}}function ig(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eu(t,e,n,r){var s=t.updateQueue;ps=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,h=u.next;u.next=null,o===null?i=h:o.next=h,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=h:c.next=h,m.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,m=h=u=null,c=i;do{var _=c.lane,C=c.eventTime;if((r&_)===_){m!==null&&(m=m.next={eventTime:C,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var R=t,M=c;switch(_=e,C=n,M.tag){case 1:if(R=M.payload,typeof R=="function"){g=R.call(C,g,_);break e}g=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=M.payload,_=typeof R=="function"?R.call(C,g,_):R,_==null)break e;g=it({},g,_);break e;case 2:ps=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,_=s.effects,_===null?s.effects=[c]:_.push(c))}else C={eventTime:C,lane:_,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(h=m=C,u=g):m=m.next=C,o|=_;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;_=c,c=_.next,_.next=null,s.lastBaseUpdate=_,s.shared.pending=null}}while(!0);if(m===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);_i|=o,t.lanes=o,t.memoizedState=g}}function og(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Q(191,s));s.call(r)}}}var _l={},vr=Ws(_l),Za=Ws(_l),el=Ws(_l);function ui(t){if(t===_l)throw Error(Q(174));return t}function ep(t,e){switch(We(el,e),We(Za,t),We(vr,_l),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hh(e,t)}Qe(vr),We(vr,e)}function _o(){Qe(vr),Qe(Za),Qe(el)}function I0(t){ui(el.current);var e=ui(vr.current),n=hh(e,t.type);e!==n&&(We(Za,t),We(vr,n))}function tp(t){Za.current===t&&(Qe(vr),Qe(Za))}var rt=Ws(0);function tu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rd=[];function np(){for(var t=0;t<Rd.length;t++)Rd[t]._workInProgressVersionPrimary=null;Rd.length=0}var kc=Jr.ReactCurrentDispatcher,Dd=Jr.ReactCurrentBatchConfig,xi=0,st=null,xt=null,kt=null,nu=!1,Ra=!1,tl=0,GE=0;function Bt(){throw Error(Q(321))}function rp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Jn(t[n],e[n]))return!1;return!0}function sp(t,e,n,r,s,i){if(xi=i,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kc.current=t===null||t.memoizedState===null?YE:XE,t=n(r,s),Ra){i=0;do{if(Ra=!1,tl=0,25<=i)throw Error(Q(301));i+=1,kt=xt=null,e.updateQueue=null,kc.current=JE,t=n(r,s)}while(Ra)}if(kc.current=ru,e=xt!==null&&xt.next!==null,xi=0,kt=xt=st=null,nu=!1,e)throw Error(Q(300));return t}function ip(){var t=tl!==0;return tl=0,t}function hr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?st.memoizedState=kt=t:kt=kt.next=t,kt}function Ln(){if(xt===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=xt.next;var e=kt===null?st.memoizedState:kt.next;if(e!==null)kt=e,xt=t;else{if(t===null)throw Error(Q(310));xt=t,t={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},kt===null?st.memoizedState=kt=t:kt=kt.next=t}return kt}function nl(t,e){return typeof e=="function"?e(t):e}function Md(t){var e=Ln(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=xt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,h=i;do{var m=h.lane;if((xi&m)===m)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,st.lanes|=m,_i|=m}h=h.next}while(h!==null&&h!==i);u===null?o=r:u.next=c,Jn(r,e.memoizedState)||(ln=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,st.lanes|=i,_i|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ld(t){var e=Ln(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Jn(i,e.memoizedState)||(ln=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function S0(){}function N0(t,e){var n=st,r=Ln(),s=e(),i=!Jn(r.memoizedState,s);if(i&&(r.memoizedState=s,ln=!0),r=r.queue,op(P0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||kt!==null&&kt.memoizedState.tag&1){if(n.flags|=2048,rl(9,C0.bind(null,n,r,s,e),void 0,null),It===null)throw Error(Q(349));xi&30||A0(n,e,s)}return s}function A0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function C0(t,e,n,r){e.value=n,e.getSnapshot=r,j0(e)&&R0(t)}function P0(t,e,n){return n(function(){j0(e)&&R0(t)})}function j0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Jn(t,n)}catch{return!0}}function R0(t){var e=Wr(t,1);e!==null&&Xn(e,t,1,-1)}function ag(t){var e=hr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nl,lastRenderedState:t},e.queue=t,t=t.dispatch=QE.bind(null,st,t),[e.memoizedState,t]}function rl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function D0(){return Ln().memoizedState}function Tc(t,e,n,r){var s=hr();st.flags|=t,s.memoizedState=rl(1|e,n,void 0,r===void 0?null:r)}function Ou(t,e,n,r){var s=Ln();r=r===void 0?null:r;var i=void 0;if(xt!==null){var o=xt.memoizedState;if(i=o.destroy,r!==null&&rp(r,o.deps)){s.memoizedState=rl(e,n,i,r);return}}st.flags|=t,s.memoizedState=rl(1|e,n,i,r)}function lg(t,e){return Tc(8390656,8,t,e)}function op(t,e){return Ou(2048,8,t,e)}function M0(t,e){return Ou(4,2,t,e)}function L0(t,e){return Ou(4,4,t,e)}function O0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function V0(t,e,n){return n=n!=null?n.concat([t]):null,Ou(4,4,O0.bind(null,e,t),n)}function ap(){}function F0(t,e){var n=Ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function z0(t,e){var n=Ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function U0(t,e,n){return xi&21?(Jn(n,e)||(n=Gv(),st.lanes|=n,_i|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=n)}function qE(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=Dd.transition;Dd.transition={};try{t(!1),e()}finally{De=n,Dd.transition=r}}function $0(){return Ln().memoizedState}function KE(t,e,n){var r=Ps(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},B0(t))W0(e,n);else if(n=k0(t,e,n,r),n!==null){var s=en();Xn(n,t,r,s),H0(n,e,r)}}function QE(t,e,n){var r=Ps(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(B0(t))W0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,Jn(c,o)){var u=e.interleaved;u===null?(s.next=s,Jf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=k0(t,e,s,r),n!==null&&(s=en(),Xn(n,t,r,s),H0(n,e,r))}}function B0(t){var e=t.alternate;return t===st||e!==null&&e===st}function W0(t,e){Ra=nu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function H0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vf(t,n)}}var ru={readContext:Mn,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},YE={readContext:Mn,useCallback:function(t,e){return hr().memoizedState=[t,e===void 0?null:e],t},useContext:Mn,useEffect:lg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Tc(4194308,4,O0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Tc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tc(4,2,t,e)},useMemo:function(t,e){var n=hr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=KE.bind(null,st,t),[r.memoizedState,t]},useRef:function(t){var e=hr();return t={current:t},e.memoizedState=t},useState:ag,useDebugValue:ap,useDeferredValue:function(t){return hr().memoizedState=t},useTransition:function(){var t=ag(!1),e=t[0];return t=qE.bind(null,t[1]),hr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=st,s=hr();if(Ye){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=e(),It===null)throw Error(Q(349));xi&30||A0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lg(P0.bind(null,r,i,t),[t]),r.flags|=2048,rl(9,C0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=hr(),e=It.identifierPrefix;if(Ye){var n=Lr,r=Mr;n=(r&~(1<<32-Yn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=tl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=GE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},XE={readContext:Mn,useCallback:F0,useContext:Mn,useEffect:op,useImperativeHandle:V0,useInsertionEffect:M0,useLayoutEffect:L0,useMemo:z0,useReducer:Md,useRef:D0,useState:function(){return Md(nl)},useDebugValue:ap,useDeferredValue:function(t){var e=Ln();return U0(e,xt.memoizedState,t)},useTransition:function(){var t=Md(nl)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:S0,useSyncExternalStore:N0,useId:$0,unstable_isNewReconciler:!1},JE={readContext:Mn,useCallback:F0,useContext:Mn,useEffect:op,useImperativeHandle:V0,useInsertionEffect:M0,useLayoutEffect:L0,useMemo:z0,useReducer:Ld,useRef:D0,useState:function(){return Ld(nl)},useDebugValue:ap,useDeferredValue:function(t){var e=Ln();return xt===null?e.memoizedState=t:U0(e,xt.memoizedState,t)},useTransition:function(){var t=Ld(nl)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:S0,useSyncExternalStore:N0,useId:$0,unstable_isNewReconciler:!1};function Gn(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Vu={isMounted:function(t){return(t=t._reactInternals)?Ni(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=en(),s=Ps(t),i=zr(r,s);i.payload=e,n!=null&&(i.callback=n),e=As(t,i,s),e!==null&&(Xn(e,t,s,r),bc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=en(),s=Ps(t),i=zr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=As(t,i,s),e!==null&&(Xn(e,t,s,r),bc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=en(),r=Ps(t),s=zr(n,r);s.tag=2,e!=null&&(s.callback=e),e=As(t,s,r),e!==null&&(Xn(e,t,r,n),bc(e,t,r))}};function cg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Qa(n,r)||!Qa(s,i):!0}function G0(t,e,n){var r=!1,s=Vs,i=e.contextType;return typeof i=="object"&&i!==null?i=Mn(i):(s=un(e)?yi:Qt.current,r=e.contextTypes,i=(r=r!=null)?yo(t,s):Vs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ug(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Vu.enqueueReplaceState(e,e.state,null)}function Dh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Zf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Mn(i):(i=un(e)?yi:Qt.current,s.context=yo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Rh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Vu.enqueueReplaceState(s,s.state,null),eu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function wo(t,e){try{var n="",r=e;do n+=I1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Od(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Mh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ZE=typeof WeakMap=="function"?WeakMap:Map;function q0(t,e,n){n=zr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){iu||(iu=!0,Hh=r),Mh(t,e)},n}function K0(t,e,n){n=zr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Mh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Mh(t,e),typeof r!="function"&&(Cs===null?Cs=new Set([this]):Cs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ZE;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=fb.bind(null,t,e,n),e.then(t,t))}function hg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zr(-1,1),e.tag=2,As(n,e,1))),n.lanes|=1),t)}var eb=Jr.ReactCurrentOwner,ln=!1;function Zt(t,e,n,r){e.child=t===null?b0(e,null,n,r):xo(e,t.child,n,r)}function pg(t,e,n,r,s){n=n.render;var i=e.ref;return lo(e,s),r=sp(t,e,n,r,i,s),n=ip(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Hr(t,e,s)):(Ye&&n&&Gf(e),e.flags|=1,Zt(t,e,r,s),e.child)}function mg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!mp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Q0(t,e,i,r,s)):(t=Ac(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qa,n(o,r)&&t.ref===e.ref)return Hr(t,e,s)}return e.flags|=1,t=js(i,r),t.ref=e.ref,t.return=e,e.child=t}function Q0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Qa(i,r)&&t.ref===e.ref)if(ln=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,Hr(t,e,s)}return Lh(t,e,n,r,s)}function Y0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(no,wn),wn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(no,wn),wn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,We(no,wn),wn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,We(no,wn),wn|=r;return Zt(t,e,s,n),e.child}function X0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Lh(t,e,n,r,s){var i=un(n)?yi:Qt.current;return i=yo(e,i),lo(e,s),n=sp(t,e,n,r,i,s),r=ip(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Hr(t,e,s)):(Ye&&r&&Gf(e),e.flags|=1,Zt(t,e,n,s),e.child)}function gg(t,e,n,r,s){if(un(n)){var i=!0;Qc(e)}else i=!1;if(lo(e,s),e.stateNode===null)Ic(t,e),G0(e,n,r),Dh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Mn(h):(h=un(n)?yi:Qt.current,h=yo(e,h));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==h)&&ug(e,o,r,h),ps=!1;var _=e.memoizedState;o.state=_,eu(e,r,o,s),u=e.memoizedState,c!==r||_!==u||cn.current||ps?(typeof m=="function"&&(Rh(e,n,m,r),u=e.memoizedState),(c=ps||cg(e,n,c,r,_,u,h))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,T0(t,e),c=e.memoizedProps,h=e.type===e.elementType?c:Gn(e.type,c),o.props=h,g=e.pendingProps,_=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Mn(u):(u=un(n)?yi:Qt.current,u=yo(e,u));var C=n.getDerivedStateFromProps;(m=typeof C=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||_!==u)&&ug(e,o,r,u),ps=!1,_=e.memoizedState,o.state=_,eu(e,r,o,s);var R=e.memoizedState;c!==g||_!==R||cn.current||ps?(typeof C=="function"&&(Rh(e,n,C,r),R=e.memoizedState),(h=ps||cg(e,n,h,r,_,R,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),r=!1)}return Oh(t,e,n,r,i,s)}function Oh(t,e,n,r,s,i){X0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tg(e,n,!1),Hr(t,e,i);r=e.stateNode,eb.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=xo(e,t.child,null,i),e.child=xo(e,null,c,i)):Zt(t,e,c,i),e.memoizedState=r.state,s&&tg(e,n,!0),e.child}function J0(t){var e=t.stateNode;e.pendingContext?eg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eg(t,e.context,!1),ep(t,e.containerInfo)}function yg(t,e,n,r,s){return vo(),Kf(s),e.flags|=256,Zt(t,e,n,r),e.child}var Vh={dehydrated:null,treeContext:null,retryLane:0};function Fh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z0(t,e,n){var r=e.pendingProps,s=rt.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),We(rt,s&1),t===null)return Ph(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Uu(o,r,0,null),t=fi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fh(n),e.memoizedState=Vh,t):lp(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return tb(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=js(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=js(c,i):(i=fi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Fh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Vh,r}return i=t.child,t=i.sibling,r=js(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function lp(t,e){return e=Uu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ac(t,e,n,r){return r!==null&&Kf(r),xo(e,t.child,null,n),t=lp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Od(Error(Q(422))),ac(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Uu({mode:"visible",children:r.children},s,0,null),i=fi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&xo(e,t.child,null,o),e.child.memoizedState=Fh(o),e.memoizedState=Vh,i);if(!(e.mode&1))return ac(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(Q(419)),r=Od(i,r,void 0),ac(t,e,o,r)}if(c=(o&t.childLanes)!==0,ln||c){if(r=It,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Wr(t,s),Xn(r,t,s,-1))}return pp(),r=Od(Error(Q(421))),ac(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=pb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,En=Ns(s.nextSibling),bn=e,Ye=!0,Kn=null,t!==null&&(Cn[Pn++]=Mr,Cn[Pn++]=Lr,Cn[Pn++]=vi,Mr=t.id,Lr=t.overflow,vi=e),e=lp(e,r.children),e.flags|=4096,e)}function vg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jh(t.return,e,n)}function Vd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ex(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Zt(t,e,r.children,n),r=rt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vg(t,n,e);else if(t.tag===19)vg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(We(rt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&tu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Vd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&tu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Vd(e,!0,n,null,i);break;case"together":Vd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ic(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_i|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,n=js(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=js(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function nb(t,e,n){switch(e.tag){case 3:J0(e),vo();break;case 5:I0(e);break;case 1:un(e.type)&&Qc(e);break;case 4:ep(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;We(Jc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(We(rt,rt.current&1),e.flags|=128,null):n&e.child.childLanes?Z0(t,e,n):(We(rt,rt.current&1),t=Hr(t,e,n),t!==null?t.sibling:null);We(rt,rt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ex(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),We(rt,rt.current),r)break;return null;case 22:case 23:return e.lanes=0,Y0(t,e,n)}return Hr(t,e,n)}var tx,zh,nx,rx;tx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zh=function(){};nx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ui(vr.current);var i=null;switch(n){case"input":s=lh(t,s),r=lh(t,r),i=[];break;case"select":s=it({},s,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":s=dh(t,s),r=dh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qc)}fh(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&($a.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==c&&(u!=null||c!=null))if(h==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&($a.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&qe("scroll",t),i||c===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};rx=function(t,e,n,r){n!==r&&(e.flags|=4)};function pa(t,e){if(!Ye)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Wt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function rb(t,e,n){var r=e.pendingProps;switch(qf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(e),null;case 1:return un(e.type)&&Kc(),Wt(e),null;case 3:return r=e.stateNode,_o(),Qe(cn),Qe(Qt),np(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ic(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kn!==null&&(Kh(Kn),Kn=null))),zh(t,e),Wt(e),null;case 5:tp(e);var s=ui(el.current);if(n=e.type,t!==null&&e.stateNode!=null)nx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Q(166));return Wt(e),null}if(t=ui(vr.current),ic(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[fr]=e,r[Ja]=i,t=(e.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(s=0;s<_a.length;s++)qe(_a[s],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":Sm(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":Am(r,i),qe("invalid",r)}fh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&sc(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&sc(r.textContent,c,t),s=["children",""+c]):$a.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&qe("scroll",r)}switch(n){case"input":Yl(r),Nm(r,i,!0);break;case"textarea":Yl(r),Cm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=qc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[fr]=e,t[Ja]=r,tx(t,e,!1,!1),e.stateNode=t;e:{switch(o=ph(n,r),n){case"dialog":qe("cancel",t),qe("close",t),s=r;break;case"iframe":case"object":case"embed":qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<_a.length;s++)qe(_a[s],t);s=r;break;case"source":qe("error",t),s=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),s=r;break;case"details":qe("toggle",t),s=r;break;case"input":Sm(t,r),s=lh(t,r),qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=it({},r,{value:void 0}),qe("invalid",t);break;case"textarea":Am(t,r),s=dh(t,r),qe("invalid",t);break;default:s=r}fh(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Dv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&jv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ba(t,u):typeof u=="number"&&Ba(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($a.hasOwnProperty(i)?u!=null&&i==="onScroll"&&qe("scroll",t):u!=null&&jf(t,i,u,o))}switch(n){case"input":Yl(t),Nm(t,r,!1);break;case"textarea":Yl(t),Cm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Os(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?so(t,!!r.multiple,i,!1):r.defaultValue!=null&&so(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wt(e),null;case 6:if(t&&e.stateNode!=null)rx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Q(166));if(n=ui(el.current),ui(vr.current),ic(e)){if(r=e.stateNode,n=e.memoizedProps,r[fr]=e,(i=r.nodeValue!==n)&&(t=bn,t!==null))switch(t.tag){case 3:sc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fr]=e,e.stateNode=r}return Wt(e),null;case 13:if(Qe(rt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ye&&En!==null&&e.mode&1&&!(e.flags&128))w0(),vo(),e.flags|=98560,i=!1;else if(i=ic(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[fr]=e}else vo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wt(e),i=!1}else Kn!==null&&(Kh(Kn),Kn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||rt.current&1?_t===0&&(_t=3):pp())),e.updateQueue!==null&&(e.flags|=4),Wt(e),null);case 4:return _o(),zh(t,e),t===null&&Ya(e.stateNode.containerInfo),Wt(e),null;case 10:return Xf(e.type._context),Wt(e),null;case 17:return un(e.type)&&Kc(),Wt(e),null;case 19:if(Qe(rt),i=e.memoizedState,i===null)return Wt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)pa(i,!1);else{if(_t!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tu(t),o!==null){for(e.flags|=128,pa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return We(rt,rt.current&1|2),e.child}t=t.sibling}i.tail!==null&&dt()>Eo&&(e.flags|=128,r=!0,pa(i,!1),e.lanes=4194304)}else{if(!r)if(t=tu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),pa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ye)return Wt(e),null}else 2*dt()-i.renderingStartTime>Eo&&n!==1073741824&&(e.flags|=128,r=!0,pa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=dt(),e.sibling=null,n=rt.current,We(rt,r?n&1|2:n&1),e):(Wt(e),null);case 22:case 23:return fp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?wn&1073741824&&(Wt(e),e.subtreeFlags&6&&(e.flags|=8192)):Wt(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function sb(t,e){switch(qf(e),e.tag){case 1:return un(e.type)&&Kc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _o(),Qe(cn),Qe(Qt),np(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return tp(e),null;case 13:if(Qe(rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));vo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(rt),null;case 4:return _o(),null;case 10:return Xf(e.type._context),null;case 22:case 23:return fp(),null;case 24:return null;default:return null}}var lc=!1,qt=!1,ib=typeof WeakSet=="function"?WeakSet:Set,ne=null;function to(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ct(t,e,r)}else n.current=null}function Uh(t,e,n){try{n()}catch(r){ct(t,e,r)}}var xg=!1;function ob(t,e){if(kh=Wc,t=l0(),Hf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,h=0,m=0,g=t,_=null;t:for(;;){for(var C;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(C=g.firstChild)!==null;)_=g,g=C;for(;;){if(g===t)break t;if(_===n&&++h===s&&(c=o),_===i&&++m===r&&(u=o),(C=g.nextSibling)!==null)break;g=_,_=g.parentNode}g=C}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Th={focusedElem:t,selectionRange:n},Wc=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var M=R.memoizedProps,F=R.memoizedState,A=e.stateNode,I=A.getSnapshotBeforeUpdate(e.elementType===e.type?M:Gn(e.type,M),F);A.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(k){ct(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return R=xg,xg=!1,R}function Da(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Uh(e,n,i)}s=s.next}while(s!==r)}}function Fu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function $h(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function sx(t){var e=t.alternate;e!==null&&(t.alternate=null,sx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fr],delete e[Ja],delete e[Nh],delete e[$E],delete e[BE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ix(t){return t.tag===5||t.tag===3||t.tag===4}function _g(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ix(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qc));else if(r!==4&&(t=t.child,t!==null))for(Bh(t,e,n),t=t.sibling;t!==null;)Bh(t,e,n),t=t.sibling}function Wh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wh(t,e,n),t=t.sibling;t!==null;)Wh(t,e,n),t=t.sibling}var Pt=null,qn=!1;function ds(t,e,n){for(n=n.child;n!==null;)ox(t,e,n),n=n.sibling}function ox(t,e,n){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(Pu,n)}catch{}switch(n.tag){case 5:qt||to(n,e);case 6:var r=Pt,s=qn;Pt=null,ds(t,e,n),Pt=r,qn=s,Pt!==null&&(qn?(t=Pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(qn?(t=Pt,n=n.stateNode,t.nodeType===8?Pd(t.parentNode,n):t.nodeType===1&&Pd(t,n),qa(t)):Pd(Pt,n.stateNode));break;case 4:r=Pt,s=qn,Pt=n.stateNode.containerInfo,qn=!0,ds(t,e,n),Pt=r,qn=s;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Uh(n,e,o),s=s.next}while(s!==r)}ds(t,e,n);break;case 1:if(!qt&&(to(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){ct(n,e,c)}ds(t,e,n);break;case 21:ds(t,e,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,ds(t,e,n),qt=r):ds(t,e,n);break;default:ds(t,e,n)}}function wg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ib),e.forEach(function(r){var s=mb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Pt=c.stateNode,qn=!1;break e;case 3:Pt=c.stateNode.containerInfo,qn=!0;break e;case 4:Pt=c.stateNode.containerInfo,qn=!0;break e}c=c.return}if(Pt===null)throw Error(Q(160));ox(i,o,s),Pt=null,qn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){ct(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ax(e,t),e=e.sibling}function ax(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hn(e,t),dr(t),r&4){try{Da(3,t,t.return),Fu(3,t)}catch(M){ct(t,t.return,M)}try{Da(5,t,t.return)}catch(M){ct(t,t.return,M)}}break;case 1:Hn(e,t),dr(t),r&512&&n!==null&&to(n,n.return);break;case 5:if(Hn(e,t),dr(t),r&512&&n!==null&&to(n,n.return),t.flags&32){var s=t.stateNode;try{Ba(s,"")}catch(M){ct(t,t.return,M)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Av(s,i),ph(c,o);var h=ph(c,i);for(o=0;o<u.length;o+=2){var m=u[o],g=u[o+1];m==="style"?Dv(s,g):m==="dangerouslySetInnerHTML"?jv(s,g):m==="children"?Ba(s,g):jf(s,m,g,h)}switch(c){case"input":ch(s,i);break;case"textarea":Cv(s,i);break;case"select":var _=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?so(s,!!i.multiple,C,!1):_!==!!i.multiple&&(i.defaultValue!=null?so(s,!!i.multiple,i.defaultValue,!0):so(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ja]=i}catch(M){ct(t,t.return,M)}}break;case 6:if(Hn(e,t),dr(t),r&4){if(t.stateNode===null)throw Error(Q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(M){ct(t,t.return,M)}}break;case 3:if(Hn(e,t),dr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qa(e.containerInfo)}catch(M){ct(t,t.return,M)}break;case 4:Hn(e,t),dr(t);break;case 13:Hn(e,t),dr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(dp=dt())),r&4&&wg(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(qt=(h=qt)||m,Hn(e,t),qt=h):Hn(e,t),dr(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!m&&t.mode&1)for(ne=t,m=t.child;m!==null;){for(g=ne=m;ne!==null;){switch(_=ne,C=_.child,_.tag){case 0:case 11:case 14:case 15:Da(4,_,_.return);break;case 1:to(_,_.return);var R=_.stateNode;if(typeof R.componentWillUnmount=="function"){r=_,n=_.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(M){ct(r,n,M)}}break;case 5:to(_,_.return);break;case 22:if(_.memoizedState!==null){bg(g);continue}}C!==null?(C.return=_,ne=C):bg(g)}m=m.sibling}e:for(m=null,g=t;;){if(g.tag===5){if(m===null){m=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Rv("display",o))}catch(M){ct(t,t.return,M)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(M){ct(t,t.return,M)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Hn(e,t),dr(t),r&4&&wg(t);break;case 21:break;default:Hn(e,t),dr(t)}}function dr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ix(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ba(s,""),r.flags&=-33);var i=_g(t);Wh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=_g(t);Bh(t,c,o);break;default:throw Error(Q(161))}}catch(u){ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ab(t,e,n){ne=t,lx(t)}function lx(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||lc;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||qt;c=lc;var h=qt;if(lc=o,(qt=u)&&!h)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?kg(s):u!==null?(u.return=o,ne=u):kg(s);for(;i!==null;)ne=i,lx(i),i=i.sibling;ne=s,lc=c,qt=h}Eg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):Eg(t)}}function Eg(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qt||Fu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Gn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&og(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}og(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&qa(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}qt||e.flags&512&&$h(e)}catch(_){ct(e,e.return,_)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function bg(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function kg(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fu(4,e)}catch(u){ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){ct(e,s,u)}}var i=e.return;try{$h(e)}catch(u){ct(e,i,u)}break;case 5:var o=e.return;try{$h(e)}catch(u){ct(e,o,u)}}}catch(u){ct(e,e.return,u)}if(e===t){ne=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ne=c;break}ne=e.return}}var lb=Math.ceil,su=Jr.ReactCurrentDispatcher,cp=Jr.ReactCurrentOwner,Dn=Jr.ReactCurrentBatchConfig,Ne=0,It=null,mt=null,Mt=0,wn=0,no=Ws(0),_t=0,sl=null,_i=0,zu=0,up=0,Ma=null,an=null,dp=0,Eo=1/0,Rr=null,iu=!1,Hh=null,Cs=null,cc=!1,bs=null,ou=0,La=0,Gh=null,Sc=-1,Nc=0;function en(){return Ne&6?dt():Sc!==-1?Sc:Sc=dt()}function Ps(t){return t.mode&1?Ne&2&&Mt!==0?Mt&-Mt:HE.transition!==null?(Nc===0&&(Nc=Gv()),Nc):(t=De,t!==0||(t=window.event,t=t===void 0?16:Zv(t.type)),t):1}function Xn(t,e,n,r){if(50<La)throw La=0,Gh=null,Error(Q(185));yl(t,n,r),(!(Ne&2)||t!==It)&&(t===It&&(!(Ne&2)&&(zu|=n),_t===4&&gs(t,Mt)),dn(t,r),n===1&&Ne===0&&!(e.mode&1)&&(Eo=dt()+500,Lu&&Hs()))}function dn(t,e){var n=t.callbackNode;H1(t,e);var r=Bc(t,t===It?Mt:0);if(r===0)n!==null&&Rm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Rm(n),e===1)t.tag===0?WE(Tg.bind(null,t)):v0(Tg.bind(null,t)),zE(function(){!(Ne&6)&&Hs()}),n=null;else{switch(qv(r)){case 1:n=Of;break;case 4:n=Wv;break;case 16:n=$c;break;case 536870912:n=Hv;break;default:n=$c}n=gx(n,cx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function cx(t,e){if(Sc=-1,Nc=0,Ne&6)throw Error(Q(327));var n=t.callbackNode;if(co()&&t.callbackNode!==n)return null;var r=Bc(t,t===It?Mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=au(t,r);else{e=r;var s=Ne;Ne|=2;var i=dx();(It!==t||Mt!==e)&&(Rr=null,Eo=dt()+500,hi(t,e));do try{db();break}catch(c){ux(t,c)}while(!0);Yf(),su.current=i,Ne=s,mt!==null?e=0:(It=null,Mt=0,e=_t)}if(e!==0){if(e===2&&(s=xh(t),s!==0&&(r=s,e=qh(t,s))),e===1)throw n=sl,hi(t,0),gs(t,r),dn(t,dt()),n;if(e===6)gs(t,r);else{if(s=t.current.alternate,!(r&30)&&!cb(s)&&(e=au(t,r),e===2&&(i=xh(t),i!==0&&(r=i,e=qh(t,i))),e===1))throw n=sl,hi(t,0),gs(t,r),dn(t,dt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Q(345));case 2:oi(t,an,Rr);break;case 3:if(gs(t,r),(r&130023424)===r&&(e=dp+500-dt(),10<e)){if(Bc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){en(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sh(oi.bind(null,t,an,Rr),e);break}oi(t,an,Rr);break;case 4:if(gs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Yn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lb(r/1960))-r,10<r){t.timeoutHandle=Sh(oi.bind(null,t,an,Rr),r);break}oi(t,an,Rr);break;case 5:oi(t,an,Rr);break;default:throw Error(Q(329))}}}return dn(t,dt()),t.callbackNode===n?cx.bind(null,t):null}function qh(t,e){var n=Ma;return t.current.memoizedState.isDehydrated&&(hi(t,e).flags|=256),t=au(t,e),t!==2&&(e=an,an=n,e!==null&&Kh(e)),t}function Kh(t){an===null?an=t:an.push.apply(an,t)}function cb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Jn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gs(t,e){for(e&=~up,e&=~zu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yn(e),r=1<<n;t[n]=-1,e&=~r}}function Tg(t){if(Ne&6)throw Error(Q(327));co();var e=Bc(t,0);if(!(e&1))return dn(t,dt()),null;var n=au(t,e);if(t.tag!==0&&n===2){var r=xh(t);r!==0&&(e=r,n=qh(t,r))}if(n===1)throw n=sl,hi(t,0),gs(t,e),dn(t,dt()),n;if(n===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,oi(t,an,Rr),dn(t,dt()),null}function hp(t,e){var n=Ne;Ne|=1;try{return t(e)}finally{Ne=n,Ne===0&&(Eo=dt()+500,Lu&&Hs())}}function wi(t){bs!==null&&bs.tag===0&&!(Ne&6)&&co();var e=Ne;Ne|=1;var n=Dn.transition,r=De;try{if(Dn.transition=null,De=1,t)return t()}finally{De=r,Dn.transition=n,Ne=e,!(Ne&6)&&Hs()}}function fp(){wn=no.current,Qe(no)}function hi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,FE(n)),mt!==null)for(n=mt.return;n!==null;){var r=n;switch(qf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Kc();break;case 3:_o(),Qe(cn),Qe(Qt),np();break;case 5:tp(r);break;case 4:_o();break;case 13:Qe(rt);break;case 19:Qe(rt);break;case 10:Xf(r.type._context);break;case 22:case 23:fp()}n=n.return}if(It=t,mt=t=js(t.current,null),Mt=wn=e,_t=0,sl=null,up=zu=_i=0,an=Ma=null,ci!==null){for(e=0;e<ci.length;e++)if(n=ci[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ci=null}return t}function ux(t,e){do{var n=mt;try{if(Yf(),kc.current=ru,nu){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}nu=!1}if(xi=0,kt=xt=st=null,Ra=!1,tl=0,cp.current=null,n===null||n.return===null){_t=1,sl=e,mt=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=Mt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,m=c,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var _=m.alternate;_?(m.updateQueue=_.updateQueue,m.memoizedState=_.memoizedState,m.lanes=_.lanes):(m.updateQueue=null,m.memoizedState=null)}var C=hg(o);if(C!==null){C.flags&=-257,fg(C,o,c,i,e),C.mode&1&&dg(i,h,e),e=C,u=h;var R=e.updateQueue;if(R===null){var M=new Set;M.add(u),e.updateQueue=M}else R.add(u);break e}else{if(!(e&1)){dg(i,h,e),pp();break e}u=Error(Q(426))}}else if(Ye&&c.mode&1){var F=hg(o);if(F!==null){!(F.flags&65536)&&(F.flags|=256),fg(F,o,c,i,e),Kf(wo(u,c));break e}}i=u=wo(u,c),_t!==4&&(_t=2),Ma===null?Ma=[i]:Ma.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=q0(i,u,e);ig(i,A);break e;case 1:c=u;var I=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Cs===null||!Cs.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=K0(i,c,e);ig(i,k);break e}}i=i.return}while(i!==null)}fx(n)}catch(O){e=O,mt===n&&n!==null&&(mt=n=n.return);continue}break}while(!0)}function dx(){var t=su.current;return su.current=ru,t===null?ru:t}function pp(){(_t===0||_t===3||_t===2)&&(_t=4),It===null||!(_i&268435455)&&!(zu&268435455)||gs(It,Mt)}function au(t,e){var n=Ne;Ne|=2;var r=dx();(It!==t||Mt!==e)&&(Rr=null,hi(t,e));do try{ub();break}catch(s){ux(t,s)}while(!0);if(Yf(),Ne=n,su.current=r,mt!==null)throw Error(Q(261));return It=null,Mt=0,_t}function ub(){for(;mt!==null;)hx(mt)}function db(){for(;mt!==null&&!L1();)hx(mt)}function hx(t){var e=mx(t.alternate,t,wn);t.memoizedProps=t.pendingProps,e===null?fx(t):mt=e,cp.current=null}function fx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=sb(n,e),n!==null){n.flags&=32767,mt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_t=6,mt=null;return}}else if(n=rb(n,e,wn),n!==null){mt=n;return}if(e=e.sibling,e!==null){mt=e;return}mt=e=t}while(e!==null);_t===0&&(_t=5)}function oi(t,e,n){var r=De,s=Dn.transition;try{Dn.transition=null,De=1,hb(t,e,n,r)}finally{Dn.transition=s,De=r}return null}function hb(t,e,n,r){do co();while(bs!==null);if(Ne&6)throw Error(Q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(G1(t,i),t===It&&(mt=It=null,Mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||cc||(cc=!0,gx($c,function(){return co(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Dn.transition,Dn.transition=null;var o=De;De=1;var c=Ne;Ne|=4,cp.current=null,ob(t,n),ax(n,t),jE(Th),Wc=!!kh,Th=kh=null,t.current=n,ab(n),O1(),Ne=c,De=o,Dn.transition=i}else t.current=n;if(cc&&(cc=!1,bs=t,ou=s),i=t.pendingLanes,i===0&&(Cs=null),z1(n.stateNode),dn(t,dt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(iu)throw iu=!1,t=Hh,Hh=null,t;return ou&1&&t.tag!==0&&co(),i=t.pendingLanes,i&1?t===Gh?La++:(La=0,Gh=t):La=0,Hs(),null}function co(){if(bs!==null){var t=qv(ou),e=Dn.transition,n=De;try{if(Dn.transition=null,De=16>t?16:t,bs===null)var r=!1;else{if(t=bs,bs=null,ou=0,Ne&6)throw Error(Q(331));var s=Ne;for(Ne|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var h=c[u];for(ne=h;ne!==null;){var m=ne;switch(m.tag){case 0:case 11:case 15:Da(8,m,i)}var g=m.child;if(g!==null)g.return=m,ne=g;else for(;ne!==null;){m=ne;var _=m.sibling,C=m.return;if(sx(m),m===h){ne=null;break}if(_!==null){_.return=C,ne=_;break}ne=C}}}var R=i.alternate;if(R!==null){var M=R.child;if(M!==null){R.child=null;do{var F=M.sibling;M.sibling=null,M=F}while(M!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Da(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,ne=A;break e}ne=i.return}}var I=t.current;for(ne=I;ne!==null;){o=ne;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ne=T;else e:for(o=I;ne!==null;){if(c=ne,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Fu(9,c)}}catch(O){ct(c,c.return,O)}if(c===o){ne=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,ne=k;break e}ne=c.return}}if(Ne=s,Hs(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(Pu,t)}catch{}r=!0}return r}finally{De=n,Dn.transition=e}}return!1}function Ig(t,e,n){e=wo(n,e),e=q0(t,e,1),t=As(t,e,1),e=en(),t!==null&&(yl(t,1,e),dn(t,e))}function ct(t,e,n){if(t.tag===3)Ig(t,t,n);else for(;e!==null;){if(e.tag===3){Ig(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cs===null||!Cs.has(r))){t=wo(n,t),t=K0(e,t,1),e=As(e,t,1),t=en(),e!==null&&(yl(e,1,t),dn(e,t));break}}e=e.return}}function fb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=en(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Mt&n)===n&&(_t===4||_t===3&&(Mt&130023424)===Mt&&500>dt()-dp?hi(t,0):up|=n),dn(t,e)}function px(t,e){e===0&&(t.mode&1?(e=Zl,Zl<<=1,!(Zl&130023424)&&(Zl=4194304)):e=1);var n=en();t=Wr(t,e),t!==null&&(yl(t,e,n),dn(t,n))}function pb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),px(t,n)}function mb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(e),px(t,n)}var mx;mx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ln=!1,nb(t,e,n);ln=!!(t.flags&131072)}else ln=!1,Ye&&e.flags&1048576&&x0(e,Xc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ic(t,e),t=e.pendingProps;var s=yo(e,Qt.current);lo(e,n),s=sp(null,e,r,t,s,n);var i=ip();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(r)?(i=!0,Qc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Zf(e),s.updater=Vu,e.stateNode=s,s._reactInternals=e,Dh(e,r,t,n),e=Oh(null,e,r,!0,i,n)):(e.tag=0,Ye&&i&&Gf(e),Zt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ic(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=yb(r),t=Gn(r,t),s){case 0:e=Lh(null,e,r,t,n);break e;case 1:e=gg(null,e,r,t,n);break e;case 11:e=pg(null,e,r,t,n);break e;case 14:e=mg(null,e,r,Gn(r.type,t),n);break e}throw Error(Q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gn(r,s),Lh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gn(r,s),gg(t,e,r,s,n);case 3:e:{if(J0(e),t===null)throw Error(Q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,T0(t,e),eu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=wo(Error(Q(423)),e),e=yg(t,e,r,n,s);break e}else if(r!==s){s=wo(Error(Q(424)),e),e=yg(t,e,r,n,s);break e}else for(En=Ns(e.stateNode.containerInfo.firstChild),bn=e,Ye=!0,Kn=null,n=b0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vo(),r===s){e=Hr(t,e,n);break e}Zt(t,e,r,n)}e=e.child}return e;case 5:return I0(e),t===null&&Ph(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ih(r,s)?o=null:i!==null&&Ih(r,i)&&(e.flags|=32),X0(t,e),Zt(t,e,o,n),e.child;case 6:return t===null&&Ph(e),null;case 13:return Z0(t,e,n);case 4:return ep(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=xo(e,null,r,n):Zt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gn(r,s),pg(t,e,r,s,n);case 7:return Zt(t,e,e.pendingProps,n),e.child;case 8:return Zt(t,e,e.pendingProps.children,n),e.child;case 12:return Zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,We(Jc,r._currentValue),r._currentValue=o,i!==null)if(Jn(i.value,o)){if(i.children===s.children&&!cn.current){e=Hr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=zr(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?u.next=u:(u.next=m.next,m.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),jh(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Q(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),jh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Zt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,lo(e,n),s=Mn(s),r=r(s),e.flags|=1,Zt(t,e,r,n),e.child;case 14:return r=e.type,s=Gn(r,e.pendingProps),s=Gn(r.type,s),mg(t,e,r,s,n);case 15:return Q0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gn(r,s),Ic(t,e),e.tag=1,un(r)?(t=!0,Qc(e)):t=!1,lo(e,n),G0(e,r,s),Dh(e,r,s,n),Oh(null,e,r,!0,t,n);case 19:return ex(t,e,n);case 22:return Y0(t,e,n)}throw Error(Q(156,e.tag))};function gx(t,e){return Bv(t,e)}function gb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(t,e,n,r){return new gb(t,e,n,r)}function mp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yb(t){if(typeof t=="function")return mp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Df)return 11;if(t===Mf)return 14}return 2}function js(t,e){var n=t.alternate;return n===null?(n=Rn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ac(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")mp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Gi:return fi(n.children,s,i,e);case Rf:o=8,s|=8;break;case sh:return t=Rn(12,n,e,s|2),t.elementType=sh,t.lanes=i,t;case ih:return t=Rn(13,n,e,s),t.elementType=ih,t.lanes=i,t;case oh:return t=Rn(19,n,e,s),t.elementType=oh,t.lanes=i,t;case Iv:return Uu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case kv:o=10;break e;case Tv:o=9;break e;case Df:o=11;break e;case Mf:o=14;break e;case fs:o=16,r=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=Rn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function fi(t,e,n,r){return t=Rn(7,t,r,e),t.lanes=n,t}function Uu(t,e,n,r){return t=Rn(22,t,r,e),t.elementType=Iv,t.lanes=n,t.stateNode={isHidden:!1},t}function Fd(t,e,n){return t=Rn(6,t,null,e),t.lanes=n,t}function zd(t,e,n){return e=Rn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function vb(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_d(0),this.expirationTimes=_d(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_d(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function gp(t,e,n,r,s,i,o,c,u){return t=new vb(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Rn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zf(i),t}function xb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function yx(t){if(!t)return Vs;t=t._reactInternals;e:{if(Ni(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var n=t.type;if(un(n))return y0(t,n,e)}return e}function vx(t,e,n,r,s,i,o,c,u){return t=gp(n,r,!0,t,s,i,o,c,u),t.context=yx(null),n=t.current,r=en(),s=Ps(n),i=zr(r,s),i.callback=e??null,As(n,i,s),t.current.lanes=s,yl(t,s,r),dn(t,r),t}function $u(t,e,n,r){var s=e.current,i=en(),o=Ps(s);return n=yx(n),e.context===null?e.context=n:e.pendingContext=n,e=zr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=As(s,e,o),t!==null&&(Xn(t,s,o,i),bc(t,s,o)),o}function lu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Sg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function yp(t,e){Sg(t,e),(t=t.alternate)&&Sg(t,e)}function _b(){return null}var xx=typeof reportError=="function"?reportError:function(t){console.error(t)};function vp(t){this._internalRoot=t}Bu.prototype.render=vp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));$u(t,e,null,null)};Bu.prototype.unmount=vp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wi(function(){$u(null,t,null,null)}),e[Br]=null}};function Bu(t){this._internalRoot=t}Bu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ms.length&&e!==0&&e<ms[n].priority;n++);ms.splice(n,0,t),n===0&&Jv(t)}};function xp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ng(){}function wb(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=lu(o);i.call(h)}}var o=vx(e,r,t,0,null,!1,!1,"",Ng);return t._reactRootContainer=o,t[Br]=o.current,Ya(t.nodeType===8?t.parentNode:t),wi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=lu(u);c.call(h)}}var u=gp(t,0,!1,null,null,!1,!1,"",Ng);return t._reactRootContainer=u,t[Br]=u.current,Ya(t.nodeType===8?t.parentNode:t),wi(function(){$u(e,u,n,r)}),u}function Hu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=lu(o);c.call(u)}}$u(e,o,t,s)}else o=wb(n,e,t,s,r);return lu(o)}Kv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xa(e.pendingLanes);n!==0&&(Vf(e,n|1),dn(e,dt()),!(Ne&6)&&(Eo=dt()+500,Hs()))}break;case 13:wi(function(){var r=Wr(t,1);if(r!==null){var s=en();Xn(r,t,1,s)}}),yp(t,1)}};Ff=function(t){if(t.tag===13){var e=Wr(t,134217728);if(e!==null){var n=en();Xn(e,t,134217728,n)}yp(t,134217728)}};Qv=function(t){if(t.tag===13){var e=Ps(t),n=Wr(t,e);if(n!==null){var r=en();Xn(n,t,e,r)}yp(t,e)}};Yv=function(){return De};Xv=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};gh=function(t,e,n){switch(e){case"input":if(ch(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Mu(r);if(!s)throw Error(Q(90));Nv(r),ch(r,s)}}}break;case"textarea":Cv(t,n);break;case"select":e=n.value,e!=null&&so(t,!!n.multiple,e,!1)}};Ov=hp;Vv=wi;var Eb={usingClientEntryPoint:!1,Events:[xl,Yi,Mu,Mv,Lv,hp]},ma={findFiberByHostInstance:li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bb={bundleType:ma.bundleType,version:ma.version,rendererPackageName:ma.rendererPackageName,rendererConfig:ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Uv(t),t===null?null:t.stateNode},findFiberByHostInstance:ma.findFiberByHostInstance||_b,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uc.isDisabled&&uc.supportsFiber)try{Pu=uc.inject(bb),yr=uc}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Eb;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xp(e))throw Error(Q(200));return xb(t,e,null,n)};Tn.createRoot=function(t,e){if(!xp(t))throw Error(Q(299));var n=!1,r="",s=xx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=gp(t,1,!1,null,null,n,!1,r,s),t[Br]=e.current,Ya(t.nodeType===8?t.parentNode:t),new vp(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=Uv(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return wi(t)};Tn.hydrate=function(t,e,n){if(!Wu(e))throw Error(Q(200));return Hu(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!xp(t))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=xx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=vx(e,null,t,1,n??null,s,!1,i,o),t[Br]=e.current,Ya(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Bu(e)};Tn.render=function(t,e,n){if(!Wu(e))throw Error(Q(200));return Hu(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!Wu(t))throw Error(Q(40));return t._reactRootContainer?(wi(function(){Hu(null,null,t,!1,function(){t._reactRootContainer=null,t[Br]=null})}),!0):!1};Tn.unstable_batchedUpdates=hp;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wu(n))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return Hu(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function _x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_x)}catch(t){console.error(t)}}_x(),_v.exports=Tn;var kb=_v.exports,Ag=kb;nh.createRoot=Ag.createRoot,nh.hydrateRoot=Ag.hydrateRoot;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(t,e)=>{const n=B.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,...h},m)=>B.createElement("svg",{ref:m,...Tb,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Ib(t)}`,c].join(" "),...h},[...e.map(([g,_])=>B.createElement(g,_)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=le("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=le("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=le("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=le("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ex=le("ArrowUpToLine",[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=le("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=le("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=le("CircleDashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=le("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=le("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=le("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=le("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=le("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=le("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=le("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=le("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=le("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=le("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=le("Grip",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=le("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=le("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=le("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=le("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Px=le("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=le("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=le("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=le("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=le("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=le("StickyNote",[["path",{d:"M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z",key:"1wis1t"}],["path",{d:"M15 3v6h6",key:"edgan2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=le("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=le("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=le("Waypoints",[["circle",{cx:"12",cy:"4.5",r:"2.5",key:"r5ysbb"}],["path",{d:"m10.2 6.3-3.9 3.9",key:"1nzqf6"}],["circle",{cx:"4.5",cy:"12",r:"2.5",key:"jydg6v"}],["path",{d:"M7 12h10",key:"b7w52i"}],["circle",{cx:"19.5",cy:"12",r:"2.5",key:"1piiel"}],["path",{d:"m13.8 17.7 3.9-3.9",key:"1wyg1y"}],["circle",{cx:"12",cy:"19.5",r:"2.5",key:"13o1pw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=le("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=le("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/*! Capacitor: https://capacitorjs.com/ - MIT License */var To;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(To||(To={}));class Ud extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const Hb=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Gb=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:Hb(t),i=()=>s()!=="web",o=g=>{const _=h.get(g);return!!(_!=null&&_.platforms.has(s())||c(g))},c=g=>{var _;return(_=n.PluginHeaders)===null||_===void 0?void 0:_.find(C=>C.name===g)},u=g=>t.console.error(g),h=new Map,m=(g,_={})=>{const C=h.get(g);if(C)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),C.proxy;const R=s(),M=c(g);let F;const A=async()=>(!F&&R in _?F=typeof _[R]=="function"?F=await _[R]():F=_[R]:e!==null&&!F&&"web"in _&&(F=typeof _.web=="function"?F=await _.web():F=_.web),F),I=(v,w)=>{var E,P;if(M){const D=M==null?void 0:M.methods.find(N=>w===N.name);if(D)return D.rtype==="promise"?N=>n.nativePromise(g,w.toString(),N):(N,Le)=>n.nativeCallback(g,w.toString(),N,Le);if(v)return(E=v[w])===null||E===void 0?void 0:E.bind(v)}else{if(v)return(P=v[w])===null||P===void 0?void 0:P.bind(v);throw new Ud(`"${g}" plugin is not implemented on ${R}`,To.Unimplemented)}},T=v=>{let w;const E=(...P)=>{const D=A().then(N=>{const Le=I(N,v);if(Le){const St=Le(...P);return w=St==null?void 0:St.remove,St}else throw new Ud(`"${g}.${v}()" is not implemented on ${R}`,To.Unimplemented)});return v==="addListener"&&(D.remove=async()=>w()),D};return E.toString=()=>`${v.toString()}() { [capacitor code] }`,Object.defineProperty(E,"name",{value:v,writable:!1,configurable:!1}),E},k=T("addListener"),O=T("removeListener"),W=(v,w)=>{const E=k({eventName:v},w),P=async()=>{const N=await E;O({eventName:v,callbackId:N},w)},D=new Promise(N=>E.then(()=>N({remove:P})));return D.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},D},b=new Proxy({},{get(v,w){switch(w){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return M?W:k;case"removeListener":return O;default:return T(w)}}});return r[g]=b,h.set(g,{name:g,proxy:b,platforms:new Set([...Object.keys(_),...M?[R]:[]])}),b};return n.convertFileSrc||(n.convertFileSrc=g=>g),n.getPlatform=s,n.handleError=u,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=Ud,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},qb=t=>t.Capacitor=Gb(t),ef=qb(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Gu=ef.registerPlugin;class kp{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new ef.Exception(e,To.Unimplemented)}unavailable(e="not available"){return new ef.Exception(e,To.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const jg=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Rg=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Kb extends kp{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Rg(s).trim(),i=Rg(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=jg(e.key),r=jg(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Gu("CapacitorCookies",{web:()=>new Kb});const Qb=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),Yb=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},Xb=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let c,u;return Array.isArray(o)?(u="",o.forEach(h=>{c=e?encodeURIComponent(h):h,u+=`${i}=${c}&`}),u.slice(0,-1)):(c=e?encodeURIComponent(o):o,u=`${i}=${c}`),`${r}&${u}`},"").substr(1):null,Jb=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=Yb(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,u)=>{i.append(u,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Zb extends kp{async request(e){const n=Jb(e,e.webFetchExtra),r=Xb(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let u,h;switch(c){case"arraybuffer":case"blob":h=await i.blob(),u=await Qb(h);break;case"json":u=await i.json();break;case"document":case"text":default:u=await i.text()}const m={};return i.headers.forEach((g,_)=>{m[_]=g}),{data:u,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Gu("CapacitorHttp",{web:()=>new Zb});var Dg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Dg||(Dg={}));var Mg;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})(Mg||(Mg={}));class ek extends kp{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Gu("SystemBars",{web:()=>new ek});var Lg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Lg||(Lg={}));var Og;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(Og||(Og={}));const tk=Gu("StatusBar");var Vg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},nk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ox={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,m=i>>2,g=(i&3)<<4|c>>4;let _=(c&15)<<2|h>>6,C=h&63;u||(C=64,o||(_=64)),r.push(n[m],n[g],n[_],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Lx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new rk;const _=i<<2|c>>4;if(r.push(_),h!==64){const C=c<<4&240|h>>2;if(r.push(C),g!==64){const R=h<<6&192|g;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sk=function(t){const e=Lx(t);return Ox.encodeByteArray(e,!0)},fu=function(t){return sk(t).replace(/\./g,"")},Vx=function(t){try{return Ox.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok=()=>ik().__FIREBASE_DEFAULTS__,ak=()=>{if(typeof process>"u"||typeof Vg>"u")return;const t=Vg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Vx(t[1]);return e&&JSON.parse(e)},qu=()=>{try{return ok()||ak()||lk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Fx=t=>{var e,n;return(n=(e=qu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ck=t=>{const e=Fx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zx=()=>{var t;return(t=qu())===null||t===void 0?void 0:t.config},Ux=t=>{var e;return(e=qu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[fu(JSON.stringify(n)),fu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yt())}function fk(){var t;const e=(t=qu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function gk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yk(){const t=Yt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function vk(){return!fk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xk(){try{return typeof indexedDB=="object"}catch{return!1}}function _k(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="FirebaseError";class Zr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=wk,Object.setPrototypeOf(this,Zr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,El.prototype.create)}}class El{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ek(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Zr(s,c,r)}}function Ek(t,e){return t.replace(bk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const bk=/\{\$([^}]+)}/g;function kk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Fg(i)&&Fg(o)){if(!pu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Fg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Tk(t,e){const n=new Ik(t,e);return n.subscribe.bind(n)}class Ik{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Sk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=$d),s.error===void 0&&(s.error=$d),s.complete===void 0&&(s.complete=$d);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function $d(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t){return t&&t._delegate?t._delegate:t}class Ei{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new uk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ck(e))try{this.getOrInitializeService({instanceIdentifier:ai})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ai){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ai){return this.instances.has(e)}getOptions(e=ai){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ak(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ai){return this.component?this.component.multipleInstances?e:ai:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ak(t){return t===ai?void 0:t}function Ck(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Nk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(be||(be={}));const jk={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},Rk=be.INFO,Dk={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},Mk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Dk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tp{constructor(e){this.name=e,this._logLevel=Rk,this._logHandler=Mk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const Lk=(t,e)=>e.some(n=>t instanceof n);let zg,Ug;function Ok(){return zg||(zg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vk(){return Ug||(Ug=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $x=new WeakMap,tf=new WeakMap,Bx=new WeakMap,Bd=new WeakMap,Ip=new WeakMap;function Fk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Rs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&$x.set(n,t)}).catch(()=>{}),Ip.set(e,t),e}function zk(t){if(tf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});tf.set(t,e)}let nf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return tf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Bx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Rs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Uk(t){nf=t(nf)}function $k(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Wd(this),e,...n);return Bx.set(r,e.sort?e.sort():[e]),Rs(r)}:Vk().includes(t)?function(...e){return t.apply(Wd(this),e),Rs($x.get(this))}:function(...e){return Rs(t.apply(Wd(this),e))}}function Bk(t){return typeof t=="function"?$k(t):(t instanceof IDBTransaction&&zk(t),Lk(t,Ok())?new Proxy(t,nf):t)}function Rs(t){if(t instanceof IDBRequest)return Fk(t);if(Bd.has(t))return Bd.get(t);const e=Bk(t);return e!==t&&(Bd.set(t,e),Ip.set(e,t)),e}const Wd=t=>Ip.get(t);function Wk(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Rs(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Rs(o.result),u.oldVersion,u.newVersion,Rs(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Hk=["get","getKey","getAll","getAllKeys","count"],Gk=["put","add","delete","clear"],Hd=new Map;function $g(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hd.get(e))return Hd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Gk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Hk.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),s&&u.done]))[0]};return Hd.set(e,i),i}Uk(t=>({...t,get:(e,n,r)=>$g(e,n)||t.get(e,n,r),has:(e,n)=>!!$g(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Kk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Kk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rf="@firebase/app",Bg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr=new Tp("@firebase/app"),Qk="@firebase/app-compat",Yk="@firebase/analytics-compat",Xk="@firebase/analytics",Jk="@firebase/app-check-compat",Zk="@firebase/app-check",e2="@firebase/auth",t2="@firebase/auth-compat",n2="@firebase/database",r2="@firebase/data-connect",s2="@firebase/database-compat",i2="@firebase/functions",o2="@firebase/functions-compat",a2="@firebase/installations",l2="@firebase/installations-compat",c2="@firebase/messaging",u2="@firebase/messaging-compat",d2="@firebase/performance",h2="@firebase/performance-compat",f2="@firebase/remote-config",p2="@firebase/remote-config-compat",m2="@firebase/storage",g2="@firebase/storage-compat",y2="@firebase/firestore",v2="@firebase/vertexai-preview",x2="@firebase/firestore-compat",_2="firebase",w2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="[DEFAULT]",E2={[rf]:"fire-core",[Qk]:"fire-core-compat",[Xk]:"fire-analytics",[Yk]:"fire-analytics-compat",[Zk]:"fire-app-check",[Jk]:"fire-app-check-compat",[e2]:"fire-auth",[t2]:"fire-auth-compat",[n2]:"fire-rtdb",[r2]:"fire-data-connect",[s2]:"fire-rtdb-compat",[i2]:"fire-fn",[o2]:"fire-fn-compat",[a2]:"fire-iid",[l2]:"fire-iid-compat",[c2]:"fire-fcm",[u2]:"fire-fcm-compat",[d2]:"fire-perf",[h2]:"fire-perf-compat",[f2]:"fire-rc",[p2]:"fire-rc-compat",[m2]:"fire-gcs",[g2]:"fire-gcs-compat",[y2]:"fire-fst",[x2]:"fire-fst-compat",[v2]:"fire-vertex","fire-js":"fire-js",[_2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=new Map,b2=new Map,of=new Map;function Wg(t,e){try{t.container.addComponent(e)}catch(n){Gr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Io(t){const e=t.name;if(of.has(e))return Gr.debug(`There were multiple attempts to register component ${e}.`),!1;of.set(e,t);for(const n of il.values())Wg(n,t);for(const n of b2.values())Wg(n,t);return!0}function Sp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function pr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ds=new El("app","Firebase",k2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo=w2;function Wx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:sf,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ds.create("bad-app-name",{appName:String(s)});if(n||(n=zx()),!n)throw Ds.create("no-options");const i=il.get(s);if(i){if(pu(n,i.options)&&pu(r,i.config))return i;throw Ds.create("duplicate-app",{appName:s})}const o=new Pk(s);for(const u of of.values())o.addComponent(u);const c=new T2(n,r,o);return il.set(s,c),c}function Np(t=sf){const e=il.get(t);if(!e&&t===sf&&zx())return Wx();if(!e)throw Ds.create("no-app",{appName:t});return e}function I2(){return Array.from(il.values())}function Ms(t,e,n){var r;let s=(r=E2[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gr.warn(c.join(" "));return}Io(new Ei(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2="firebase-heartbeat-database",N2=1,ol="firebase-heartbeat-store";let Gd=null;function Hx(){return Gd||(Gd=Wk(S2,N2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ol)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ds.create("idb-open",{originalErrorMessage:t.message})})),Gd}async function A2(t){try{const n=(await Hx()).transaction(ol),r=await n.objectStore(ol).get(Gx(t));return await n.done,r}catch(e){if(e instanceof Zr)Gr.warn(e.message);else{const n=Ds.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Gr.warn(n.message)}}}async function Hg(t,e){try{const r=(await Hx()).transaction(ol,"readwrite");await r.objectStore(ol).put(e,Gx(t)),await r.done}catch(n){if(n instanceof Zr)Gr.warn(n.message);else{const r=Ds.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Gr.warn(r.message)}}}function Gx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=1024,P2=30*24*60*60*1e3;class j2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new D2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Gg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=P2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Gr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Gg(),{heartbeatsToSend:r,unsentEntries:s}=R2(this._heartbeatsCache.heartbeats),i=fu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Gr.warn(n),""}}}function Gg(){return new Date().toISOString().substring(0,10)}function R2(t,e=C2){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),qg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),qg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class D2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xk()?_k().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await A2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function qg(t){return fu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t){Io(new Ei("platform-logger",e=>new qk(e),"PRIVATE")),Io(new Ei("heartbeat",e=>new j2(e),"PRIVATE")),Ms(rf,Bg,t),Ms(rf,Bg,"esm2017"),Ms("fire-js","")}M2("");var L2="firebase",O2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ms(L2,O2,"app");function Ap(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function qx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const V2=qx,Kx=new El("auth","Firebase",qx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=new Tp("@firebase/auth");function F2(t,...e){mu.logLevel<=be.WARN&&mu.warn(`Auth (${Vo}): ${t}`,...e)}function Cc(t,...e){mu.logLevel<=be.ERROR&&mu.error(`Auth (${Vo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t,...e){throw Cp(t,...e)}function xr(t,...e){return Cp(t,...e)}function Qx(t,e,n){const r=Object.assign(Object.assign({},V2()),{[e]:n});return new El("auth","Firebase",r).create(e,{appName:t.name})}function Ur(t){return Qx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Kx.create(t,...e)}function me(t,e,...n){if(!t)throw Cp(e,...n)}function Or(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cc(e),new Error(e)}function Kr(t,e){t||Or(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function z2(){return Kg()==="http:"||Kg()==="https:"}function Kg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(z2()||mk()||"connection"in navigator)?navigator.onLine:!0}function $2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Kr(n>e,"Short delay should be less than long delay!"),this.isMobile=hk()||gk()}get(){return U2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(t,e){Kr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Or("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Or("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Or("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2=new kl(3e4,6e4);function Tl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Fo(t,e,n,r,s={}){return Xx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=bl(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},i);return pk()||(h.referrerPolicy="no-referrer"),Yx.fetch()(Jx(t,t.config.apiHost,n,c),h)})}async function Xx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},B2),e);try{const s=new H2(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw dc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw dc(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw dc(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw dc(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Qx(t,m,h);qr(t,m)}}catch(s){if(s instanceof Zr)throw s;qr(t,"network-request-failed",{message:String(s)})}}async function jp(t,e,n,r,s={}){const i=await Fo(t,e,n,r,s);return"mfaPendingCredential"in i&&qr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Jx(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Pp(t.config,s):`${t.config.apiScheme}://${s}`}class H2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(xr(this.auth,"network-request-failed")),W2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function dc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=xr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G2(t,e){return Fo(t,"POST","/v1/accounts:delete",e)}async function Zx(t,e){return Fo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function q2(t,e=!1){const n=fn(t),r=await n.getIdToken(e),s=Rp(r);me(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Oa(qd(s.auth_time)),issuedAtTime:Oa(qd(s.iat)),expirationTime:Oa(qd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function qd(t){return Number(t)*1e3}function Rp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Cc("JWT malformed, contained fewer than 3 sections"),null;try{const s=Vx(n);return s?JSON.parse(s):(Cc("Failed to decode base64 JWT payload"),null)}catch(s){return Cc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Qg(t){const e=Rp(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Zr&&K2(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function K2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oa(this.lastLoginAt),this.creationTime=Oa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await al(t,Zx(n,{idToken:r}));me(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?e_(i.providerUserInfo):[],c=X2(t.providerData,o),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),m=u?h:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new lf(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function Y2(t){const e=fn(t);await gu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function X2(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function e_(t){return t.map(e=>{var{providerId:n}=e,r=Ap(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J2(t,e){const n=await Xx(t,{},async()=>{const r=bl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Jx(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Yx.fetch()(o,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Z2(t,e){return Fo(t,"POST","/v2/accounts:revokeToken",Tl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=Qg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await J2(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ho;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(me(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(me(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ho,this.toJSON())}_performRefresh(){return Or("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Vr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Ap(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Q2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new lf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await al(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return q2(this,e)}reload(){return Y2(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Vr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await gu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(pr(this.auth.app))return Promise.reject(Ur(this.auth));const e=await this.getIdToken();return await al(this,G2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,c,u,h,m;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,_=(s=n.email)!==null&&s!==void 0?s:void 0,C=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,R=(o=n.photoURL)!==null&&o!==void 0?o:void 0,M=(c=n.tenantId)!==null&&c!==void 0?c:void 0,F=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,A=(h=n.createdAt)!==null&&h!==void 0?h:void 0,I=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:T,emailVerified:k,isAnonymous:O,providerData:W,stsTokenManager:b}=n;me(T&&b,e,"internal-error");const v=ho.fromJSON(this.name,b);me(typeof T=="string",e,"internal-error"),hs(g,e.name),hs(_,e.name),me(typeof k=="boolean",e,"internal-error"),me(typeof O=="boolean",e,"internal-error"),hs(C,e.name),hs(R,e.name),hs(M,e.name),hs(F,e.name),hs(A,e.name),hs(I,e.name);const w=new Vr({uid:T,auth:e,email:_,emailVerified:k,displayName:g,isAnonymous:O,photoURL:R,phoneNumber:C,tenantId:M,stsTokenManager:v,createdAt:A,lastLoginAt:I});return W&&Array.isArray(W)&&(w.providerData=W.map(E=>Object.assign({},E))),F&&(w._redirectEventId=F),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new ho;s.updateFromServerResponse(n);const i=new Vr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await gu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];me(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?e_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new ho;c.updateFromIdToken(r);const u=new Vr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new lf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=new Map;function Fr(t){Kr(t instanceof Function,"Expected a class definition");let e=Yg.get(t);return e?(Kr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Yg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}t_.type="NONE";const Xg=t_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t,e,n){return`firebase:${t}:${e}:${n}`}class fo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Pc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Pc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Vr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new fo(Fr(Xg),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Fr(Xg);const o=Pc(r,e.config.apiKey,e.name);let c=null;for(const h of n)try{const m=await h._get(o);if(m){const g=Vr._fromJSON(e,m);h!==i&&(c=g),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new fo(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new fo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a_(e))return"Blackberry";if(l_(e))return"Webos";if(r_(e))return"Safari";if((e.includes("chrome/")||s_(e))&&!e.includes("edge/"))return"Chrome";if(o_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function n_(t=Yt()){return/firefox\//i.test(t)}function r_(t=Yt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function s_(t=Yt()){return/crios\//i.test(t)}function i_(t=Yt()){return/iemobile/i.test(t)}function o_(t=Yt()){return/android/i.test(t)}function a_(t=Yt()){return/blackberry/i.test(t)}function l_(t=Yt()){return/webos/i.test(t)}function Dp(t=Yt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function eT(t=Yt()){var e;return Dp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function tT(){return yk()&&document.documentMode===10}function c_(t=Yt()){return Dp(t)||o_(t)||l_(t)||a_(t)||/windows phone/i.test(t)||i_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(t,e=[]){let n;switch(t){case"Browser":n=Jg(Yt());break;case"Worker":n=`${Jg(Yt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Vo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rT(t,e={}){return Fo(t,"GET","/v2/passwordPolicy",Tl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=6;class iT{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:sT,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zg(this),this.idTokenSubscription=new Zg(this),this.beforeStateQueue=new nT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Fr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await fo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zx(this,{idToken:e}),r=await Vr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(pr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await gu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(pr(this.app))return Promise.reject(Ur(this));const n=e?fn(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return pr(this.app)?Promise.reject(Ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return pr(this.app)?Promise.reject(Ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rT(this),n=new iT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new El("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Z2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Fr(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await fo.create(this,[Fr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&F2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Il(t){return fn(t)}class Zg{constructor(e){this.auth=e,this.observer=null,this.addObserver=Tk(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aT(t){Mp=t}function lT(t){return Mp.loadJS(t)}function cT(){return Mp.gapiScript}function uT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dT(t,e){const n=Sp(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(pu(i,e??{}))return s;qr(s,"already-initialized")}return n.initialize({options:e})}function hT(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Fr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fT(t,e,n){const r=Il(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=d_(e),{host:o,port:c}=pT(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),mT()}function d_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function pT(t){const e=d_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ey(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:ey(o)}}}function ey(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function mT(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Or("not implemented")}_getIdTokenResponse(e){return Or("not implemented")}_linkToIdToken(e,n){return Or("not implemented")}_getReauthenticationResolver(e){return Or("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function po(t,e){return jp(t,"POST","/v1/accounts:signInWithIdp",Tl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="http://localhost";class bi extends h_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new bi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):qr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Ap(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new bi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return po(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,po(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,po(e,n)}buildRequest(){const e={requestUri:gT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl extends f_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Sl{constructor(){super("facebook.com")}static credential(e){return bi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ys.credential(e.oauthAccessToken)}catch{return null}}}ys.FACEBOOK_SIGN_IN_METHOD="facebook.com";ys.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Sl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return bi._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vs.credential(n,r)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Sl{constructor(){super("github.com")}static credential(e){return bi._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xs.credential(e.oauthAccessToken)}catch{return null}}}xs.GITHUB_SIGN_IN_METHOD="github.com";xs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends Sl{constructor(){super("twitter.com")}static credential(e,n){return bi._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return _s.credential(n,r)}catch{return null}}}_s.TWITTER_SIGN_IN_METHOD="twitter.com";_s.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yT(t,e){return jp(t,"POST","/v1/accounts:signUp",Tl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Vr._fromIdTokenResponse(e,r,s),o=ty(r);return new Qr({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ty(r);return new Qr({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ty(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vT(t){var e;if(pr(t.app))return Promise.reject(Ur(t));const n=Il(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Qr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await yT(n,{returnSecureToken:!0}),s=await Qr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends Zr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,yu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new yu(e,n,r,s)}}function p_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?yu._fromErrorAndOperation(t,i,e,r):i})}async function xT(t,e,n=!1){const r=await al(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Qr._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _T(t,e,n=!1){const{auth:r}=t;if(pr(r.app))return Promise.reject(Ur(r));const s="reauthenticate";try{const i=await al(t,p_(r,s,e,t),n);me(i.idToken,r,"internal-error");const o=Rp(i.idToken);me(o,r,"internal-error");const{sub:c}=o;return me(t.uid===c,r,"user-mismatch"),Qr._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&qr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(t,e,n=!1){if(pr(t.app))return Promise.reject(Ur(t));const r="signIn",s=await p_(t,r,e),i=await Qr._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ET(t,e){return jp(t,"POST","/v1/accounts:signInWithCustomToken",Tl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bT(t,e){if(pr(t.app))return Promise.reject(Ur(t));const n=Il(t),r=await ET(n,{token:e,returnSecureToken:!0}),s=await Qr._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}function kT(t,e,n,r){return fn(t).onIdTokenChanged(e,n,r)}function TT(t,e,n){return fn(t).beforeAuthStateChanged(e,n)}function IT(t,e,n,r){return fn(t).onAuthStateChanged(e,n,r)}const vu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(vu,"1"),this.storage.removeItem(vu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST=1e3,NT=10;class g_ extends m_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=c_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);tT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,NT):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},ST)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}g_.type="LOCAL";const AT=g_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends m_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}y_.type="SESSION";const v_=y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ku(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async h=>h(n.origin,i)),u=await CT(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ku.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=Lp("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const _=g;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(_.data.response);break;default:clearTimeout(m),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return window}function jT(t){_r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(){return typeof _r().WorkerGlobalScope<"u"&&typeof _r().importScripts=="function"}async function RT(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DT(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function MT(){return x_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __="firebaseLocalStorageDb",LT=1,xu="firebaseLocalStorage",w_="fbase_key";class Nl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Qu(t,e){return t.transaction([xu],e?"readwrite":"readonly").objectStore(xu)}function OT(){const t=indexedDB.deleteDatabase(__);return new Nl(t).toPromise()}function cf(){const t=indexedDB.open(__,LT);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xu,{keyPath:w_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xu)?e(r):(r.close(),await OT(),e(await cf()))})})}async function ny(t,e,n){const r=Qu(t,!0).put({[w_]:e,value:n});return new Nl(r).toPromise()}async function VT(t,e){const n=Qu(t,!1).get(e),r=await new Nl(n).toPromise();return r===void 0?null:r.value}function ry(t,e){const n=Qu(t,!0).delete(e);return new Nl(n).toPromise()}const FT=800,zT=3;class E_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>zT)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ku._getInstance(MT()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await RT(),!this.activeServiceWorker)return;this.sender=new PT(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cf();return await ny(e,vu,"1"),await ry(e,vu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ny(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>VT(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ry(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Qu(s,!1).getAll();return new Nl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}E_.type="LOCAL";const UT=E_;new kl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t,e){return e?Fr(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op extends h_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return po(e,this._buildIdpRequest())}_linkToIdToken(e,n){return po(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return po(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function BT(t){return wT(t.auth,new Op(t),t.bypassAuthState)}function WT(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),_T(n,new Op(t),t.bypassAuthState)}async function HT(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),xT(n,new Op(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BT;case"linkViaPopup":case"linkViaRedirect":return HT;case"reauthViaPopup":case"reauthViaRedirect":return WT;default:qr(this.auth,"internal-error")}}resolve(e){Kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT=new kl(2e3,1e4);class ro extends b_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ro.currentPopupAction&&ro.currentPopupAction.cancel(),ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){Kr(this.filter.length===1,"Popup operations only handle one event");const e=Lp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(xr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(xr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,GT.get())};e()}}ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qT="pendingRedirect",jc=new Map;class KT extends b_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=jc.get(this.auth._key());if(!e){try{const r=await QT(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}jc.set(this.auth._key(),e)}return this.bypassAuthState||jc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function QT(t,e){const n=JT(e),r=XT(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function YT(t,e){jc.set(t._key(),e)}function XT(t){return Fr(t._redirectPersistence)}function JT(t){return Pc(qT,t.config.apiKey,t.name)}async function ZT(t,e,n=!1){if(pr(t.app))return Promise.reject(Ur(t));const r=Il(t),s=$T(r,e),o=await new KT(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=10*60*1e3;class tI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!k_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(xr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eI&&this.cachedEventUids.clear(),this.cachedEventUids.has(sy(e))}saveEventToCache(e){this.cachedEventUids.add(sy(e)),this.lastProcessedEventTime=Date.now()}}function sy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function k_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return k_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(t,e={}){return Fo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iI=/^https?/;async function oI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await rI(t);for(const n of e)try{if(aI(n))return}catch{}qr(t,"unauthorized-domain")}function aI(t){const e=af(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!iI.test(n))return!1;if(sI.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=new kl(3e4,6e4);function iy(){const t=_r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function cI(t){return new Promise((e,n)=>{var r,s,i;function o(){iy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iy(),n(xr(t,"network-request-failed"))},timeout:lI.get()})}if(!((s=(r=_r().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=_r().gapi)===null||i===void 0)&&i.load)o();else{const c=uT("iframefcb");return _r()[c]=()=>{gapi.load?o():n(xr(t,"network-request-failed"))},lT(`${cT()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Rc=null,e})}let Rc=null;function uI(t){return Rc=Rc||cI(t),Rc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=new kl(5e3,15e3),hI="__/auth/iframe",fI="emulator/auth/iframe",pI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gI(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Pp(e,fI):`https://${t.config.authDomain}/${hI}`,r={apiKey:e.apiKey,appName:t.name,v:Vo},s=mI.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bl(r).slice(1)}`}async function yI(t){const e=await uI(t),n=_r().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:gI(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pI,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=xr(t,"network-request-failed"),c=_r().setTimeout(()=>{i(o)},dI.get());function u(){_r().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xI=500,_I=600,wI="_blank",EI="http://localhost";class oy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bI(t,e,n,r=xI,s=_I){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},vI),{width:r.toString(),height:s.toString(),top:i,left:o}),h=Yt().toLowerCase();n&&(c=s_(h)?wI:n),n_(h)&&(e=e||EI,u.scrollbars="yes");const m=Object.entries(u).reduce((_,[C,R])=>`${_}${C}=${R},`,"");if(eT(h)&&c!=="_self")return kI(e||"",c),new oy(null);const g=window.open(e||"",c,m);me(g,t,"popup-blocked");try{g.focus()}catch{}return new oy(g)}function kI(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="__/auth/handler",II="emulator/auth/handler",SI=encodeURIComponent("fac");async function ay(t,e,n,r,s,i){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Vo,eventId:s};if(e instanceof f_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",kk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))o[m]=g}if(e instanceof Sl){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),h=u?`#${SI}=${encodeURIComponent(u)}`:"";return`${NI(t)}?${bl(c).slice(1)}${h}`}function NI({config:t}){return t.emulator?Pp(t,II):`https://${t.authDomain}/${TI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd="webStorageSupport";class AI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=v_,this._completeRedirectFn=ZT,this._overrideRedirectResult=YT}async _openPopup(e,n,r,s){var i;Kr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await ay(e,n,r,af(),s);return bI(e,o,Lp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await ay(e,n,r,af(),s);return jT(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Kr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await yI(e),r=new tI(e);return n.register("authEvent",s=>(me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Kd,{type:Kd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Kd];o!==void 0&&n(!!o),qr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=oI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return c_()||r_()||Dp()}}const CI=AI;var ly="@firebase/auth",cy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RI(t){Io(new Ei("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u_(t)},h=new oT(r,s,i,u);return hT(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Io(new Ei("auth-internal",e=>{const n=Il(e.getProvider("auth").getImmediate());return(r=>new PI(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ms(ly,cy,jI(t)),Ms(ly,cy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=5*60,MI=Ux("authIdTokenMaxAge")||DI;let uy=null;const LI=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>MI)return;const s=n==null?void 0:n.token;uy!==s&&(uy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function OI(t=Np()){const e=Sp(t,"auth");if(e.isInitialized())return e.getImmediate();const n=dT(t,{popupRedirectResolver:CI,persistence:[UT,AT,v_]}),r=Ux("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=LI(i.toString());TT(n,o,()=>o(n.currentUser)),kT(n,c=>o(c))}}const s=Fx("auth");return s&&fT(n,`http://${s}`),n}function VI(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}aT({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=xr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",VI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RI("Browser");var dy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pi,T_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,v){function w(){}w.prototype=v.prototype,b.D=v.prototype,b.prototype=new w,b.prototype.constructor=b,b.C=function(E,P,D){for(var N=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)N[Le-2]=arguments[Le];return v.prototype[P].apply(E,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(b,v,w){w||(w=0);var E=Array(16);if(typeof v=="string")for(var P=0;16>P;++P)E[P]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(P=0;16>P;++P)E[P]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=b.g[0],w=b.g[1],P=b.g[2];var D=b.g[3],N=v+(D^w&(P^D))+E[0]+3614090360&4294967295;v=w+(N<<7&4294967295|N>>>25),N=D+(P^v&(w^P))+E[1]+3905402710&4294967295,D=v+(N<<12&4294967295|N>>>20),N=P+(w^D&(v^w))+E[2]+606105819&4294967295,P=D+(N<<17&4294967295|N>>>15),N=w+(v^P&(D^v))+E[3]+3250441966&4294967295,w=P+(N<<22&4294967295|N>>>10),N=v+(D^w&(P^D))+E[4]+4118548399&4294967295,v=w+(N<<7&4294967295|N>>>25),N=D+(P^v&(w^P))+E[5]+1200080426&4294967295,D=v+(N<<12&4294967295|N>>>20),N=P+(w^D&(v^w))+E[6]+2821735955&4294967295,P=D+(N<<17&4294967295|N>>>15),N=w+(v^P&(D^v))+E[7]+4249261313&4294967295,w=P+(N<<22&4294967295|N>>>10),N=v+(D^w&(P^D))+E[8]+1770035416&4294967295,v=w+(N<<7&4294967295|N>>>25),N=D+(P^v&(w^P))+E[9]+2336552879&4294967295,D=v+(N<<12&4294967295|N>>>20),N=P+(w^D&(v^w))+E[10]+4294925233&4294967295,P=D+(N<<17&4294967295|N>>>15),N=w+(v^P&(D^v))+E[11]+2304563134&4294967295,w=P+(N<<22&4294967295|N>>>10),N=v+(D^w&(P^D))+E[12]+1804603682&4294967295,v=w+(N<<7&4294967295|N>>>25),N=D+(P^v&(w^P))+E[13]+4254626195&4294967295,D=v+(N<<12&4294967295|N>>>20),N=P+(w^D&(v^w))+E[14]+2792965006&4294967295,P=D+(N<<17&4294967295|N>>>15),N=w+(v^P&(D^v))+E[15]+1236535329&4294967295,w=P+(N<<22&4294967295|N>>>10),N=v+(P^D&(w^P))+E[1]+4129170786&4294967295,v=w+(N<<5&4294967295|N>>>27),N=D+(w^P&(v^w))+E[6]+3225465664&4294967295,D=v+(N<<9&4294967295|N>>>23),N=P+(v^w&(D^v))+E[11]+643717713&4294967295,P=D+(N<<14&4294967295|N>>>18),N=w+(D^v&(P^D))+E[0]+3921069994&4294967295,w=P+(N<<20&4294967295|N>>>12),N=v+(P^D&(w^P))+E[5]+3593408605&4294967295,v=w+(N<<5&4294967295|N>>>27),N=D+(w^P&(v^w))+E[10]+38016083&4294967295,D=v+(N<<9&4294967295|N>>>23),N=P+(v^w&(D^v))+E[15]+3634488961&4294967295,P=D+(N<<14&4294967295|N>>>18),N=w+(D^v&(P^D))+E[4]+3889429448&4294967295,w=P+(N<<20&4294967295|N>>>12),N=v+(P^D&(w^P))+E[9]+568446438&4294967295,v=w+(N<<5&4294967295|N>>>27),N=D+(w^P&(v^w))+E[14]+3275163606&4294967295,D=v+(N<<9&4294967295|N>>>23),N=P+(v^w&(D^v))+E[3]+4107603335&4294967295,P=D+(N<<14&4294967295|N>>>18),N=w+(D^v&(P^D))+E[8]+1163531501&4294967295,w=P+(N<<20&4294967295|N>>>12),N=v+(P^D&(w^P))+E[13]+2850285829&4294967295,v=w+(N<<5&4294967295|N>>>27),N=D+(w^P&(v^w))+E[2]+4243563512&4294967295,D=v+(N<<9&4294967295|N>>>23),N=P+(v^w&(D^v))+E[7]+1735328473&4294967295,P=D+(N<<14&4294967295|N>>>18),N=w+(D^v&(P^D))+E[12]+2368359562&4294967295,w=P+(N<<20&4294967295|N>>>12),N=v+(w^P^D)+E[5]+4294588738&4294967295,v=w+(N<<4&4294967295|N>>>28),N=D+(v^w^P)+E[8]+2272392833&4294967295,D=v+(N<<11&4294967295|N>>>21),N=P+(D^v^w)+E[11]+1839030562&4294967295,P=D+(N<<16&4294967295|N>>>16),N=w+(P^D^v)+E[14]+4259657740&4294967295,w=P+(N<<23&4294967295|N>>>9),N=v+(w^P^D)+E[1]+2763975236&4294967295,v=w+(N<<4&4294967295|N>>>28),N=D+(v^w^P)+E[4]+1272893353&4294967295,D=v+(N<<11&4294967295|N>>>21),N=P+(D^v^w)+E[7]+4139469664&4294967295,P=D+(N<<16&4294967295|N>>>16),N=w+(P^D^v)+E[10]+3200236656&4294967295,w=P+(N<<23&4294967295|N>>>9),N=v+(w^P^D)+E[13]+681279174&4294967295,v=w+(N<<4&4294967295|N>>>28),N=D+(v^w^P)+E[0]+3936430074&4294967295,D=v+(N<<11&4294967295|N>>>21),N=P+(D^v^w)+E[3]+3572445317&4294967295,P=D+(N<<16&4294967295|N>>>16),N=w+(P^D^v)+E[6]+76029189&4294967295,w=P+(N<<23&4294967295|N>>>9),N=v+(w^P^D)+E[9]+3654602809&4294967295,v=w+(N<<4&4294967295|N>>>28),N=D+(v^w^P)+E[12]+3873151461&4294967295,D=v+(N<<11&4294967295|N>>>21),N=P+(D^v^w)+E[15]+530742520&4294967295,P=D+(N<<16&4294967295|N>>>16),N=w+(P^D^v)+E[2]+3299628645&4294967295,w=P+(N<<23&4294967295|N>>>9),N=v+(P^(w|~D))+E[0]+4096336452&4294967295,v=w+(N<<6&4294967295|N>>>26),N=D+(w^(v|~P))+E[7]+1126891415&4294967295,D=v+(N<<10&4294967295|N>>>22),N=P+(v^(D|~w))+E[14]+2878612391&4294967295,P=D+(N<<15&4294967295|N>>>17),N=w+(D^(P|~v))+E[5]+4237533241&4294967295,w=P+(N<<21&4294967295|N>>>11),N=v+(P^(w|~D))+E[12]+1700485571&4294967295,v=w+(N<<6&4294967295|N>>>26),N=D+(w^(v|~P))+E[3]+2399980690&4294967295,D=v+(N<<10&4294967295|N>>>22),N=P+(v^(D|~w))+E[10]+4293915773&4294967295,P=D+(N<<15&4294967295|N>>>17),N=w+(D^(P|~v))+E[1]+2240044497&4294967295,w=P+(N<<21&4294967295|N>>>11),N=v+(P^(w|~D))+E[8]+1873313359&4294967295,v=w+(N<<6&4294967295|N>>>26),N=D+(w^(v|~P))+E[15]+4264355552&4294967295,D=v+(N<<10&4294967295|N>>>22),N=P+(v^(D|~w))+E[6]+2734768916&4294967295,P=D+(N<<15&4294967295|N>>>17),N=w+(D^(P|~v))+E[13]+1309151649&4294967295,w=P+(N<<21&4294967295|N>>>11),N=v+(P^(w|~D))+E[4]+4149444226&4294967295,v=w+(N<<6&4294967295|N>>>26),N=D+(w^(v|~P))+E[11]+3174756917&4294967295,D=v+(N<<10&4294967295|N>>>22),N=P+(v^(D|~w))+E[2]+718787259&4294967295,P=D+(N<<15&4294967295|N>>>17),N=w+(D^(P|~v))+E[9]+3951481745&4294967295,b.g[0]=b.g[0]+v&4294967295,b.g[1]=b.g[1]+(P+(N<<21&4294967295|N>>>11))&4294967295,b.g[2]=b.g[2]+P&4294967295,b.g[3]=b.g[3]+D&4294967295}r.prototype.u=function(b,v){v===void 0&&(v=b.length);for(var w=v-this.blockSize,E=this.B,P=this.h,D=0;D<v;){if(P==0)for(;D<=w;)s(this,b,D),D+=this.blockSize;if(typeof b=="string"){for(;D<v;)if(E[P++]=b.charCodeAt(D++),P==this.blockSize){s(this,E),P=0;break}}else for(;D<v;)if(E[P++]=b[D++],P==this.blockSize){s(this,E),P=0;break}}this.h=P,this.o+=v},r.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var v=1;v<b.length-8;++v)b[v]=0;var w=8*this.o;for(v=b.length-8;v<b.length;++v)b[v]=w&255,w/=256;for(this.u(b),b=Array(16),v=w=0;4>v;++v)for(var E=0;32>E;E+=8)b[w++]=this.g[v]>>>E&255;return b};function i(b,v){var w=c;return Object.prototype.hasOwnProperty.call(w,b)?w[b]:w[b]=v(b)}function o(b,v){this.h=v;for(var w=[],E=!0,P=b.length-1;0<=P;P--){var D=b[P]|0;E&&D==v||(w[P]=D,E=!1)}this.g=w}var c={};function u(b){return-128<=b&&128>b?i(b,function(v){return new o([v|0],0>v?-1:0)}):new o([b|0],0>b?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return g;if(0>b)return F(h(-b));for(var v=[],w=1,E=0;b>=w;E++)v[E]=b/w|0,w*=4294967296;return new o(v,0)}function m(b,v){if(b.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(b.charAt(0)=="-")return F(m(b.substring(1),v));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=h(Math.pow(v,8)),E=g,P=0;P<b.length;P+=8){var D=Math.min(8,b.length-P),N=parseInt(b.substring(P,P+D),v);8>D?(D=h(Math.pow(v,D)),E=E.j(D).add(h(N))):(E=E.j(w),E=E.add(h(N)))}return E}var g=u(0),_=u(1),C=u(16777216);t=o.prototype,t.m=function(){if(M(this))return-F(this).m();for(var b=0,v=1,w=0;w<this.g.length;w++){var E=this.i(w);b+=(0<=E?E:4294967296+E)*v,v*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(R(this))return"0";if(M(this))return"-"+F(this).toString(b);for(var v=h(Math.pow(b,6)),w=this,E="";;){var P=k(w,v).g;w=A(w,P.j(v));var D=((0<w.g.length?w.g[0]:w.h)>>>0).toString(b);if(w=P,R(w))return D+E;for(;6>D.length;)D="0"+D;E=D+E}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function R(b){if(b.h!=0)return!1;for(var v=0;v<b.g.length;v++)if(b.g[v]!=0)return!1;return!0}function M(b){return b.h==-1}t.l=function(b){return b=A(this,b),M(b)?-1:R(b)?0:1};function F(b){for(var v=b.g.length,w=[],E=0;E<v;E++)w[E]=~b.g[E];return new o(w,~b.h).add(_)}t.abs=function(){return M(this)?F(this):this},t.add=function(b){for(var v=Math.max(this.g.length,b.g.length),w=[],E=0,P=0;P<=v;P++){var D=E+(this.i(P)&65535)+(b.i(P)&65535),N=(D>>>16)+(this.i(P)>>>16)+(b.i(P)>>>16);E=N>>>16,D&=65535,N&=65535,w[P]=N<<16|D}return new o(w,w[w.length-1]&-2147483648?-1:0)};function A(b,v){return b.add(F(v))}t.j=function(b){if(R(this)||R(b))return g;if(M(this))return M(b)?F(this).j(F(b)):F(F(this).j(b));if(M(b))return F(this.j(F(b)));if(0>this.l(C)&&0>b.l(C))return h(this.m()*b.m());for(var v=this.g.length+b.g.length,w=[],E=0;E<2*v;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var P=0;P<b.g.length;P++){var D=this.i(E)>>>16,N=this.i(E)&65535,Le=b.i(P)>>>16,St=b.i(P)&65535;w[2*E+2*P]+=N*St,I(w,2*E+2*P),w[2*E+2*P+1]+=D*St,I(w,2*E+2*P+1),w[2*E+2*P+1]+=N*Le,I(w,2*E+2*P+1),w[2*E+2*P+2]+=D*Le,I(w,2*E+2*P+2)}for(E=0;E<v;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=v;E<2*v;E++)w[E]=0;return new o(w,0)};function I(b,v){for(;(b[v]&65535)!=b[v];)b[v+1]+=b[v]>>>16,b[v]&=65535,v++}function T(b,v){this.g=b,this.h=v}function k(b,v){if(R(v))throw Error("division by zero");if(R(b))return new T(g,g);if(M(b))return v=k(F(b),v),new T(F(v.g),F(v.h));if(M(v))return v=k(b,F(v)),new T(F(v.g),v.h);if(30<b.g.length){if(M(b)||M(v))throw Error("slowDivide_ only works with positive integers.");for(var w=_,E=v;0>=E.l(b);)w=O(w),E=O(E);var P=W(w,1),D=W(E,1);for(E=W(E,2),w=W(w,2);!R(E);){var N=D.add(E);0>=N.l(b)&&(P=P.add(w),D=N),E=W(E,1),w=W(w,1)}return v=A(b,P.j(v)),new T(P,v)}for(P=g;0<=b.l(v);){for(w=Math.max(1,Math.floor(b.m()/v.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),D=h(w),N=D.j(v);M(N)||0<N.l(b);)w-=E,D=h(w),N=D.j(v);R(D)&&(D=_),P=P.add(D),b=A(b,N)}return new T(P,b)}t.A=function(b){return k(this,b).h},t.and=function(b){for(var v=Math.max(this.g.length,b.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)&b.i(E);return new o(w,this.h&b.h)},t.or=function(b){for(var v=Math.max(this.g.length,b.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)|b.i(E);return new o(w,this.h|b.h)},t.xor=function(b){for(var v=Math.max(this.g.length,b.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)^b.i(E);return new o(w,this.h^b.h)};function O(b){for(var v=b.g.length+1,w=[],E=0;E<v;E++)w[E]=b.i(E)<<1|b.i(E-1)>>>31;return new o(w,b.h)}function W(b,v){var w=v>>5;v%=32;for(var E=b.g.length-w,P=[],D=0;D<E;D++)P[D]=0<v?b.i(D+w)>>>v|b.i(D+w+1)<<32-v:b.i(D+w);return new o(P,b.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,T_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,pi=o}).apply(typeof dy<"u"?dy:typeof self<"u"?self:typeof window<"u"?window:{});var hc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var I_,Ea,S_,Dc,uf,N_,A_,C_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,f){return l==Array.prototype||l==Object.prototype||(l[d]=f.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof hc=="object"&&hc];for(var d=0;d<l.length;++d){var f=l[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(l,d){if(d)e:{var f=r;l=l.split(".");for(var x=0;x<l.length-1;x++){var L=l[x];if(!(L in f))break e;f=f[L]}l=l[l.length-1],x=f[l],d=d(x),d!=x&&d!=null&&e(f,l,{configurable:!0,writable:!0,value:d})}}function i(l,d){l instanceof String&&(l+="");var f=0,x=!1,L={next:function(){if(!x&&f<l.length){var U=f++;return{value:d(U,l[U]),done:!1}}return x=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(l){return l||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function h(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function m(l,d,f){return l.call.apply(l.bind,arguments)}function g(l,d,f){if(!l)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,x),l.apply(d,L)}}return function(){return l.apply(d,arguments)}}function _(l,d,f){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,_.apply(null,arguments)}function C(l,d){var f=Array.prototype.slice.call(arguments,1);return function(){var x=f.slice();return x.push.apply(x,arguments),l.apply(this,x)}}function R(l,d){function f(){}f.prototype=d.prototype,l.aa=d.prototype,l.prototype=new f,l.prototype.constructor=l,l.Qb=function(x,L,U){for(var Y=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)Y[Ue-2]=arguments[Ue];return d.prototype[L].apply(x,Y)}}function M(l){const d=l.length;if(0<d){const f=Array(d);for(let x=0;x<d;x++)f[x]=l[x];return f}return[]}function F(l,d){for(let f=1;f<arguments.length;f++){const x=arguments[f];if(u(x)){const L=l.length||0,U=x.length||0;l.length=L+U;for(let Y=0;Y<U;Y++)l[L+Y]=x[Y]}else l.push(x)}}class A{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function I(l){return/^[\s\xa0]*$/.test(l)}function T(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function k(l){return k[" "](l),l}k[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function W(l,d,f){for(const x in l)d.call(f,l[x],x,l)}function b(l,d){for(const f in l)d.call(void 0,l[f],f,l)}function v(l){const d={};for(const f in l)d[f]=l[f];return d}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(l,d){let f,x;for(let L=1;L<arguments.length;L++){x=arguments[L];for(f in x)l[f]=x[f];for(let U=0;U<w.length;U++)f=w[U],Object.prototype.hasOwnProperty.call(x,f)&&(l[f]=x[f])}}function P(l){var d=1;l=l.split(":");const f=[];for(;0<d&&l.length;)f.push(l.shift()),d--;return l.length&&f.push(l.join(":")),f}function D(l){c.setTimeout(()=>{throw l},0)}function N(){var l=de;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class Le{constructor(){this.h=this.g=null}add(d,f){const x=St.get();x.set(d,f),this.h?this.h.next=x:this.g=x,this.h=x}}var St=new A(()=>new fe,l=>l.reset());class fe{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Xe,Z=!1,de=new Le,ue=()=>{const l=c.Promise.resolve(void 0);Xe=()=>{l.then(Ae)}};var Ae=()=>{for(var l;l=N();){try{l.h.call(l.g)}catch(f){D(f)}var d=St;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}Z=!1};function Te(){this.s=this.s,this.C=this.C}Te.prototype.s=!1,Te.prototype.ma=function(){this.s||(this.s=!0,this.N())},Te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Oe(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}Oe.prototype.h=function(){this.defaultPrevented=!0};var Ft=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const f=()=>{};c.addEventListener("test",f,d),c.removeEventListener("test",f,d)}catch{}return l}();function ht(l,d){if(Oe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var f=this.type=l.type,x=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(O){e:{try{k(d.nodeName);var L=!0;break e}catch{}L=!1}L||(d=null)}}else f=="mouseover"?d=l.fromElement:f=="mouseout"&&(d=l.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:er[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&ht.aa.h.call(this)}}R(ht,Oe);var er={2:"touch",3:"pen",4:"mouse"};ht.prototype.h=function(){ht.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Nt="closure_listenable_"+(1e6*Math.random()|0),Ll=0;function Tr(l,d,f,x,L){this.listener=l,this.proxy=null,this.src=d,this.type=f,this.capture=!!x,this.ha=L,this.key=++Ll,this.da=this.fa=!1}function es(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ir(l){this.src=l,this.g={},this.h=0}Ir.prototype.add=function(l,d,f,x,L){var U=l.toString();l=this.g[U],l||(l=this.g[U]=[],this.h++);var Y=Gs(l,d,x,L);return-1<Y?(d=l[Y],f||(d.fa=!1)):(d=new Tr(d,this.src,U,!!x,L),d.fa=f,l.push(d)),d};function Pi(l,d){var f=d.type;if(f in l.g){var x=l.g[f],L=Array.prototype.indexOf.call(x,d,void 0),U;(U=0<=L)&&Array.prototype.splice.call(x,L,1),U&&(es(d),l.g[f].length==0&&(delete l.g[f],l.h--))}}function Gs(l,d,f,x){for(var L=0;L<l.length;++L){var U=l[L];if(!U.da&&U.listener==d&&U.capture==!!f&&U.ha==x)return L}return-1}var qs="closure_lm_"+(1e6*Math.random()|0),Sr={};function pn(l,d,f,x,L){if(Array.isArray(d)){for(var U=0;U<d.length;U++)pn(l,d[U],f,x,L);return null}return f=ee(f),l&&l[Nt]?l.K(d,f,h(x)?!!x.capture:!1,L):Ol(l,d,f,!1,x,L)}function Ol(l,d,f,x,L,U){if(!d)throw Error("Invalid event type");var Y=h(L)?!!L.capture:!!L,Ue=ts(l);if(Ue||(l[qs]=Ue=new Ir(l)),f=Ue.add(d,f,x,Y,U),f.proxy)return f;if(x=ji(),f.proxy=x,x.src=l,x.listener=f,l.addEventListener)Ft||(L=Y),L===void 0&&(L=!1),l.addEventListener(d.toString(),x,L);else if(l.attachEvent)l.attachEvent(Sn(d.toString()),x);else if(l.addListener&&l.removeListener)l.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return f}function ji(){function l(f){return d.call(l.src,l.listener,f)}const d=Ho;return l}function tr(l,d,f,x,L){if(Array.isArray(d))for(var U=0;U<d.length;U++)tr(l,d[U],f,x,L);else x=h(x)?!!x.capture:!!x,f=ee(f),l&&l[Nt]?(l=l.i,d=String(d).toString(),d in l.g&&(U=l.g[d],f=Gs(U,f,x,L),-1<f&&(es(U[f]),Array.prototype.splice.call(U,f,1),U.length==0&&(delete l.g[d],l.h--)))):l&&(l=ts(l))&&(d=l.g[d.toString()],l=-1,d&&(l=Gs(d,f,x,L)),(f=-1<l?d[l]:null)&&Ri(f))}function Ri(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[Nt])Pi(d.i,l);else{var f=l.type,x=l.proxy;d.removeEventListener?d.removeEventListener(f,x,l.capture):d.detachEvent?d.detachEvent(Sn(f),x):d.addListener&&d.removeListener&&d.removeListener(x),(f=ts(d))?(Pi(f,l),f.h==0&&(f.src=null,d[qs]=null)):es(l)}}}function Sn(l){return l in Sr?Sr[l]:Sr[l]="on"+l}function Ho(l,d){if(l.da)l=!0;else{d=new ht(d,this);var f=l.listener,x=l.ha||l.src;l.fa&&Ri(l),l=f.call(x,d)}return l}function ts(l){return l=l[qs],l instanceof Ir?l:null}var Ks="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(l){return typeof l=="function"?l:(l[Ks]||(l[Ks]=function(d){return l.handleEvent(d)}),l[Ks])}function Je(){Te.call(this),this.i=new Ir(this),this.M=this,this.F=null}R(Je,Te),Je.prototype[Nt]=!0,Je.prototype.removeEventListener=function(l,d,f,x){tr(this,l,d,f,x)};function pe(l,d){var f,x=l.F;if(x)for(f=[];x;x=x.F)f.push(x);if(l=l.M,x=d.type||d,typeof d=="string")d=new Oe(d,l);else if(d instanceof Oe)d.target=d.target||l;else{var L=d;d=new Oe(x,l),E(d,L)}if(L=!0,f)for(var U=f.length-1;0<=U;U--){var Y=d.g=f[U];L=nr(Y,x,!0,d)&&L}if(Y=d.g=l,L=nr(Y,x,!0,d)&&L,L=nr(Y,x,!1,d)&&L,f)for(U=0;U<f.length;U++)Y=d.g=f[U],L=nr(Y,x,!1,d)&&L}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var f=l.g[d],x=0;x<f.length;x++)es(f[x]);delete l.g[d],l.h--}}this.F=null},Je.prototype.K=function(l,d,f,x){return this.i.add(String(l),d,!1,f,x)},Je.prototype.L=function(l,d,f,x){return this.i.add(String(l),d,!0,f,x)};function nr(l,d,f,x){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var L=!0,U=0;U<d.length;++U){var Y=d[U];if(Y&&!Y.da&&Y.capture==f){var Ue=Y.listener,Ct=Y.ha||Y.src;Y.fa&&Pi(l.i,Y),L=Ue.call(Ct,x)!==!1&&L}}return L&&!x.defaultPrevented}function xe(l,d,f){if(typeof l=="function")f&&(l=_(l,f));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(l,d||0)}function ns(l){l.g=xe(()=>{l.g=null,l.i&&(l.i=!1,ns(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class Qs extends Te{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:ns(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rs(l){Te.call(this),this.h=l,this.g={}}R(rs,Te);var rr=[];function Di(l){W(l.g,function(d,f){this.g.hasOwnProperty(f)&&Ri(d)},l),l.g={}}rs.prototype.N=function(){rs.aa.N.call(this),Di(this)},rs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=c.JSON.stringify,Ys=c.JSON.parse,ss=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Ze(){}Ze.prototype.h=null;function mn(l){return l.h||(l.h=l.i())}function On(){}var is={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sr(){Oe.call(this,"d")}R(sr,Oe);function Mi(){Oe.call(this,"c")}R(Mi,Oe);var ir={},he=null;function $e(){return he=he||new Je}ir.La="serverreachability";function Vn(l){Oe.call(this,ir.La,l)}R(Vn,Oe);function zt(l){const d=$e();pe(d,new Vn(d))}ir.STAT_EVENT="statevent";function or(l,d){Oe.call(this,ir.STAT_EVENT,l),this.stat=d}R(or,Oe);function Ve(l){const d=$e();pe(d,new or(d,l))}ir.Ma="timingevent";function ar(l,d){Oe.call(this,ir.Ma,l),this.size=d}R(ar,Oe);function Nr(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},d)}function Be(){this.g=!0}Be.prototype.xa=function(){this.g=!1};function os(l,d,f,x,L,U){l.info(function(){if(l.g)if(U)for(var Y="",Ue=U.split("&"),Ct=0;Ct<Ue.length;Ct++){var Ce=Ue[Ct].split("=");if(1<Ce.length){var Ut=Ce[0];Ce=Ce[1];var $t=Ut.split("_");Y=2<=$t.length&&$t[1]=="type"?Y+(Ut+"="+Ce+"&"):Y+(Ut+"=redacted&")}}else Y=null;else Y=U;return"XMLHTTP REQ ("+x+") [attempt "+L+"]: "+d+`
`+f+`
`+Y})}function Ar(l,d,f,x,L,U,Y){l.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+L+"]: "+d+`
`+f+`
`+U+" "+Y})}function as(l,d,f,x){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+gm(l,f)+(x?" "+x:"")})}function Go(l,d){l.info(function(){return"TIMEOUT: "+d})}Be.prototype.info=function(){};function gm(l,d){if(!l.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(l=0;l<f.length;l++)if(Array.isArray(f[l])){var x=f[l];if(!(2>x.length)){var L=x[1];if(Array.isArray(L)&&!(1>L.length)){var U=L[0];if(U!="noop"&&U!="stop"&&U!="close")for(var Y=1;Y<L.length;Y++)L[Y]=""}}}}return Xt(f)}catch{return d}}var Fn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qo={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ko;function Xs(){}R(Xs,Ze),Xs.prototype.g=function(){return new XMLHttpRequest},Xs.prototype.i=function(){return{}},Ko=new Xs;function lr(l,d,f,x){this.j=l,this.i=d,this.l=f,this.R=x||1,this.U=new rs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qo}function Qo(){this.i=null,this.g="",this.h=!1}var zn={},Yo={};function Xo(l,d,f){l.L=1,l.v=ei($n(d)),l.m=f,l.P=!0,Jo(l,null)}function Jo(l,d){l.F=Date.now(),Zo(l),l.A=$n(l.v);var f=l.A,x=l.R;Array.isArray(x)||(x=[String(x)]),Hl(f.i,"t",x),l.C=0,f=l.j.J,l.h=new Qo,l.g=ym(l.j,f?d:null,!l.m),0<l.O&&(l.M=new Qs(_(l.Y,l,l.g),l.O)),d=l.U,f=l.g,x=l.ca;var L="readystatechange";Array.isArray(L)||(L&&(rr[0]=L.toString()),L=rr);for(var U=0;U<L.length;U++){var Y=pn(f,L[U],x||d.handleEvent,!1,d.h||d);if(!Y)break;d.g[Y.key]=Y}d=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),zt(),os(l.i,l.u,l.A,l.l,l.R,l.m)}lr.prototype.ca=function(l){l=l.target;const d=this.M;d&&je(l)==3?d.j():this.Y(l)},lr.prototype.Y=function(l){try{if(l==this.g)e:{const $t=je(this.g);var d=this.g.Ba();const zi=this.g.Z();if(!(3>$t)&&($t!=3||this.g&&(this.h.h||this.g.oa()||Re(this.g)))){this.J||$t!=4||d==7||(d==8||0>=zi?zt(3):zt(2)),Cr(this);var f=this.g.Z();this.X=f;t:if(Fe(this)){var x=Re(this.g);l="";var L=x.length,U=je(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Nn(this),sn(this);var Y="";break t}this.h.i=new c.TextDecoder}for(d=0;d<L;d++)this.h.h=!0,l+=this.h.i.decode(x[d],{stream:!(U&&d==L-1)});x.length=0,this.h.g+=l,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=f==200,Ar(this.i,this.u,this.A,this.l,this.R,$t,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,Ct=this.g;if((Ue=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(Ue)){var Ce=Ue;break t}}Ce=null}if(f=Ce)as(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,cr(this,f);else{this.o=!1,this.s=3,Ve(12),Nn(this),sn(this);break e}}if(this.P){f=!0;let Wn;for(;!this.J&&this.C<Y.length;)if(Wn=rn(this,Y),Wn==Yo){$t==4&&(this.s=4,Ve(14),f=!1),as(this.i,this.l,null,"[Incomplete Response]");break}else if(Wn==zn){this.s=4,Ve(15),as(this.i,this.l,Y,"[Invalid Chunk]"),f=!1;break}else as(this.i,this.l,Wn,null),cr(this,Wn);if(Fe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||Y.length!=0||this.h.h||(this.s=1,Ve(16),f=!1),this.o=this.o&&f,!f)as(this.i,this.l,Y,"[Invalid Chunked Response]"),Nn(this),sn(this);else if(0<Y.length&&!this.W){this.W=!0;var Ut=this.j;Ut.g==this&&Ut.ba&&!Ut.M&&(Ut.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),xn(Ut),Ut.M=!0,Ve(11))}}else as(this.i,this.l,Y,null),cr(this,Y);$t==4&&Nn(this),this.o&&!this.J&&($t==4?vt(this.j,this):(this.o=!1,Zo(this)))}else et(this.g),f==400&&0<Y.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),Nn(this),sn(this)}}}catch{}finally{}};function Fe(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function rn(l,d){var f=l.C,x=d.indexOf(`
`,f);return x==-1?Yo:(f=Number(d.substring(f,x)),isNaN(f)?zn:(x+=1,x+f>d.length?Yo:(d=d.slice(x,x+f),l.C=x+f,d)))}lr.prototype.cancel=function(){this.J=!0,Nn(this)};function Zo(l){l.S=Date.now()+l.I,ad(l,l.I)}function ad(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Nr(_(l.ba,l),d)}function Cr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}lr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Go(this.i,this.A),this.L!=2&&(zt(),Ve(17)),Nn(this),this.s=2,sn(this)):ad(this,this.S-l)};function sn(l){l.j.G==0||l.J||vt(l.j,l)}function Nn(l){Cr(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,Di(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function cr(l,d){try{var f=l.j;if(f.G!=0&&(f.g==l||na(f.h,l))){if(!l.K&&na(f.h,l)&&f.G==3){try{var x=f.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var L=x;if(L[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<l.F)ft(f),An(f);else break e;vn(f),Ve(18)}}else f.za=L[1],0<f.za-f.T&&37500>L[2]&&f.F&&f.v==0&&!f.C&&(f.C=Nr(_(f.Za,f),6e3));if(1>=Js(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ur(f,11)}else if((l.K||f.g==l)&&ft(f),!I(d))for(L=f.Da.g.parse(d),d=0;d<L.length;d++){let Ce=L[d];if(f.T=Ce[0],Ce=Ce[1],f.G==2)if(Ce[0]=="c"){f.K=Ce[1],f.ia=Ce[2];const Ut=Ce[3];Ut!=null&&(f.la=Ut,f.j.info("VER="+f.la));const $t=Ce[4];$t!=null&&(f.Aa=$t,f.j.info("SVER="+f.Aa));const zi=Ce[5];zi!=null&&typeof zi=="number"&&0<zi&&(x=1.5*zi,f.L=x,f.j.info("backChannelRequestTimeoutMs_="+x)),x=f;const Wn=l.g;if(Wn){const ql=Wn.g?Wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ql){var U=x.h;U.g||ql.indexOf("spdy")==-1&&ql.indexOf("quic")==-1&&ql.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(Zs(U,U.h),U.h=null))}if(x.D){const pd=Wn.g?Wn.g.getResponseHeader("X-HTTP-Session-Id"):null;pd&&(x.ya=pd,ze(x.I,x.D,pd))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-l.F,f.j.info("Handshake RTT: "+f.R+"ms")),x=f;var Y=l;if(x.qa=aa(x,x.J?x.ia:null,x.W),Y.K){gn(x.h,Y);var Ue=Y,Ct=x.L;Ct&&(Ue.I=Ct),Ue.B&&(Cr(Ue),Zo(Ue)),x.g=Y}else tt(x);0<f.i.length&&Ee(f)}else Ce[0]!="stop"&&Ce[0]!="close"||ur(f,7);else f.G==3&&(Ce[0]=="stop"||Ce[0]=="close"?Ce[0]=="stop"?ur(f,7):He(f):Ce[0]!="noop"&&f.l&&f.l.ta(Ce),f.v=0)}}zt(4)}catch{}}var ea=class{constructor(l,d){this.g=l,this.map=d}};function ta(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Un(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Js(l){return l.h?1:l.g?l.g.size:0}function na(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function Zs(l,d){l.g?l.g.add(d):l.h=d}function gn(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}ta.prototype.cancel=function(){if(this.i=ra(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ra(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const f of l.g.values())d=d.concat(f.D);return d}return M(l.i)}function yn(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var d=[],f=l.length,x=0;x<f;x++)d.push(l[x]);return d}d=[],f=0;for(x in l)d[f++]=l[x];return d}function ld(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var d=[];l=l.length;for(var f=0;f<l;f++)d.push(f);return d}d=[],f=0;for(const x in l)d[f++]=x;return d}}}function Vl(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var f=ld(l),x=yn(l),L=x.length,U=0;U<L;U++)d.call(void 0,x[U],f&&f[U],l)}var Fl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cd(l,d){if(l){l=l.split("&");for(var f=0;f<l.length;f++){var x=l[f].indexOf("="),L=null;if(0<=x){var U=l[f].substring(0,x);L=l[f].substring(x+1)}else U=l[f];d(U,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Pr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Pr){this.h=l.h,Li(this,l.j),this.o=l.o,this.g=l.g,Oi(this,l.s),this.l=l.l;var d=l.i,f=new ni;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),zl(this,f),this.m=l.m}else l&&(d=String(l).match(Fl))?(this.h=!1,Li(this,d[1]||"",!0),this.o=ti(d[2]||""),this.g=ti(d[3]||"",!0),Oi(this,d[4]),this.l=ti(d[5]||"",!0),zl(this,d[6]||"",!0),this.m=ti(d[7]||"")):(this.h=!1,this.i=new ni(null,this.h))}Pr.prototype.toString=function(){var l=[],d=this.j;d&&l.push(ls(d,Ul,!0),":");var f=this.g;return(f||d=="file")&&(l.push("//"),(d=this.o)&&l.push(ls(d,Ul,!0),"@"),l.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&l.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&l.push("/"),l.push(ls(f,f.charAt(0)=="/"?Bl:$l,!0))),(f=this.i.toString())&&l.push("?",f),(f=this.m)&&l.push("#",ls(f,ud)),l.join("")};function $n(l){return new Pr(l)}function Li(l,d,f){l.j=f?ti(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function Oi(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function zl(l,d,f){d instanceof ni?(l.i=d,dd(l.i,l.h)):(f||(d=ls(d,Wl)),l.i=new ni(d,l.h))}function ze(l,d,f){l.i.set(d,f)}function ei(l){return ze(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ti(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ls(l,d,f){return typeof l=="string"?(l=encodeURI(l).replace(d,sa),f&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function sa(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ul=/[#\/\?@]/g,$l=/[#\?:]/g,Bl=/[#\?]/g,Wl=/[#\?@]/g,ud=/#/g;function ni(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function Bn(l){l.g||(l.g=new Map,l.h=0,l.i&&cd(l.i,function(d,f){l.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=ni.prototype,t.add=function(l,d){Bn(this),this.i=null,l=cs(this,l);var f=this.g.get(l);return f||this.g.set(l,f=[]),f.push(d),this.h+=1,this};function Vi(l,d){Bn(l),d=cs(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function ia(l,d){return Bn(l),d=cs(l,d),l.g.has(d)}t.forEach=function(l,d){Bn(this),this.g.forEach(function(f,x){f.forEach(function(L){l.call(d,L,x,this)},this)},this)},t.na=function(){Bn(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let x=0;x<d.length;x++){const L=l[x];for(let U=0;U<L.length;U++)f.push(d[x])}return f},t.V=function(l){Bn(this);let d=[];if(typeof l=="string")ia(this,l)&&(d=d.concat(this.g.get(cs(this,l))));else{l=Array.from(this.g.values());for(let f=0;f<l.length;f++)d=d.concat(l[f])}return d},t.set=function(l,d){return Bn(this),this.i=null,l=cs(this,l),ia(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function Hl(l,d,f){Vi(l,d),0<f.length&&(l.i=null,l.g.set(cs(l,d),M(f)),l.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var x=d[f];const U=encodeURIComponent(String(x)),Y=this.V(x);for(x=0;x<Y.length;x++){var L=U;Y[x]!==""&&(L+="="+encodeURIComponent(String(Y[x]))),l.push(L)}}return this.i=l.join("&")};function cs(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function dd(l,d){d&&!l.j&&(Bn(l),l.i=null,l.g.forEach(function(f,x){var L=x.toLowerCase();x!=L&&(Vi(this,x),Hl(this,L,f))},l)),l.j=d}function hd(l,d){const f=new Be;if(c.Image){const x=new Image;x.onload=C(Ie,f,"TestLoadImage: loaded",!0,d,x),x.onerror=C(Ie,f,"TestLoadImage: error",!1,d,x),x.onabort=C(Ie,f,"TestLoadImage: abort",!1,d,x),x.ontimeout=C(Ie,f,"TestLoadImage: timeout",!1,d,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=l}else d(!1)}function fd(l,d){const f=new Be,x=new AbortController,L=setTimeout(()=>{x.abort(),Ie(f,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:x.signal}).then(U=>{clearTimeout(L),U.ok?Ie(f,"TestPingServer: ok",!0,d):Ie(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(L),Ie(f,"TestPingServer: error",!1,d)})}function Ie(l,d,f,x,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),x(f)}catch{}}function at(){this.g=new ss}function yt(l,d,f){const x=f||"";try{Vl(l,function(L,U){let Y=L;h(L)&&(Y=Xt(L)),d.push(x+U+"="+encodeURIComponent(Y))})}catch(L){throw d.push(x+"type="+encodeURIComponent("_badmap")),L}}function ri(l){this.l=l.Ub||null,this.j=l.eb||!1}R(ri,Ze),ri.prototype.g=function(){return new p(this.l,this.j)},ri.prototype.i=function(l){return function(){return l}}({});function p(l,d){Je.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(p,Je),t=p.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,j(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,S(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,j(this)),this.g&&(this.readyState=3,j(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;y(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function y(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?S(this):j(this),this.readyState==3&&y(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,S(this))},t.Qa=function(l){this.g&&(this.response=l,S(this))},t.ga=function(){this.g&&S(this)};function S(l){l.readyState=4,l.l=null,l.j=null,l.v=null,j(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,l.push(f[0]+": "+f[1]),f=d.next();return l.join(`\r
`)};function j(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(p.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function $(l){let d="";return W(l,function(f,x){d+=x,d+=":",d+=f,d+=`\r
`}),d}function V(l,d,f){e:{for(x in f){var x=!1;break e}x=!0}x||(f=$(f),typeof l=="string"?f!=null&&encodeURIComponent(String(f)):ze(l,d,f))}function z(l){Je.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(z,Je);var H=/^https?$/i,X=["POST","PUT"];t=z.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,f,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ko.g(),this.v=this.o?mn(this.o):mn(Ko),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch(U){q(this,U);return}if(l=f||"",f=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var L in x)f.set(L,x[L]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const U of x.keys())f.set(U,x.get(U));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(f.keys()).find(U=>U.toLowerCase()=="content-type"),L=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(X,d,void 0))||x||L||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,Y]of f)this.g.setRequestHeader(U,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{te(this),this.u=!0,this.g.send(l),this.u=!1}catch(U){q(this,U)}};function q(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,J(l),ie(l)}function J(l){l.A||(l.A=!0,pe(l,"complete"),pe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,pe(this,"complete"),pe(this,"abort"),ie(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ie(this,!0)),z.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ce(this):this.bb())},t.bb=function(){ce(this)};function ce(l){if(l.h&&typeof o<"u"&&(!l.v[1]||je(l)!=4||l.Z()!=2)){if(l.u&&je(l)==4)xe(l.Ea,0,l);else if(pe(l,"readystatechange"),je(l)==4){l.h=!1;try{const Y=l.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var x;if(x=Y===0){var L=String(l.D).match(Fl)[1]||null;!L&&c.self&&c.self.location&&(L=c.self.location.protocol.slice(0,-1)),x=!H.test(L?L.toLowerCase():"")}f=x}if(f)pe(l,"complete"),pe(l,"success");else{l.m=6;try{var U=2<je(l)?l.g.statusText:""}catch{U=""}l.l=U+" ["+l.Z()+"]",J(l)}}finally{ie(l)}}}}function ie(l,d){if(l.g){te(l);const f=l.g,x=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||pe(l,"ready");try{f.onreadystatechange=x}catch{}}}function te(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function je(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<je(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),Ys(d)}};function Re(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function et(l){const d={};l=(l.g&&2<=je(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<l.length;x++){if(I(l[x]))continue;var f=P(l[x]);const L=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const U=d[L]||[];d[L]=U,U.push(f)}b(d,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function lt(l,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[l]||d}function jr(l){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=lt("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=lt("baseRetryDelayMs",5e3,l),this.cb=lt("retryDelaySeedMs",1e4,l),this.Wa=lt("forwardChannelMaxRetries",2,l),this.wa=lt("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new ta(l&&l.concurrentRequestLimit),this.Da=new at,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=jr.prototype,t.la=8,t.G=1,t.connect=function(l,d,f,x){Ve(0),this.W=l,this.H=d||{},f&&x!==void 0&&(this.H.OSID=f,this.H.OAID=x),this.F=this.X,this.I=aa(this,null,this.W),Ee(this)};function He(l){if(oe(l),l.G==3){var d=l.U++,f=$n(l.I);if(ze(f,"SID",l.K),ze(f,"RID",d),ze(f,"TYPE","terminate"),Se(l,f),d=new lr(l,l.j,d),d.L=2,d.v=ei($n(f)),f=!1,c.navigator&&c.navigator.sendBeacon)try{f=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&c.Image&&(new Image().src=d.v,f=!0),f||(d.g=ym(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Zo(d)}oa(l)}function An(l){l.g&&(xn(l),l.g.cancel(),l.g=null)}function oe(l){An(l),l.u&&(c.clearTimeout(l.u),l.u=null),ft(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ee(l){if(!Un(l.h)&&!l.s){l.s=!0;var d=l.Ga;Xe||ue(),Z||(Xe(),Z=!0),de.add(d,l),l.B=0}}function Jt(l,d){return Js(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Nr(_(l.Ga,l,d),si(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const L=new lr(this,this.j,l);let U=this.o;if(this.S&&(U?(U=v(U),E(U,this.S)):U=this.S),this.m!==null||this.O||(L.H=U,U=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var x=this.i[f];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Ge(this,L,d),f=$n(this.I),ze(f,"RID",l),ze(f,"CVER",22),this.D&&ze(f,"X-HTTP-Session-Id",this.D),Se(this,f),U&&(this.O?d="headers="+encodeURIComponent(String($(U)))+"&"+d:this.m&&V(f,this.m,U)),Zs(this.h,L),this.Ua&&ze(f,"TYPE","init"),this.P?(ze(f,"$req",d),ze(f,"SID","null"),L.T=!0,Xo(L,f,null)):Xo(L,f,d),this.G=2}}else this.G==3&&(l?At(this,l):this.i.length==0||Un(this.h)||At(this))};function At(l,d){var f;d?f=d.l:f=l.U++;const x=$n(l.I);ze(x,"SID",l.K),ze(x,"RID",f),ze(x,"AID",l.T),Se(l,x),l.m&&l.o&&V(x,l.m,l.o),f=new lr(l,l.j,f,l.B+1),l.m===null&&(f.H=l.o),d&&(l.i=d.D.concat(l.i)),d=Ge(l,f,1e3),f.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Zs(l.h,f),Xo(f,x,d)}function Se(l,d){l.H&&W(l.H,function(f,x){ze(d,x,f)}),l.l&&Vl({},function(f,x){ze(d,x,f)})}function Ge(l,d,f){f=Math.min(l.i.length,f);var x=l.l?_(l.l.Na,l.l,l):null;e:{var L=l.i;let U=-1;for(;;){const Y=["count="+f];U==-1?0<f?(U=L[0].g,Y.push("ofs="+U)):U=0:Y.push("ofs="+U);let Ue=!0;for(let Ct=0;Ct<f;Ct++){let Ce=L[Ct].g;const Ut=L[Ct].map;if(Ce-=U,0>Ce)U=Math.max(0,L[Ct].g-100),Ue=!1;else try{yt(Ut,Y,"req"+Ce+"_")}catch{x&&x(Ut)}}if(Ue){x=Y.join("&");break e}}}return l=l.i.splice(0,f),d.D=l,x}function tt(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;Xe||ue(),Z||(Xe(),Z=!0),de.add(d,l),l.v=0}}function vn(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Nr(_(l.Fa,l),si(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,us(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Nr(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),An(this),us(this))};function xn(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function us(l){l.g=new lr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=$n(l.qa);ze(d,"RID","rpc"),ze(d,"SID",l.K),ze(d,"AID",l.T),ze(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&ze(d,"TO",l.ja),ze(d,"TYPE","xmlhttp"),Se(l,d),l.m&&l.o&&V(d,l.m,l.o),l.L&&(l.g.I=l.L);var f=l.g;l=l.ia,f.L=1,f.v=ei($n(d)),f.m=null,f.P=!0,Jo(f,l)}t.Za=function(){this.C!=null&&(this.C=null,An(this),vn(this),Ve(19))};function ft(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function vt(l,d){var f=null;if(l.g==d){ft(l),xn(l),l.g=null;var x=2}else if(na(l.h,d))f=d.D,gn(l.h,d),x=1;else return;if(l.G!=0){if(d.o)if(x==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var L=l.B;x=$e(),pe(x,new ar(x,f)),Ee(l)}else tt(l);else if(L=d.s,L==3||L==0&&0<d.X||!(x==1&&Jt(l,d)||x==2&&vn(l)))switch(f&&0<f.length&&(d=l.h,d.i=d.i.concat(f)),L){case 1:ur(l,5);break;case 4:ur(l,10);break;case 3:ur(l,6);break;default:ur(l,2)}}}function si(l,d){let f=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(f*=2),f*d}function ur(l,d){if(l.j.info("Error code "+d),d==2){var f=_(l.fb,l),x=l.Xa;const L=!x;x=new Pr(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Li(x,"https"),ei(x),L?hd(x.toString(),f):fd(x.toString(),f)}else Ve(2);l.G=0,l.l&&l.l.sa(d),oa(l),oe(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function oa(l){if(l.G=0,l.ka=[],l.l){const d=ra(l.h);(d.length!=0||l.i.length!=0)&&(F(l.ka,d),F(l.ka,l.i),l.h.i.length=0,M(l.i),l.i.length=0),l.l.ra()}}function aa(l,d,f){var x=f instanceof Pr?$n(f):new Pr(f);if(x.g!="")d&&(x.g=d+"."+x.g),Oi(x,x.s);else{var L=c.location;x=L.protocol,d=d?d+"."+L.hostname:L.hostname,L=+L.port;var U=new Pr(null);x&&Li(U,x),d&&(U.g=d),L&&Oi(U,L),f&&(U.l=f),x=U}return f=l.D,d=l.ya,f&&d&&ze(x,f,d),ze(x,"VER",l.la),Se(l,x),x}function ym(l,d,f){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new z(new ri({eb:f})):new z(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vm(){}t=vm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Gl(){}Gl.prototype.g=function(l,d){return new _n(l,d)};function _n(l,d){Je.call(this),this.g=new jr(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!I(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!I(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new Fi(this)}R(_n,Je),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){He(this.g)},_n.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var f={};f.__data__=l,l=f}else this.u&&(f={},f.__data__=Xt(l),l=f);d.i.push(new ea(d.Ya++,l)),d.G==3&&Ee(d)},_n.prototype.N=function(){this.g.l=null,delete this.j,He(this.g),delete this.g,_n.aa.N.call(this)};function xm(l){sr.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const f in d){l=f;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}R(xm,sr);function _m(){Mi.call(this),this.status=1}R(_m,Mi);function Fi(l){this.g=l}R(Fi,vm),Fi.prototype.ua=function(){pe(this.g,"a")},Fi.prototype.ta=function(l){pe(this.g,new xm(l))},Fi.prototype.sa=function(l){pe(this.g,new _m)},Fi.prototype.ra=function(){pe(this.g,"b")},Gl.prototype.createWebChannel=Gl.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,C_=function(){return new Gl},A_=function(){return $e()},N_=ir,uf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fn.NO_ERROR=0,Fn.TIMEOUT=8,Fn.HTTP_ERROR=6,Dc=Fn,qo.COMPLETE="complete",S_=qo,On.EventType=is,is.OPEN="a",is.CLOSE="b",is.ERROR="c",is.MESSAGE="d",Je.prototype.listen=Je.prototype.K,Ea=On,z.prototype.listenOnce=z.prototype.L,z.prototype.getLastError=z.prototype.Ka,z.prototype.getLastErrorCode=z.prototype.Ba,z.prototype.getStatus=z.prototype.Z,z.prototype.getResponseJson=z.prototype.Oa,z.prototype.getResponseText=z.prototype.oa,z.prototype.send=z.prototype.ea,z.prototype.setWithCredentials=z.prototype.Ha,I_=z}).apply(typeof hc<"u"?hc:typeof self<"u"?self:typeof window<"u"?window:{});const hy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=new Tp("@firebase/firestore");function ga(){return ki.logLevel}function re(t,...e){if(ki.logLevel<=be.DEBUG){const n=e.map(Vp);ki.debug(`Firestore (${zo}): ${t}`,...n)}}function Yr(t,...e){if(ki.logLevel<=be.ERROR){const n=e.map(Vp);ki.error(`Firestore (${zo}): ${t}`,...n)}}function So(t,...e){if(ki.logLevel<=be.WARN){const n=e.map(Vp);ki.warn(`Firestore (${zo}): ${t}`,...n)}}function Vp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(t="Unexpected state"){const e=`FIRESTORE (${zo}) INTERNAL ASSERTION FAILED: `+t;throw Yr(e),new Error(e)}function Me(t,e){t||ge()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends Zr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Gt.UNAUTHENTICATED))}shutdown(){}}class zI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class UI{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Me(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new mi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Me(typeof r.accessToken=="string"),new P_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new Gt(e)}}class $I{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class BI{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $I(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class WI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HI{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Me(this.o===void 0);const r=i=>{i.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Me(typeof n.token=="string"),this.R=n.token,new WI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=GI(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Pe(t,e){return t<e?-1:t>e?1:0}function No(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new se(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new wt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pe(this.nanoseconds,e.nanoseconds):Pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ye(e)}static min(){return new ye(new wt(0,0))}static max(){return new ye(new wt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n,r){n===void 0?n=0:n>e.length&&ge(),r===void 0?r=e.length-n:r>e.length-n&&ge(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ll.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ll?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ke extends ll{construct(e,n,r){return new Ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(G.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ke(n)}static emptyPath(){return new Ke([])}}const qI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends ll{construct(e,n,r){return new Dt(e,n,r)}static isValidIdentifier(e){return qI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new se(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new se(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new se(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new se(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dt(n)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Ke.fromString(e))}static fromName(e){return new ae(Ke.fromString(e).popFirst(5))}static empty(){return new ae(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Ke(e.slice()))}}function KI(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ye.fromTimestamp(r===1e9?new wt(n+1,0):new wt(n,r));return new zs(s,ae.empty(),e)}function QI(t){return new zs(t.readTime,t.key,-1)}class zs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zs(ye.min(),ae.empty(),-1)}static max(){return new zs(ye.max(),ae.empty(),-1)}}function YI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:Pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Al(t){if(t.code!==G.FAILED_PRECONDITION||t.message!==XI)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(s=>s?K.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new K((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(m=>{o[h]=m,++c,c===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new K((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function ZI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Cl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Fp.oe=-1;function Yu(t){return t==null}function _u(t){return t===0&&1/t==-1/0}function eS(t){return typeof t=="number"&&Number.isInteger(t)&&!_u(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Uo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function R_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n){this.comparator=e,this.root=n||Rt.EMPTY}insert(e,n){return new ot(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fc(this.root,e,this.comparator,!1)}getReverseIterator(){return new fc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fc(this.root,e,this.comparator,!0)}}class fc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Rt.RED,this.left=s??Rt.EMPTY,this.right=i??Rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.comparator=e,this.data=new ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new py(this.data.getIterator())}getIteratorFrom(e){return new py(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Lt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Lt(this.comparator);return n.data=e,n}}class py{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.fields=e,e.sort(Dt.comparator)}static empty(){return new Qn([])}unionWith(e){let n=new Lt(Dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return No(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new D_("Invalid base64 string: "+i):i}}(e);return new Vt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const tS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(t){if(Me(!!t),typeof t=="string"){let e=0;const n=tS.exec(t);if(Me(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ti(t){return typeof t=="string"?Vt.fromBase64String(t):Vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Up(t){const e=t.mapValue.fields.__previous_value__;return zp(e)?Up(e):e}function cl(t){const e=Us(t.mapValue.fields.__local_write_time__.timestampValue);return new wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,n,r,s,i,o,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class ul{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ul("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ul&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc={mapValue:{}};function Ii(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zp(t)?4:sS(t)?9007199254740991:rS(t)?10:11:ge()}function kr(t,e){if(t===e)return!0;const n=Ii(t);if(n!==Ii(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return cl(t).isEqual(cl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Us(s.timestampValue),c=Us(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ti(s.bytesValue).isEqual(Ti(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ut(s.geoPointValue.latitude)===ut(i.geoPointValue.latitude)&&ut(s.geoPointValue.longitude)===ut(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ut(s.integerValue)===ut(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ut(s.doubleValue),c=ut(i.doubleValue);return o===c?_u(o)===_u(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return No(t.arrayValue.values||[],e.arrayValue.values||[],kr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(fy(o)!==fy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!kr(o[u],c[u])))return!1;return!0}(t,e);default:return ge()}}function dl(t,e){return(t.values||[]).find(n=>kr(n,e))!==void 0}function Ao(t,e){if(t===e)return 0;const n=Ii(t),r=Ii(e);if(n!==r)return Pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=ut(i.integerValue||i.doubleValue),u=ut(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return my(t.timestampValue,e.timestampValue);case 4:return my(cl(t),cl(e));case 5:return Pe(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Ti(i),u=Ti(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const m=Pe(c[h],u[h]);if(m!==0)return m}return Pe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=Pe(ut(i.latitude),ut(o.latitude));return c!==0?c:Pe(ut(i.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,u,h,m;const g=i.fields||{},_=o.fields||{},C=(c=g.value)===null||c===void 0?void 0:c.arrayValue,R=(u=_.value)===null||u===void 0?void 0:u.arrayValue,M=Pe(((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0,((m=R==null?void 0:R.values)===null||m===void 0?void 0:m.length)||0);return M!==0?M:gy(C,R)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===pc.mapValue&&o===pc.mapValue)return 0;if(i===pc.mapValue)return 1;if(o===pc.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},m=Object.keys(h);u.sort(),m.sort();for(let g=0;g<u.length&&g<m.length;++g){const _=Pe(u[g],m[g]);if(_!==0)return _;const C=Ao(c[u[g]],h[m[g]]);if(C!==0)return C}return Pe(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ge()}}function my(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pe(t,e);const n=Us(t),r=Us(e),s=Pe(n.seconds,r.seconds);return s!==0?s:Pe(n.nanos,r.nanos)}function gy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ao(n[s],r[s]);if(i)return i}return Pe(n.length,r.length)}function Co(t){return df(t)}function df(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Us(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ti(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=df(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${df(n.fields[o])}`;return s+"}"}(t.mapValue):ge()}function yy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function hf(t){return!!t&&"integerValue"in t}function $p(t){return!!t&&"arrayValue"in t}function vy(t){return!!t&&"nullValue"in t}function xy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mc(t){return!!t&&"mapValue"in t}function rS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Va(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Uo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Va(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Va(t.arrayValue.values[n]);return e}return Object.assign({},t)}function sS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.value=e}static empty(){return new jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Mc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Va(n)}setAll(e){let n=Dt.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=Va(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Mc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Mc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Uo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new jn(Va(this.value))}}function M_(t){const e=[];return Uo(t.fields,(n,r)=>{const s=new Dt([n]);if(Mc(r)){const i=M_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Kt(e,0,ye.min(),ye.min(),ye.min(),jn.empty(),0)}static newFoundDocument(e,n,r,s){return new Kt(e,1,n,ye.min(),r,s,0)}static newNoDocument(e,n){return new Kt(e,2,n,ye.min(),ye.min(),jn.empty(),0)}static newUnknownDocument(e,n){return new Kt(e,3,n,ye.min(),ye.min(),jn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n){this.position=e,this.inclusive=n}}function _y(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),n.key):r=Ao(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function wy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,n="asc"){this.field=e,this.dir=n}}function iS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{}class gt extends L_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new aS(e,n,r):n==="array-contains"?new uS(e,r):n==="in"?new dS(e,r):n==="not-in"?new hS(e,r):n==="array-contains-any"?new fS(e,r):new gt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new lS(e,r):new cS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ao(n,this.value)):n!==null&&Ii(this.value)===Ii(n)&&this.matchesComparison(Ao(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zn extends L_{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Zn(e,n)}matches(e){return O_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function O_(t){return t.op==="and"}function V_(t){return oS(t)&&O_(t)}function oS(t){for(const e of t.filters)if(e instanceof Zn)return!1;return!0}function ff(t){if(t instanceof gt)return t.field.canonicalString()+t.op.toString()+Co(t.value);if(V_(t))return t.filters.map(e=>ff(e)).join(",");{const e=t.filters.map(n=>ff(n)).join(",");return`${t.op}(${e})`}}function F_(t,e){return t instanceof gt?function(r,s){return s instanceof gt&&r.op===s.op&&r.field.isEqual(s.field)&&kr(r.value,s.value)}(t,e):t instanceof Zn?function(r,s){return s instanceof Zn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&F_(o,s.filters[c]),!0):!1}(t,e):void ge()}function z_(t){return t instanceof gt?function(n){return`${n.field.canonicalString()} ${n.op} ${Co(n.value)}`}(t):t instanceof Zn?function(n){return n.op.toString()+" {"+n.getFilters().map(z_).join(" ,")+"}"}(t):"Filter"}class aS extends gt{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class lS extends gt{constructor(e,n){super(e,"in",n),this.keys=U_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class cS extends gt{constructor(e,n){super(e,"not-in",n),this.keys=U_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function U_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class uS extends gt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return $p(n)&&dl(n.arrayValue,this.value)}}class dS extends gt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&dl(this.value.arrayValue,n)}}class hS extends gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(dl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!dl(this.value.arrayValue,n)}}class fS extends gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!$p(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>dl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}}function Ey(t,e=null,n=[],r=[],s=null,i=null,o=null){return new pS(t,e,n,r,s,i,o)}function Bp(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ff(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Yu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Co(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Co(r)).join(",")),e.ue=n}return e.ue}function Wp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!iS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!F_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wy(t.startAt,e.startAt)&&wy(t.endAt,e.endAt)}function pf(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function mS(t,e,n,r,s,i,o,c){return new Pl(t,e,n,r,s,i,o,c)}function Hp(t){return new Pl(t)}function by(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $_(t){return t.collectionGroup!==null}function Fa(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Lt(Dt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Eu(i,r))}),n.has(Dt.keyField().canonicalString())||e.ce.push(new Eu(Dt.keyField(),r))}return e.ce}function wr(t){const e=ve(t);return e.le||(e.le=gS(e,Fa(t))),e.le}function gS(t,e){if(t.limitType==="F")return Ey(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Eu(s.field,i)});const n=t.endAt?new wu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wu(t.startAt.position,t.startAt.inclusive):null;return Ey(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function mf(t,e){const n=t.filters.concat([e]);return new Pl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function gf(t,e,n){return new Pl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Xu(t,e){return Wp(wr(t),wr(e))&&t.limitType===e.limitType}function B_(t){return`${Bp(wr(t))}|lt:${t.limitType}`}function $i(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>z_(s)).join(", ")}]`),Yu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Co(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Co(s)).join(",")),`Target(${r})`}(wr(t))}; limitType=${t.limitType})`}function Ju(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Fa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const h=_y(o,c,u);return o.inclusive?h<=0:h<0}(r.startAt,Fa(r),s)||r.endAt&&!function(o,c,u){const h=_y(o,c,u);return o.inclusive?h>=0:h>0}(r.endAt,Fa(r),s))}(t,e)}function yS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function W_(t){return(e,n)=>{let r=!1;for(const s of Fa(t)){const i=vS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function vS(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?Ao(u,h):ge()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Uo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return R_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS=new ot(ae.comparator);function Xr(){return xS}const H_=new ot(ae.comparator);function ba(...t){let e=H_;for(const n of t)e=e.insert(n.key,n);return e}function G_(t){let e=H_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function di(){return za()}function q_(){return za()}function za(){return new $o(t=>t.toString(),(t,e)=>t.isEqual(e))}const _S=new ot(ae.comparator),wS=new Lt(ae.comparator);function we(...t){let e=wS;for(const n of t)e=e.add(n);return e}const ES=new Lt(Pe);function bS(){return ES}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_u(e)?"-0":e}}function K_(t){return{integerValue:""+t}}function kS(t,e){return eS(e)?K_(e):Gp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(){this._=void 0}}function TS(t,e,n){return t instanceof bu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&zp(i)&&(i=Up(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof hl?Y_(t,e):t instanceof fl?X_(t,e):function(s,i){const o=Q_(s,i),c=ky(o)+ky(s.Pe);return hf(o)&&hf(s.Pe)?K_(c):Gp(s.serializer,c)}(t,e)}function IS(t,e,n){return t instanceof hl?Y_(t,e):t instanceof fl?X_(t,e):n}function Q_(t,e){return t instanceof ku?function(r){return hf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class bu extends Zu{}class hl extends Zu{constructor(e){super(),this.elements=e}}function Y_(t,e){const n=J_(e);for(const r of t.elements)n.some(s=>kr(s,r))||n.push(r);return{arrayValue:{values:n}}}class fl extends Zu{constructor(e){super(),this.elements=e}}function X_(t,e){let n=J_(e);for(const r of t.elements)n=n.filter(s=>!kr(s,r));return{arrayValue:{values:n}}}class ku extends Zu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function ky(t){return ut(t.integerValue||t.doubleValue)}function J_(t){return $p(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function SS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof hl&&s instanceof hl||r instanceof fl&&s instanceof fl?No(r.elements,s.elements,kr):r instanceof ku&&s instanceof ku?kr(r.Pe,s.Pe):r instanceof bu&&s instanceof bu}(t.transform,e.transform)}class NS{constructor(e,n){this.version=e,this.transformResults=n}}class Er{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Er}static exists(e){return new Er(void 0,e)}static updateTime(e){return new Er(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Lc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ed{}function Z_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new qp(t.key,Er.none()):new jl(t.key,t.data,Er.none());{const n=t.data,r=jn.empty();let s=new Lt(Dt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ai(t.key,r,new Qn(s.toArray()),Er.none())}}function AS(t,e,n){t instanceof jl?function(s,i,o){const c=s.value.clone(),u=Iy(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Ai?function(s,i,o){if(!Lc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=Iy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(ew(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ua(t,e,n,r){return t instanceof jl?function(i,o,c,u){if(!Lc(i.precondition,o))return c;const h=i.value.clone(),m=Sy(i.fieldTransforms,u,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ai?function(i,o,c,u){if(!Lc(i.precondition,o))return c;const h=Sy(i.fieldTransforms,u,o),m=o.data;return m.setAll(ew(i)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,c){return Lc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function CS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Q_(r.transform,s||null);i!=null&&(n===null&&(n=jn.empty()),n.set(r.field,i))}return n||null}function Ty(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&No(r,s,(i,o)=>SS(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jl extends ed{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ai extends ed{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ew(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Iy(t,e,n){const r=new Map;Me(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,IS(o,c,n[s]))}return r}function Sy(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,TS(i,o,e))}return r}class qp extends ed{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PS extends ed{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&AS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ua(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ua(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=q_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=Z_(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ye.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&No(this.mutations,e.mutations,(n,r)=>Ty(n,r))&&No(this.baseMutations,e.baseMutations,(n,r)=>Ty(n,r))}}class Kp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Me(e.mutations.length===r.length);let s=function(){return _S}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Kp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,ke;function MS(t){switch(t){default:return ge();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function tw(t){if(t===void 0)return Yr("GRPC error has no .code"),G.UNKNOWN;switch(t){case pt.OK:return G.OK;case pt.CANCELLED:return G.CANCELLED;case pt.UNKNOWN:return G.UNKNOWN;case pt.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case pt.INTERNAL:return G.INTERNAL;case pt.UNAVAILABLE:return G.UNAVAILABLE;case pt.UNAUTHENTICATED:return G.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case pt.NOT_FOUND:return G.NOT_FOUND;case pt.ALREADY_EXISTS:return G.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return G.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case pt.ABORTED:return G.ABORTED;case pt.OUT_OF_RANGE:return G.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return G.UNIMPLEMENTED;case pt.DATA_LOSS:return G.DATA_LOSS;default:return ge()}}(ke=pt||(pt={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new pi([4294967295,4294967295],0);function Ny(t){const e=LS().encode(t),n=new T_;return n.update(e),new Uint8Array(n.digest())}function Ay(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new pi([n,r],0),new pi([s,i],0)]}class Qp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ka(`Invalid padding: ${n}`);if(r<0)throw new ka(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ka(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ka(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=pi.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(pi.fromNumber(r)));return s.compare(OS)===1&&(s=new pi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ny(e),[r,s]=Ay(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Qp(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const n=Ny(e),[r,s]=Ay(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ka extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Rl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new td(ye.min(),s,new ot(Pe),Xr(),we())}}class Rl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Rl(r,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class nw{constructor(e,n){this.targetId=e,this.me=n}}class rw{constructor(e,n,r=Vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Cy{constructor(){this.fe=0,this.ge=jy(),this.pe=Vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),r=we();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ge()}}),new Rl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=jy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Me(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class VS{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xr(),this.qe=Py(),this.Qe=new ot(Pe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ge()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(pf(i))if(r===0){const o=new ae(i.path);this.Ue(n,o,Kt.newNoDocument(o,ye.min()))}else Me(r===1);else{const o=this.Ye(n);if(o!==r){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Ti(r).toUint8Array()}catch(u){if(u instanceof D_)return So("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Qp(o,s,i)}catch(u){return So(u instanceof ka?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const c=this.Je(o);if(c){if(i.current&&pf(c.target)){const u=new ae(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Kt.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=we();this.qe.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new td(e,n,this.Qe,this.ke,r);return this.ke=Xr(),this.qe=Py(),this.Qe=new ot(Pe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Cy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Lt(Pe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Cy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Py(){return new ot(ae.comparator)}function jy(){return new ot(ae.comparator)}const FS={asc:"ASCENDING",desc:"DESCENDING"},zS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},US={and:"AND",or:"OR"};class $S{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function yf(t,e){return t.useProto3Json||Yu(e)?e:{value:e}}function Tu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function sw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function BS(t,e){return Tu(t,e.toTimestamp())}function br(t){return Me(!!t),ye.fromTimestamp(function(n){const r=Us(n);return new wt(r.seconds,r.nanos)}(t))}function Yp(t,e){return vf(t,e).canonicalString()}function vf(t,e){const n=function(s){return new Ke(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function iw(t){const e=Ke.fromString(t);return Me(uw(e)),e}function xf(t,e){return Yp(t.databaseId,e.path)}function Qd(t,e){const n=iw(e);if(n.get(1)!==t.databaseId.projectId)throw new se(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(aw(n))}function ow(t,e){return Yp(t.databaseId,e)}function WS(t){const e=iw(t);return e.length===4?Ke.emptyPath():aw(e)}function _f(t){return new Ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function aw(t){return Me(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ry(t,e,n){return{name:xf(t,e),fields:n.value.mapValue.fields}}function HS(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,m){return h.useProto3Json?(Me(m===void 0||typeof m=="string"),Vt.fromBase64String(m||"")):(Me(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Vt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const m=h.code===void 0?G.UNKNOWN:tw(h.code);return new se(m,h.message||"")}(o);n=new rw(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Qd(t,r.document.name),i=br(r.document.updateTime),o=r.document.createTime?br(r.document.createTime):ye.min(),c=new jn({mapValue:{fields:r.document.fields}}),u=Kt.newFoundDocument(s,i,o,c),h=r.targetIds||[],m=r.removedTargetIds||[];n=new Oc(h,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Qd(t,r.document),i=r.readTime?br(r.readTime):ye.min(),o=Kt.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Oc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Qd(t,r.document),i=r.removedTargetIds||[];n=new Oc([],i,s,null)}else{if(!("filter"in e))return ge();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new DS(s,i),c=r.targetId;n=new nw(c,o)}}return n}function GS(t,e){let n;if(e instanceof jl)n={update:Ry(t,e.key,e.value)};else if(e instanceof qp)n={delete:xf(t,e.key)};else if(e instanceof Ai)n={update:Ry(t,e.key,e.data),updateMask:tN(e.fieldMask)};else{if(!(e instanceof PS))return ge();n={verify:xf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof bu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof hl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof fl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ku)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw ge()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:BS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ge()}(t,e.precondition)),n}function qS(t,e){return t&&t.length>0?(Me(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?br(s.updateTime):br(i);return o.isEqual(ye.min())&&(o=br(i)),new NS(o,s.transformResults||[])}(n,e))):[]}function KS(t,e){return{documents:[ow(t,e.path)]}}function QS(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ow(t,s);const i=function(h){if(h.length!==0)return cw(Zn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(m=>function(_){return{field:Bi(_.field),direction:JS(_.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=yf(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function YS(t){let e=WS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Me(r===1);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(g){const _=lw(g);return _ instanceof Zn&&V_(_)?_.getFilters():[_]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(_=>function(R){return new Eu(Wi(R.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(_))}(n.orderBy));let c=null;n.limit&&(c=function(g){let _;return _=typeof g=="object"?g.value:g,Yu(_)?null:_}(n.limit));let u=null;n.startAt&&(u=function(g){const _=!!g.before,C=g.values||[];return new wu(C,_)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const _=!g.before,C=g.values||[];return new wu(C,_)}(n.endAt)),mS(e,s,o,i,c,"F",u,h)}function XS(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function lw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wi(n.unaryFilter.field);return gt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Wi(n.unaryFilter.field);return gt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Wi(n.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Wi(n.unaryFilter.field);return gt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(t):t.fieldFilter!==void 0?function(n){return gt.create(Wi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Zn.create(n.compositeFilter.filters.map(r=>lw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ge()}}(n.compositeFilter.op))}(t):ge()}function JS(t){return FS[t]}function ZS(t){return zS[t]}function eN(t){return US[t]}function Bi(t){return{fieldPath:t.canonicalString()}}function Wi(t){return Dt.fromServerFormat(t.fieldPath)}function cw(t){return t instanceof gt?function(n){if(n.op==="=="){if(xy(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NAN"}};if(vy(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(xy(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NOT_NAN"}};if(vy(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bi(n.field),op:ZS(n.op),value:n.value}}}(t):t instanceof Zn?function(n){const r=n.getFilters().map(s=>cw(s));return r.length===1?r[0]:{compositeFilter:{op:eN(n.op),filters:r}}}(t):ge()}function tN(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function uw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,n,r,s,i=ye.min(),o=ye.min(),c=Vt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ks(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e){this.ct=e}}function rN(t){const e=YS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(){this.un=new iN}addToCollectionParentIndex(e,n){return this.un.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve(zs.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve(zs.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class iN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Lt(Ke.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Lt(Ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Po(0)}static kn(){return new Po(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(){this.changes=new $o(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Kt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ua(r.mutation,s,Qn.empty(),wt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,n,r=we()){const s=di();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=ba();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=di();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,we()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=Xr();const o=za(),c=function(){return za()}();return n.forEach((u,h)=>{const m=r.get(h.key);s.has(h.key)&&(m===void 0||m.mutation instanceof Ai)?i=i.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),Ua(m.mutation,h,m.mutation.getFieldMask(),wt.now())):o.set(h.key,Qn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,m)=>o.set(h,m)),n.forEach((h,m)=>{var g;return c.set(h,new aN(m,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=za();let s=new ot((o,c)=>o-c),i=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let m=r.get(u)||Qn.empty();m=c.applyToLocalView(h,m),r.set(u,m);const g=(s.get(c.batchId)||we()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,m=u.value,g=q_();m.forEach(_=>{if(!i.has(_)){const C=Z_(n.get(_),r.get(_));C!==null&&g.set(_,C),i=i.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):$_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):K.resolve(di());let c=-1,u=i;return o.next(h=>K.forEach(h,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(m)?K.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{u=u.insert(m,_)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,we())).next(m=>({batchId:c,changes:G_(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let s=ba();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=ba();return this.indexManager.getCollectionParents(e,i).next(c=>K.forEach(c,u=>{const h=function(g,_){return new Pl(_,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(m=>{m.forEach((g,_)=>{o=o.insert(g,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,h)=>{const m=h.getKey();o.get(m)===null&&(o=o.insert(m,Kt.newInvalidDocument(m)))});let c=ba();return o.forEach((u,h)=>{const m=i.get(u);m!==void 0&&Ua(m.mutation,h,Qn.empty(),wt.now()),Ju(n,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return K.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:br(s.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:rN(s.bundledQuery),readTime:br(s.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(){this.overlays=new ot(ae.comparator),this.Ir=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=di();return K.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const s=di(),i=n.length+1,o=new ae(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ot((h,m)=>h-m);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let m=i.get(h.largestBatchId);m===null&&(m=di(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=di(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,m)=>c.set(h,m)),!(c.size()>=s)););return K.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new RS(n,r));let i=this.Ir.get(n);i===void 0&&(i=we(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this.Tr=new Lt(bt.Er),this.dr=new Lt(bt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new bt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new bt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ae(new Ke([])),r=new bt(n,e),s=new bt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ae(new Ke([])),r=new bt(n,e),s=new bt(n,e+1);let i=we();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new bt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class bt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ae.comparator(e.key,n.key)||Pe(e.wr,n.wr)}static Ar(e,n){return Pe(e.wr,n.wr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Lt(bt.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new jS(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new bt(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new bt(n,0),s=new bt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);i.push(c)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Lt(Pe);return n.forEach(s=>{const i=new bt(s,0),o=new bt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],c=>{r=r.add(c.wr)})}),K.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new bt(new ae(i),0);let c=new Lt(Pe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.wr)),!0)},o),K.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Me(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return K.forEach(n.mutations,s=>{const i=new bt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new bt(n,0),s=this.br.firstAfterOrEqual(r);return K.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.Mr=e,this.docs=function(){return new ot(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():Kt.newInvalidDocument(n))}getEntries(e,n){let r=Xr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Kt.newInvalidDocument(s))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Xr();const o=n.path,c=new ae(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:m}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||YI(QI(m),r)<=0||(s.has(m.key)||Ju(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ge()}Or(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pN(this)}getSize(e){return K.resolve(this.size)}}class pN extends oN{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.persistence=e,this.Nr=new $o(n=>Bp(n),Wp),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Xp,this.targetCount=0,this.kr=Po.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),K.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Po(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.Kn(n),K.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Fp(0),this.Kr=!1,this.Kr=!0,this.$r=new dN,this.referenceDelegate=e(this),this.Ur=new mN(this),this.indexManager=new sN,this.remoteDocumentCache=function(s){return new fN(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new nN(n),this.Gr=new cN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uN,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new hN(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const s=new yN(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return K.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class yN extends JI{constructor(e){super(),this.currentSequenceNumber=e}}class Jp{constructor(e){this.persistence=e,this.Jr=new Xp,this.Yr=null}static Zr(e){return new Jp(e)}get Xr(){if(this.Yr)return this.Yr;throw ge()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),K.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,r=>{const s=ae.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ye.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return K.or([()=>K.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=we(),s=we();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Zp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return vk()?8:ZI(Yt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new vN;return this.Xi(e,n,o).next(c=>{if(i.result=c,this.zi)return this.es(e,n,o,c.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(ga()<=be.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",$i(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(ga()<=be.DEBUG&&re("QueryEngine","Query:",$i(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ga()<=be.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",$i(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wr(n))):K.resolve())}Yi(e,n){if(by(n))return K.resolve(null);let r=wr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=gf(n,null,"F"),r=wr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=we(...i);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,c);return this.ns(n,h,o,u.readTime)?this.Yi(e,gf(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return by(n)||s.isEqual(ye.min())?K.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?K.resolve(null):(ga()<=be.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$i(n)),this.rs(e,o,n,KI(s,-1)).next(c=>c))})}ts(e,n){let r=new Lt(W_(e));return n.forEach((s,i)=>{Ju(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return ga()<=be.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",$i(n)),this.Ji.getDocumentsMatchingQuery(e,n,zs.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ot(Pe),this._s=new $o(i=>Bp(i),Wp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function wN(t,e,n,r){return new _N(t,e,n,r)}async function dw(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=we();for(const h of s){o.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}for(const h of i){c.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:c}))})})}function EN(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,m){const g=h.batch,_=g.keys();let C=K.resolve();return _.forEach(R=>{C=C.next(()=>m.getEntry(u,R)).next(M=>{const F=h.docVersions.get(R);Me(F!==null),M.version.compareTo(F)<0&&(g.applyToRemoteDocument(M,h),M.isValidDocument()&&(M.setReadTime(h.commitVersion),m.addEntry(M)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=we();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function hw(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function bN(t,e){const n=ve(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((m,g)=>{const _=s.get(g);if(!_)return;c.push(n.Ur.removeMatchingKeys(i,m.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,m.addedDocuments,g)));let C=_.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(Vt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):m.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(m.resumeToken,r)),s=s.insert(g,C),function(M,F,A){return M.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(_,C,m)&&c.push(n.Ur.updateTargetData(i,C))});let u=Xr(),h=we();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(kN(i,o,e.documentUpdates).next(m=>{u=m.Ps,h=m.Is})),!r.isEqual(ye.min())){const m=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(m)}return K.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function kN(t,e,n){let r=we(),s=we();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Xr();return n.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ye.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):re("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function TN(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function IN(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,K.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new ks(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function wf(t,e,n){const r=ve(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Cl(o))throw o;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Dy(t,e,n){const r=ve(t);let s=ye.min(),i=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,m){const g=ve(u),_=g._s.get(m);return _!==void 0?K.resolve(g.os.get(_)):g.Ur.getTargetData(h,m)}(r,o,wr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ye.min(),n?i:we())).next(c=>(SN(r,yS(e),c),{documents:c,Ts:i})))}function SN(t,e,n){let r=t.us.get(e)||ye.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class My{constructor(){this.activeTargetIds=bS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NN{constructor(){this.so=new My,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new My,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mc=null;function Yd(){return mc===null?mc=function(){return 268435456+Math.round(2147483648*Math.random())}():mc++,"0x"+mc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht="WebChannelConnection";class jN extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const c=Yd(),u=this.xo(n,r.toUriEncodedString());re("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,o),this.No(n,u,h,s).then(m=>(re("RestConnection",`Received RPC '${n}' ${c}: `,m),m),m=>{throw So("RestConnection",`RPC '${n}' ${c} failed with error: `,m,"url: ",u,"request:",s),m})}Lo(n,r,s,i,o,c){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+zo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=CN[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Yd();return new Promise((o,c)=>{const u=new I_;u.setWithCredentials(!0),u.listenOnce(S_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Dc.NO_ERROR:const m=u.getResponseJson();re(Ht,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(m)),o(m);break;case Dc.TIMEOUT:re(Ht,`RPC '${e}' ${i} timed out`),c(new se(G.DEADLINE_EXCEEDED,"Request time out"));break;case Dc.HTTP_ERROR:const g=u.getStatus();if(re(Ht,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const C=_==null?void 0:_.error;if(C&&C.status&&C.message){const R=function(F){const A=F.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(A)>=0?A:G.UNKNOWN}(C.status);c(new se(R,C.message))}else c(new se(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new se(G.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{re(Ht,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);re(Ht,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Yd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=C_(),c=A_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=i.join("");re(Ht,`Creating RPC '${e}' stream ${s}: ${m}`,u);const g=o.createWebChannel(m,u);let _=!1,C=!1;const R=new PN({Io:F=>{C?re(Ht,`Not sending because RPC '${e}' stream ${s} is closed:`,F):(_||(re(Ht,`Opening RPC '${e}' stream ${s} transport.`),g.open(),_=!0),re(Ht,`RPC '${e}' stream ${s} sending:`,F),g.send(F))},To:()=>g.close()}),M=(F,A,I)=>{F.listen(A,T=>{try{I(T)}catch(k){setTimeout(()=>{throw k},0)}})};return M(g,Ea.EventType.OPEN,()=>{C||(re(Ht,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),M(g,Ea.EventType.CLOSE,()=>{C||(C=!0,re(Ht,`RPC '${e}' stream ${s} transport closed`),R.So())}),M(g,Ea.EventType.ERROR,F=>{C||(C=!0,So(Ht,`RPC '${e}' stream ${s} transport errored:`,F),R.So(new se(G.UNAVAILABLE,"The operation could not be completed")))}),M(g,Ea.EventType.MESSAGE,F=>{var A;if(!C){const I=F.data[0];Me(!!I);const T=I,k=T.error||((A=T[0])===null||A===void 0?void 0:A.error);if(k){re(Ht,`RPC '${e}' stream ${s} received error:`,k);const O=k.status;let W=function(w){const E=pt[w];if(E!==void 0)return tw(E)}(O),b=k.message;W===void 0&&(W=G.INTERNAL,b="Unknown error status: "+O+" with message "+k.message),C=!0,R.So(new se(W,b)),g.close()}else re(Ht,`RPC '${e}' stream ${s} received:`,I),R.bo(I)}}),M(c,N_.STAT_EVENT,F=>{F.stat===uf.PROXY?re(Ht,`RPC '${e}' stream ${s} detected buffering proxy`):F.stat===uf.NOPROXY&&re(Ht,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}function Xd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t){return new $S(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,n,r,s,i,o,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new fw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===G.RESOURCE_EXHAUSTED?(Yr(n.toString()),Yr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new se(G.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RN extends pw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=HS(this.serializer,e),r=function(i){if(!("targetChange"in i))return ye.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?br(o.readTime):ye.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=_f(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=pf(u)?{documents:KS(i,u)}:{query:QS(i,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=sw(i,o.resumeToken);const h=yf(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(ye.min())>0){c.readTime=Tu(i,o.snapshotVersion.toTimestamp());const h=yf(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const r=XS(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=_f(this.serializer),n.removeTarget=e,this.a_(n)}}class DN extends pw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Me(!!e.streamToken),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=qS(e.writeResults,e.commitTime),r=br(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=_f(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>GS(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new se(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,vf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new se(G.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,vf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new se(G.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class LN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Yr(n),this.D_=!1):re("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Ci(this)&&(re("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ve(u);h.L_.add(4),await Dl(h),h.q_.set("Unknown"),h.L_.delete(4),await rd(h)}(this))})}),this.q_=new LN(r,s)}}async function rd(t){if(Ci(t))for(const e of t.B_)await e(!0)}async function Dl(t){for(const e of t.B_)await e(!1)}function mw(t,e){const n=ve(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),rm(n)?nm(n):Bo(n).r_()&&tm(n,e))}function em(t,e){const n=ve(t),r=Bo(n);n.N_.delete(e),r.r_()&&gw(n,e),n.N_.size===0&&(r.r_()?r.o_():Ci(n)&&n.q_.set("Unknown"))}function tm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Bo(t).A_(e)}function gw(t,e){t.Q_.xe(e),Bo(t).R_(e)}function nm(t){t.Q_=new VS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Bo(t).start(),t.q_.v_()}function rm(t){return Ci(t)&&!Bo(t).n_()&&t.N_.size>0}function Ci(t){return ve(t).L_.size===0}function yw(t){t.Q_=void 0}async function VN(t){t.q_.set("Online")}async function FN(t){t.N_.forEach((e,n)=>{tm(t,e)})}async function zN(t,e){yw(t),rm(t)?(t.q_.M_(e),nm(t)):t.q_.set("Unknown")}async function UN(t,e,n){if(t.q_.set("Online"),e instanceof rw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Iu(t,r)}else if(e instanceof Oc?t.Q_.Ke(e):e instanceof nw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ye.min()))try{const r=await hw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Q_.rt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const m=i.N_.get(h);m&&i.N_.set(h,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const m=i.N_.get(u);if(!m)return;i.N_.set(u,m.withResumeToken(Vt.EMPTY_BYTE_STRING,m.snapshotVersion)),gw(i,u);const g=new ks(m.target,u,h,m.sequenceNumber);tm(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){re("RemoteStore","Failed to raise snapshot:",r),await Iu(t,r)}}async function Iu(t,e,n){if(!Cl(e))throw e;t.L_.add(1),await Dl(t),t.q_.set("Offline"),n||(n=()=>hw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await rd(t)})}function vw(t,e){return e().catch(n=>Iu(t,n,e))}async function sd(t){const e=ve(t),n=$s(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;$N(e);)try{const s=await TN(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,BN(e,s)}catch(s){await Iu(e,s)}xw(e)&&_w(e)}function $N(t){return Ci(t)&&t.O_.length<10}function BN(t,e){t.O_.push(e);const n=$s(t);n.r_()&&n.V_&&n.m_(e.mutations)}function xw(t){return Ci(t)&&!$s(t).n_()&&t.O_.length>0}function _w(t){$s(t).start()}async function WN(t){$s(t).p_()}async function HN(t){const e=$s(t);for(const n of t.O_)e.m_(n.mutations)}async function GN(t,e,n){const r=t.O_.shift(),s=Kp.from(r,e,n);await vw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await sd(t)}async function qN(t,e){e&&$s(t).V_&&await async function(r,s){if(function(o){return MS(o)&&o!==G.ABORTED}(s.code)){const i=r.O_.shift();$s(r).s_(),await vw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await sd(r)}}(t,e),xw(t)&&_w(t)}async function Oy(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const r=Ci(n);n.L_.add(3),await Dl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await rd(n)}async function KN(t,e){const n=ve(t);e?(n.L_.delete(2),await rd(n)):e||(n.L_.add(2),await Dl(n),n.q_.set("Unknown"))}function Bo(t){return t.K_||(t.K_=function(n,r,s){const i=ve(n);return i.w_(),new RN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:VN.bind(null,t),Ro:FN.bind(null,t),mo:zN.bind(null,t),d_:UN.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),rm(t)?nm(t):t.q_.set("Unknown")):(await t.K_.stop(),yw(t))})),t.K_}function $s(t){return t.U_||(t.U_=function(n,r,s){const i=ve(n);return i.w_(),new DN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:WN.bind(null,t),mo:qN.bind(null,t),f_:HN.bind(null,t),g_:GN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await sd(t)):(await t.U_.stop(),t.O_.length>0&&(re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new sm(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function im(t,e){if(Yr("AsyncQueue",`${e}: ${t}`),Cl(t))return new se(G.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=ba(),this.sortedSet=new ot(this.comparator)}static emptySet(e){return new mo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof mo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new mo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.W_=new ot(ae.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ge():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class jo{constructor(e,n,r,s,i,o,c,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new jo(e,n,mo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class YN{constructor(){this.queries=Fy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ve(n),i=s.queries;s.queries=Fy(),i.forEach((o,c)=>{for(const u of c.j_)u.onError(r)})})(this,new se(G.ABORTED,"Firestore shutting down"))}}function Fy(){return new $o(t=>B_(t),Xu)}async function XN(t,e){const n=ve(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new QN,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=im(o,`Initialization of query '${$i(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&om(n)}async function JN(t,e){const n=ve(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ZN(t,e){const n=ve(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&om(n)}function eA(t,e,n){const r=ve(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function om(t){t.Y_.forEach(e=>{e.next()})}var Ef,zy;(zy=Ef||(Ef={})).ea="default",zy.Cache="cache";class tA{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new jo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=jo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ef.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e){this.key=e}}class Ew{constructor(e){this.key=e}}class nA{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=W_(e),this.Ra=new mo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Vy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,g)=>{const _=s.get(m),C=Ju(this.query,g)?g:null,R=!!_&&this.mutatedKeys.has(_.key),M=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let F=!1;_&&C?_.data.isEqual(C.data)?R!==M&&(r.track({type:3,doc:C}),F=!0):this.ga(_,C)||(r.track({type:2,doc:C}),F=!0,(u&&this.Aa(C,u)>0||h&&this.Aa(C,h)<0)&&(c=!0)):!_&&C?(r.track({type:0,doc:C}),F=!0):_&&!C&&(r.track({type:1,doc:_}),F=!0,(u||h)&&(c=!0)),F&&(C?(o=o.add(C),i=M?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:c,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,g)=>function(C,R){const M=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return M(C)-M(R)}(m.type,g.type)||this.Aa(m.doc,g.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new jo(this.query,e.Ra,i,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Vy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Ew(r))}),this.da.forEach(r=>{e.has(r)||n.push(new ww(r))}),n}ba(e){this.Ta=e.Ts,this.da=we();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return jo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class rA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class sA{constructor(e){this.key=e,this.va=!1}}class iA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new $o(c=>B_(c),Xu),this.Ma=new Map,this.xa=new Set,this.Oa=new ot(ae.comparator),this.Na=new Map,this.La=new Xp,this.Ba={},this.ka=new Map,this.qa=Po.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function oA(t,e,n=!0){const r=Nw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await bw(r,e,n,!0),s}async function aA(t,e){const n=Nw(t);await bw(n,e,!0,!1)}async function bw(t,e,n,r){const s=await IN(t.localStore,wr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await lA(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&mw(t.remoteStore,s),c}async function lA(t,e,n,r,s){t.Ka=(g,_,C)=>async function(M,F,A,I){let T=F.view.ma(A);T.ns&&(T=await Dy(M.localStore,F.query,!1).then(({documents:b})=>F.view.ma(b,T)));const k=I&&I.targetChanges.get(F.targetId),O=I&&I.targetMismatches.get(F.targetId)!=null,W=F.view.applyChanges(T,M.isPrimaryClient,k,O);return $y(M,F.targetId,W.wa),W.snapshot}(t,g,_,C);const i=await Dy(t.localStore,e,!0),o=new nA(e,i.Ts),c=o.ma(i.documents),u=Rl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);$y(t,n,h.wa);const m=new rA(e,n,o);return t.Fa.set(e,m),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function cA(t,e,n){const r=ve(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Xu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await wf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&em(r.remoteStore,s.targetId),bf(r,s.targetId)}).catch(Al)):(bf(r,s.targetId),await wf(r.localStore,s.targetId,!0))}async function uA(t,e){const n=ve(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),em(n.remoteStore,r.targetId))}async function dA(t,e,n){const r=vA(t);try{const s=await function(o,c){const u=ve(o),h=wt.now(),m=c.reduce((C,R)=>C.add(R.key),we());let g,_;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let R=Xr(),M=we();return u.cs.getEntries(C,m).next(F=>{R=F,R.forEach((A,I)=>{I.isValidDocument()||(M=M.add(A))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,R)).next(F=>{g=F;const A=[];for(const I of c){const T=CS(I,g.get(I.key).overlayedDocument);T!=null&&A.push(new Ai(I.key,T,M_(T.value.mapValue),Er.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,A,c)}).next(F=>{_=F;const A=F.applyToLocalDocumentSet(g,M);return u.documentOverlayCache.saveOverlays(C,F.batchId,A)})}).then(()=>({batchId:_.batchId,changes:G_(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new ot(Pe)),h=h.insert(c,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await Ml(r,s.changes),await sd(r.remoteStore)}catch(s){const i=im(s,"Failed to persist write");n.reject(i)}}async function kw(t,e){const n=ve(t);try{const r=await bN(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Me(o.va):s.removedDocuments.size>0&&(Me(o.va),o.va=!1))}),await Ml(n,r,e)}catch(r){await Al(r)}}function Uy(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=ve(o);u.onlineState=c;let h=!1;u.queries.forEach((m,g)=>{for(const _ of g.j_)_.Z_(c)&&(h=!0)}),h&&om(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hA(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ot(ae.comparator);o=o.insert(i,Kt.newNoDocument(i,ye.min()));const c=we().add(i),u=new td(ye.min(),new Map,new ot(Pe),o,c);await kw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),am(r)}else await wf(r.localStore,e,!1).then(()=>bf(r,e,n)).catch(Al)}async function fA(t,e){const n=ve(t),r=e.batch.batchId;try{const s=await EN(n.localStore,e);Iw(n,r,null),Tw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ml(n,s)}catch(s){await Al(s)}}async function pA(t,e,n){const r=ve(t);try{const s=await function(o,c){const u=ve(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(Me(g!==null),m=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>u.localDocuments.getDocuments(h,m))})}(r.localStore,e);Iw(r,e,n),Tw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ml(r,s)}catch(s){await Al(s)}}function Tw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Iw(t,e,n){const r=ve(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function bf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Sw(t,r)})}function Sw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(em(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),am(t))}function $y(t,e,n){for(const r of n)r instanceof ww?(t.La.addReference(r.key,e),mA(t,r)):r instanceof Ew?(re("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Sw(t,r.key)):ge()}function mA(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(re("SyncEngine","New document in limbo: "+n),t.xa.add(r),am(t))}function am(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ae(Ke.fromString(e)),r=t.qa.next();t.Na.set(r,new sA(n)),t.Oa=t.Oa.insert(n,r),mw(t.remoteStore,new ks(wr(Hp(n.path)),r,"TargetPurposeLimboResolution",Fp.oe))}}async function Ml(t,e,n){const r=ve(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{o.push(r.Ka(u,e,n).then(h=>{var m;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=Zp.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const m=ve(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>K.forEach(h,_=>K.forEach(_.$i,C=>m.persistence.referenceDelegate.addReference(g,_.targetId,C)).next(()=>K.forEach(_.Ui,C=>m.persistence.referenceDelegate.removeReference(g,_.targetId,C)))))}catch(g){if(!Cl(g))throw g;re("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const _=g.targetId;if(!g.fromCache){const C=m.os.get(_),R=C.snapshotVersion,M=C.withLastLimboFreeSnapshotVersion(R);m.os=m.os.insert(_,M)}}}(r.localStore,i))}async function gA(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const r=await dw(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new se(G.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ml(n,r.hs)}}function yA(t,e){const n=ve(t),r=n.Na.get(e);if(r&&r.va)return we().add(r.key);{let s=we();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const c=n.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function Nw(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hA.bind(null,e),e.Ca.d_=ZN.bind(null,e.eventManager),e.Ca.$a=eA.bind(null,e.eventManager),e}function vA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pA.bind(null,e),e}class Su{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return wN(this.persistence,new xN,e.initialUser,this.serializer)}Ga(e){return new gN(Jp.Zr,this.serializer)}Wa(e){return new NN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Su.provider={build:()=>new Su};class kf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Uy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gA.bind(null,this.syncEngine),await KN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YN}()}createDatastore(e){const n=nd(e.databaseInfo.databaseId),r=function(i){return new jN(i)}(e.databaseInfo);return function(i,o,c,u){return new MN(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new ON(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Uy(this.syncEngine,n,0),function(){return Ly.D()?new Ly:new AN}())}createSyncEngine(e,n){return function(s,i,o,c,u,h,m){const g=new iA(s,i,o,c,u,h);return m&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ve(s);re("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Dl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}kf.provider={build:()=>new kf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Yr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Gt.UNAUTHENTICATED,this.clientId=j_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{re("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(re("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=im(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Jd(t,e){t.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await dw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function By(t,e){t.asyncQueue.verifyOperationInProgress();const n=await wA(t);re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Oy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Oy(e.remoteStore,s)),t._onlineComponents=e}async function wA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Jd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;So("Error using user provided cache. Falling back to memory cache: "+n),await Jd(t,new Su)}}else re("FirestoreClient","Using default OfflineComponentProvider"),await Jd(t,new Su);return t._offlineComponents}async function Aw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),await By(t,t._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),await By(t,new kf))),t._onlineComponents}function EA(t){return Aw(t).then(e=>e.syncEngine)}async function Wy(t){const e=await Aw(t),n=e.eventManager;return n.onListen=oA.bind(null,e.syncEngine),n.onUnlisten=cA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=aA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=uA.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e,n){if(!n)throw new se(G.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function bA(t,e,n,r){if(e===!0&&r===!0)throw new se(G.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Gy(t){if(!ae.isDocumentKey(t))throw new se(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qy(t){if(ae.isDocumentKey(t))throw new se(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function id(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ge()}function gi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=id(t);throw new se(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new se(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class od{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ky({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ky(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new FI;switch(r.type){case"firstParty":return new BI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Hy.get(n);r&&(re("ComponentProvider","Removing Datastore"),Hy.delete(n),r.terminate())}(this),Promise.resolve()}}function kA(t,e,n,r={}){var s;const i=(t=gi(t,od))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&So("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Gt.MOCK_USER;else{c=dk(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new se(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Gt(h)}t._authCredentials=new zI(new P_(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Wo(this.firestore,e,this._query)}}class hn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ls(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}}class Ls extends Wo{constructor(e,n,r){super(e,n,Hp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new ae(e))}withConverter(e){return new Ls(this.firestore,e,this._path)}}function TA(t,e,...n){if(t=fn(t),Pw("collection","path",e),t instanceof od){const r=Ke.fromString(e,...n);return qy(r),new Ls(t,null,r)}{if(!(t instanceof hn||t instanceof Ls))throw new se(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return qy(r),new Ls(t.firestore,null,r)}}function Zd(t,e,...n){if(t=fn(t),arguments.length===1&&(e=j_.newId()),Pw("doc","path",e),t instanceof od){const r=Ke.fromString(e,...n);return Gy(r),new hn(t,null,new ae(r))}{if(!(t instanceof hn||t instanceof Ls))throw new se(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return Gy(r),new hn(t.firestore,t instanceof Ls?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new fw(this,"async_queue_retry"),this.Vu=()=>{const r=Xd();r&&re("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Xd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Xd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new mi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cl(e))throw e;re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw Yr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=sm.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ge()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Yy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class pl extends od{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Qy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qy(e),this._firestoreClient=void 0,await e}}}function IA(t,e){const n=typeof t=="object"?t:Np(),r=typeof t=="string"?t:"(default)",s=Sp(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=ck("firestore");i&&kA(s,...i)}return s}function jw(t){if(t._terminated)throw new se(G.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||SA(t),t._firestoreClient}function SA(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,h,m){return new nS(c,u,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,Cw(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new _A(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ro(Vt.fromBase64String(e))}catch(n){throw new se(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ro(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pe(this._lat,e._lat)||Pe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=/^__.*__$/;class AA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ai(e,this.data,this.fieldMask,n,this.fieldTransforms):new jl(e,this.data,n,this.fieldTransforms)}}function Dw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class dm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new dm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Dw(this.Cu)&&NA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class CA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||nd(e)}Qu(e,n,r,s=!1){return new dm({Cu:e,methodName:n,qu:r,path:Dt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mw(t){const e=t._freezeSettings(),n=nd(t._databaseId);return new CA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function PA(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Vw("Data must be an object, but it was:",o,r);const c=Lw(r,o);let u,h;if(i.merge)u=new Qn(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const _=RA(e,g,n);if(!o.contains(_))throw new se(G.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);MA(m,_)||m.push(_)}u=new Qn(m),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new AA(new jn(c),u,h)}function jA(t,e,n,r=!1){return hm(n,t.Qu(r?4:3,e))}function hm(t,e){if(Ow(t=fn(t)))return Vw("Unsupported field value:",e,t),Lw(t,e);if(t instanceof Rw)return function(r,s){if(!Dw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=hm(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=fn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=wt.fromDate(r);return{timestampValue:Tu(s.serializer,i)}}if(r instanceof wt){const i=new wt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Tu(s.serializer,i)}}if(r instanceof cm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ro)return{bytesValue:sw(s.serializer,r._byteString)};if(r instanceof hn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Yp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof um)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return Gp(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${id(r)}`)}(t,e)}function Lw(t,e){const n={};return R_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Uo(t,(r,s)=>{const i=hm(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Ow(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof wt||t instanceof cm||t instanceof Ro||t instanceof hn||t instanceof Rw||t instanceof um)}function Vw(t,e,n){if(!Ow(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=id(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function RA(t,e,n){if((e=fn(e))instanceof lm)return e._internalPath;if(typeof e=="string")return Fw(t,e);throw Nu("Field path arguments must be of type string or ",t,!1,void 0,n)}const DA=new RegExp("[~\\*/\\[\\]]");function Fw(t,e,n){if(e.search(DA)>=0)throw Nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new lm(...e.split("."))._internalPath}catch{throw Nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Nu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new se(G.INVALID_ARGUMENT,c+t+u)}function MA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Uw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class LA extends zw{data(){return super.data()}}function Uw(t,e){return typeof e=="string"?Fw(t,e):e instanceof lm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fm{}class VA extends fm{}function FA(t,e,...n){let r=[];e instanceof fm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof mm).length,c=i.filter(u=>u instanceof pm).length;if(o>1||o>0&&c>0)throw new se(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class pm extends VA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pm(e,n,r)}_apply(e){const n=this._parse(e);return $w(e._query,n),new Wo(e.firestore,e.converter,mf(e._query,n))}_parse(e){const n=Mw(e.firestore);return function(i,o,c,u,h,m,g){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new se(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Jy(g,m);const C=[];for(const R of g)C.push(Xy(u,i,R));_={arrayValue:{values:C}}}else _=Xy(u,i,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Jy(g,m),_=jA(c,o,g,m==="in"||m==="not-in");return gt.create(h,m,_)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class mm extends fm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new mm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Zn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)$w(o,u),o=mf(o,u)}(e._query,n),new Wo(e.firestore,e.converter,mf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Xy(t,e,n){if(typeof(n=fn(n))=="string"){if(n==="")throw new se(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$_(e)&&n.indexOf("/")!==-1)throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ke.fromString(n));if(!ae.isDocumentKey(r))throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yy(t,new ae(r))}if(n instanceof hn)return yy(t,n._key);throw new se(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${id(n)}.`)}function Jy(t,e){if(!Array.isArray(t)||t.length===0)throw new se(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $w(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new se(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class zA{convertValue(e,n="none"){switch(Ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Uo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>ut(o.doubleValue));return new um(i)}convertGeoPoint(e){return new cm(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Up(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(cl(e));default:return null}}convertTimestamp(e){const n=Us(e);return new wt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ke.fromString(e);Me(uw(r));const s=new ul(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(n)||Yr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bw extends zw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Vc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Uw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Vc extends Bw{data(e={}){return super.data(e)}}class $A{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ta(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Vc(this._firestore,this._userDataWriter,r.key,r,new Ta(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new Vc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ta(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Vc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ta(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,m=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:BA(c.type),doc:u,oldIndex:h,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function BA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}class Ww extends zA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ro(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,n)}}function Zy(t,e,n){t=gi(t,hn);const r=gi(t.firestore,pl),s=UA(t.converter,e,n);return Hw(r,[PA(Mw(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Er.none())])}function WA(t){return Hw(gi(t.firestore,pl),[new qp(t._key,Er.none())])}function HA(t,...e){var n,r,s;t=fn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Yy(e[o])||(i=e[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Yy(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,h,m;if(t instanceof hn)h=gi(t.firestore,pl),m=Hp(t._key.path),u={next:g=>{e[o]&&e[o](GA(h,t,g))},error:e[o+1],complete:e[o+2]};else{const g=gi(t,Wo);h=gi(g.firestore,pl),m=g._query;const _=new Ww(h);u={next:C=>{e[o]&&e[o](new $A(h,_,g,C))},error:e[o+1],complete:e[o+2]},OA(t._query)}return function(_,C,R,M){const F=new xA(M),A=new tA(C,F,R);return _.asyncQueue.enqueueAndForget(async()=>XN(await Wy(_),A)),()=>{F.Za(),_.asyncQueue.enqueueAndForget(async()=>JN(await Wy(_),A))}}(jw(h),m,c,u)}function Hw(t,e){return function(r,s){const i=new mi;return r.asyncQueue.enqueueAndForget(async()=>dA(await EA(r),s,i)),i.promise}(jw(t),e)}function GA(t,e,n){const r=n.docs.get(e._key),s=new Ww(t);return new Bw(t,s,e._key,r,new Ta(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){zo=s})(Vo),Io(new Ei("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new pl(new UI(r.getProvider("auth-internal")),new HI(r.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new se(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ul(h.options.projectId,m)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Ms(hy,"4.7.3",e),Ms(hy,"4.7.3","esm2017")})();const Tt={marriage:{label:"Matrimonio",color:"#000000",lineStyle:"solid",renderType:"standard"},cohabitation:{label:"Convivenza",color:"#000000",lineStyle:"dashed",renderType:"standard"},separation:{label:"Separazione",color:"#000000",lineStyle:"solid",renderType:"oblique"},"separation-repaired":{label:"Separazione Riparata",color:"#000000",lineStyle:"solid",renderType:"x-cross"},"separation-cohab":{label:"Separazione (Conv.)",color:"#000000",lineStyle:"dashed",renderType:"oblique"},divorce:{label:"Divorzio",color:"#000000",lineStyle:"solid",renderType:"oblique-double"},"divorce-repaired":{label:"Divorzio Riparato",color:"#000000",lineStyle:"solid",renderType:"oblique-double-crossed"},"re-marriage":{label:"Risposati",color:"#000000",lineStyle:"solid",renderType:"standard"},affair:{label:"Relazione Extra/Amante",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},"one-night":{label:"Avventura",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},engagement:{label:"Fidanzamento",color:"#0000FF",lineStyle:"dashed",renderType:"standard"},"child-bio":{label:"Figlio Biologico",color:"#000000",lineStyle:"solid",renderType:"standard"},"child-adopted":{label:"Adozione",color:"#0000FF",lineStyle:"dotted",renderType:"standard"},"child-foster":{label:"Affido",color:"#000000",lineStyle:"dashed",renderType:"standard"},"twin-dizygotic":{label:"Gemelli Dizigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link"},"twin-monozygotic":{label:"Gemelli Monozigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link-bar"},pregnancy:{label:"Gravidanza",color:"#000000",lineStyle:"solid",renderType:"standard"},harmony:{label:"Armonia",color:"#008000",lineStyle:"solid",renderType:"standard"},friendship:{label:"Amicizia",color:"#008000",lineStyle:"dashed",renderType:"standard"},"best-friend":{label:"Migliore Amico",color:"#008000",lineStyle:"dotted",renderType:"double"},close:{label:"Molto Uniti",color:"#008000",lineStyle:"solid",renderType:"double"},fusion:{label:"Invischiamento (Fusione)",color:"#008000",lineStyle:"solid",renderType:"triple"},"in-love":{label:"Innamorati",color:"#008000",lineStyle:"solid",renderType:"two-circles-center"},fan:{label:"Ammiratore",color:"#008000",lineStyle:"dashed",renderType:"arrow"},spiritual:{label:"Conn. Spirituale",color:"#800080",lineStyle:"dashed",renderType:"standard"},hostile:{label:"Ostilit",color:"#FF0000",lineStyle:"dotted",renderType:"standard"},conflict:{label:"Conflitto",color:"#FF0000",lineStyle:"zigzag",renderType:"standard"},"fusion-hostile":{label:"Fusione & Conflitto",color:"#000000",lineStyle:"solid",renderType:"fusion-hostile"},"close-hostile":{label:"Uniti & Conflittuali",color:"#000000",lineStyle:"solid",renderType:"double-zigzag"},"distant-hostile":{label:"Distante & Ostile",color:"#FF0000",lineStyle:"dotted",renderType:"zigzag-overlay"},hate:{label:"Odio",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag"},violence:{label:"Violenza",color:"#FF0000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-physical":{label:"Abuso Fisico",color:"#800000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-emotional":{label:"Abuso Emotivo",color:"#800000",lineStyle:"dashed",renderType:"arrow"},"abuse-sexual":{label:"Abuso Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"arrow-double-bar-center"},neglect:{label:"Trascuratezza",color:"#808080",lineStyle:"dashed",renderType:"standard"},focused:{label:"Focalizzata Su",color:"#0000FF",lineStyle:"solid",renderType:"arrow-open"},manipulative:{label:"Manipolativo",color:"#FF0000",lineStyle:"solid",renderType:"arrow-x-center"},controlling:{label:"Controllante",color:"#800080",lineStyle:"solid",renderType:"arrow-box-center"},keeper:{label:"Custode/Caregiver",color:"#008080",lineStyle:"solid",renderType:"arrow-diamond-center"},distant:{label:"Distante",color:"#808080",lineStyle:"dotted",renderType:"standard"},poor:{label:"Povera",color:"#808080",lineStyle:"solid",renderType:"standard"},cutoff:{label:"Taglio",color:"#000000",lineStyle:"solid",renderType:"cutoff"},"cutoff-repaired":{label:"Taglio Riparato",color:"#000000",lineStyle:"solid",renderType:"cutoff-circle"},custom:{label:"Personalizzata",color:"#000000",lineStyle:"solid",renderType:"standard"}},mr={Struttura:["marriage","cohabitation","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","re-marriage","engagement","affair","one-night"],Figli:["child-bio","child-adopted","child-foster","twin-dizygotic","twin-monozygotic","pregnancy"],"Legami Affettivi":["harmony","friendship","best-friend","close","fusion","in-love","fan","spiritual"],"Conflitto/Distanza":["hostile","conflict","fusion-hostile","close-hostile","distant-hostile","hate","distant","poor","cutoff","cutoff-repaired"],"Abuso/Potere":["abuse-physical","abuse-emotional","abuse-sexual","neglect","violence","manipulative","controlling","focused","keeper"],Altro:["custom"]},ev={home:Mb,heart:bo,user:$b,users:ko,grad:Db,book:Nb,briefcase:Ab,folder:Rb,help:wp,tag:Zh},qA=[{id:"family",label:"Famiglie",color:"#3b82f6",iconKey:"home"},{id:"couple",label:"Coppie",color:"#ec4899",iconKey:"heart"},{id:"individual",label:"Individuali",color:"#10b981",iconKey:"user"},{id:"school",label:"Scolastico",color:"#f59e0b",iconKey:"grad"},{id:"exercise",label:"Esercitazioni",color:"#6366f1",iconKey:"book"},{id:"work",label:"Lavoro/Org",color:"#64748b",iconKey:"briefcase"},{id:"other",label:"Altro",color:"#94a3b8",iconKey:"folder"}],Gw=["#bfdbfe","#bbf7d0","#fbcfe8","#fde68a","#ddd6fe","#fed7aa","#e2e8f0"],qw=["#3b82f6","#22c55e","#ec4899","#f59e0b","#8b5cf6","#f97316","#64748b"],KA=["#ffffff","#f3f4f6","#d1d5db","#9ca3af","#4b5563","#1f2937","#000000"],QA=["#78350f","#92400e","#b45309","#d97706","#f59e0b","#fcd34d","#fffbeb"],YA=["#f8fafc","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#475569","#1e293b"],Ia={Classico:["#fef3c7","#d1fae5","#dbeafe","#fce7f3","#f3f4f6","#ffedd5","#e0e7ff"],Pastello:Gw,Vivido:qw,Terra:QA,Monocromo:YA},XA=["#1f2937","#000000","#ffffff","#dc2626","#2563eb","#16a34a","#d97706","#57534e"],Kw=[{label:"App Default",value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},{label:"Handwriting",value:'"Comic Sans MS", "Chalkboard SE", sans-serif'},{label:"Sans Serif",value:"ui-sans-serif, system-ui, sans-serif"},{label:"Serif",value:"ui-serif, Georgia, serif"},{label:"Monospace",value:"ui-monospace, monospace"}],ws=[{id:"light",label:"Light (Default)",type:"light",colors:{bgMain:"#f9fafb",bgPanel:"#ffffff",border:"#e5e7eb",text:"#111827",textMuted:"#6b7280",accent:"#2563eb"}},{id:"sepia",label:"Vintage Sepia",type:"light",colors:{bgMain:"#fdf6e3",bgPanel:"#eee8d5",border:"#d2b48c",text:"#433422",textMuted:"#93a1a1",accent:"#b58900"}},{id:"nordic",label:"Nordic Snow",type:"light",colors:{bgMain:"#eceff4",bgPanel:"#e5e9f0",border:"#d8dee9",text:"#2e3440",textMuted:"#4c566a",accent:"#5e81ac"}},{id:"dark",label:"Dark (Classic)",type:"dark",colors:{bgMain:"#111827",bgPanel:"#1f2937",border:"#374151",text:"#f9fafb",textMuted:"#9ca3af",accent:"#3b82f6"}},{id:"onedark",label:"One Dark Pro",type:"dark",colors:{bgMain:"#282c34",bgPanel:"#21252b",border:"#3e4451",text:"#abb2bf",textMuted:"#5c6370",accent:"#61afef"}},{id:"dracula",label:"Dracula",type:"dark",colors:{bgMain:"#282a36",bgPanel:"#44475a",border:"#6272a4",text:"#f8f8f2",textMuted:"#bd93f9",accent:"#ff79c6"}},{id:"nightowl",label:"Night Owl",type:"dark",colors:{bgMain:"#011627",bgPanel:"#0b2942",border:"#5f7e97",text:"#d6deeb",textMuted:"#7e57c2",accent:"#82aaff"}},{id:"forest",label:"Forest Night",type:"dark",colors:{bgMain:"#0d1117",bgPanel:"#161b22",border:"#30363d",text:"#c9d1d9",textMuted:"#8b949e",accent:"#238636"}}],on=20,Sa=8e3,Et=Sa/2,jt=40,gr=40,Do=20,Qw=40,JA=Do+Qw,gc=40,nt=()=>Math.random().toString(36).substr(2,9),Yw=t=>{if(!t)return null;const e=t.split(/[\/\-\.]/);if(e.length===3){const n=parseInt(e[0]),r=parseInt(e[1])-1,s=parseInt(e[2]);if(!isNaN(n)&&!isNaN(r)&&!isNaN(s)){const i=s<100?s>30?1900+s:2e3+s:s;return new Date(i,r,n)}}return/^\d{4}$/.test(t)?new Date(parseInt(t),0,1):null},ml=t=>{const e=Yw(t);if(!e)return"?";const n=new Date;let r=n.getFullYear()-e.getFullYear();const s=n.getMonth()-e.getMonth();return(s<0||s===0&&n.getDate()<e.getDate())&&r--,r.toString()},tv=(t,e)=>e.find(n=>(n.fromId===t||n.toId===t)&&["marriage","cohabitation","separation","divorce","affair","re-marriage"].includes(n.type)),ZA=(t,e)=>Math.max(t,e)+Qw,Xw=(t,e)=>{const n=e.filter(c=>t.memberIds.includes(c.id));if(!n.length)return null;const r=Math.min(...n.map(c=>c.x)),s=Math.max(...n.map(c=>c.x+jt)),i=Math.min(...n.map(c=>c.y)),o=Math.max(...n.map(c=>c.y+gr));return{x:r-gc,y:i-gc,w:s-r+gc*2,h:o-i+gc*2,cx:(r+s)/2,cy:(i+o)/2}},nv=(t,e,n)=>{const r=e.find(i=>i.id===t);if(r)return{x:r.x+Do,y:r.y+Do};const s=n.find(i=>i.id===t);if(s){const i=Xw(s,e);if(i)return{x:i.x+i.w/2,y:i.y+i.h/2}}return null},rv=(t,e,n)=>(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),eC=t=>{t.sort((r,s)=>r.x===s.x?r.y-s.y:r.x-s.x);const e=[];for(let r=0;r<t.length;r++){for(;e.length>=2&&rv(e[e.length-2],e[e.length-1],t[r])<=0;)e.pop();e.push(t[r])}const n=[];for(let r=t.length-1;r>=0;r--){for(;n.length>=2&&rv(n[n.length-2],n[n.length-1],t[r])<=0;)n.pop();n.push(t[r])}return[...e.slice(0,-1),...n.slice(0,-1)]},tC=(t,e)=>{if(t.length<3)return{d:"",cx:0,cy:0,expandedPoints:[],controlPoints:[]};const n=t.reduce((u,h)=>u+h.x,0)/t.length,r=t.reduce((u,h)=>u+h.y,0)/t.length,s=t.map(u=>{const h=Math.atan2(u.y-r,u.x-n),m=Math.hypot(u.x-n,u.y-r);return{x:n+Math.cos(h)*(m+e),y:r+Math.sin(h)*(m+e)}}),i=s.length,o=s.map((u,h)=>{const m=s[(h+1)%i];return{x:(u.x+m.x)/2,y:(u.y+m.y)/2}});let c=`M ${o[0].x} ${o[0].y}`;for(let u=0;u<i;u++){const h=s[(u+1)%i],m=o[(u+1)%i];c+=` Q ${h.x} ${h.y} ${m.x} ${m.y}`}return c+=" Z",{d:c,cx:n,cy:r,expandedPoints:o,controlPoints:s}},sv=(t,e)=>{let n=1/0,r=e;for(let s=0;s<t.length;s++){const i=t[s],o=t[(s+1)%t.length],c=(i.x-o.x)**2+(i.y-o.y)**2;if(c===0)continue;let u=((e.x-i.x)*(o.x-i.x)+(e.y-i.y)*(o.y-i.y))/c;u=Math.max(0,Math.min(1,u));const h=i.x+u*(o.x-i.x),m=i.y+u*(o.y-i.y),g=(e.x-h)**2+(e.y-m)**2;g<n&&(n=g,r={x:h,y:m})}return r},iv=(t,e)=>{const n=t.length;if(n<3)return t[0];const s=e*n,i=Math.floor(s)%n,o=s-Math.floor(s),c=t[(i+1)%n],u=t[i],h=t[(i+2)%n],m={x:(u.x+c.x)/2,y:(u.y+c.y)/2},g={x:(c.x+h.x)/2,y:(c.y+h.y)/2},_=c,C=1-o,R=C*C*m.x+2*C*o*_.x+o*o*g.x,M=C*C*m.y+2*C*o*_.y+o*o*g.y;return{x:R,y:M}},yc=(t,e)=>{const n=e.filter(o=>t.memberIds.includes(o.id));if(n.length===0)return null;let r=[];n.forEach(o=>{const u=Math.max(80,o.name.length*8)/2,h=o.x+jt/2,m=o.y-25;r.push({x:h-u,y:m}),r.push({x:h+u,y:m});const g=o.y+gr+10;r.push({x:h-u,y:g}),r.push({x:h+u,y:g}),r.push({x:o.x-5,y:o.y+gr/2}),r.push({x:o.x+jt+5,y:o.y+gr/2})});const s=eC(r),i=t.customPadding||23;return tC(s,i)},eh=(t,e,n,r,s=4,i=12)=>{const o=n-t,c=r-e,u=Math.sqrt(o*o+c*c);if(u===0)return`M ${t} ${e}`;const h=o/u,g=-(c/u),_=h;let C=`M ${t} ${e}`;const R=Math.floor(u/i);for(let M=1;M<=R;M++){const F=M/R,A=t+o*F,I=e+c*F,T=M%2===0?s:-s;C+=` L ${A+g*T} ${I+_*T}`}return C+=` L ${n} ${r}`,C},Au=t=>{if(!t)return 0;const e=t.match(/\d{4}/);return e?parseInt(e[0]):0},nC=({x:t,y:e,darkMode:n,nodes:r,edges:s})=>{const i=n?"#1f2937":"#ffffff",o=n?"#f3f4f6":"#1f2937",c=n?"#374151":"#e5e7eb",u=n?"#9ca3af":"#6b7280",h=Array.from(new Set(r.map(v=>v.gender))).sort(),m=r.some(v=>v.deceased),g=r.some(v=>v.indexPerson),_=Array.from(new Set(s.map(v=>v.type))).sort(),C=15,R=24,M=140,F=30,A=h.length+(m?1:0)+(g?1:0),I=_.length,T=A+I>8,k=T?M*2+C*3:M+C*2,O=F+C+Math.max(A,T?I:A+I)*R+(T?0:20),W=v=>{const w=o,E="none",P=1.5;return v==="M"?a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:w,fill:E,strokeWidth:P}):v==="F"?a.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:w,fill:E,strokeWidth:P}):v==="Pet"?a.jsx("path",{d:"M8 2 L14 8 L8 14 L2 8 Z",stroke:w,fill:E,strokeWidth:P}):v==="Pregnancy"?a.jsx("path",{d:"M8 2 L14 14 L2 14 Z",stroke:w,fill:E,strokeWidth:P}):a.jsx("text",{x:"8",y:"12",textAnchor:"middle",fontSize:"10",fill:w,fontFamily:"sans-serif",children:"?"})},b=v=>{const w=Tt[v]||Tt.custom;if(!w)return null;const E=w.color==="#000000"&&n?"#ffffff":w.color;let P=a.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:E,strokeWidth:"2"});w.lineStyle==="dashed"&&(P=a.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:E,strokeWidth:"2",strokeDasharray:"4,2"})),w.lineStyle==="dotted"&&(P=a.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:E,strokeWidth:"2",strokeDasharray:"1,3"})),w.lineStyle==="zigzag"&&(P=a.jsx("path",{d:"M0 8 L5 4 L10 12 L15 4 L20 12 L25 4 L30 8",stroke:w.renderType.includes("hostile")?"red":E,fill:"none",strokeWidth:"1.5"}));let D=null;return v==="best-friend"?D=a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"5",x2:"30",y2:"5",stroke:E,strokeWidth:"1"}),a.jsx("line",{x1:"0",y1:"11",x2:"30",y2:"11",stroke:E,strokeWidth:"1"})]}):w.renderType==="double"?D=a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"5",x2:"30",y2:"5",stroke:E,strokeWidth:"1"}),a.jsx("line",{x1:"0",y1:"11",x2:"30",y2:"11",stroke:E,strokeWidth:"1"})]}):w.renderType==="triple"||w.renderType==="fusion"?D=a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"4",x2:"30",y2:"4",stroke:E,strokeWidth:"1"}),a.jsx("line",{x1:"0",y1:"8",x2:"30",y2:"8",stroke:E,strokeWidth:"1"}),a.jsx("line",{x1:"0",y1:"12",x2:"30",y2:"12",stroke:E,strokeWidth:"1"})]}):w.renderType==="oblique"?D=a.jsx("line",{x1:"18",y1:"2",x2:"12",y2:"14",stroke:E,strokeWidth:"2"}):w.renderType==="oblique-double"?D=a.jsxs("g",{children:[a.jsx("line",{x1:"16",y1:"2",x2:"10",y2:"14",stroke:E,strokeWidth:"2"}),a.jsx("line",{x1:"20",y1:"2",x2:"14",y2:"14",stroke:E,strokeWidth:"2"})]}):w.renderType==="cutoff"&&(D=a.jsx("line",{x1:"15",y1:"2",x2:"15",y2:"14",stroke:E,strokeWidth:"2"})),a.jsxs("g",{transform:"translate(0, 2)",children:[P,D]})};return a.jsxs("g",{transform:`translate(${t}, ${e})`,children:[a.jsx("rect",{width:k,height:O,rx:"8",fill:i,stroke:c,strokeWidth:"1",filter:"drop-shadow(0 4px 6px rgb(0 0 0 / 0.1))"}),a.jsx("text",{x:C,y:22,fontWeight:"bold",fill:o,fontSize:"12",letterSpacing:"0.5px",fontFamily:"sans-serif",children:"LEGENDA"}),a.jsx("line",{x1:C,y1:F,x2:k-C,y2:F,stroke:c,strokeWidth:"1"}),a.jsxs("g",{transform:`translate(${C}, ${F+15})`,children:[a.jsxs("g",{children:[A>0&&a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Persone"}),h.map((v,w)=>a.jsxs("g",{transform:`translate(0, ${w*R})`,children:[W(v),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:v==="M"?"Maschio":v==="F"?"Femmina":v})]},v)),m&&a.jsxs("g",{transform:`translate(0, ${h.length*R})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("line",{x1:"2",y1:"2",x2:"14",y2:"14",stroke:o}),a.jsx("line",{x1:"14",y1:"2",x2:"2",y2:"14",stroke:o}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Deceduto"})]}),g&&a.jsxs("g",{transform:`translate(0, ${(h.length+(m?1:0))*R})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("rect",{x:"4",y:"4",width:"8",height:"8",stroke:o,fill:"none"}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Paz. Designato"})]})]}),_.length>0&&a.jsxs("g",{transform:`translate(${T?M+C:0}, ${T?0:A*R+15})`,children:[a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Relazioni"}),_.map((v,w)=>{var P;const E=((P=Tt[v])==null?void 0:P.label)||"Custom";return a.jsxs("g",{transform:`translate(0, ${w*R})`,children:[b(v),a.jsx("text",{x:"35",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:E})]},v)})]})]})]})},Tf=({type:t})=>{const e=Tt[t]||Tt.custom;if(!e)return null;const n=e.color;return a.jsxs("svg",{width:"50",height:"14",className:"shrink-0 mr-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 overflow-visible",children:[e.lineStyle==="dashed"&&a.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2",strokeDasharray:"4,2"}),e.lineStyle==="dotted"&&a.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2",strokeDasharray:"1,3"}),e.lineStyle==="solid"&&!["fusion","double","triple","triple-zigzag","close-hostile"].includes(e.renderType)&&a.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"2"}),e.lineStyle==="zigzag"&&a.jsx("path",{d:"M0 7 L5 3 L10 11 L15 3 L20 11 L25 3 L30 11 L35 3 L40 11 L45 3 L50 7",stroke:e.renderType==="fusion-hostile"?"red":n,fill:"none",strokeWidth:"1.5"}),(e.renderType==="fusion"||e.renderType==="triple")&&a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"3",x2:"50",y2:"3",stroke:n,strokeWidth:"1.5"}),a.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"1.5"}),a.jsx("line",{x1:"0",y1:"11",x2:"50",y2:"11",stroke:n,strokeWidth:"1.5"})]}),e.renderType==="triple-zigzag"&&a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"3",x2:"50",y2:"3",stroke:n,strokeWidth:"1.5"}),a.jsx("line",{x1:"0",y1:"7",x2:"50",y2:"7",stroke:n,strokeWidth:"1.5"}),a.jsx("line",{x1:"0",y1:"11",x2:"50",y2:"11",stroke:n,strokeWidth:"1.5"}),a.jsx("path",{d:"M0 7 L5 3 L10 11 L15 3 L20 11 L25 3 L30 11 L35 3 L40 11 L45 3 L50 7",stroke:"red",fill:"none",strokeWidth:"1.5"})]}),(e.renderType==="double"||e.renderType==="best-friend")&&a.jsxs("g",{children:[a.jsx("line",{x1:"0",y1:"4",x2:"50",y2:"4",stroke:n,strokeWidth:"1.5"}),a.jsx("line",{x1:"0",y1:"10",x2:"50",y2:"10",stroke:n,strokeWidth:"1.5"})]}),e.renderType.includes("arrow")&&a.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),e.renderType==="oblique"&&a.jsx("line",{x1:"28",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),e.renderType==="oblique-double"&&a.jsxs("g",{children:[a.jsx("line",{x1:"26",y1:"2",x2:"20",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"30",y1:"2",x2:"24",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="x-cross"&&a.jsxs("g",{children:[a.jsx("line",{x1:"28",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"22",y1:"2",x2:"28",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="oblique-double-crossed"&&a.jsxs("g",{children:[a.jsx("line",{x1:"27",y1:"2",x2:"21",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"33",y1:"2",x2:"27",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"19",y1:"2",x2:"35",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="arrow-x-center"&&a.jsxs("g",{children:[a.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),a.jsx("line",{x1:"22",y1:"4",x2:"28",y2:"10",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"22",y1:"10",x2:"28",y2:"4",stroke:n,strokeWidth:"2"})]}),e.renderType==="arrow-box-center"&&a.jsxs("g",{children:[a.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),a.jsx("rect",{x:"20",y:"2",width:"10",height:"10",stroke:n,strokeWidth:"2",fill:"white"})]}),e.renderType==="arrow-diamond-center"&&a.jsxs("g",{children:[a.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),a.jsx("polygon",{points:"25,2 30,7 25,12 20,7",stroke:n,strokeWidth:"2",fill:"none"})]}),e.renderType==="arrow-double-bar-center"&&a.jsxs("g",{children:[a.jsx("polygon",{points:"40,3 48,7 40,11",fill:n}),a.jsx("line",{x1:"22",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"26",y1:"2",x2:"26",y2:"12",stroke:n,strokeWidth:"2"})]}),e.renderType==="cutoff-double"&&a.jsxs("g",{children:[a.jsx("line",{x1:"22",y1:"2",x2:"22",y2:"12",stroke:n,strokeWidth:"2"}),a.jsx("line",{x1:"28",y1:"2",x2:"28",y2:"12",stroke:n,strokeWidth:"2"})]})]})},rC=({value:t,onChange:e,className:n})=>{const[r,s]=B.useState(!1),i=Tt[t]||Tt.custom||{label:t};return a.jsxs("div",{className:`relative ${n}`,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between p-2 border rounded bg-white text-gray-900 dark:text-gray-100 dark:bg-gray-700 text-xs hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[a.jsxs("div",{className:"flex items-center overflow-hidden",children:[a.jsx(Tf,{type:t}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsx(kx,{size:14,className:"opacity-50 shrink-0 ml-1"})]}),r&&a.jsxs("div",{className:"absolute top-full left-0 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded shadow-xl max-h-60 overflow-y-auto z-50 text-gray-900 dark:text-gray-100 text-left",children:[Object.entries(mr).map(([o,c])=>a.jsxs("div",{children:[a.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-900 text-[9px] font-bold uppercase text-gray-500 sticky top-0 border-b border-gray-200 dark:border-gray-700",children:o}),c.map(u=>{const h=Tt[u];return h?a.jsxs("button",{onClick:()=>{e(u),s(!1)},className:`w-full flex items-center p-2 text-xs hover:bg-blue-50 dark:hover:bg-blue-900/30 text-left border-b border-gray-50 dark:border-gray-700 ${t===u?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[a.jsx(Tf,{type:u}),a.jsx("span",{children:h.label})]},u):null})]},o)),a.jsx("div",{className:"p-1 sticky bottom-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:a.jsx("button",{onClick:()=>s(!1),className:"w-full py-1 text-center text-gray-400 hover:text-red-500 text-[10px]",children:"Chiudi"})})]})]})},sC=({edge:t,start:e,end:n,isSelected:r,darkMode:s,customConfig:i,onSelect:o,onAddChild:c})=>{let u=Tt[t.type];!u&&i&&(u=i.config),u||(u={color:"#000",lineStyle:"solid",renderType:"standard"});const h=t.color||u.color,m=u.renderType,g=r?"#3b82f6":s&&h==="#000000"?"#ffffff":h,_=["marriage","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","cohabitation","affair","re-marriage"].includes(t.type),C=ZA(e.y,n.y);let R=(e.x+n.x)/2,M=(e.y+n.y)/2;_&&(M=C);let F="";_?F=`M ${e.x} ${e.y+Do} L ${e.x} ${C} L ${n.x} ${C} L ${n.x} ${n.y+Do}`:t.type.startsWith("child")||t.type.startsWith("twin")?t.type.startsWith("twin")?F=`M ${e.x} ${e.y} L ${n.x} ${n.y}`:F=`M ${e.x} ${e.y} L ${n.x} ${e.y} L ${n.x} ${n.y}`:u.lineStyle==="zigzag"?F=eh(e.x,e.y,n.x,n.y):F=`M ${e.x} ${e.y} Q ${R} ${M} ${n.x} ${n.y}`;const A=u.lineStyle==="dashed"?"8,4":u.lineStyle==="dotted"?"2,2":"0",I=()=>{let k=R,O=M;if(t.type==="best-friend")return a.jsxs("g",{children:[a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(m==="fusion"||m==="triple")return a.jsxs("g",{children:[a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(m==="fusion-hostile")return a.jsxs("g",{children:[a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:eh(e.x,e.y,n.x,n.y),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(m==="triple-zigzag")return a.jsxs("g",{children:[a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:eh(e.x,e.y,n.x,n.y),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(m==="double"||m==="double-zigzag"||m==="best-friend")return a.jsx("path",{d:F,stroke:g,strokeWidth:1,transform:"translate(3,3)",fill:"none",strokeDasharray:A});if(m==="oblique")return a.jsx("line",{x1:k+5,y1:O-10,x2:k-5,y2:O+10,stroke:g,strokeWidth:2});if(m==="oblique-double")return a.jsxs("g",{children:[a.jsx("line",{x1:k+2,y1:O-10,x2:k-8,y2:O+10,stroke:g,strokeWidth:2}),a.jsx("line",{x1:k+8,y1:O-10,x2:k-2,y2:O+10,stroke:g,strokeWidth:2})]});if(m==="x-cross")return a.jsxs("g",{children:[a.jsx("line",{x1:k+5,y1:O-10,x2:k-5,y2:O+10,stroke:g,strokeWidth:2}),a.jsx("line",{x1:k-5,y1:O-10,x2:k+5,y2:O+10,stroke:g,strokeWidth:2})]});if(m==="oblique-double-crossed")return a.jsxs("g",{children:[a.jsx("line",{x1:k+2,y1:O-10,x2:k-8,y2:O+10,stroke:g,strokeWidth:2}),a.jsx("line",{x1:k+8,y1:O-10,x2:k-2,y2:O+10,stroke:g,strokeWidth:2}),a.jsx("line",{x1:k-8,y1:O-10,x2:k+8,y2:O+10,stroke:g,strokeWidth:2})]});if(m==="cutoff-double")return a.jsxs("g",{children:[a.jsx("line",{x1:k-3,y1:O-10,x2:k-3,y2:O+10,stroke:g,strokeWidth:2}),a.jsx("line",{x1:k+3,y1:O-10,x2:k+3,y2:O+10,stroke:g,strokeWidth:2})]});if(m==="cutoff")return a.jsx("line",{x1:k,y1:O-10,x2:k,y2:O+10,stroke:g,strokeWidth:3});const W=_?0:Math.atan2(n.y-e.y,n.x-e.x)*180/Math.PI,b=`translate(${n.x},${n.y}) rotate(${W}) translate(-25,0)`,v=`translate(${R},${M}) rotate(${W})`;return m==="arrow-x-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:g,transform:b}),a.jsxs("g",{transform:v,children:[a.jsx("line",{x1:"-6",y1:"-6",x2:"6",y2:"6",stroke:g,strokeWidth:2}),a.jsx("line",{x1:"-6",y1:"6",x2:"6",y2:"-6",stroke:g,strokeWidth:2})]})]}):m==="arrow-box-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:g,transform:b}),a.jsx("rect",{x:"-6",y:"-6",width:"12",height:"12",stroke:g,strokeWidth:2,fill:"white",transform:v})]}):m==="arrow-diamond-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:g,transform:b}),a.jsx("polygon",{points:"0,-6 6,0 0,6 -6,0",stroke:g,strokeWidth:2,fill:"white",transform:v})]}):m==="arrow-double-bar-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:g,transform:b}),a.jsxs("g",{transform:v,children:[a.jsx("line",{x1:"-3",y1:"-8",x2:"-3",y2:"8",stroke:g,strokeWidth:2}),a.jsx("line",{x1:"3",y1:"-8",x2:"3",y2:"8",stroke:g,strokeWidth:2})]})]}):m.includes("arrow")&&!m.includes("center")&&!m.includes("thick")?a.jsx("g",{children:a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:g,transform:b})}):m==="arrow-thick"?a.jsx("polygon",{points:"-8,-8 4,0 -8,8",fill:g,transform:b}):null},T=k=>{k.stopPropagation(),k.preventDefault(),c(k,t.id)};return a.jsxs("g",{className:"group hover:opacity-80 cursor-pointer",onClick:o,children:[a.jsx("path",{d:F,stroke:"transparent",strokeWidth:20,fill:"none"}),a.jsx("path",{d:F,stroke:g,strokeWidth:r?3:2,strokeDasharray:A,fill:"none"}),a.jsx(I,{}),t.label&&a.jsx("text",{x:R,y:M-15,textAnchor:"middle",fill:g,className:"text-[10px] bg-white dark:bg-gray-800 px-1",children:t.label}),r&&_&&a.jsxs("g",{transform:`translate(${R}, ${C})`,onMouseDown:T,onTouchStart:T,children:[a.jsx("circle",{r:12,fill:"#10b981",stroke:"white"}),a.jsx(wl,{size:12,x:-6,y:-6,stroke:"white",strokeWidth:3}),a.jsx("title",{children:"Aggiungi Figlio alla Coppia"})]})]})},iC=({node:t,isSelected:e,showLabelType:n,darkMode:r,onHandleDown:s,selectionMode:i,onRename:o})=>{const[c,u]=B.useState(!1),[h,m]=B.useState(t.name),g=B.useRef(null);B.useEffect(()=>{c&&g.current&&(g.current.focus(),g.current.select())},[c]);const _=fe=>{fe.stopPropagation(),m(t.name),u(!0)},C=()=>{u(!1),h.trim()!==""&&h!==t.name&&o(t.id,h)},R=fe=>{fe.key==="Enter"&&C(),fe.key==="Escape"&&u(!1)},M=r?"#ffffff":"#000000",F=e||t.indexPerson?3:1.5,A=e?r?"#374151":"#e0f2fe":r?"#1f2937":"#ffffff",I=r?"#ffffff":"#000000",T=r?"#111827":"#ffffff",k=jt,O=gr,W=Do;let b;switch(t.gender){case"M":b=a.jsx("rect",{x:0,y:0,width:k,height:O,stroke:M,strokeWidth:F,fill:A});break;case"F":b=a.jsx("circle",{cx:k/2,cy:O/2,r:k/2,stroke:M,strokeWidth:F,fill:A});break;case"TransWoman":b=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:k,height:O,stroke:M,strokeWidth:F,fill:A}),a.jsx("circle",{cx:k/2,cy:O/2,r:k/3,stroke:M,strokeWidth:1,fill:"none"})]});break;case"TransMan":b=a.jsxs("g",{children:[a.jsx("circle",{cx:k/2,cy:O/2,r:k/2,stroke:M,strokeWidth:F,fill:A}),a.jsx("rect",{x:10,y:10,width:k-20,height:O-20,stroke:M,strokeWidth:1,fill:"none"})]});break;case"NonBinary":b=a.jsx("polygon",{points:`${k/2},0 ${k},${O/2} ${k/2},${O} 0,${O/2}`,stroke:M,strokeWidth:F,fill:A});break;case"Pet":b=a.jsx("path",{d:`M${k/2} 0 L${k} ${O/2} L${k/2} ${O} L0 ${O/2} Z`,stroke:M,strokeWidth:F,fill:A});break;case"Pregnancy":b=a.jsx("path",{d:`M${k/2} 0 L${k} ${O} L0 ${O} Z`,stroke:M,strokeWidth:F,fill:A});break;case"Miscarriage":b=a.jsx("circle",{cx:k/2,cy:O/2,r:8,fill:M});break;case"Abortion":b=a.jsx("g",{children:a.jsx("path",{d:`M5 5 L${k-5} ${O-5} M${k-5} 5 L5 ${O-5}`,stroke:M,strokeWidth:2})});break;case"Stillbirth":b=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:k,height:O,stroke:M,strokeWidth:F,fill:A}),a.jsx("path",{d:`M0 0 L${k} ${O} M${k} 0 L0 ${O}`,stroke:M,strokeWidth:1})]});break;default:b=a.jsx("rect",{x:5,y:5,width:k-10,height:O-10,stroke:M,strokeWidth:F,fill:A,strokeDasharray:"4 2"});break}const v=()=>a.jsxs("g",{className:"pointer-events-none",children:[t.substanceAbuse&&(t.gender==="M"?a.jsx("rect",{x:0,y:O/2,width:k,height:O/2,fill:"#f97316",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M 0 ${O/2} A ${W} ${W} 0 0 0 ${k} ${O/2} Z`,fill:"#f97316",fillOpacity:"0.8",stroke:"none"})),t.mentalIssue&&(t.gender==="M"?a.jsx("rect",{x:0,y:0,width:k/3,height:O,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M ${W} 0 A ${W} ${W} 0 0 0 ${W} ${O} Z`,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"})),t.gayLesbian&&a.jsx("path",{d:`M ${k/2-7} ${O-12} L ${k/2+7} ${O-12} L ${k/2} ${O} Z`,fill:"#ec4899",stroke:A,strokeWidth:1})]}),w=t.deceased?a.jsxs("g",{stroke:M,strokeWidth:1.5,children:[a.jsx("line",{x1:0,y1:0,x2:k,y2:O}),a.jsx("line",{x1:k,y1:0,x2:0,y2:O})]}):null,E=t.indexPerson?t.gender==="M"?a.jsx("rect",{x:6,y:6,width:k-12,height:O-12,stroke:M,strokeWidth:1.5,fill:"none"}):a.jsx("circle",{cx:k/2,cy:O/2,r:k/2-6,stroke:M,strokeWidth:1.5,fill:"none"}):null;let P="";const D=t.birthDate&&t.birthDate.trim()!=="",N=t.showAge!==!1;if(n==="age"&&D&&N&&(P=ml(t.birthDate)),n==="year"&&D&&N){const fe=Yw(t.birthDate);fe&&(P=fe.getFullYear().toString())}const Le=(fe,Xe)=>{fe.stopPropagation(),fe.preventDefault(),s(fe,Xe,t.id)},St=({y:fe,text:Xe,size:Z,bold:de})=>{if(!Xe)return null;const ue=Z*.65,Ae=Xe.length*ue+8,Te=Z+4;return a.jsxs("g",{pointerEvents:"none",children:[a.jsx("rect",{x:k/2-Ae/2,y:fe-Te/2,width:Ae,height:Te,fill:T,fillOpacity:"0.9",rx:"3"}),a.jsx("text",{x:k/2,y:fe,dominantBaseline:"middle",textAnchor:"middle",fill:I,className:`text-[${Z}px] font-sans ${de?"font-bold":""} select-none`,style:{fontSize:Z},children:Xe})]})};return a.jsxs("g",{transform:`translate(${t.x},${t.y})`,className:"cursor-pointer group",onDoubleClick:_,children:[b," ",a.jsx(v,{})," ",E," ",w,c?a.jsx("foreignObject",{x:-40,y:-30,width:120,height:30,children:a.jsx("input",{ref:g,value:h,onChange:fe=>m(fe.target.value),onBlur:C,onKeyDown:R,style:{width:"100%",height:"100%",border:"1px solid #3b82f6",borderRadius:"4px",padding:"2px",fontSize:"12px",textAlign:"center",background:T,color:I,outline:"none"}})}):a.jsx(St,{y:-10,text:t.name,size:11,bold:!0}),a.jsx(St,{y:O+12,text:P,size:10,bold:!0}),t.label&&a.jsx(St,{y:O+26,text:t.label,size:9}),t.notes&&t.notes.length>0&&a.jsx("circle",{cx:k+5,cy:0,r:4,fill:"#ef4444",stroke:"white",strokeWidth:1}),e&&!i&&!c&&a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${k+20}, ${W})`,onMouseDown:fe=>Le(fe,"spouse"),onTouchStart:fe=>Le(fe,"spouse"),className:"cursor-crosshair hover:opacity-80",children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#db2777",strokeWidth:2}),a.jsx(bo,{size:14,x:-7,y:-7,fill:"#db2777",stroke:"#db2777"}),a.jsx("title",{children:"Coniuge"})]}),a.jsxs("g",{transform:`translate(${W}, ${O+25})`,onMouseDown:fe=>Le(fe,"child"),onTouchStart:fe=>Le(fe,"child"),className:"cursor-crosshair hover:opacity-80",children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#10b981",strokeWidth:2}),a.jsx(wl,{size:14,x:-7,y:-7,color:"#10b981",strokeWidth:3}),a.jsx("title",{children:"Figlio"})]}),a.jsxs("g",{transform:`translate(${W}, -25)`,onMouseDown:fe=>Le(fe,"parents"),onTouchStart:fe=>Le(fe,"parents"),className:"cursor-crosshair hover:opacity-80",children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#8b5cf6",strokeWidth:2}),a.jsx(ko,{size:14,x:-7,y:-7,color:"#8b5cf6"}),a.jsx("title",{children:"Genitori"})]}),a.jsxs("g",{transform:`translate(-20, ${W})`,onMouseDown:fe=>Le(fe,"link"),onTouchStart:fe=>Le(fe,"link"),className:"cursor-alias hover:opacity-80",children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:1}),a.jsx(bp,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Relazione"})]})]})]})},oC=({x:t,y:e,mode:n,customPresets:r,onSelect:s,onClose:i})=>{let o=[];n==="child"||n==="parents"?o=mr.Figli||[]:n==="spouse"?o=mr.Struttura||[]:o=["Legami Affettivi","Conflitto/Distanza","Abuso/Potere"].flatMap(h=>mr[h]);const c=[...o.map(h=>{const m=Tt[h];return m?{type:h,label:m.label}:null}).filter(Boolean),...r.map(h=>({type:h.id,label:h.name}))],u={left:t,top:e};return t>window.innerWidth-260&&(u.left=t-260),e>window.innerHeight-300&&(u.top=e-300),a.jsxs("div",{className:"fixed theme-panel shadow-2xl rounded-lg p-2 w-64 border theme-border z-[9999] flex flex-col max-h-80",style:u,children:[a.jsxs("div",{className:"text-[10px] font-bold opacity-50 uppercase px-2 py-1 rounded sticky top-0 flex justify-between items-center z-10 mb-1",style:{backgroundColor:"rgba(127,127,127,0.1)"},children:[a.jsx("span",{children:"Seleziona Tipo"}),a.jsx("button",{onClick:i,className:"hover:text-red-500",children:a.jsx(Fs,{size:12})})]}),a.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:c.map(h=>h&&a.jsxs("button",{onClick:()=>s(h.type),className:"w-full flex items-center gap-2 p-2 text-xs theme-hover text-left border-b theme-border last:border-0",children:[a.jsx("div",{className:"shrink-0",children:a.jsx(Tf,{type:h.type})}),a.jsx("span",{className:"truncate",children:h.label})]},h.type))})]})},aC={Pastello:Gw,Vividi:qw,Neutri:KA},lC=({value:t,onChange:e})=>{const n=B.useRef(null);return a.jsxs("div",{className:"space-y-2",children:[Object.entries(aC).map(([r,s])=>a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1",children:r}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.map(i=>a.jsx("button",{onClick:()=>e(i),className:"w-6 h-6 rounded-full border border-black/10 dark:border-white/10 transition-transform hover:scale-110 flex items-center justify-center relative",style:{backgroundColor:i},title:i,children:t.toLowerCase()===i.toLowerCase()&&a.jsx("div",{className:`w-2 h-2 rounded-full ${["#ffffff","#f3f4f6","#fbcfe8","#fde68a"].includes(i)?"bg-black":"bg-white"}`})},i))})]},r)),a.jsxs("div",{className:"pt-2 border-t theme-border mt-2",children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},className:"w-full flex items-center justify-center gap-2 p-1.5 text-xs rounded border theme-border theme-hover opacity-70 hover:opacity-100",children:[a.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:t}}),a.jsx("span",{children:"Colore Personalizzato..."})]}),a.jsx("input",{ref:n,type:"color",className:"hidden",value:t,onChange:r=>e(r.target.value)})]})]})},th=({notes:t,onChange:e})=>{const[n,r]=B.useState(""),[s,i]=B.useState(""),[o,c]=B.useState(null),u=B.useMemo(()=>[...t].sort((g,_)=>{const C=Au(g.date);return Au(_.date)-C}),[t]),h=()=>{if(!n.trim())return;const g=s||new Date().toLocaleDateString();o?(e(t.map(_=>_.id===o?{..._,text:n,date:g}:_)),c(null)):e([...t,{id:nt(),text:n,date:g}]),r(""),i("")},m=g=>{c(g.id),r(g.text),i(g.date)};return a.jsxs("div",{className:"border-t theme-border pt-2 mt-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1 theme-text",children:"Diario Clinico / Note"}),a.jsx("div",{className:"space-y-1 mb-2 max-h-32 overflow-y-auto custom-scrollbar",children:u.map(g=>a.jsxs("div",{className:"p-2 rounded text-xs relative group border theme-border bg-yellow-50/10 border-yellow-200/50 dark:border-yellow-900/30",children:[a.jsx("div",{className:"absolute inset-0 bg-yellow-500 opacity-10 rounded pointer-events-none"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("div",{className:"font-bold opacity-50 text-[10px] theme-text",children:g.date||"Senza data"}),a.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:()=>m(g),className:"theme-text hover:bg-black/10 dark:hover:bg-white/10 rounded p-0.5",children:a.jsx(du,{size:10})}),a.jsx("button",{onClick:()=>e(t.filter(_=>_.id!==g.id)),className:"text-red-500 hover:bg-red-100 rounded p-0.5",children:a.jsx(Fs,{size:10})})]})]}),a.jsx("div",{className:"whitespace-pre-wrap theme-text",children:g.text})]})]},g.id))}),a.jsxs("div",{className:"flex flex-col gap-1 border theme-border p-1 rounded bg-black/5 dark:bg-white/5",children:[a.jsx("input",{type:"text",className:"w-full text-[10px] border-b theme-border bg-transparent p-1 outline-none theme-text placeholder-opacity-50 placeholder-current",value:s,onChange:g=>i(g.target.value),placeholder:"Data (es. Gennaio 2025, 12/05/98)"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("textarea",{className:"flex-1 border-none bg-transparent text-xs p-1 outline-none resize-none h-12 theme-text placeholder-opacity-50 placeholder-current",value:n,onChange:g=>r(g.target.value),placeholder:o?"Modifica nota...":"Nuova nota...",onKeyDown:g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),h())}}),a.jsx("button",{onClick:h,className:"bg-blue-600 text-white p-1 rounded self-end hover:bg-blue-700",children:o?a.jsx(bx,{size:14}):a.jsx(wl,{size:14})}),o&&a.jsx("button",{onClick:()=>{c(null),r(""),i("")},className:"bg-gray-200 text-gray-600 p-1 rounded self-end hover:bg-gray-300",children:a.jsx(Fs,{size:14})})]})]})]})},cC=({onClose:t,nodes:e,edges:n,groups:r})=>{const[s,i]=B.useState(null),[o,c]=B.useState(""),u=B.useMemo(()=>{if(!s)return null;const m=e.find(T=>T.id===s);if(!m)return null;const _=n.filter(T=>(T.fromId===s||T.toId===s)&&mr.Struttura.includes(T.type)).map(T=>{const k=T.fromId===s?T.toId:T.fromId,O=e.find(b=>b.id===k),W=Tt[T.type];return{name:O?O.name:"Sconosciuto",type:W?W.label:T.type}}),R=n.filter(T=>T.fromId===s||T.toId===s).map(T=>{if(mr.Struttura.includes(T.type))return null;const k=T.fromId===s?T.toId:T.fromId;let O="Sconosciuto";const W=e.find(v=>v.id===k);if(W)O=W.name;else{const v=r.find(w=>w.id===k);if(v){const w=e.filter(E=>v.memberIds.includes(E.id)).map(E=>E.name).join(", ");O=`Gruppo: ${v.label} (Membri: ${w})`}}const b=Tt[T.type];return{id:T.id,with:O,type:b?b.label:T.type,notes:T.notes}}).filter(Boolean),F=n.filter(T=>T.toId===s&&T.type.startsWith("child")).map(T=>{const k=e.find(O=>O.id===T.fromId);return k?k.name:"Ignoto"}),I=n.filter(T=>T.fromId===s&&T.type.startsWith("child")).map(T=>{const k=e.find(O=>O.id===T.toId);return k?k.name:"Ignoto"});return{person:m,relations:R,parents:F,children:I,spouses:_}},[s,e,n,r]),h=e.filter(m=>m.name.toLowerCase().includes(o.toLowerCase()));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel border theme-border rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex overflow-hidden",children:[a.jsxs("div",{className:"w-1/3 border-r theme-border flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h2",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(uo,{})," Report"]}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx(hu,{className:"absolute left-2 top-2.5 opacity-50 theme-text",size:14}),a.jsx("input",{className:"w-full pl-8 p-2 text-sm border rounded bg-transparent theme-border theme-text placeholder-opacity-50 placeholder-current focus:outline-none focus:ring-1 focus:ring-[var(--theme-accent)]",placeholder:"Cerca persona...",value:o,onChange:m=>c(m.target.value)})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:h.map(m=>a.jsxs("button",{onClick:()=>i(m.id),className:`w-full text-left p-3 border-b theme-border theme-hover transition-colors ${s===m.id?"bg-black/10 dark:bg-white/10 border-l-4 border-l-[var(--theme-accent)]":""}`,children:[a.jsx("div",{className:"font-bold text-sm theme-text",children:m.name}),a.jsxs("div",{className:"text-xs opacity-50 theme-text",children:[m.gender,"  ",ml(m.birthDate)," anni"]})]},m.id))})]}),a.jsxs("div",{className:"flex-1 flex flex-col bg-black/5 dark:bg-white/5",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center theme-panel border-b theme-border",children:[a.jsx("h3",{className:"font-bold theme-text",children:"Dettagli Scheda"}),a.jsx("button",{onClick:t,className:"theme-text theme-hover p-1 rounded",children:a.jsx(Fs,{})})]}),a.jsx("div",{className:"p-6 overflow-y-auto flex-1 custom-scrollbar",children:u?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsx("div",{className:`w-16 h-16 flex items-center justify-center rounded-full text-2xl font-bold shadow-sm border theme-border ${["M","TransMan"].includes(u.person.gender)?"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200":["F","TransWoman"].includes(u.person.gender)?"bg-pink-100 text-pink-600 dark:bg-pink-900 dark:text-pink-200":"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-200"}`,children:u.person.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold theme-text",children:u.person.name}),a.jsxs("div",{className:"text-sm opacity-70 theme-text",children:["Nato/a: ",u.person.birthDate||"?","  Et: ",ml(u.person.birthDate)]})]})]}),u.spouses.length>0&&a.jsxs("div",{className:"p-4 rounded shadow-sm border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h4",{className:"font-bold mb-2 text-sm uppercase opacity-70 theme-text flex items-center gap-2",children:[a.jsx(bo,{size:12})," Partner / Coniugi"]}),u.spouses.map((m,g)=>a.jsxs("div",{className:"font-medium theme-text",children:[" ",m.name," ",a.jsxs("span",{className:"opacity-60 text-xs",children:["(",m.type,")"]})]},g))]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Genitori"}),u.parents.length?u.parents.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Figli"}),u.children.length?u.children.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsxs("h4",{className:"font-bold mb-3 text-sm uppercase opacity-50 theme-text",children:["Altre Relazioni (",u.relations.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[u.relations.map(m=>a.jsxs("div",{className:"flex justify-between items-center p-2 border theme-border rounded theme-hover",children:[a.jsxs("span",{className:"font-medium theme-text",children:[m.type," ",a.jsx("span",{className:"font-normal opacity-70",children:"con"})," ",m.with]}),m.notes.length>0&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100 px-2 py-0.5 rounded border border-yellow-200 dark:border-yellow-700",children:"Note"})]},m.id)),u.relations.length===0&&a.jsx("div",{className:"text-sm opacity-50 theme-text",children:"Nessuna altra relazione registrata"})]})]})]}):a.jsx("div",{className:"opacity-50 text-center mt-20 theme-text",children:"Seleziona una persona per vedere il report"})})]})]})})},uC=({onClose:t,onExport:e,onImport:n,setCustomUser:r,customUser:s,setFirebaseConfig:i,firebaseConfig:o})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel p-6 rounded-lg shadow-xl w-96 space-y-4 border theme-border",children:[a.jsxs("h2",{className:"font-bold text-lg flex justify-between items-center",children:["Impostazioni ",a.jsx("button",{onClick:t,children:a.jsx(Fs,{size:20})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"ID Utente (Opzionale)"}),a.jsx("input",{className:"w-full border theme-border p-2 rounded bg-transparent text-sm",value:s,onChange:c=>r(c.target.value),placeholder:"Tuo ID univoco per sync"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Configurazione Firebase (JSON)"}),a.jsx("textarea",{className:"w-full border theme-border p-2 rounded bg-transparent text-[10px] h-24 font-mono",value:o,onChange:c=>i(c.target.value),placeholder:'{"apiKey": "...", ...}'})]}),a.jsxs("div",{className:"pt-4 border-t theme-border flex flex-col gap-2",children:[a.jsxs("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm flex items-center justify-center gap-2",children:[a.jsx(_p,{size:14})," Backup Dati (JSON)"]}),a.jsxs("label",{className:"w-full border theme-border py-2 rounded text-sm flex items-center justify-center gap-2 cursor-pointer theme-hover",children:[a.jsx(Ub,{size:14})," Ripristina Backup",a.jsx("input",{type:"file",onChange:n,className:"hidden",accept:".json"})]})]})]})}),dC=({onClose:t,firebaseConfig:e})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-4xl h-[90vh] rounded-xl shadow-2xl flex flex-col overflow-hidden border theme-border",children:[a.jsxs("div",{className:"p-4 border-b theme-border flex justify-between items-center bg-black/5 dark:bg-white/5 shrink-0",children:[a.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2 theme-text",children:[a.jsx(wp,{className:"text-[var(--theme-accent)]"})," Manuale Utente"]}),a.jsx("button",{onClick:t,className:"p-1 theme-hover rounded theme-text",children:a.jsx(Fs,{})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar leading-relaxed",children:[a.jsx("style",{children:`
                        .manual-section { margin-bottom: 40px; }
                        .manual-h2 { font-size: 1.4rem; font-weight: 700; color: var(--theme-accent); border-left: 4px solid var(--theme-accent); padding-left: 12px; margin-bottom: 1.5rem; margin-top: 1rem; background: rgba(125,125,125,0.05); padding-top:8px; padding-bottom:8px; border-radius: 0 8px 8px 0; }
                        .manual-h3 { font-size: 1.1rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.8rem; opacity: 0.9; color: var(--theme-text); border-bottom: 1px dashed var(--theme-border); padding-bottom: 4px; }
                        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; margin-top: 15px; }
                        .tool-card { border: 1px solid var(--theme-border); border-radius: 8px; padding: 16px; display: flex; gap: 16px; background: rgba(125,125,125,0.03); align-items: flex-start; transition: transform 0.2s; }
                        .tool-card:hover { background: rgba(125,125,125,0.06); }
                        .key-badge { background: rgba(125,125,125,0.1); border: 1px solid var(--theme-border); padding: 2px 8px; border-radius: 6px; font-family: monospace; font-weight: bold; font-size: 0.9em; color: var(--theme-text); display: inline-block; min-width: 24px; text-align: center; }
                        .theme-text-desc { color: var(--theme-text); opacity: 0.7; font-size: 0.9rem; margin-top: 4px; line-height: 1.4; }
                        .icon-box { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: rgba(125,125,125,0.1); }
                        ul.manual-list { list-style: disc; margin-left: 20px; color: var(--theme-text); opacity: 0.9; }
                        ul.manual-list li { margin-bottom: 6px; }
                        strong { color: var(--theme-text); opacity: 1; }
                    `}),a.jsxs("div",{className:"text-center mb-10",children:[a.jsx("h1",{className:"text-3xl font-bold theme-text mb-2",children:"GenoPro Web"}),a.jsx("p",{className:"opacity-60 theme-text text-lg",children:"Guida completa alle funzionalit, strumenti e simbologia."})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"1. Dashboard e Temi"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Yh,{className:"text-blue-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Categorie"}),a.jsx("div",{className:"theme-text-desc",children:"Filtra per Famiglie, Coppie, Individuali, Lavoro, ecc."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ep,{className:"text-orange-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Temi Grafici"}),a.jsxs("div",{className:"theme-text-desc",children:["Scegli tra vari stili: ",a.jsx("b",{children:"Light"}),", ",a.jsx("b",{children:"Dark"}),", ",a.jsx("b",{children:"Sepia"}),", ",a.jsx("b",{children:"Dracula"}),", ",a.jsx("b",{children:"Nordic"})," e altri."]})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(hu,{className:"text-purple-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Ricerca"}),a.jsx("div",{className:"theme-text-desc",children:"Cerca genogrammi velocemente per titolo."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"2. Navigazione Touch (Tablet & iPad)"}),a.jsx("p",{className:"theme-text mb-4 opacity-80",children:"L'interfaccia  ottimizzata per l'uso con le dita e supporta gesture avanzate."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 rounded border theme-border bg-blue-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scorrimento (Pan)"}),a.jsx("p",{className:"theme-text-desc",children:"Trascina un dito su un'area vuota per spostarti nel grafico."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-green-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Zoom (Pinch)"}),a.jsx("p",{className:"theme-text-desc",children:"Usa due dita (pizzico) per ingrandire o rimpicciolire la vista."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-purple-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiunta Rapida (Long Press)"}),a.jsxs("p",{className:"theme-text-desc",children:["Tocca e ",a.jsx("b",{children:"tieni premuto"})," un dito su un punto vuoto per aprire il menu rapido (M/F)."]})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-orange-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Selezione Multipla"}),a.jsxs("p",{className:"theme-text-desc",children:["Attiva ",a.jsx("strong",{children:"Mod. Selezione"})," nella toolbar, poi trascina per creare un rettangolo."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"3. Costruzione Rapida"}),a.jsx("p",{className:"mb-4 theme-text opacity-80",children:"Seleziona una persona per vedere le 4 maniglie colorate:"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-pink-100 dark:bg-pink-900/30 border border-pink-200 dark:border-pink-800",children:a.jsx(bo,{size:20,className:"text-pink-600 dark:text-pink-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Destra: Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un coniuge/partner a destra."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800",children:a.jsx(wl,{size:20,className:"text-green-600 dark:text-green-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Basso: Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio (collegato alla coppia se presente)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-purple-100 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800",children:a.jsx(ko,{size:20,className:"text-purple-600 dark:text-purple-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Alto: Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Genera automaticamente la coppia di genitori sopra il soggetto."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800",children:a.jsx(bp,{size:20,className:"text-orange-600 dark:text-orange-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Sinistra: Link"}),a.jsxs("div",{className:"theme-text-desc",children:["Trascina verso un'altra persona ",a.jsx("b",{children:"o un Gruppo"})," per creare una relazione manuale."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"4. Propriet e Simbologia"}),a.jsx("h3",{className:"manual-h3",children:" Propriet Persona"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Dati Anagrafici:"}),' Nome, Data (es. "1980" o "12/05/1980").']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Mostra Et:"})," Checkbox per nascondere/mostrare l'et calcolata."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Marcatori Clinici:"})," Deceduto (X), Pz. Designato (Doppio bordo), Abuso Sostanze (Arancio), Problema Psi (Viola), Omosessualit (Triangolo Rosa)."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Relazione"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Tipo Relazione:"})," Scegli tra decine di stili (Conflitto, Armonia, Abuso, Distanza, ecc.)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Ancoraggio Gruppi:"})," Se colleghi un gruppo, usa lo ",a.jsx("strong",{children:"Slider (0-100%)"})," nella sidebar per spostare la freccia lungo il bordo curvo."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Gruppo"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Palette Colori:"})," Selettore rapido (Pastello, Vividi, Neutri)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Forma Organica:"})," Si adatta automaticamente al contenuto."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Viola (Basso):"})," Trascina per regolare la grandezza (padding)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Gialla (Sinistra):"})," Trascina per creare relazioni dal gruppo."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"5. Strumenti della Toolbar"}),a.jsx("p",{className:"theme-text opacity-80 mb-4",children:"Ecco la spiegazione di tutti i pulsanti presenti nella barra in alto, da sinistra a destra."}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Xh,{size:20,className:"text-[var(--theme-accent)]"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Maschio"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto maschio al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Qh,{size:20,className:"text-pink-600"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuova Femmina"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto femmina al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Mx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Crea i genitori sopra la persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(bo,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un coniuge a fianco della persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Sx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio sotto la selezione (se coppia, collega a entrambi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(ko,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Gruppo"}),a.jsx("div",{className:"theme-text-desc",children:'Raggruppa le persone selezionate in una "Household" o sottosistema.'})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(jx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Auto-Layout"}),a.jsx("div",{className:"theme-text-desc",children:"Riorganizza automaticamente l'intero albero genealogico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(cu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Orizzontale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa riga (Y)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(cu,{size:20,className:"theme-text rotate-90"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Verticale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa colonna (X)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(wx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Figli"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i figli selezionati esattamente sotto al centro dei genitori."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ex,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i genitori selezionati esattamente sopra al centro dei figli."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Tx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Cerchio"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi selezionati in cerchio (utile per sociogrammi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Nx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Ordina i nodi selezionati in una griglia compatta."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Dx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scala / Diagonale"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi in diagonale (utile per linee temporali)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ax,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Snap Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Attiva/Disattiva l'aggancio magnetico dei nodi alla griglia."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Px,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Mod. Selezione"}),a.jsx("div",{className:"theme-text-desc",children:"Permette di selezionare pi elementi trascinando un rettangolo blu."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(du,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Designer Stili"}),a.jsx("div",{className:"theme-text-desc",children:"Editor per creare nuovi tipi di linee o simboli relazionali."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(uu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Legenda"}),a.jsx("div",{className:"theme-text-desc",children:"Mostra o nasconde la legenda automatica sul grafico."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"6. Esportazione"}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-yellow-500/10 mb-4 flex gap-3 items-center",children:[a.jsx(uu,{size:24,className:"text-yellow-600 dark:text-yellow-400 shrink-0"}),a.jsxs("p",{className:"theme-text text-sm",children:[a.jsx("strong",{children:"Nota Importante:"})," L'esportazione mantiene i colori del ",a.jsx("strong",{children:"Tema Attuale"}),'. Se sei in "Dark Mode", il PDF/Immagine avr sfondo scuro. Passa a "Light Mode" prima di esportare se desideri uno sfondo bianco per la stampa.']})]}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"PNG / JPEG:"})," Immagine raster ad alta risoluzione (supporta zoom impostabile da 1x a 6x)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"PDF Vettoriale:"})," Scarica solo il grafico in vettoriale. Perfetto per stampe professionali o tesi (non sgrana mai)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Report Clinico:"})," Genera un documento PDF multipagina con grafico, legenda simboli e scheda testuale dettagliata per ogni persona."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"7. Impostazioni, Backup e Cloud"}),a.jsx("p",{className:"theme-text opacity-80 mb-6",children:"Gestisci i tuoi dati, salvali al sicuro o sincronizzali tra pi dispositivi."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-600",children:a.jsx(_p,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Backup Locale"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Salva tutti i tuoi genogrammi in un unico file (JSON) sul tuo computer. Utile per creare copie di sicurezza o trasferire i dati manualmente."}),a.jsxs("ul",{className:"manual-list text-sm",children:[a.jsxs("li",{children:["Clicca su ",a.jsx(Rx,{size:12,className:"inline"})," ",a.jsx("strong",{children:"Impostazioni"}),"."]}),a.jsxs("li",{children:["Premi ",a.jsx("strong",{children:"Backup Dati"})," per scaricare il file."]}),a.jsxs("li",{children:["Usa ",a.jsx("strong",{children:"Ripristina"})," per caricare un backup salvato."]})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-orange-100 dark:bg-orange-900/30 text-orange-600",children:a.jsx(Ix,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Sincronizzazione Cloud"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Collega un database personale per salvare i dati online e accedervi da PC, iPad e Tablet contemporaneamente."}),a.jsxs("div",{className:"p-3 rounded bg-green-500/10 border border-green-500/20 text-xs theme-text",children:[a.jsx("strong",{className:"text-green-600 dark:text-green-400",children:"Stato:"})," ",e?" Connesso":" Non configurato (Salvataggio solo locale)"]})]})]}),a.jsxs("div",{className:"p-5 rounded-xl border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h3",{className:"text-base font-bold theme-text mb-4 flex items-center gap-2",children:[a.jsx(Cb,{size:18,className:"text-[var(--theme-accent)]"}),"Guida: Come creare il tuo Cloud Personale (Gratis)"]}),a.jsxs("div",{className:"space-y-4 text-sm theme-text opacity-90",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"1"}),a.jsxs("div",{children:["Vai su ",a.jsx("a",{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Firebase Console"})," e accedi con il tuo account Google."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"2"}),a.jsxs("div",{children:["Clicca ",a.jsx("strong",{children:'"Crea un progetto"'}),' (chiamalo es. "GenoPro-Mio"). Disabilita Google Analytics per fare prima.']})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"3"}),a.jsxs("div",{children:["Nel menu a sinistra, vai su ",a.jsx("strong",{children:'"Build" > "Firestore Database"'})," e clicca su ",a.jsx("strong",{children:'"Crea Database"'}),".",a.jsx("br",{}),a.jsxs("span",{className:"opacity-70 text-xs",children:["(Seleziona una localit vicina, es. eur3, e scegli avvia in ",a.jsx("strong",{children:"Modalit Test"}),")."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"4"}),a.jsxs("div",{children:["Torna alla ",a.jsx("strong",{children:"Home del Progetto"}),` (icona ingranaggio in alto a sx > Impostazioni progetto). Scorri in basso fino a "Le tue app" e clicca sull'icona `,a.jsx("strong",{children:"Web (</>)"}),"."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"5"}),a.jsxs("div",{children:["Dai un nome all'app e registrala. Ti verr mostrato un codice. Copia tutto il contenuto tra le parentesi graffe:",a.jsxs("div",{className:"mt-2 p-2 bg-gray-200 dark:bg-gray-800 rounded font-mono text-[10px] opacity-70",children:['apiKey: "AIzaSy...",',a.jsx("br",{}),'authDomain: "...",',a.jsx("br",{}),'projectId: "...",',a.jsx("br",{}),"..."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"6"}),a.jsxs("div",{children:["Torna qui in GenoPro, apri ",a.jsx("strong",{children:"Impostazioni"}),' e incolla il codice nel box "Configurazione Firebase".']})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"Scorciatoie da Tastiera"}),a.jsxs("div",{className:"border theme-border rounded overflow-hidden text-sm mt-4",children:[a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 bg-black/5 dark:bg-white/5 font-bold theme-text",children:[a.jsx("span",{children:"Azione"})," ",a.jsx("span",{children:"Tasti"})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Maschio / Femmina"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"M"})," / ",a.jsx("span",{className:"key-badge",children:"F"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Partner"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"S"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Figlio"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"C"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Genitori"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"P"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Seleziona Tutto"}),a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"A"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Cerchio"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"C"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Griglia"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"G"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Scala"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"D"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Allinea Orizz./Vert."})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"H"})," / ",a.jsx("span",{className:"key-badge",children:"V"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Legenda"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"I"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Elimina"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"Canc"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Salva"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"S"})]})]})]})]})]})," ",a.jsx("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 text-center shrink-0",children:a.jsx("button",{onClick:t,className:"px-8 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md transition-all font-medium",children:"Chiudi Manuale"})})]})}),hC=({onClose:t,onSave:e})=>{const[n,r]=B.useState("Nuovo Stile"),[s,i]=B.useState("#000000"),[o,c]=B.useState("solid"),[u,h]=B.useState("standard"),m=()=>{e({id:`custom-${nt()}`,name:n,type:"relationship",config:{color:s,lineStyle:o,renderType:u,decorator:""}}),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-96 space-y-4 text-black dark:text-white",children:[a.jsx("h3",{className:"font-bold text-lg",children:"Designer Relazioni"}),a.jsx("input",{className:"w-full border p-2 rounded dark:bg-gray-700",value:n,onChange:g=>r(g.target.value),placeholder:"Nome stile"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Colore"}),a.jsx("input",{type:"color",className:"w-full h-8",value:s,onChange:g=>i(g.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Tratteggio"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:o,onChange:g=>c(g.target.value),children:[a.jsx("option",{value:"solid",children:"Solido"}),a.jsx("option",{value:"dashed",children:"Tratteggiato"}),a.jsx("option",{value:"dotted",children:"Puntinato"}),a.jsx("option",{value:"zigzag",children:"ZigZag"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Decorazione"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:u,onChange:g=>h(g.target.value),children:[a.jsx("option",{value:"standard",children:"Nessuna"}),a.jsx("option",{value:"arrow",children:"Freccia Singola"}),a.jsx("option",{value:"arrow-double",children:"Freccia Doppia"}),a.jsx("option",{value:"fusion",children:"Fusione"}),a.jsx("option",{value:"cutoff",children:"Taglio"})]})]}),a.jsx("div",{className:"p-4 border rounded bg-gray-50 dark:bg-gray-900 flex justify-center items-center h-20",children:a.jsx("svg",{width:"200",height:"20",children:a.jsx("line",{x1:"0",y1:"10",x2:"200",y2:"10",stroke:s,strokeWidth:"2",strokeDasharray:o==="dashed"?"5,5":o==="dotted"?"2,2":""})})}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500",children:"Annulla"}),a.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Salva Preset"})]})]})})},fC=t=>{try{if(!t)return null;let e=t.trim();const n=e.indexOf("{"),r=e.lastIndexOf("}");return n===-1||r===-1||(e=e.substring(n,r+1),e=e.replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2":'),e=e.replace(/'/g,'"'),e=e.replace(/,(\s*[}\]])/g,"$1")),JSON.parse(e)}catch(e){console.error("Errore parsing config string:",e);try{return JSON.parse(t)}catch{return null}}},pC=({nodes:t,selectedIds:e,onHandleDown:n,onMove:r})=>{if(e.length<2)return null;const s=t.filter(R=>e.includes(R.id));if(s.length===0)return null;const i=Math.min(...s.map(R=>R.x)),o=Math.max(...s.map(R=>R.x+jt)),c=Math.min(...s.map(R=>R.y)),u=Math.max(...s.map(R=>R.y+gr)),h=20,m=i-h,g=c-h,_=o-i+h*2,C=u-c+h*2;return a.jsxs("g",{pointerEvents:"visible",children:[a.jsx("rect",{x:m,y:g,width:_,height:C,fill:"black",fillOpacity:"0.01",stroke:"#3b82f6",strokeWidth:1,strokeDasharray:"5,5",className:"cursor-move",onMouseDown:r,onTouchStart:r}),a.jsxs("g",{transform:`translate(${m+_/2}, ${g})`,className:"cursor-grab active:cursor-grabbing",onMouseDown:R=>n(R,"rotate"),onTouchStart:R=>n(R,"rotate"),children:[a.jsx("line",{x1:0,y1:0,x2:0,y2:-25,stroke:"#3b82f6",strokeWidth:1}),a.jsx("circle",{cx:0,cy:-25,r:5,fill:"white",stroke:"#3b82f6",strokeWidth:2})]}),a.jsx("g",{transform:`translate(${m+_}, ${g+C})`,className:"cursor-nwse-resize",onMouseDown:R=>n(R,"scale"),onTouchStart:R=>n(R,"scale"),children:a.jsx("rect",{x:-6,y:-6,width:12,height:12,fill:"white",stroke:"#3b82f6",strokeWidth:2})})]})},ov=({currentThemeId:t,onChange:e,placement:n="bottom"})=>{const[r,s]=B.useState(!1),i=ws.find(c=>c.id===t)||ws[0],o=B.useRef(null);return B.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&s(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),a.jsxs("div",{className:"relative w-full",ref:o,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors border theme-border theme-panel hover:brightness-95 overflow-hidden",children:[a.jsxs("span",{className:"flex items-center gap-2 truncate min-w-0",children:[i.type==="dark"?a.jsx(Cx,{size:14,className:"shrink-0"}):a.jsx(Ep,{size:14,className:"shrink-0"}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsxs("div",{className:"flex gap-1 ml-2 shrink-0",children:[a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.bgMain}}),a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.accent}})]})]}),r&&a.jsxs("div",{className:`absolute left-0 w-64 max-h-80 overflow-y-auto theme-panel border theme-border shadow-xl rounded-lg p-1 z-[100] ${n==="top"?"bottom-full mb-2":"top-full mt-2"}`,children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 px-2 py-1 uppercase theme-text",children:"Seleziona Tema"}),ws.map(c=>a.jsxs("button",{onClick:()=>{e(c.id),s(!1)},className:`w-full flex items-center justify-between p-2 rounded text-xs theme-hover mb-1 ${t===c.id?"border theme-border bg-black/5 dark:bg-white/5":""}`,children:[a.jsx("span",{className:"font-medium theme-text",children:c.label}),a.jsxs("div",{className:"flex gap-1 shrink-0",children:[a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgMain},title:"Sfondo"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgPanel},title:"Pannelli"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.accent},title:"Accento"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20 flex items-center justify-center",style:{background:c.colors.bgMain},children:a.jsx("span",{style:{color:c.colors.text,fontSize:"8px"},children:"A"})})]})]},c.id))]})]})},mC=({note:t,onUpdate:e,onDelete:n})=>{const[r,s]=B.useState("Classico"),[i,o]=B.useState("Classico");return a.jsxs("div",{onPointerDown:c=>c.stopPropagation(),className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b theme-border",children:[a.jsx(Jh,{className:"text-yellow-500"}),a.jsx("span",{className:"font-bold",children:"Nota Adesiva"})]}),a.jsxs("div",{className:"bg-black/5 dark:bg-white/5 p-1 rounded flex text-xs font-bold mb-2",children:[a.jsx("button",{onClick:()=>e({variant:"classic"}),className:`flex-1 py-1.5 rounded transition-all ${!t.variant||t.variant==="classic"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Post-it"}),a.jsx("button",{onClick:()=>e({variant:"label"}),className:`flex-1 py-1.5 rounded transition-all ${t.variant==="label"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Etichetta"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Contenuto"}),a.jsx("textarea",{className:"w-full h-24 p-2 rounded border bg-white/50 dark:bg-black/20 theme-border text-sm resize-none focus:ring-2 focus:ring-blue-500 outline-none",style:{fontFamily:t.fontFamily,color:t.textColor},value:t.text,onChange:c=>e({text:c.target.value}),placeholder:"Scrivi qui..."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Sfondo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:r,onChange:c=>s(c.target.value),children:Object.keys(Ia).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:[Ia[r].map(c=>a.jsx("button",{onClick:()=>e({color:c}),className:`w-6 h-6 rounded-full border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.color===c?"ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-800 scale-110":""}`,style:{backgroundColor:c}},c)),a.jsx("button",{onClick:()=>e({color:"transparent",opacity:0}),className:"w-6 h-6 rounded-full border border-dashed border-gray-400 flex items-center justify-center text-[8px] opacity-70 hover:opacity-100",title:"Trasparente",children:"/"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold opacity-50 block mb-1 flex justify-between",children:["Opacit ",a.jsxs("span",{children:[Math.round(t.opacity*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",className:"w-full accent-blue-500",value:t.opacity,onChange:c=>e({opacity:parseFloat(c.target.value)})})]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 my-2"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Font"}),a.jsx("select",{className:"w-full p-2 rounded border bg-transparent theme-border text-sm",value:t.fontFamily,onChange:c=>e({fontFamily:c.target.value}),children:Kw.map(c=>a.jsx("option",{value:c.value,className:"text-black",style:{fontFamily:c.value},children:c.label},c.value))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Testo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:i,onChange:c=>o(c.target.value),children:Object.keys(Ia).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsx("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:Ia[i].map(c=>a.jsx("button",{onClick:()=>e({textColor:c}),className:`w-6 h-6 rounded-md border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.textColor===c?"ring-2 ring-blue-500 ring-offset-1 scale-110":""}`,style:{backgroundColor:c}},c))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"W"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.width,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"H"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.height,readOnly:!0})]})]}),a.jsx("div",{className:"pt-4 border-t theme-border mt-auto",children:a.jsxs("button",{onClick:n,className:"w-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 py-2 rounded text-xs hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors flex items-center justify-center gap-2",children:[a.jsx(wa,{size:14})," Elimina Nota"]})})]})},gC=({note:t,isSelected:e,onPointerDown:n,onUpdate:r})=>{const[s,i]=B.useState(null);B.useEffect(()=>{if(!s||!s.active)return;const g=C=>{if(C.buttons===0){i(null);return}const R=C.clientX-s.startX,M=C.clientY-s.startY;let F=s.startW,A=s.startH;s.handle.includes("e")&&(F=Math.max(30,s.startW+R)),s.handle.includes("s")&&(A=Math.max(30,s.startH+M)),r({...t,width:Math.round(F),height:Math.round(A)})},_=()=>i(null);return window.addEventListener("pointermove",g),window.addEventListener("pointerup",_),()=>{window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",_)}},[s,t,r]);const o=(g,_)=>{g.stopPropagation(),g.preventDefault(),g.target.setPointerCapture(g.pointerId),i({active:!0,handle:_,startX:g.clientX,startY:g.clientY,startW:t.width,startH:t.height})},c=({x:g,y:_,cursor:C,handle:R})=>a.jsx("rect",{x:g-8,y:_-8,width:16,height:16,fill:"white",stroke:"#3b82f6",strokeWidth:1,style:{cursor:C,touchAction:"none"},onPointerDown:M=>o(M,R)}),u=t.variant==="label",h=u?8:1,m=u&&t.opacity===0&&(e||(s==null?void 0:s.active));return a.jsxs("g",{transform:`translate(${t.x}, ${t.y})`,onPointerDown:n,className:"cursor-move group",children:[!u&&a.jsx("rect",{x:3,y:3,width:t.width,height:t.height,fill:"black",fillOpacity:.15*t.opacity,rx:2,pointerEvents:"none"}),a.jsx("rect",{width:t.width,height:t.height,fill:t.color,fillOpacity:t.opacity,stroke:e?"#3b82f6":m?"#ccc":"rgba(0,0,0,0.05)",strokeWidth:e?2:1,strokeDasharray:m?"4,2":"",rx:h,style:u?{}:{filter:`drop-shadow(0 1px 2px rgba(0,0,0,${.1*t.opacity}))`}}),!u&&a.jsx("rect",{x:0,y:0,width:t.width,height:20,fill:"black",fillOpacity:.05*t.opacity,pointerEvents:"none"}),a.jsx("foreignObject",{x:5,y:5,width:t.width-10,height:t.height-10,style:{pointerEvents:"none"},children:a.jsx("div",{className:"w-full h-full text-sm whitespace-pre-wrap overflow-hidden leading-snug flex items-center justify-center",style:{fontFamily:t.fontFamily||"sans-serif",fontSize:"13px",color:t.textColor||"#000",opacity:t.opacity<.3&&t.textColor==="#000000"?1:.9,textAlign:u?"center":"left",alignItems:u?"center":"flex-start",display:"flex"},children:a.jsx("span",{className:"w-full",children:t.text||(u?"Etichetta":"Nuova nota...")})})}),e&&a.jsxs(a.Fragment,{children:[a.jsx(c,{x:t.width,y:t.height/2,cursor:"ew-resize",handle:"e"}),a.jsx(c,{x:t.width/2,y:t.height,cursor:"ns-resize",handle:"s"}),a.jsx(c,{x:t.width,y:t.height,cursor:"nwse-resize",handle:"se"})]})]})},yC=({onClose:t,onConfirm:e})=>{const[n,r]=B.useState({onlyPeopleWithNotes:!1,showGender:!0,showBirthDate:!0,showAge:!0,showClinical:!0,showGroups:!0,showFamily:!0,showRelations:!0,showNotes:!0}),s=i=>r(o=>({...o,[i]:!o[i]}));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-md rounded-xl shadow-2xl border theme-border overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5 flex justify-between items-center",children:[a.jsxs("h3",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(uo,{size:18})," Configura Report"]}),a.jsx("button",{onClick:t,children:a.jsx(Fs,{size:18,className:"theme-text opacity-50 hover:opacity-100"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 rounded-lg",children:a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600 shrink-0",checked:n.onlyPeopleWithNotes,onChange:()=>s("onlyPeopleWithNotes")}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm text-blue-900 dark:text-blue-100",children:"Includi solo persone con note"}),a.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300 opacity-80",children:"Esclude dal report chi non ha voci nel diario clinico."})]})]})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Dati Anagrafici"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGender,onChange:()=>s("showGender"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Genere"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showBirthDate,onChange:()=>s("showBirthDate"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Data Nascita"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showAge,onChange:()=>s("showAge"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Et"})]})]}),a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Altri Contenuti"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showClinical,onChange:()=>s("showClinical"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Marcatori Clinici (Simboli, Deceduto, ecc)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGroups,onChange:()=>s("showGroups"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Appartenenza a Gruppi"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showFamily,onChange:()=>s("showFamily"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Legami Familiari (Partner, Genitori, Figli)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showRelations,onChange:()=>s("showRelations"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Altre Relazioni (Amicizie, Conflitti, ecc.)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showNotes,onChange:()=>s("showNotes"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Diario Clinico / Note"})]})]})]})]}),a.jsxs("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 flex justify-end gap-2",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm rounded hover:bg-black/10 dark:hover:bg-white/10 theme-text",children:"Annulla"}),a.jsxs("button",{onClick:()=>e(n),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded shadow-sm flex items-center gap-2",children:[a.jsx(uo,{size:16})," Genera PDF"]})]})]})})};function vC(){var ri;const t=B.useRef(null),e=B.useRef(null),n=B.useRef(null),r=B.useRef({clientX:0,clientY:0}),s=B.useRef(!1),i=B.useRef(null),[o,c]=B.useState(null),[u,h]=B.useState([]),[m,g]=B.useState([]),[_,C]=B.useState(!1),R=B.useRef(null),M=p=>{if(p.touches.length===2){s.current=!0;const y=p.touches[0],S=p.touches[1],j=Math.hypot(y.clientX-S.clientX,y.clientY-S.clientY);R.current={dist:j}}},F=p=>{if(p.touches.length===2&&R.current){s.current=!0;const y=p.touches[0],S=p.touches[1],j=Math.hypot(y.clientX-S.clientX,y.clientY-S.clientY),$=j/R.current.dist,V=Math.min(Math.max(Nn*$,.1),5);cr(V),R.current={dist:j}}},A=p=>{p.touches.length<2&&(R.current=null,setTimeout(()=>{s.current=!1},100))};B.useEffect(()=>{const p=async()=>{if(!document.fullscreenElement)try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&await document.documentElement.webkitRequestFullscreen()}catch(S){console.log("Fullscreen request blocked/ignored",S)}};p();const y=()=>{p(),window.removeEventListener("touchstart",y),window.removeEventListener("mousedown",y)};return window.addEventListener("touchstart",y),window.addEventListener("mousedown",y),()=>{window.removeEventListener("touchstart",y),window.removeEventListener("mousedown",y)}},[]),B.useEffect(()=>{(async()=>{try{await tk.hide()}catch{console.log("Status bar hide not supported on web")}})()},[]),B.useEffect(()=>{const p=y=>{console.log("S PEN NATIVE:",y);const{clientX:S,clientY:j}=r.current,{x:$,y:V}=O(S,j);Xe({x:S,y:j,gx:$,gy:V})};return window.addEventListener("sPenNativeEvent",p),()=>{window.removeEventListener("sPenNativeEvent",p)}},[]),B.useEffect(()=>{const p=y=>{r.current={clientX:y.clientX,clientY:y.clientY}};return window.addEventListener("mousemove",p),()=>window.removeEventListener("mousemove",p)},[]);const I=()=>{var S;const{clientX:p,clientY:y}=r.current;if(p===0&&y===0)return{x:Et,y:Et};if(t.current&&e.current){const j=t.current.createSVGPoint();j.x=p,j.y=y;const $=j.matrixTransform((S=e.current.getScreenCTM())==null?void 0:S.inverse());return Ar?{x:Math.round($.x/on)*on,y:Math.round($.y/on)*on}:{x:$.x,y:$.y}}return{x:Et,y:Et}},T=(p,y)=>{let S,j;if(p!==void 0&&y!==void 0)S=p,j=y;else{const z=I();S=z.x,j=z.y}const $={id:nt(),x:S,y:j,width:160,height:140,text:"Nuova nota...",color:Ia.Classico[0],fontFamily:Kw[0].value,opacity:1,textColor:XA[0],variant:"classic"},V=[...u,$];h(V),ss(ee,pe,xe,V)},k=B.useRef(null),O=(p,y)=>{var S;if(t.current&&e.current){const j=t.current.createSVGPoint();return j.x=p,j.y=y,j.matrixTransform((S=e.current.getScreenCTM())==null?void 0:S.inverse())}return{x:0,y:0}},[W,b]=B.useState(null),[v,w]=B.useState("dashboard"),[E,P]=B.useState(localStorage.getItem("genopro_custom_user")||""),[D,N]=B.useState(localStorage.getItem("genopro_firebase_config")||""),[Le,St]=B.useState(null);B.useRef(null);const[fe,Xe]=B.useState(null),[Z,de]=B.useState(!1),[ue,Ae]=B.useState("offline"),Te=B.useRef(!1),[Oe,Ft]=B.useState([]),[ht,er]=B.useState(()=>{const p=localStorage.getItem("genopro_categories");return p?JSON.parse(p):qA}),[Nt,Ll]=B.useState("ALL"),[Tr,es]=B.useState("date_desc"),[Ir,Pi]=B.useState(""),[Gs,qs]=B.useState(!1),{auth:Sr,db:pn}=B.useMemo(()=>{try{let p=null;if(D?p=fC(D):typeof window.__firebase_config<"u"&&(p=JSON.parse(window.__firebase_config)),!p||!p.apiKey)return{auth:null,db:null};const y=I2().length?Np():Wx(p);return{auth:OI(y),db:IA(y)}}catch(p){return console.error("Firebase Init Error:",p),{auth:null,db:null}}},[D]),Ol=B.useMemo(()=>Oe.filter(p=>{const y=p.title.toLowerCase().includes(Ir.toLowerCase()),S=Nt==="ALL"||p.category===Nt||Nt==="other"&&!ht.some(j=>j.id===p.category);return y&&S}).sort((p,y)=>Tr==="date_desc"?y.lastModified-p.lastModified:Tr==="date_asc"?p.lastModified-y.lastModified:Tr==="name_asc"?p.title.localeCompare(y.title):0),[Oe,Nt,Tr,Ir,ht]);B.useEffect(()=>{localStorage.setItem("genopro_categories",JSON.stringify(ht))},[ht]),B.useEffect(()=>{localStorage.setItem("genopro_custom_user",E)},[E]),B.useEffect(()=>{localStorage.setItem("genopro_firebase_config",D)},[D]);const ji=typeof window.__app_id<"u"?window.__app_id:"default-app-id",[tr,Ri]=B.useState(null),[Sn,Ho]=B.useState("Nuovo Genogramma"),[ts,Ks]=B.useState("family"),[ee,Je]=B.useState([]),[pe,nr]=B.useState([]),[xe,ns]=B.useState([]),[Qs,rs]=B.useState([]),[rr,Di]=B.useState([]),[Xt,Ys]=B.useState(-1),ss=B.useCallback((p,y,S,j)=>{const $=JSON.stringify({nodes:p,edges:y,groups:S,stickyNotes:j});Di(V=>[...V.slice(0,Xt+1),$]),Ys(V=>V+1)},[Xt]),Ze=p=>{const y=typeof p=="function"?p(ee):p;Je(y),ss(y,pe,xe)},mn=p=>{const y=typeof p=="function"?p(pe):p;nr(y),ss(ee,y,xe)},On=p=>{const y=typeof p=="function"?p(xe):p;ns(y),ss(ee,pe,y)},is=(p,y,S,j)=>{Je(p),nr(y),ns(S),h(j),ss(p,y,S,j)},sr=(p,y,S,j)=>{is(p,y,S,j||u)},Mi=()=>{if(Xt>0){const p=Xt-1,y=JSON.parse(rr[p]);Je(y.nodes),nr(y.edges),ns(y.groups),Ys(p)}},ir=()=>{if(Xt<rr.length-1){const p=Xt+1,y=JSON.parse(rr[p]);Je(y.nodes),nr(y.edges),ns(y.groups),Ys(p)}};B.useEffect(()=>{rr.length===0&&v==="editor"&&ss(ee,pe,xe)},[v]);const[he,$e]=B.useState([]),[Vn,zt]=B.useState([]),[or,Ve]=B.useState([]),[ar,Nr]=B.useState(()=>localStorage.getItem("genopro_theme_id")||"light"),Be=B.useMemo(()=>ws.find(p=>p.id===ar)||ws[0],[ar]),os=Be.type==="dark";B.useEffect(()=>{localStorage.setItem("genopro_theme_id",ar)},[ar]);const[Ar,as]=B.useState(()=>localStorage.getItem("genopro_snap")!=="false"),[Go,gm]=B.useState(()=>localStorage.getItem("genopro_labels")||"age"),[Fn,qo]=B.useState(()=>localStorage.getItem("genopro_legend")==="true");B.useEffect(()=>{localStorage.setItem("genopro_snap",String(Ar))},[Ar]),B.useEffect(()=>{localStorage.setItem("genopro_labels",Go)},[Go]),B.useEffect(()=>{localStorage.setItem("genopro_legend",String(Fn))},[Fn]);const[Ko,Xs]=B.useState(!1),[lr,Qo]=B.useState(!1),[zn,Yo]=B.useState(!1),[Xo,Jo]=B.useState(!1),[Fe,rn]=B.useState(null),[Zo,ad]=B.useState(null),[Cr,sn]=B.useState(null),[Nn,cr]=B.useState(1),[ea,ta]=B.useState(4);B.useEffect(()=>{if(v!=="editor")return;if(!W||!pn||!tr){Ae("offline");return}if(Te.current){Te.current=!1;return}const p=E||W.uid;if(!p){Ae("error");return}Ae("syncing");const S=setTimeout(async()=>{try{const j=Zd(pn,"artifacts",ji,"users",p,"genograms",tr);await Zy(j,{id:tr,title:Sn,category:ts,lastModified:Date.now(),data:{nodes:ee,edges:pe,groups:xe,presets:Qs,stickyNotes:u}},{merge:!0}),Ae("synced")}catch(j){console.error("Errore Salvataggio:",j),Ae("error")}},1500);return()=>clearTimeout(S)},[ee,pe,xe,Sn,ts,Qs,E,W,pn,v,tr]),B.useEffect(()=>{const p=y=>{y.key==="i"&&!["INPUT","TEXTAREA"].includes(y.target.tagName)&&qo(S=>!S)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]),B.useEffect(()=>{const p=V=>{if(V.ctrlKey){V.preventDefault();const H=-V.deltaY*.008;cr(X=>{const q=X+H;return Math.min(3,Math.max(.2,q))})}},y=V=>{V.preventDefault()},S=V=>{V.preventDefault();const H=(V.scale-1)*.05;cr(X=>Math.min(3,Math.max(.2,X+H)))},j=V=>V.preventDefault(),$={passive:!1};return document.addEventListener("wheel",p,$),document.addEventListener("gesturestart",y,$),document.addEventListener("gesturechange",S,$),document.addEventListener("gestureend",j,$),()=>{document.removeEventListener("wheel",p),document.removeEventListener("gesturestart",y),document.removeEventListener("gesturechange",S),document.removeEventListener("gestureend",j)}},[]);const Un=B.useRef(ee);B.useEffect(()=>{Un.current=ee},[ee]);const Js=B.useRef(pe);B.useEffect(()=>{Js.current=pe},[pe]);const na=B.useRef(he);B.useEffect(()=>{na.current=he},[he]);const Zs=B.useRef(xe);B.useEffect(()=>{Zs.current=xe},[xe]);const gn=p=>{if(he.length===0)return;const y=ee.filter(z=>he.includes(z.id)),S=y.reduce((z,H)=>z+H.x,0)/y.length,j=y.reduce((z,H)=>z+H.y,0)/y.length,$=[...y];p==="circle"?$.sort((z,H)=>{const X=Math.atan2(z.y-j,z.x-S),q=Math.atan2(H.y-j,H.x-S);return X-q}):p==="h"?$.sort((z,H)=>z.x-H.x):p==="v"?$.sort((z,H)=>z.y-H.y):p==="diagonal"?$.sort((z,H)=>z.x+z.y-(H.x+H.y)):p==="grid"&&$.sort((z,H)=>Math.abs(z.y-H.y)>40?z.y-H.y:z.x-H.x);let V=150;if(p==="circle"){const z=y.reduce((X,q)=>X+Math.hypot(q.x-S,q.y-j),0)/y.length,H=prompt("Inserisci raggio cerchio (px):",Math.round(z).toString());if(H!==null)V=parseInt(H)||150;else return}Ze(z=>z.map(H=>{if(!he.includes(H.id))return H;const X=$.findIndex(q=>q.id===H.id);if(p==="h")return{...H,y:Math.round(j/20)*20};if(p==="v")return{...H,x:Math.round(S/20)*20};if(p==="circle"){if(y.length<2)return H;const q=2*Math.PI/y.length,J=$[0],ie=Math.atan2(J.y-j,J.x-S)+q*X;return{...H,x:Math.round((S+V*Math.cos(ie))/20)*20,y:Math.round((j+V*Math.sin(ie))/20)*20}}if(p==="grid"){const q=Math.ceil(Math.sqrt(y.length)),J=Math.floor(X/q),ce=X%q,ie=(q-1)*120,te=(Math.ceil(y.length/q)-1)*120,je=S-ie/2,Re=j-te/2;return{...H,x:Math.round((je+ce*120)/20)*20,y:Math.round((Re+J*120)/20)*20}}if(p==="diagonal"){const q=(X-(y.length-1)/2)*80;return{...H,x:Math.round((S+q)/20)*20,y:Math.round((j+q)/20)*20}}return H}))},ra=p=>{const y=ee.filter(q=>he.includes(q.id));if(y.length<2)return;const S=[...y].sort((q,J)=>q.y-J.y),j=[];let $=[S[0]];for(let q=1;q<S.length;q++){const J=S[q],ce=S[q-1];Math.abs(J.y-ce.y)<50?$.push(J):(j.push($),$=[J])}if(j.push($),j.length<2)return alert("Seleziona persone di almeno due generazioni diverse");const V=j[0],z=j[j.length-1];V.sort((q,J)=>q.x-J.x),z.sort((q,J)=>q.x-J.x);const H=40,X=jt+H;Ze(q=>q.map(J=>{if(!he.includes(J.id))return J;if(p==="align-children"&&z.some(ce=>ce.id===J.id)){const ce=V[0].x,ie=V[V.length-1].x+jt,te=(ce+ie)/2,je=z.length*jt+(z.length-1)*H,Re=te-je/2,et=z.findIndex(lt=>lt.id===J.id);return{...J,x:Re+et*X,y:V[0].y+180}}if(p==="align-parents"&&V.some(ce=>ce.id===J.id)){const ce=z[0].x,ie=z[z.length-1].x+jt,te=(ce+ie)/2,je=V.length*jt+(V.length-1)*H,Re=te-je/2,et=V.findIndex(lt=>lt.id===J.id);return{...J,x:Re+et*X}}return J}))};B.useEffect(()=>{const p=y=>{if(!["INPUT","TEXTAREA","SELECT"].includes(y.target.tagName)){if((y.ctrlKey||y.metaKey)&&y.key.toLowerCase()==="a"){y.preventDefault(),$e(Un.current.map(S=>S.id));return}if((y.ctrlKey||y.metaKey)&&y.key.toLowerCase()==="z"){y.preventDefault(),Mi();return}if((y.ctrlKey||y.metaKey)&&y.key.toLowerCase()==="y"){y.preventDefault(),ir();return}if((y.ctrlKey||y.metaKey)&&y.key==="s"){y.preventDefault(),ze();return}if(y.altKey&&he.length>1)switch(y.code){case"KeyH":y.preventDefault(),gn("h");break;case"KeyV":y.preventDefault(),gn("v");break;case"KeyC":y.preventDefault(),gn("circle");break;case"KeyG":y.preventDefault(),gn("grid");break;case"KeyD":y.preventDefault(),gn("diagonal");break}if((y.key==="Backspace"||y.key==="Delete")&&(he.length>0||Vn.length>0||or.length>0)&&confirm("Eliminare gli elementi selezionati?")){let S=Un.current.filter(z=>!he.includes(z.id)),j=Js.current.filter(z=>!he.includes(z.fromId)&&!he.includes(z.toId)&&!Vn.includes(z.id)),$=Zs.current.filter(z=>!or.includes(z.id)),V=u.filter(z=>!m.includes(z.id));sr(S,j,$,V),$e([]),zt([]),Ve([]),g([])}if((y.key==="Esc"||y.key==="Escape")&&($e([]),zt([]),Ve([]),sn(null)),(y.key.toLowerCase()==="m"||y.key.toLowerCase()==="f")&&he.length===0&&!y.altKey&&!y.ctrlKey){const{x:S,y:j}=I();sa(y.key.toLowerCase()==="m"?"M":"F",S,j)}if(y.key.toLowerCase()==="n"&&!y.altKey&&!y.ctrlKey&&T(),he.length===1&&!y.altKey&&!y.ctrlKey){const S=he[0];Un.current.find(j=>j.id===S)&&(y.key.toLowerCase()==="s"&&Bl(),y.key.toLowerCase()==="c"&&Wl(),y.key.toLowerCase()==="p"&&$l())}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(y.key)&&he.length>0){y.preventDefault();const S=y.shiftKey?10:1,j=y.key==="ArrowLeft"?-S:y.key==="ArrowRight"?S:0,$=y.key==="ArrowUp"?-S:y.key==="ArrowDown"?S:0;Ze(V=>V.map(z=>he.includes(z.id)?{...z,x:z.x+j,y:z.y+$}:z))}}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[he,Vn,or,Xt,rr,Nn]);const yn=p=>{let y,S;p.touches&&p.touches.length>0?(y=p.touches[0].clientX,S=p.touches[0].clientY):p.changedTouches&&p.changedTouches.length>0?(y=p.changedTouches[0].clientX,S=p.changedTouches[0].clientY):(y=p.clientX,S=p.clientY);const j=O(y,S);return{x:j.x,y:j.y,cx:y,cy:S}},ld=(p,y,S)=>{const{x:j,y:$}=yn(p);k.current={active:!0,type:y,sourceId:S,startX:j,startY:$,currX:j,currY:$},rn({...k.current}),sn(null)},Vl=p=>{p.stopPropagation(),p.preventDefault();const{x:y,y:S}=yn(p),j={};Un.current.forEach($=>{he.includes($.id)&&(j[$.id]={x:$.x,y:$.y})}),k.current={active:!0,type:"move",sourceId:"selection-group",startX:y,startY:S,currX:y,currY:S,initialNodePositions:j},rn({...k.current})},Fl=(p,y)=>{p.stopPropagation(),p.preventDefault();const{x:S,y:j}=yn(p),$=ee.filter(X=>he.includes(X.id)),V=$.reduce((X,q)=>X+q.x,0)/$.length,z=$.reduce((X,q)=>X+q.y,0)/$.length,H={};$.forEach(X=>H[X.id]={x:X.x,y:X.y}),k.current={active:!0,type:`transform-${y}`,sourceId:"group",startX:S,startY:j,currX:S,currY:j,initialNodePositions:H,centerX:V,centerY:z,startAngle:Math.atan2(j-z,S-V),startDist:Math.hypot(S-V,j-z)},rn({...k.current})},cd=(p,y)=>{const{x:S,y:j}=yn(p),$=Js.current.find(V=>V.id===y);if($){const V=nt(),z=S-jt/2,H=j+50,X={id:V,x:z,y:H,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},q={id:nt(),fromId:$.fromId,toId:V,type:"child-bio",label:"",notes:[]},J={id:nt(),fromId:$.toId,toId:V,type:"child-bio",label:"",notes:[]};sr([...Un.current,X],[...Js.current,q,J],Zs.current),sn({x:p.clientX,y:p.clientY,edgeId:V,mode:"child"})}},Pr=p=>{var X,q;if(p.target.tagName!=="svg")return;if(i.current&&clearTimeout(i.current),p.pointerType==="touch"&&p.isPrimary){const J=p.clientX,ce=p.clientY;i.current=setTimeout(()=>{k.current={active:!1,...k.current},rn(null);const{x:ie,y:te}=O(J,ce);Xe({x:J,y:ce,gx:ie,gy:te})},500)}if(p.isPrimary&&p.preventDefault(),o){c(null);return}fe&&Xe(null),!p.shiftKey&&!zn&&($e([]),zt([]),Ve([]),g([]));const{x:y,y:S,cx:j,cy:$}=yn(p);let V="pan";(p.pointerType==="mouse"||p.pointerType==="pen"||zn)&&(V="box");const z=((X=n.current)==null?void 0:X.scrollLeft)||0,H=((q=n.current)==null?void 0:q.scrollTop)||0;k.current={active:!0,type:V,sourceId:"",startX:y,startY:S,currX:y,currY:S,clientStartX:j,clientStartY:$,initialScrollLeft:z,initialScrollTop:H},rn({...k.current}),sn(null)},$n=(p,y)=>{var V,z;p.stopPropagation(),p.preventDefault();const{x:S,y:j}=yn(p);p.shiftKey||zn?g(H=>H.includes(y)?H.filter(X=>X!==y):[...H,y]):($e([]),zt([]),Ve([]),g([y])),k.current={active:!0,type:"move-note",sourceId:y,startX:S,startY:j,currX:S,currY:j,initialNodePositions:{[y]:{x:((V=u.find(H=>H.id===y))==null?void 0:V.x)||0,y:((z=u.find(H=>H.id===y))==null?void 0:z.y)||0}}},rn({...k.current})},Li=(p,y)=>{if(p.stopPropagation(),p.preventDefault(),o){On(H=>H.map(X=>{if(X.id!==o)return X;const q=X.memberIds.includes(y);return{...X,memberIds:q?X.memberIds.filter(J=>J!==y):[...X.memberIds,y]}}));return}const{x:S,y:j}=yn(p),$=p.shiftKey||zn;let V=he;$?V=he.includes(y)?he.filter(H=>H!==y):[...he,y]:he.includes(y)||(V=[y],zt([]),Ve([]),g([])),$e(V);const z={};Un.current.forEach(H=>{V.includes(H.id)&&(z[H.id]={x:H.x,y:H.y})}),k.current={active:!0,type:"move",sourceId:y,startX:S,startY:j,currX:S,currY:j,initialNodePositions:z},rn({...k.current}),sn(null)},Oi=(p,y)=>{p.stopPropagation(),p.preventDefault();const{x:S,y:j}=yn(p);k.current={active:!0,type:"link",sourceId:y,startX:S,startY:j,currX:S,currY:j},rn({...k.current}),sn(null)},zl=(p,y)=>{y.stopPropagation(),zt([p]),$e([]);const S=pe.find(j=>j.id===p);S&&["marriage","cohabitation","separation","divorce"].includes(S.type)&&$e([S.fromId,S.toId])};B.useEffect(()=>{const p=j=>{if(s.current)return;if(r.current={clientX:j.clientX,clientY:j.clientY},i.current&&k.current&&k.current.active&&Math.hypot(j.clientX-(k.current.clientStartX||0),j.clientY-(k.current.clientStartY||0))>10&&(clearTimeout(i.current),i.current=null),k.current&&k.current.active&&j.buttons===0){y(j);return}if(!k.current||!k.current.active)return;j.preventDefault();const{currX:$,currY:V,startX:z,startY:H,clientStartX:X,clientStartY:q,initialScrollLeft:J,initialScrollTop:ce}=k.current,{x:ie,y:te,cx:je,cy:Re}=yn(j);if(k.current.currX=ie,k.current.currY=te,k.current.type==="pan"&&n.current){const et=je-(X||0),lt=Re-(q||0);n.current.scrollLeft=(J||0)-et,n.current.scrollTop=(ce||0)-lt}else if(k.current.type==="box")rn({...k.current,currX:ie,currY:te});else if(k.current.type==="move"){const et=ie-z,lt=te-H;Je(jr=>jr.map(He=>{var An;if(he.includes(He.id)){const oe=((An=k.current.initialNodePositions)==null?void 0:An[He.id])||{x:He.x,y:He.y};return{...He,x:oe.x+et,y:oe.y+lt}}return He}))}else if(k.current.type==="move-note"){const et=ie-z,lt=te-H;h(jr=>jr.map(He=>{var An;if(m.includes(He.id)){const oe=((An=k.current.initialNodePositions)==null?void 0:An[He.id])||{x:He.x,y:He.y};return{...He,x:oe.x+et,y:oe.y+lt}}return He}))}},y=j=>{if(i.current&&(clearTimeout(i.current),i.current=null),!(!k.current||!k.current.active)){if(k.current.type==="box"){const $=Math.min(k.current.startX,k.current.currX),V=Math.max(k.current.startX,k.current.currX),z=Math.min(k.current.startY,k.current.currY),H=Math.max(k.current.startY,k.current.currY);if(Math.abs(V-$)>5||Math.abs(H-z)>5){const X=[],q=[];Un.current.forEach(J=>{J.x>=$&&J.x<=V&&J.y>=z&&J.y<=H&&X.push(J.id)}),u.forEach(J=>{J.x>=$&&J.x<=V&&J.y>=z&&J.y<=H&&q.push(J.id)}),j.shiftKey?($e(J=>[...new Set([...J,...X])]),g(J=>[...new Set([...J,...q])])):($e(X),g(q),zt([]),Ve([]))}}k.current={active:!1,type:"pan",sourceId:"",startX:0,startY:0,currX:0,currY:0,clientStartX:0,clientStartY:0},rn(null)}},S=()=>{};return window.addEventListener("pointermove",p),window.addEventListener("pointerup",y),window.addEventListener("pointercancel",y),window.addEventListener("resize",S),()=>{window.removeEventListener("pointermove",p),window.removeEventListener("pointerup",y),window.removeEventListener("pointercancel",y),window.removeEventListener("resize",S)}},[he,m,u,zn]),B.useEffect(()=>Sr?((async()=>{const y=window.__initial_auth_token;y?await bT(Sr,y).catch(S=>console.error("Token Auth Error:",S)):await vT(Sr).catch(S=>console.error("Anon Auth Error:",S))})(),IT(Sr,y=>{b(y)})):void 0,[Sr]),B.useEffect(()=>{const p=localStorage.getItem("genopro_local_index"),y=p?JSON.parse(p):[];if(!W||!pn){Ft(y);return}const S=E||W.uid;if(!S){Ft(y);return}try{const j=FA(TA(pn,"artifacts",ji,"users",S,"genograms")),$=HA(j,V=>{const z=[];V.forEach(X=>z.push({id:X.id,...X.data()}));const H=new Map;y.forEach(X=>H.set(X.id,X)),z.forEach(X=>H.set(X.id,X)),Ft(Array.from(H.values()))},V=>{console.error("Dashboard offline, uso cache locale"),Ft(y)});return()=>$()}catch{Ft(y)}},[W,pn,E]),B.useLayoutEffect(()=>{v==="editor"&&n.current&&setTimeout(()=>{n.current&&n.current.scrollTo(Et-n.current.clientWidth/2,Et-n.current.clientHeight/2)},100)},[v]);const ze=async()=>{if(!W||!tr||!pn)return;const p=E||W.uid;await Zy(Zd(pn,"artifacts",ji,"users",p,"genograms",tr),{id:tr,title:Sn,category:ts,lastModified:Date.now(),data:{nodes:ee,edges:pe,groups:xe,presets:Qs}}),alert("Salvato!")},ei=(p,y,S,j=[])=>{Je(p),nr(y),ns(S),h(j),Di([]),Ys(-1),setTimeout(()=>{const $=JSON.stringify({nodes:p,edges:y,groups:S,stickyNotes:j});Di([$]),Ys(0)},0)},ti=()=>{Ri(nt()),Ho("Nuovo Genogramma"),Ks("family"),ei([],[],[]),w("editor")},ls=p=>{const y={id:nt(),x:Et,y:Et,gender:p,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};Ze(S=>[...S,y]),$e([y.id])},sa=(p,y,S)=>{Ar&&(y=Math.round(y/on)*on,S=Math.round(S/on)*on);const j={id:nt(),x:y,y:S,gender:p,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};Ze($=>[...$,j]),$e([j.id])},Ul=()=>{if(he.length===0)return alert("Seleziona nodi");const p={id:nt(),memberIds:[...he],type:"household",label:"Nuovo Gruppo",color:"#000000",notes:[]};On(y=>[...y,p]),Ve([p.id]),$e([])},$l=()=>{if(he.length!==1)return alert("Seleziona una persona");const p=he[0],y=ee.find(H=>H.id===p);if(!y)return;const S=nt(),j=nt(),$={id:S,x:y.x-80,y:y.y-150,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},V={id:j,x:y.x+80,y:y.y-150,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},z=[{id:nt(),fromId:S,toId:j,type:"marriage",label:"",notes:[]},{id:nt(),fromId:S,toId:p,type:"child-bio",label:"",notes:[]},{id:nt(),fromId:j,toId:p,type:"child-bio",label:"",notes:[]}];sr([...ee,$,V],[...pe,...z],xe),$e([S,j])},Bl=()=>{if(he.length!==1)return alert("Seleziona una persona");const p=he[0],y=ee.find(V=>V.id===p);if(!y)return;const S=nt(),j={id:S,x:y.x+120,y:y.y,gender:y.gender==="M"?"F":"M",name:"Partner",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},$={id:nt(),fromId:p,toId:S,type:"marriage",label:"",notes:[]};sr([...ee,j],[...pe,$],xe),$e([S])},Wl=()=>{if(Vn.length===1){const p=pe.find(y=>y.id===Vn[0]);if(p&&mr.Struttura.includes(p.type)){const y=ee.find(H=>H.id===p.fromId),S=ee.find(H=>H.id===p.toId);if(!y||!S)return;const j=nt(),$={id:j,x:(y.x+S.x)/2,y:Math.max(y.y,S.y)+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},V={id:nt(),fromId:p.fromId,toId:j,type:"child-bio",label:"",notes:[]},z={id:nt(),fromId:p.toId,toId:j,type:"child-bio",label:"",notes:[]};sr([...ee,$],[...pe,V,z],xe),$e([j]),zt([]);return}}if(he.length===1){const p=he[0],y=ee.find(z=>z.id===p);if(!y)return;const S=tv(p,pe),j=nt(),$={id:j,x:y.x,y:y.y+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},V=[{id:nt(),fromId:p,toId:j,type:"child-bio",label:"",notes:[]}];if(S){const z=S.fromId===p?S.toId:S.fromId;V.push({id:nt(),fromId:z,toId:j,type:"child-bio",label:"",notes:[]})}sr([...ee,$],[...pe,...V],xe),$e([j])}else alert("Seleziona una coppia o un genitore")},ud=()=>{const p=he.length>0?ee.filter(oe=>he.includes(oe.id)):ee;if(p.length===0)return;const y=JSON.parse(JSON.stringify(ee)),S=new Map(y.map(oe=>[oe.id,oe])),j=180,$=60,V=80,z=100,H=250,X=oe=>pe.filter(Ee=>(Ee.fromId===oe||Ee.toId===oe)&&mr.Struttura.includes(Ee.type)).map(Ee=>Ee.fromId===oe?Ee.toId:Ee.fromId),q=oe=>{const Ee=pe.filter(Jt=>Jt.toId===oe&&Jt.type.startsWith("child"));return[...new Set(Ee.map(Jt=>Jt.fromId))]},J=oe=>{const Ee=pe.filter(At=>oe.includes(At.fromId)&&At.type.startsWith("child"));return[...new Set(Ee.map(At=>At.toId))]},ce=new Map;p.forEach(oe=>ce.set(oe.id,-1));const ie=(oe,Ee=new Set)=>{if(Ee.has(oe))return 0;if(ce.get(oe)!==-1)return ce.get(oe);Ee.add(oe);const Jt=J([oe]),At=X(oe);let Se=-1;const Ge=new Set(Jt);if(At.forEach(vn=>J([vn]).forEach(xn=>Ge.add(xn))),Ge.size>0){const vn=Array.from(Ge).map(xn=>ie(xn,new Set(Ee)));Se=Math.max(...vn)}const tt=Se+1;return ce.set(oe,tt),tt};p.forEach(oe=>ie(oe.id));let te=!0;for(;te;)te=!1,p.forEach(oe=>{const Ee=ce.get(oe.id)||0;X(oe.id).forEach(Jt=>{const At=ce.get(Jt)||0;if(Ee!==At){const Se=Math.max(Ee,At);ce.set(oe.id,Se),ce.set(Jt,Se),te=!0}})});const je=Math.max(...Array.from(ce.values())),Re=new Map;ce.forEach((oe,Ee)=>Re.set(Ee,je-oe)),[...p].sort((oe,Ee)=>Au(oe.birthDate||"")-Au(Ee.birthDate||"")).forEach((oe,Ee)=>{oe.x=Ee*($+20)});for(let oe=0;oe<H;oe++){const Ee=new Map;p.forEach(Se=>{let Ge=0,tt=0;if(q(Se.id).forEach(ft=>{const vt=S.get(ft);vt&&(Ge+=vt.x,tt++)}),J([Se.id]).forEach(ft=>{const vt=S.get(ft);vt&&(Ge+=vt.x,tt++)}),X(Se.id).forEach(ft=>{const vt=S.get(ft);vt&&(Ge+=vt.x,tt++)}),tt>0){const ft=Ge/tt,vt=.5*(1-oe/H);Ee.set(Se.id,(ft-Se.x)*vt)}}),p.forEach(Se=>{Ee.has(Se.id)&&(Se.x+=Ee.get(Se.id))});const Jt=new Set;p.forEach(Se=>{if(Jt.has(Se.id))return;const Ge=X(Se.id);if(Ge.length>0){const tt=[Se.id,...Ge];tt.forEach(ft=>Jt.add(ft)),tt.sort((ft,vt)=>{var oa,aa;const si=(oa=S.get(ft))==null?void 0:oa.gender,ur=(aa=S.get(vt))==null?void 0:aa.gender;return si==="M"&&ur!=="M"?-1:si!=="M"&&ur==="M"?1:0});const vn=tt.reduce((ft,vt)=>ft+S.get(vt).x,0)/tt.length,xn=(tt.length-1)*V;let us=vn-xn/2;tt.forEach((ft,vt)=>{const si=S.get(ft);si.x=us+vt*V})}});const At=new Map;p.forEach(Se=>{const Ge=Re.get(Se.id)||0;At.has(Ge)||At.set(Ge,[]),At.get(Ge).push(Se)}),At.forEach(Se=>{Se.sort((Ge,tt)=>Ge.x-tt.x);for(let Ge=0;Ge<Se.length-1;Ge++){const tt=Se[Ge],vn=Se[Ge+1],xn=vn.x-tt.x;if(xn<z){const us=(z-xn)/2;tt.x-=us,vn.x+=us}}})}const lt=p.map(oe=>oe.x),jr=Math.min(...lt),He=Math.max(...lt),An=Et-(jr+He)/2;p.forEach(oe=>{oe.x=Math.round((oe.x+An)/20)*20;const Ee=Re.get(oe.id)||0;oe.y=Math.round((Et+Ee*j)/20)*20}),Ze(y)},ni=()=>{cr(1),n.current&&n.current.scrollTo({left:Et-n.current.clientWidth/2,top:Et-n.current.clientHeight/2,behavior:"smooth"})},Bn=B.useCallback(()=>{let p=1/0,y=1/0,S=-1/0,j=-1/0;return ee.length===0?{minX:Et-400,minY:Et-300,maxX:Et+400,maxY:Et+300}:(ee.forEach($=>{p=Math.min(p,$.x),y=Math.min(y,$.y),S=Math.max(S,$.x+jt),j=Math.max(j,$.y+gr)}),xe.forEach($=>{const V=Xw($,ee);V&&(p=Math.min(p,V.x),y=Math.min(y,V.y),S=Math.max(S,V.x+V.w),j=Math.max(j,V.y+V.h))}),{minX:p,minY:y,maxX:S,maxY:j})},[ee,xe]),Vi=()=>{let{minX:p,minY:y,maxX:S,maxY:j}=Bn();if(Fn){const z=new Set(ee.map(ce=>ce.gender)).size+(ee.some(ce=>ce.deceased)?1:0)+(ee.some(ce=>ce.indexPerson)?1:0),H=new Set(pe.map(ce=>ce.type)).size,X=80+Math.max(z,H)*24+20,q=p-220-50,J=y;p=Math.min(p,q),y=Math.min(y,J),S=Math.max(S,p+220+(S-p)),j=Math.max(j,J+X)}const $=100;return{x:p-$,y:y-$,w:S-p+$*2,h:j-y+$*2}},ia=async p=>{if(!t.current)return;const y=Vi(),S=ea,j=t.current.cloneNode(!0),$=j.querySelector("g");$&&($.setAttribute("transform",""),$.style.transform=""),j.setAttribute("viewBox",`${y.x} ${y.y} ${y.w} ${y.h}`),j.setAttribute("width",`${y.w*S}`),j.setAttribute("height",`${y.h*S}`),j.style.fontFamily="sans-serif";const V=new XMLSerializer().serializeToString(j),z=document.createElement("canvas"),H=z.getContext("2d"),X=new Image,q=new Blob([V],{type:"image/svg+xml;charset=utf-8"}),J=URL.createObjectURL(q),ce=new Date,ie=`${Sn.replace(/\s+/g,"_")}_${ce.toISOString().slice(0,10)}.${p}`;X.onload=()=>{z.width=y.w*S,z.height=y.h*S,H&&(H.font="12px sans-serif",p==="jpeg"&&(H.fillStyle=os?"#111827":"#ffffff",H.fillRect(0,0,z.width,z.height)),H.drawImage(X,0,0),z.toBlob(async te=>{if(!te)return;if(navigator.canShare&&navigator.share)try{const et=new File([te],ie,{type:`image/${p}`});if(navigator.canShare({files:[et]})){await navigator.share({files:[et],title:Sn,text:"Esportazione Genogramma"}),URL.revokeObjectURL(J);return}}catch(et){console.warn("Share fallito, provo download classico",et)}const je=URL.createObjectURL(te),Re=document.createElement("a");Re.href=je,Re.download=ie,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(je),URL.revokeObjectURL(J)},`image/${p}`,1))},X.src=J},Hl=()=>{const p=window.open("","_blank");if(p&&t.current){const y=Vi(),S=t.current.cloneNode(!0),j=os?"#111827":"#ffffff",$=document.createElementNS("http://www.w3.org/2000/svg","rect");$.setAttribute("x",String(y.x)),$.setAttribute("y",String(y.y)),$.setAttribute("width",String(y.w)),$.setAttribute("height",String(y.h)),$.setAttribute("fill",j),S.firstChild?S.insertBefore($,S.firstChild):S.appendChild($),S.setAttribute("viewBox",`${y.x} ${y.y} ${y.w} ${y.h}`),S.setAttribute("width",`${y.w}px`),S.setAttribute("height",`${y.h}px`);const V=S.querySelector("g");V&&(V.setAttribute("transform",""),V.style.transform=""),S.style.display="block",S.style.overflow="visible";const z=new XMLSerializer().serializeToString(S);p.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${Sn} - Vettoriale</title>
                    <style>
                        @page { 
                            size: ${y.w}px ${y.h}px; 
                            margin: 0; 
                        }
                        body { 
                            margin: 0; 
                            padding: 0; 
                            width: ${y.w}px;
                            height: ${y.h}px;
                            overflow: hidden;
                            background-color: ${j};
                            /* FORZA STAMPA COLORI SFONDO */
                            -webkit-print-color-adjust: exact; 
                            print-color-adjust: exact;
                        }
                        svg { 
                            width: 100%; 
                            height: 100%; 
                            display: block;
                        }
                        /* FIX FONT */
                        text { 
                            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important; 
                        }
                    </style>
                </head>
                <body>
                    ${z}
                </body>
                </html>
            `),p.document.close(),p.onload=()=>{setTimeout(()=>{p.focus(),p.print()},500)}}},cs=(p,y,S,j)=>{const $=p.filter(V=>j.onlyPeopleWithNotes?V.notes&&V.notes.length>0:!0);return $.length===0?'<div style="padding:20px; text-align:center; color:#666;">Nessuna persona corrisponde ai criteri selezionati.</div>':$.map(V=>{const z=y.filter(te=>(te.fromId===V.id||te.toId===V.id)&&mr.Struttura.includes(te.type)).map(te=>{const je=te.fromId===V.id?te.toId:te.fromId,Re=p.find(lt=>lt.id===je),et=Tt[te.type];return Re?`<b>${Re.name}</b> (${et.label})`:null}).filter(Boolean).join(", "),H=y.filter(te=>te.fromId===V.id&&te.type.startsWith("child")).map(te=>{const je=p.find(Re=>Re.id===te.toId);return je?je.name:null}).filter(Boolean).join(", "),X=y.filter(te=>(te.fromId===V.id||te.toId===V.id)&&!mr.Struttura.includes(te.type)&&!te.type.startsWith("child")).map(te=>{const je=te.fromId===V.id?te.toId:te.fromId,Re=p.find(He=>He.id===je),et=Re?null:S.find(He=>He.id===je),lt=Re?Re.name:et?`Gruppo: ${et.label}`:"Sconosciuto";return`<li>${(Tt[te.type]||{label:te.type}).label} con <b>${lt}</b>${te.notes.length?` (Note: ${te.notes.map(He=>He.text).join("; ")})`:""}</li>`}).join(""),q=S.filter(te=>te.memberIds.includes(V.id)).map(te=>te.label).join(", ");let J=[];j.showGender&&J.push(V.gender),j.showBirthDate&&V.birthDate&&J.push(V.birthDate),j.showAge&&V.birthDate&&J.push(`${ml(V.birthDate)} anni`);const ce=J.length>0?`<small style="font-weight:normal; color:#666;">(${J.join(", ")})</small>`:"";let ie=[];return V.deceased&&ie.push("Deceduto"),V.indexPerson&&ie.push("Paziente Designato"),V.substanceAbuse&&ie.push("Abuso Sostanze"),V.mentalIssue&&ie.push("Problema Psicologico"),V.physicalIssue&&ie.push("Problema Fisico"),V.gayLesbian&&ie.push("Omosessuale"),`
            <div class="person-card">
                <h3>${V.name} ${ce}</h3>
                
                ${j.showClinical&&ie.length>0?`<p class="clinical-tags"><strong>Clinica:</strong> ${ie.join(", ")}</p>`:""}

                ${j.showGroups&&q?`<p><strong>Gruppi:</strong> ${q}</p>`:""}
                
                ${j.showFamily&&(z||H)?`
                    <div style="margin-top:10px; padding-top:10px; border-top:1px solid #eee;">
                        ${z?`<p><strong>Partner:</strong> ${z}</p>`:""}
                        ${H?`<p><strong>Figli:</strong> ${H}</p>`:""}
                    </div>
                `:""}

                ${j.showRelations&&X?`<p><strong>Altre Relazioni:</strong></p><ul>${X}</ul>`:""}
                
                ${j.showNotes&&V.notes.length>0?`<div class="notes-section"><strong>Diario Clinico:</strong><ul>${V.notes.map(te=>`<li><span class="note-date">${te.date}</span>: ${te.text}</li>`).join("")}</ul></div>`:""}
            </div>
          `}).join("")},dd=p=>{const y=window.open("","_blank");if(y&&t.current){const S=Vi(),j=t.current.cloneNode(!0),$=j.querySelector("g");$&&($.setAttribute("transform",""),$.style.transform=""),j.setAttribute("viewBox",`${S.x} ${S.y} ${S.w} ${S.h}`),j.setAttribute("width","100%"),j.setAttribute("height","50vh");const V=new XMLSerializer().serializeToString(j),z=cs(ee,pe,xe,p),H=Array.from(new Set(pe.map(ie=>ie.type))),X=Array.from(new Set(ee.map(ie=>ie.gender))),q=ie=>{const te=Tt[ie]||Tt.custom;return te?`<svg width="30" height="10" style="vertical-align:middle; margin-right:5px"><line x1="0" y1="5" x2="30" y2="5" stroke="${te.color||"#000"}" stroke-width="2" stroke-dasharray="${te.lineStyle==="dashed"?"4,2":te.lineStyle==="dotted"?"1,3":""}"/></svg>`:""},J=ie=>`<svg width="16" height="16" style="vertical-align:middle; margin-right:5px">${ie==="M"?'<rect x="2" y="2" width="12" height="12" stroke="black" fill="white"/>':'<circle cx="8" cy="8" r="6" stroke="black" fill="white"/>'}</svg>`,ce=`
              <div style="margin-top: 20px; border: 1px solid #eee; padding: 10px; border-radius: 8px; background: #fcfcfc; page-break-inside: avoid; font-size: 0.8em;">
                  <h4 style="margin:0 0 10px 0;">Legenda Rapida</h4>
                  <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                      <div>${X.map(ie=>`<span style="margin-right:10px">${J(ie)} ${ie}</span>`).join("")}</div>
                      <div>${H.map(ie=>{var te;return`<span style="margin-right:10px">${q(ie)} ${((te=Tt[ie])==null?void 0:te.label)||ie}</span>`}).join("")}</div>
                  </div>
              </div>
          `;y.document.write(`
              <html>
              <head>
                  <title>${Sn} - Report</title>
                  <style>
                      body { font-family: 'Segoe UI', sans-serif; padding: 40px; color: #333; max-width: 1000px; margin: 0 auto; background: white; }
                      h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; color: #111; }
                      .diagram-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; margin-bottom: 30px; text-align: center; background: white; }
                      .person-card { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3b82f6; page-break-inside: avoid; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
                      .person-card h3 { margin: 0 0 5px 0; font-size: 1.1em; color: #1e293b; }
                      .clinical-tags { font-size: 0.85em; color: #e11d48; margin-bottom: 5px; }
                      .notes-section { margin-top: 8px; padding-top: 8px; border-top: 1px dashed #cbd5e1; font-size: 0.9em; background: #fffbeb; padding: 10px; border-radius: 4px; }
                      .note-date { font-weight: bold; color: #b45309; }
                      ul { margin: 5px 0 0 20px; padding: 0; }
                      @media print { body { padding: 0; } }
                  </style>
              </head>
              <body>
                  <h1>${Sn}</h1>
                  <p style="color:#666; font-size:0.9em">Generato il ${new Date().toLocaleDateString()}</p>
                  
                  <div class="diagram-container">
                      ${V}
                  </div>
                  ${ce}
                  
                  <h2 style="margin-top:30px; border-bottom:1px solid #eee;">Dettaglio Clinico</h2>
                  ${z}
              </body>
              </html>
          `),y.document.close(),setTimeout(()=>{y.focus(),y.print()},500)}},hd=p=>{var j;const y=(j=p.target.files)==null?void 0:j[0];if(!y)return;const S=new FileReader;S.onload=$=>{var V;try{const z=JSON.parse((V=$.target)==null?void 0:V.result);Array.isArray(z)&&(Ft(H=>[...H,...z]),alert("Importazione completata!"))}catch{alert("Errore file")}},S.readAsText(y)},fd=()=>{const p=new Blob([JSON.stringify(Oe)],{type:"application/json"}),y=URL.createObjectURL(p),S=document.createElement("a");S.href=y,S.download="backup_genopro.json",S.click()},Ie=he.length===1?ee.find(p=>p.id===he[0]):null,at=pe.find(p=>p.id===Vn[0]),yt=xe.find(p=>p.id===or[0]);return v==="dashboard"?a.jsxs("div",{className:"h-screen flex flex-col transition-colors duration-300",style:{backgroundColor:Be.colors.bgMain,color:Be.colors.text,"--theme-bg-main":Be.colors.bgMain,"--theme-bg-panel":Be.colors.bgPanel,"--theme-border":Be.colors.border,"--theme-text":Be.colors.text,"--theme-text-muted":Be.colors.textMuted,"--theme-accent":Be.colors.accent},children:[a.jsx("style",{children:`
                .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
                .theme-border { border-color: var(--theme-border); }
                .theme-text { color: var(--theme-text); }
                .theme-text-muted { color: var(--theme-text-muted); }
                .theme-hover:hover { background-color: rgba(127,127,127, 0.1); }
              `}),Z&&a.jsx(dC,{onClose:()=>de(!1),firebaseConfig:D}),Ko&&a.jsx(uC,{onClose:()=>Xs(!1),onExport:fd,onImport:hd,setCustomUser:P,customUser:E,setFirebaseConfig:N,firebaseConfig:D}),a.jsxs("div",{className:"flex h-full",children:[a.jsxs("div",{className:"w-64 border-r p-4 flex flex-col gap-4 theme-panel theme-border",children:[a.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl mb-2",style:{color:"var(--theme-accent)"},children:[a.jsx(Sb,{})," GenoPro"]}),a.jsxs("button",{onClick:ti,className:"text-white px-4 py-2 rounded flex items-center justify-center gap-2 font-medium transition-colors shadow-sm hover:opacity-90",style:{backgroundColor:"var(--theme-accent)"},children:[a.jsx(wl,{size:18})," Nuovo"]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-xs font-bold uppercase opacity-50 mb-2 mt-4 px-2 theme-text",children:"Categorie"}),a.jsxs("button",{onClick:()=>Ll("ALL"),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${Nt==="ALL"?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,style:Nt==="ALL"?{color:"var(--theme-accent)"}:{},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Yh,{size:16})," Tutti"]}),a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:Oe.length})]}),ht.map(p=>{const y=ev[p.iconKey]||Zh,S=Oe.filter($=>$.category===p.id).length,j=Nt===p.id;return a.jsxs("button",{onClick:()=>Ll(p.id),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${j?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,children:[a.jsxs("span",{className:"flex items-center gap-2",style:{color:j?void 0:p.color},children:[a.jsx(y,{size:16,color:p.color})," ",p.label]}),S>0&&a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:S})]},p.id)})]}),a.jsxs("div",{className:"mt-auto border-t theme-border pt-4 space-y-2",children:[a.jsx(ov,{currentThemeId:ar,onChange:Nr,placement:"top"}),a.jsxs("button",{onClick:()=>de(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(wp,{size:16})," Istruzioni"]}),a.jsxs("button",{onClick:()=>Xs(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(Rx,{size:16})," Impostazioni"]})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{backgroundColor:Be.colors.bgMain},children:[a.jsx("div",{className:"h-16 border-b flex items-center justify-between px-8 theme-panel theme-border",children:a.jsxs("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(hu,{className:"absolute left-3 top-1/2 -translate-y-1/2 opacity-50",size:18}),a.jsx("input",{className:"w-full pl-10 pr-4 py-2 rounded-lg border theme-border bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 theme-text placeholder-opacity-50 placeholder-current",placeholder:"Cerca genogramma...",value:Ir,onChange:p=>Pi(p.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2 border-l pl-4 theme-border",children:[a.jsx("span",{className:"text-xs uppercase font-bold opacity-50 theme-text",children:"Ordina"}),a.jsx("button",{onClick:()=>es("date_desc"),className:`p-1.5 rounded ${Tr==="date_desc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Recenti",children:a.jsx(Cg,{className:"rotate-180",size:18})}),a.jsx("button",{onClick:()=>es("date_asc"),className:`p-1.5 rounded ${Tr==="date_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Vecchi",children:a.jsx(Cg,{size:18})}),a.jsx("button",{onClick:()=>es("name_asc"),className:`p-1.5 rounded ${Tr==="name_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Alfabetico",children:a.jsx(jb,{size:18})})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[Ol.map(p=>{var j;const y=ht.find($=>$.id===p.category)||ht[ht.length-1],S=ev[y.iconKey]||Zh;return a.jsxs("div",{onClick:()=>{Ri(p.id),Ho(p.title),Ks(p.category),rs(p.data.presets||[]),ei(p.data.nodes||[],p.data.edges||[],p.data.groups||[],p.data.stickyNotes||[]),w("editor")},className:"group relative theme-panel rounded-xl shadow-sm hover:shadow-md transition-all border theme-border cursor-pointer overflow-hidden flex flex-col h-48",children:[a.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:y.color}}),a.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider",style:{color:y.color},children:[a.jsx(S,{size:12})," ",y.label]}),a.jsx("button",{onClick:$=>{$.stopPropagation(),confirm("Eliminare?")&&pn&&WA(Zd(pn,"artifacts",ji,"users",E||(W==null?void 0:W.uid)||"anon","genograms",p.id))},className:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(wa,{size:16})})]}),a.jsx("h3",{className:"text-lg font-bold mb-1 line-clamp-2 theme-text",children:p.title}),a.jsxs("div",{className:"mt-auto pt-4 flex items-center justify-between text-xs opacity-60 border-t theme-border",children:[a.jsx("span",{children:new Date(p.lastModified).toLocaleDateString()}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(ko,{size:12})," ",((j=p.data.nodes)==null?void 0:j.length)||0]})]})]})]},p.id)}),Ol.length===0&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 opacity-40 border-2 border-dashed theme-border rounded-xl",children:[a.jsx(hu,{size:48,className:"mb-4"}),a.jsx("p",{children:"Nessun genogramma trovato"}),Ir&&a.jsx("button",{onClick:()=>Pi(""),className:"hover:underline mt-2 text-sm",style:{color:"var(--theme-accent)"},children:"Pulisci ricerca"})]})]})})]})]})]}):a.jsxs("div",{className:"h-screen flex flex-col overflow-hidden transition-colors duration-300 relative",style:{backgroundColor:Be.colors.bgMain,color:Be.colors.text,"--theme-bg-main":Be.colors.bgMain,"--theme-bg-panel":Be.colors.bgPanel,"--theme-border":Be.colors.border,"--theme-text":Be.colors.text,"--theme-text-muted":Be.colors.textMuted,"--theme-accent":Be.colors.accent,touchAction:"none"},children:[a.jsx("style",{children:`
         .no-scrollbar::-webkit-scrollbar { display: none; }
         .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
         
         /* Classi di utilit per i temi */
         .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
         .theme-border { border-color: var(--theme-border); }
         .theme-text { color: var(--theme-text); }
         .theme-text-muted { color: var(--theme-text-muted); }
         .theme-hover:hover { background-color: rgba(128,128,128, 0.1); }
       `}),Xo&&a.jsx(hC,{onClose:()=>Jo(!1),onSave:p=>rs(y=>[...y,p])}),lr&&a.jsx(cC,{onClose:()=>Qo(!1),nodes:ee,edges:pe,groups:xe}),_&&a.jsx(yC,{onClose:()=>C(!1),onConfirm:p=>{C(!1),dd(p)}}),Cr&&a.jsx(oC,{x:Cr.x,y:Cr.y,mode:Cr.mode,customPresets:Qs,onClose:()=>sn(null),onSelect:p=>{mn(y=>y.map(S=>S.id===Cr.edgeId?{...S,type:p}:S)),sn(null)}}),Gs&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>qs(!1)}),a.jsxs("div",{className:"h-14 border-b flex items-center px-2 md:px-4 justify-between shrink-0 gap-2 relative z-50 overflow-visible theme-panel border-b theme-border",children:[a.jsxs("div",{className:"flex gap-2 md:gap-3 items-center shrink-0",children:[a.jsx("button",{onClick:()=>w("dashboard"),className:"p-2 theme-hover rounded",children:a.jsx(Yh,{size:20})}),a.jsxs("div",{className:"flex flex-col ml-1",children:[a.jsx("input",{value:Sn,onChange:p=>Ho(p.target.value),className:"bg-transparent font-bold text-sm w-24 md:w-40 outline-none theme-text truncate",placeholder:"Titolo"}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>qs(!Gs),className:"flex items-center gap-1 text-[10px] uppercase font-bold theme-text-muted hover:text-[var(--theme-accent)]",children:[(ri=ht.find(p=>p.id===ts))==null?void 0:ri.label," ",a.jsx(kx,{size:10})]}),Gs&&a.jsx("div",{className:"absolute top-full left-0 mt-1 shadow-lg rounded-lg p-1 w-40 z-50 theme-panel border theme-border",children:ht.map(p=>a.jsxs("button",{onClick:()=>{Ks(p.id),qs(!1)},className:"w-full text-left px-2 py-1.5 text-xs rounded theme-hover flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:p.color}})," ",p.label]},p.id))})]})]}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"})]}),a.jsx("div",{className:"flex-1 min-w-0 flex justify-start md:justify-center px-2",children:a.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar w-full md:w-auto md:max-w-full",children:[a.jsx("button",{onClick:()=>ls("M"),title:"Nuovo Maschio (M)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(Xh,{style:{color:"var(--theme-accent)"},size:20})}),a.jsx("button",{onClick:()=>ls("F"),title:"Nuova Femmina (F)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(Qh,{className:"text-pink-600",size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:$l,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Genitori",children:a.jsx(Mx,{size:18})}),a.jsx("button",{onClick:Bl,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Partner",children:a.jsx(bo,{size:18})}),a.jsx("button",{onClick:Wl,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Figlio",children:a.jsx(Sx,{size:18})}),a.jsx("button",{onClick:Ul,title:"Gruppo",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(ko,{size:20})}),a.jsx("button",{onClick:T,title:"Aggiungi Nota (N)",className:"p-1.5 theme-hover rounded shrink-0",style:{color:"#f59e0b"},children:a.jsx(Jh,{size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:ud,className:"p-1.5 theme-hover rounded shrink-0",style:{color:"var(--theme-accent)"},title:"Auto-Layout",children:a.jsx(jx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>gn("h"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Orizzontale",children:a.jsx(cu,{size:18})}),a.jsx("button",{onClick:()=>gn("v"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Verticale",children:a.jsx(cu,{className:"rotate-90",size:18})}),a.jsx("button",{onClick:()=>ra("align-children"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Figli",children:a.jsx(wx,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("button",{onClick:()=>ra("align-parents"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Genitori",children:a.jsx(Ex,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>gn("circle"),className:"p-1.5 theme-hover rounded shrink-0",title:"Cerchio",children:a.jsx(Tx,{size:18})}),a.jsx("button",{onClick:()=>gn("grid"),className:"p-1.5 theme-hover rounded shrink-0",title:"Griglia",children:a.jsx(Nx,{size:18})}),a.jsx("button",{onClick:()=>gn("diagonal"),className:"p-1.5 theme-hover rounded shrink-0",title:"Diagonale",children:a.jsx(Dx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>as(!Ar),className:`p-1.5 rounded shrink-0 ${Ar?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Snap Griglia",children:a.jsx(Ax,{size:18})}),a.jsx("button",{onClick:()=>Yo(!zn),className:`p-1.5 rounded shrink-0 ${zn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mod. Selezione",children:a.jsx(Px,{size:18})}),a.jsx("button",{onClick:()=>Jo(!0),className:"p-1.5 theme-hover rounded shrink-0",title:"Stili",children:a.jsx(du,{size:18})}),a.jsx("button",{onClick:()=>qo(!Fn),className:`p-1.5 rounded shrink-0 ${Fn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mostra Legenda",children:a.jsx(uu,{size:18})})]})}),a.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[a.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm mr-2 theme-border theme-panel",title:"Stato Sync",children:[ue==="synced"&&a.jsx(Ix,{className:"text-green-500",size:16}),ue==="syncing"&&a.jsx(Ob,{className:"text-orange-500 animate-spin",size:16}),ue==="error"&&a.jsx(Pg,{className:"text-red-500",size:16}),ue==="offline"&&a.jsx(Pg,{className:"opacity-50",size:16}),a.jsx("span",{className:`text-[10px] font-bold uppercase ${ue==="synced"?"text-green-600":"opacity-50"}`,children:ue==="synced"?"SYNC":ue==="syncing"?"SAVING":"OFFLINE"})]}),a.jsx("button",{onClick:Mi,disabled:Xt<=0,className:`p-1.5 rounded ${Xt<=0?"opacity-30":"theme-hover"}`,title:"Annulla",children:a.jsx(Vb,{size:18})}),a.jsx("button",{onClick:ir,disabled:Xt>=rr.length-1,className:`p-1.5 rounded ${Xt>=rr.length-1?"opacity-30":"theme-hover"}`,title:"Ripristina",children:a.jsx(Fb,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"}),a.jsx("button",{onClick:ni,className:"p-1.5 theme-hover rounded hidden md:block",title:"Ricentra",children:a.jsx(zb,{size:18})}),a.jsx("button",{onClick:()=>cr(p=>Math.max(.2,p-.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(Wb,{size:18})}),a.jsxs("span",{className:"text-xs w-8 text-center hidden md:block",children:[Math.round(Nn*100),"%"]}),a.jsx("button",{onClick:()=>cr(p=>Math.min(3,p+.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(Bb,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1"}),a.jsxs("div",{className:"w-10 md:w-32",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(ov,{currentThemeId:ar,onChange:Nr,placement:"bottom"})}),a.jsx("div",{className:"md:hidden",children:a.jsx("button",{onClick:()=>{const p=ws.findIndex(S=>S.id===ar),y=ws[(p+1)%ws.length];Nr(y.id)},className:"p-1.5 theme-hover rounded",children:Be.type==="dark"?a.jsx(Cx,{size:18}):a.jsx(Ep,{size:18})})})]}),a.jsx("button",{onClick:()=>Qo(!0),className:"p-1.5 theme-hover rounded hidden sm:block",style:{color:"var(--theme-accent)"},title:"Report",children:a.jsx(uo,{size:20})}),a.jsxs("div",{className:"relative group z-50",children:[a.jsx("button",{className:"p-1.5 theme-hover rounded font-bold",style:{color:"var(--theme-accent)"},title:"Esporta",children:a.jsx(_p,{size:20})}),a.jsxs("div",{className:"absolute right-0 top-full theme-panel border theme-border shadow-lg rounded p-3 hidden group-hover:block w-64 z-[70]",children:[a.jsxs("div",{className:"mb-3 pb-3 border-b theme-border",children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-2",children:"Qualit Immagine"}),a.jsxs("div",{className:"flex bg-black/5 dark:bg-white/5 rounded p-1 gap-1 items-center",children:[[1,2,4,6].map(p=>a.jsxs("button",{onClick:y=>{y.stopPropagation(),ta(p)},className:`flex-1 text-[10px] py-1.5 rounded transition-all font-medium ${ea===p?"theme-panel shadow text-[var(--theme-accent)]":"opacity-50"}`,children:[p,"x"]},p)),a.jsx("div",{className:"w-px h-4 bg-gray-300 opacity-30 mx-0.5"}),a.jsx("div",{className:"relative group/input",children:a.jsx("input",{type:"number",min:"1",max:"12",value:ea,onClick:p=>p.stopPropagation(),onChange:p=>{const y=parseInt(p.target.value);isNaN(y)||ta(Math.max(1,Math.min(12,y)))},className:"w-10 text-[10px] py-1 rounded border-none bg-transparent text-center outline-none font-bold text-[var(--theme-accent)]",placeholder:"#"})})]})]}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Immagini"}),a.jsxs("button",{onClick:()=>ia("png"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Lb,{size:14})," Scarica PNG"]}),a.jsxs("button",{onClick:()=>ia("jpeg"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Pb,{size:14})," Scarica JPEG"]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-600 my-2 opacity-30"}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Documenti"}),a.jsxs("button",{onClick:Hl,className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(uo,{size:14})," PDF Vettoriale (Solo Grafico)"]}),a.jsxs("button",{onClick:()=>C(!0),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(uo,{size:14})," Report Clinico (Completo)"]})]})]})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden relative print:overflow-visible",children:[a.jsx("div",{ref:n,className:"flex-1 overflow-auto relative",style:{touchAction:"none"},children:a.jsxs("div",{style:{width:Sa,height:Sa},className:"relative print:w-full print:h-full",children:[a.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none print:hidden",style:{backgroundImage:"radial-gradient(currentColor 1px, transparent 1px)",backgroundSize:`${on}px ${on}px`,color:"var(--theme-text-muted)"}}),a.jsx("svg",{ref:t,width:Sa,height:Sa,className:"block touch-none",style:{touchAction:"none"},onContextMenu:p=>{p.preventDefault(),p.stopPropagation()},onPointerDown:Pr,onTouchStart:M,onTouchMove:F,onTouchEnd:A,children:a.jsxs("g",{ref:e,transform:`scale(${Nn})`,style:{transformOrigin:`${Et}px ${Et}px`},children:[xe.map(p=>{const y=yc(p,ee);if(!y)return null;const{d:S,cx:j,cy:$}=y,V=or.includes(p.id),z=p.color==="#000000"&&os?"#ffffff":p.color,H=p.labelPos?p.labelPos.x:j,X=p.labelPos?p.labelPos.y:Math.min(...y.expandedPoints.map(q=>q.y))-20;return a.jsxs("g",{onClick:q=>{q.stopPropagation(),Ve([p.id]),$e([])},children:[a.jsx("path",{d:S,fill:z,fillOpacity:.05,stroke:z,strokeDasharray:"10,5",strokeWidth:V?3:2,strokeLinejoin:"round",className:V?"stroke-blue-500 cursor-move":"cursor-pointer",onMouseDown:q=>{q.stopPropagation(),Ve([p.id]),$e([])}}),p.showLabel!==!1&&a.jsxs("g",{transform:`translate(${H}, ${X})`,className:"cursor-move",onMouseDown:q=>{q.stopPropagation(),q.preventDefault();const{x:J,y:ce}=yn(q);k.current={active:!0,type:"group-label",sourceId:p.id,startX:J,startY:ce,currX:J,currY:ce,initialNodePositions:{[p.id]:{x:H,y:X}}},rn({...k.current})},children:[a.jsx("rect",{x:-(p.label.length*4)-10,y:"-12",width:p.label.length*8+20,height:"24",fill:Be.colors.bgPanel,fillOpacity:"0.8",rx:"4",stroke:V?"blue":"transparent"}),a.jsx("text",{textAnchor:"middle",dy:"5",fill:z,className:"text-xs font-bold uppercase select-none pointer-events-none",children:p.label})]})]},p.id)}),pe.map(p=>{let y=nv(p.fromId,ee,xe),S=nv(p.toId,ee,xe);if(!y||!S)return null;const j=xe.find(q=>q.id===p.toId);if(j){const q=yc(j,ee);q&&(p.toAnchor!==void 0?S=iv(q.controlPoints,p.toAnchor):S=sv(q.expandedPoints,y))}const $=xe.find(q=>q.id===p.fromId);if($){const q=yc($,ee);q&&(p.fromAnchor!==void 0?y=iv(q.controlPoints,p.fromAnchor):y=sv(q.expandedPoints,S))}const V=ee.find(q=>q.id===p.fromId),z=ee.find(q=>q.id===p.toId),H=p.type.startsWith("twin");if((p.type.startsWith("child")||H)&&V&&z){const q=tv(p.fromId,pe);if(q){const J=ee.find(ie=>ie.id===q.fromId),ce=ee.find(ie=>ie.id===q.toId);J&&ce&&(y={x:(J.x+ce.x+jt)/2,y:Math.max(J.y,ce.y)+JA})}else y={x:V.x+jt/2,y:V.y+gr}}const X=Qs.find(q=>q.id===p.type);return a.jsx("g",{onClick:q=>{q.stopPropagation(),zl(p.id,q)},children:a.jsx(sC,{edge:p,start:y,end:S,isSelected:Vn.includes(p.id),darkMode:os,customConfig:X,onAddChild:(q,J)=>cd(q,J)})},p.id)}),Fe&&Fe.type!=="move"&&Fe.type!=="box"&&Fe.type!=="pan"&&a.jsx("line",{x1:Fe.startX,y1:Fe.startY,x2:Fe.currX,y2:Fe.currY,stroke:"gray",strokeDasharray:"5,5"}),Fe&&Fe.type==="move"&&he.map(p=>{var H,X;if(!ee.find(q=>q.id===p))return null;const S=(X=(H=k.current)==null?void 0:H.initialNodePositions)==null?void 0:X[p];if(!S)return null;const j=Fe.currX-Fe.startX,$=Fe.currY-Fe.startY;let V=S.x+j,z=S.y+$;return Ar&&(V=Math.round(V/on)*on,z=Math.round(z/on)*on),a.jsx("rect",{x:V,y:z,width:jt,height:gr,fill:"none",stroke:"gray",strokeDasharray:"2,2"},p)}),ee.map(p=>{var S;const y=o?(S=xe.find(j=>j.id===o))==null?void 0:S.memberIds.includes(p.id):!1;return a.jsxs("g",{onPointerDown:j=>Li(j,p.id),style:{touchAction:"none"},children:[o&&a.jsx("circle",{cx:p.x+jt/2,cy:p.y+gr/2,r:jt,fill:"none",stroke:y?"#22c55e":"transparent",strokeWidth:3,strokeDasharray:y?"":"4,2",className:"pointer-events-none transition-all duration-300",opacity:y?1:.3}),a.jsx(iC,{node:p,isSelected:he.includes(p.id),showLabelType:Go,darkMode:os,onHandleDown:ld,selectionMode:zn,onRename:(j,$)=>Ze(V=>V.map(z=>z.id===j?{...z,name:$}:z))})]},p.id)}),(()=>{if(!Fn)return null;const p=Bn();return a.jsx(nC,{x:p.minX-270,y:p.minY,darkMode:os,nodes:ee,edges:pe})})(),Fe&&Fe.type==="box"&&a.jsx("rect",{x:Math.min(Fe.startX,Fe.currX),y:Math.min(Fe.startY,Fe.currY),width:Math.abs(Fe.currX-Fe.startX),height:Math.abs(Fe.currY-Fe.startY),fill:"rgba(0,0,255,0.1)",stroke:"blue"}),xe.map(p=>{if(!or.includes(p.id))return null;const y=yc(p,ee);if(!y)return null;const{cx:S,cy:j}=y,$=p.customPadding||50;return a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${S-$-20}, ${j})`,className:"cursor-crosshair",onMouseDown:V=>{V.stopPropagation(),V.preventDefault(),Oi(V,p.id)},children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx(bp,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Crea Relazione"})]}),a.jsxs("g",{transform:`translate(${S}, ${j+$+10})`,className:"cursor-ns-resize",onMouseDown:V=>{V.stopPropagation(),V.preventDefault();const{x:z,y:H}=yn(V);k.current={active:!0,type:"group-padding",sourceId:p.id,startX:z,startY:H,currX:z,currY:H,initialPadding:$},rn({...k.current})},children:[a.jsx("path",{d:"M0 -8 L8 0 L0 8 L-8 0 Z",fill:"#8b5cf6",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx("title",{children:"Regola Grandezza"})]})]},`handles-${p.id}`)}),u.map(p=>a.jsx(gC,{note:p,isSelected:m.includes(p.id),onPointerDown:y=>$n(y,p.id),onUpdate:y=>{h(S=>S.map(j=>j.id===y.id?y:j))}},p.id)),a.jsx(pC,{nodes:ee,selectedIds:he,onHandleDown:Fl,onMove:Vl})]})})]})}),(he.length>0||Vn.length>0||or.length>0||m.length>0)&&a.jsxs("div",{className:"w-80 border-l p-4 overflow-y-auto theme-panel theme-border print:hidden flex flex-col h-full shadow-xl z-50",children:[a.jsxs("h3",{className:"font-bold mb-4 flex justify-between items-center shrink-0",children:["Propriet",a.jsx("button",{onClick:()=>{$e([]),zt([]),Ve([]),g([])},className:"p-1 hover:bg-red-100 hover:text-red-600 rounded transition-colors",children:a.jsx(Fs,{size:18})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-6",children:[Ie&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border font-bold",value:Ie.name,onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,name:p.target.value}:y)),placeholder:"Nome"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ie.label||"",onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,label:p.target.value}:y)),placeholder:"Etichetta (es. Padre)"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ie.birthDate,onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,birthDate:p.target.value}:y)),placeholder:"Nascita (es 1980)"}),a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("input",{type:"checkbox",id:"showAge",checked:Ie.showAge!==!1,onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,showAge:p.target.checked}:y))}),a.jsx("label",{htmlFor:"showAge",className:"text-xs opacity-70",children:"Mostra Et"})]}),a.jsxs("div",{className:"text-xs opacity-50",children:["Et: ",ml(Ie.birthDate)]}),a.jsxs("select",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ie.gender,onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,gender:p.target.value}:y)),children:[a.jsx("option",{value:"M",className:"text-black",children:"Maschio"}),a.jsx("option",{value:"F",className:"text-black",children:"Femmina"}),a.jsx("option",{value:"TransWoman",className:"text-black",children:"Donna Trans (MTF)"}),a.jsx("option",{value:"TransMan",className:"text-black",children:"Uomo Trans (FTM)"}),a.jsx("option",{value:"NonBinary",className:"text-black",children:"Non-Binary/Genderqueer"}),a.jsx("option",{value:"Pet",className:"text-black",children:"Animale"}),a.jsx("option",{value:"Pregnancy",className:"text-black",children:"Gravidanza"}),a.jsx("option",{value:"Miscarriage",className:"text-black",children:"Aborto Spontaneo"}),a.jsx("option",{value:"Abortion",className:"text-black",children:"Aborto Volontario"}),a.jsx("option",{value:"Stillbirth",className:"text-black",children:"Morto alla nascita"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ie.deceased?"bg-black text-white dark:bg-white dark:text-black":"theme-border hover:bg-black/5"}`,onClick:()=>Ze(ee.map(p=>p.id===Ie.id?{...p,deceased:!p.deceased}:p)),children:"Deceduto"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ie.indexPerson?"bg-blue-600 text-white":"theme-border hover:bg-blue-50"}`,onClick:()=>Ze(ee.map(p=>p.id===Ie.id?{...p,indexPerson:!p.indexPerson}:p)),children:"Pz. Designato"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ie.substanceAbuse?"bg-orange-500 text-white":"theme-border hover:bg-orange-50"}`,onClick:()=>Ze(ee.map(p=>p.id===Ie.id?{...p,substanceAbuse:!p.substanceAbuse}:p)),children:"Abuso Sost."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ie.mentalIssue?"bg-purple-500 text-white":"theme-border hover:bg-purple-50"}`,onClick:()=>Ze(ee.map(p=>p.id===Ie.id?{...p,mentalIssue:!p.mentalIssue}:p)),children:"Problema Psi."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ie.gayLesbian?"bg-pink-500 text-white":"theme-border hover:bg-pink-50"}`,onClick:()=>Ze(ee.map(p=>p.id===Ie.id?{...p,gayLesbian:!p.gayLesbian}:p)),children:"Omosessuale"})]}),a.jsx(th,{notes:Ie.notes,onChange:p=>Ze(ee.map(y=>y.id===Ie.id?{...y,notes:p}:y))}),a.jsxs("button",{onClick:()=>{Ze(ee.filter(p=>!he.includes(p.id))),mn(pe.filter(p=>!he.includes(p.fromId)&&!he.includes(p.toId))),$e([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(wa,{size:14})," Elimina Persona"]})]}),at&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[xe.some(p=>p.id===at.fromId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Partenza"}),a.jsxs("span",{children:[Math.round((at.fromAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(at.fromAnchor??-1)===-1?0:at.fromAnchor*100,onChange:p=>{const y=parseInt(p.target.value)/100;mn(S=>S.map(j=>j.id===at.id?{...j,fromAnchor:y}:j))}}),a.jsx("button",{onClick:()=>mn(p=>p.map(y=>y.id===at.id?{...y,fromAnchor:void 0}:y)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),xe.some(p=>p.id===at.toId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Arrivo"}),a.jsxs("span",{children:[Math.round((at.toAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(at.toAnchor??-1)===-1?0:at.toAnchor*100,onChange:p=>{const y=parseInt(p.target.value)/100;mn(S=>S.map(j=>j.id===at.id?{...j,toAnchor:y}:j))}}),a.jsx("button",{onClick:()=>mn(p=>p.map(y=>y.id===at.id?{...y,toAnchor:void 0}:y)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),a.jsx("label",{className:"text-xs opacity-50 font-bold block",children:"Tipo Relazione"}),a.jsx(rC,{value:at.type,onChange:p=>{const y=Tt[p]||{};mn(S=>S.map(j=>j.id===at.id?{...j,type:p,color:y.color,lineStyle:y.lineStyle,decorator:y.decorator}:j))},className:"text-black"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:at.label,onChange:p=>mn(y=>y.map(S=>S.id===at.id?{...S,label:p.target.value}:S)),placeholder:"Etichetta"}),a.jsx(th,{notes:at.notes,onChange:p=>mn(y=>y.map(S=>S.id===at.id?{...S,notes:p}:S))}),a.jsxs("button",{onClick:()=>{mn(pe.filter(p=>p.id!==at.id)),zt([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(wa,{size:14})," Elimina Relazione"]})]}),yt&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("label",{className:"text-xs opacity-50 font-bold",children:"Tipo Gruppo"}),a.jsxs("select",{className:"w-full p-2 rounded border bg-transparent theme-border",value:yt.type,onChange:p=>On(xe.map(y=>y.id===yt.id?{...y,type:p.target.value}:y)),children:[a.jsx("option",{value:"household",className:"text-black",children:"Household"}),a.jsx("option",{value:"subsystem",className:"text-black",children:"Sottosistema"})]}),a.jsxs("button",{onClick:()=>c(yt.id),className:`w-full py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors border ${o===yt.id?"bg-green-100 text-green-700 border-green-300":"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100"}`,children:[o===yt.id?a.jsx(bx,{size:14}):a.jsx(du,{size:14}),o===yt.id?"Fine Modifica Membri":"Modifica Membri"]}),o===yt.id&&a.jsxs("div",{className:"text-[10px] opacity-70 text-center bg-yellow-50 dark:bg-yellow-900/10 p-2 rounded text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-800",children:[a.jsx(uu,{size:10,className:"inline mr-1"})," Clicca sulle persone nel grafico per aggiungerle o rimuoverle dal gruppo."]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2 pt-2 border-t theme-border",children:[a.jsx("input",{type:"checkbox",id:"showLabel",checked:yt.showLabel!==!1,onChange:p=>On(xe.map(y=>y.id===yt.id?{...y,showLabel:p.target.checked}:y))}),a.jsx("label",{htmlFor:"showLabel",className:"text-xs",children:"Mostra Etichetta"})]}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:yt.label,onChange:p=>On(xe.map(y=>y.id===yt.id?{...y,label:p.target.value}:y)),placeholder:"Etichetta Gruppo"}),a.jsx("div",{className:"border theme-border rounded p-2 bg-black/5 dark:bg-white/5",children:a.jsx(lC,{value:yt.color,onChange:p=>On(xe.map(y=>y.id===yt.id?{...y,color:p}:y))})}),a.jsx(th,{notes:yt.notes,onChange:p=>On(xe.map(y=>y.id===yt.id?{...y,notes:p}:y))}),a.jsxs("button",{onClick:()=>{On(xe.filter(p=>p.id!==yt.id)),Ve([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(wa,{size:14})," Elimina Gruppo"]})]}),m.length===1&&(()=>{const p=u.find(y=>y.id===m[0]);return p?a.jsx(mC,{note:p,onUpdate:y=>{h(S=>S.map(j=>j.id===p.id?{...j,...y}:j))},onDelete:()=>{if(confirm("Eliminare questa nota?")){const y=u.filter(S=>S.id!==p.id);is(ee,pe,xe,y),g([])}}}):null})()]})]}),fe&&a.jsxs("div",{className:"fixed z-[9999] flex flex-col gap-2 p-3 rounded-xl shadow-2xl theme-panel theme-border border animate-in fade-in zoom-in duration-200",style:{left:fe.x-75,top:fe.y-100},children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 text-center uppercase mb-1",children:"Aggiungi"}),a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsxs("button",{onClick:()=>{sa("M",fe.gx,fe.gy),Xe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(Xh,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"M"})]}),a.jsxs("button",{onClick:()=>{sa("F",fe.gx,fe.gy),Xe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-pink-50 dark:hover:bg-pink-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-full shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(Qh,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"F"})]}),a.jsxs("button",{onClick:()=>{T(fe.gx,fe.gy),Xe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-yellow-50 dark:hover:bg-yellow-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(Jh,{size:20,className:"text-yellow-500"})}),a.jsx("span",{className:"text-xs font-bold",children:"Nota"})]})]}),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 w-3 h-3 bg-inherit border-b border-r theme-border rotate-45 transform"}),a.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>Xe(null)})]})]})," "]})}class xC extends vv.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Errore Critico di Avvio:",e,n)}render(){var e,n;return this.state.hasError?a.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[a.jsx("h1",{style:{color:"#dc2626",fontSize:"1.5rem",marginBottom:"1rem"},children:"Si  verificato un errore critico"}),a.jsx("p",{style:{marginBottom:"1rem",color:"#4b5563"},children:"L'applicazione non  riuscita ad avviarsi. Ecco i dettagli tecnici:"}),a.jsxs("div",{style:{backgroundColor:"#f3f4f6",padding:"1rem",borderRadius:"0.5rem",overflow:"auto",border:"1px solid #e5e7eb"},children:[a.jsx("code",{style:{color:"#dc2626",fontSize:"0.875rem"},children:(e=this.state.error)==null?void 0:e.message}),a.jsx("pre",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"#374151"},children:(n=this.state.error)==null?void 0:n.stack})]}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1.5rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontWeight:"bold"},children:"Ricarica Applicazione"})]}):this.props.children}}const av=document.getElementById("root");av?nh.createRoot(av).render(a.jsx(vv.StrictMode,{children:a.jsx(xC,{children:a.jsx(vC,{})})})):document.body.innerHTML=`<div style="color: red; padding: 20px; font-weight: bold;">ERRORE FATALE: Impossibile trovare l'elemento con id="root" nel file index.html.</div>`;
