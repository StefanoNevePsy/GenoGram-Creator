(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function e1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uv={exports:{}},Vu={},dv={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wl=Symbol.for("react.element"),t1=Symbol.for("react.portal"),n1=Symbol.for("react.fragment"),r1=Symbol.for("react.strict_mode"),s1=Symbol.for("react.profiler"),i1=Symbol.for("react.provider"),o1=Symbol.for("react.context"),a1=Symbol.for("react.forward_ref"),l1=Symbol.for("react.suspense"),c1=Symbol.for("react.memo"),u1=Symbol.for("react.lazy"),wm=Symbol.iterator;function d1(t){return t===null||typeof t!="object"?null:(t=wm&&t[wm]||t["@@iterator"],typeof t=="function"?t:null)}var hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fv=Object.assign,pv={};function Go(t,e,n){this.props=t,this.context=e,this.refs=pv,this.updater=n||hv}Go.prototype.isReactComponent={};Go.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Go.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mv(){}mv.prototype=Go.prototype;function Cf(t,e,n){this.props=t,this.context=e,this.refs=pv,this.updater=n||hv}var Pf=Cf.prototype=new mv;Pf.constructor=Cf;fv(Pf,Go.prototype);Pf.isPureReactComponent=!0;var Em=Array.isArray,gv=Object.prototype.hasOwnProperty,jf={current:null},yv={key:!0,ref:!0,__self:!0,__source:!0};function vv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)gv.call(e,r)&&!yv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),h=0;h<c;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:wl,type:t,key:i,ref:o,props:s,_owner:jf.current}}function h1(t,e){return{$$typeof:wl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rf(t){return typeof t=="object"&&t!==null&&t.$$typeof===wl}function f1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bm=/\/+/g;function wd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?f1(""+t.key):e.toString(36)}function Ic(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wl:case t1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+wd(o,0):r,Em(s)?(n="",t!=null&&(n=t.replace(bm,"$&/")+"/"),Ic(s,e,n,"",function(h){return h})):s!=null&&(Rf(s)&&(s=h1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(bm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Em(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+wd(i,c);o+=Ic(i,e,n,u,s)}else if(u=d1(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+wd(i,c++),o+=Ic(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function tc(t,e,n){if(t==null)return t;var r=[],s=0;return Ic(t,r,"","",function(i){return e.call(n,i,s++)}),r}function p1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},Tc={transition:null},m1={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:jf};function xv(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:tc,forEach:function(t,e,n){tc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return tc(t,function(){e++}),e},toArray:function(t){return tc(t,function(e){return e})||[]},only:function(t){if(!Rf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=Go;ke.Fragment=n1;ke.Profiler=s1;ke.PureComponent=Cf;ke.StrictMode=r1;ke.Suspense=l1;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m1;ke.act=xv;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=jf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)gv.call(e,u)&&!yv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:wl,type:t.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(t){return t={$$typeof:o1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:i1,_context:t},t.Consumer=t};ke.createElement=vv;ke.createFactory=function(t){var e=vv.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:a1,render:t}};ke.isValidElement=Rf;ke.lazy=function(t){return{$$typeof:u1,_payload:{_status:-1,_result:t},_init:p1}};ke.memo=function(t,e){return{$$typeof:c1,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Tc.transition;Tc.transition={};try{t()}finally{Tc.transition=e}};ke.unstable_act=xv;ke.useCallback=function(t,e){return cn.current.useCallback(t,e)};ke.useContext=function(t){return cn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return cn.current.useEffect(t,e)};ke.useId=function(){return cn.current.useId()};ke.useImperativeHandle=function(t,e,n){return cn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return cn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return cn.current.useReducer(t,e,n)};ke.useRef=function(t){return cn.current.useRef(t)};ke.useState=function(t){return cn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return cn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return cn.current.useTransition()};ke.version="18.3.1";dv.exports=ke;var H=dv.exports;const _v=e1(H);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1=H,y1=Symbol.for("react.element"),v1=Symbol.for("react.fragment"),x1=Object.prototype.hasOwnProperty,_1=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w1={key:!0,ref:!0,__self:!0,__source:!0};function wv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)x1.call(e,r)&&!w1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:y1,type:t,key:i,ref:o,props:s,_owner:_1.current}}Vu.Fragment=v1;Vu.jsx=wv;Vu.jsxs=wv;uv.exports=Vu;var a=uv.exports,ah={},Ev={exports:{}},Rn={},bv={exports:{}},kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,fe){var ue=Z.length;Z.push(fe);e:for(;0<ue;){var Ie=ue-1>>>1,je=Z[Ie];if(0<s(je,fe))Z[Ie]=fe,Z[ue]=je,ue=Ie;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var fe=Z[0],ue=Z.pop();if(ue!==fe){Z[0]=ue;e:for(var Ie=0,je=Z.length,We=je>>>1;Ie<We;){var Rt=2*(Ie+1)-1,gt=Z[Rt],lr=Rt+1,Dt=Z[lr];if(0>s(gt,ue))lr<je&&0>s(Dt,gt)?(Z[Ie]=Dt,Z[lr]=ue,Ie=lr):(Z[Ie]=gt,Z[Rt]=ue,Ie=Rt);else if(lr<je&&0>s(Dt,ue))Z[Ie]=Dt,Z[lr]=ue,Ie=lr;else break e}}return fe}function s(Z,fe){var ue=Z.sortIndex-fe.sortIndex;return ue!==0?ue:Z.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,g=null,v=3,k=!1,P=!1,D=!1,L=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Z){for(var fe=n(h);fe!==null;){if(fe.callback===null)r(h);else if(fe.startTime<=Z)r(h),fe.sortIndex=fe.expirationTime,e(u,fe);else break;fe=n(h)}}function S(Z){if(D=!1,N(Z),!P)if(n(u)!==null)P=!0,ne(z);else{var fe=n(h);fe!==null&&Oe(S,fe.startTime-Z)}}function z(Z,fe){P=!1,D&&(D=!1,A(x),x=-1),k=!0;var ue=v;try{for(N(fe),g=n(u);g!==null&&(!(g.expirationTime>fe)||Z&&!R());){var Ie=g.callback;if(typeof Ie=="function"){g.callback=null,v=g.priorityLevel;var je=Ie(g.expirationTime<=fe);fe=t.unstable_now(),typeof je=="function"?g.callback=je:g===n(u)&&r(u),N(fe)}else r(u);g=n(u)}if(g!==null)var We=!0;else{var Rt=n(h);Rt!==null&&Oe(S,Rt.startTime-fe),We=!1}return We}finally{g=null,v=ue,k=!1}}var G=!1,T=null,x=-1,E=5,I=-1;function R(){return!(t.unstable_now()-I<E)}function M(){if(T!==null){var Z=t.unstable_now();I=Z;var fe=!0;try{fe=T(!0,Z)}finally{fe?C():(G=!1,T=null)}}else G=!1}var C;if(typeof b=="function")C=function(){b(M)};else if(typeof MessageChannel<"u"){var Je=new MessageChannel,ce=Je.port2;Je.port1.onmessage=M,C=function(){ce.postMessage(null)}}else C=function(){L(M,0)};function ne(Z){T=Z,G||(G=!0,C())}function Oe(Z,fe){x=L(function(){Z(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){P||k||(P=!0,ne(z))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Z){switch(v){case 1:case 2:case 3:var fe=3;break;default:fe=v}var ue=v;v=fe;try{return Z()}finally{v=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,fe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ue=v;v=Z;try{return fe()}finally{v=ue}},t.unstable_scheduleCallback=function(Z,fe,ue){var Ie=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ie+ue:Ie):ue=Ie,Z){case 1:var je=-1;break;case 2:je=250;break;case 5:je=1073741823;break;case 4:je=1e4;break;default:je=5e3}return je=ue+je,Z={id:m++,callback:fe,priorityLevel:Z,startTime:ue,expirationTime:je,sortIndex:-1},ue>Ie?(Z.sortIndex=ue,e(h,Z),n(u)===null&&Z===n(h)&&(D?(A(x),x=-1):D=!0,Oe(S,ue-Ie))):(Z.sortIndex=je,e(u,Z),P||k||(P=!0,ne(z))),Z},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(Z){var fe=v;return function(){var ue=v;v=fe;try{return Z.apply(this,arguments)}finally{v=ue}}}})(kv);bv.exports=kv;var E1=bv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1=H,jn=E1;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Iv=new Set,qa={};function Ai(t,e){So(t,e),So(t+"Capture",e)}function So(t,e){for(qa[t]=e,t=0;t<e.length;t++)Iv.add(e[t])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lh=Object.prototype.hasOwnProperty,k1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,km={},Im={};function I1(t){return lh.call(Im,t)?!0:lh.call(km,t)?!1:k1.test(t)?Im[t]=!0:(km[t]=!0,!1)}function T1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function S1(t,e,n,r){if(e===null||typeof e>"u"||T1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var Df=/[\-:]([a-z])/g;function Mf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Df,Mf);Ht[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Df,Mf);Ht[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Df,Mf);Ht[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lf(t,e,n,r){var s=Ht.hasOwnProperty(e)?Ht[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(S1(e,n,s,r)&&(n=null),r||s===null?I1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ss=b1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nc=Symbol.for("react.element"),no=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),Of=Symbol.for("react.strict_mode"),ch=Symbol.for("react.profiler"),Tv=Symbol.for("react.provider"),Sv=Symbol.for("react.context"),Vf=Symbol.for("react.forward_ref"),uh=Symbol.for("react.suspense"),dh=Symbol.for("react.suspense_list"),Ff=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),Nv=Symbol.for("react.offscreen"),Tm=Symbol.iterator;function fa(t){return t===null||typeof t!="object"?null:(t=Tm&&t[Tm]||t["@@iterator"],typeof t=="function"?t:null)}var dt=Object.assign,Ed;function Ea(t){if(Ed===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ed=e&&e[1]||""}return`
`+Ed+t}var bd=!1;function kd(t,e){if(!t||bd)return"";bd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{bd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ea(t):""}function N1(t){switch(t.tag){case 5:return Ea(t.type);case 16:return Ea("Lazy");case 13:return Ea("Suspense");case 19:return Ea("SuspenseList");case 0:case 2:case 15:return t=kd(t.type,!1),t;case 11:return t=kd(t.type.render,!1),t;case 1:return t=kd(t.type,!0),t;default:return""}}function hh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ro:return"Fragment";case no:return"Portal";case ch:return"Profiler";case Of:return"StrictMode";case uh:return"Suspense";case dh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sv:return(t.displayName||"Context")+".Consumer";case Tv:return(t._context.displayName||"Context")+".Provider";case Vf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ff:return e=t.displayName||null,e!==null?e:hh(t.type)||"Memo";case ys:e=t._payload,t=t._init;try{return hh(t(e))}catch{}}return null}function A1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hh(e);case 8:return e===Of?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Us(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Av(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function C1(t){var e=Av(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rc(t){t._valueTracker||(t._valueTracker=C1(t))}function Cv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Av(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function fh(t,e){var n=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Us(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Pv(t,e){e=e.checked,e!=null&&Lf(t,"checked",e,!1)}function ph(t,e){Pv(t,e);var n=Us(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?mh(t,e.type,n):e.hasOwnProperty("defaultValue")&&mh(t,e.type,Us(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Nm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function mh(t,e,n){(e!=="number"||Gc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ba=Array.isArray;function go(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Us(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function gh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Am(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(ba(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Us(n)}}function jv(t,e){var n=Us(e.value),r=Us(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Rv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Rv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sc,Dv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sc=sc||document.createElement("div"),sc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ka(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ra={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P1=["Webkit","ms","Moz","O"];Object.keys(Ra).forEach(function(t){P1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ra[e]=Ra[t]})});function Mv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ra.hasOwnProperty(t)&&Ra[t]?(""+e).trim():e+"px"}function Lv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Mv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var j1=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vh(t,e){if(e){if(j1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function xh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _h=null;function zf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wh=null,yo=null,vo=null;function Pm(t){if(t=kl(t)){if(typeof wh!="function")throw Error(X(280));var e=t.stateNode;e&&(e=Bu(e),wh(t.stateNode,t.type,e))}}function Ov(t){yo?vo?vo.push(t):vo=[t]:yo=t}function Vv(){if(yo){var t=yo,e=vo;if(vo=yo=null,Pm(t),e)for(t=0;t<e.length;t++)Pm(e[t])}}function Fv(t,e){return t(e)}function zv(){}var Id=!1;function Uv(t,e,n){if(Id)return t(e,n);Id=!0;try{return Fv(t,e,n)}finally{Id=!1,(yo!==null||vo!==null)&&(zv(),Vv())}}function Qa(t,e){var n=t.stateNode;if(n===null)return null;var r=Bu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var Eh=!1;if(Kr)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){Eh=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{Eh=!1}function R1(t,e,n,r,s,i,o,c,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(m){this.onError(m)}}var Da=!1,qc=null,Kc=!1,bh=null,D1={onError:function(t){Da=!0,qc=t}};function M1(t,e,n,r,s,i,o,c,u){Da=!1,qc=null,R1.apply(D1,arguments)}function L1(t,e,n,r,s,i,o,c,u){if(M1.apply(this,arguments),Da){if(Da){var h=qc;Da=!1,qc=null}else throw Error(X(198));Kc||(Kc=!0,bh=h)}}function Ci(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $v(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function jm(t){if(Ci(t)!==t)throw Error(X(188))}function O1(t){var e=t.alternate;if(!e){if(e=Ci(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return jm(s),t;if(i===r)return jm(s),e;i=i.sibling}throw Error(X(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function Bv(t){return t=O1(t),t!==null?Wv(t):null}function Wv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Wv(t);if(e!==null)return e;t=t.sibling}return null}var Hv=jn.unstable_scheduleCallback,Rm=jn.unstable_cancelCallback,V1=jn.unstable_shouldYield,F1=jn.unstable_requestPaint,mt=jn.unstable_now,z1=jn.unstable_getCurrentPriorityLevel,Uf=jn.unstable_ImmediatePriority,Gv=jn.unstable_UserBlockingPriority,Qc=jn.unstable_NormalPriority,U1=jn.unstable_LowPriority,qv=jn.unstable_IdlePriority,Fu=null,Er=null;function $1(t){if(Er&&typeof Er.onCommitFiberRoot=="function")try{Er.onCommitFiberRoot(Fu,t,void 0,(t.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:H1,B1=Math.log,W1=Math.LN2;function H1(t){return t>>>=0,t===0?32:31-(B1(t)/W1|0)|0}var ic=64,oc=4194304;function ka(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=ka(c):(i&=o,i!==0&&(r=ka(i)))}else o=n&~s,o!==0?r=ka(o):i!==0&&(r=ka(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sr(e),s=1<<n,r|=t[n],e&=~s;return r}function G1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-sr(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=G1(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function kh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Kv(){var t=ic;return ic<<=1,!(ic&4194240)&&(ic=64),t}function Td(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function El(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sr(e),t[e]=n}function K1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-sr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function $f(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ze=0;function Qv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Xv,Bf,Yv,Jv,Zv,Ih=!1,ac=[],As=null,Cs=null,Ps=null,Xa=new Map,Ya=new Map,xs=[],Q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dm(t,e){switch(t){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Ps=null;break;case"pointerover":case"pointerout":Xa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ya.delete(e.pointerId)}}function ma(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=kl(e),e!==null&&Bf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function X1(t,e,n,r,s){switch(e){case"focusin":return As=ma(As,t,e,n,r,s),!0;case"dragenter":return Cs=ma(Cs,t,e,n,r,s),!0;case"mouseover":return Ps=ma(Ps,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Xa.set(i,ma(Xa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ya.set(i,ma(Ya.get(i)||null,t,e,n,r,s)),!0}return!1}function e0(t){var e=ui(t.target);if(e!==null){var n=Ci(e);if(n!==null){if(e=n.tag,e===13){if(e=$v(n),e!==null){t.blockedOn=e,Zv(t.priority,function(){Yv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Th(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_h=r,n.target.dispatchEvent(r),_h=null}else return e=kl(n),e!==null&&Bf(e),t.blockedOn=n,!1;e.shift()}return!0}function Mm(t,e,n){Sc(t)&&n.delete(e)}function Y1(){Ih=!1,As!==null&&Sc(As)&&(As=null),Cs!==null&&Sc(Cs)&&(Cs=null),Ps!==null&&Sc(Ps)&&(Ps=null),Xa.forEach(Mm),Ya.forEach(Mm)}function ga(t,e){t.blockedOn===e&&(t.blockedOn=null,Ih||(Ih=!0,jn.unstable_scheduleCallback(jn.unstable_NormalPriority,Y1)))}function Ja(t){function e(s){return ga(s,t)}if(0<ac.length){ga(ac[0],t);for(var n=1;n<ac.length;n++){var r=ac[n];r.blockedOn===t&&(r.blockedOn=null)}}for(As!==null&&ga(As,t),Cs!==null&&ga(Cs,t),Ps!==null&&ga(Ps,t),Xa.forEach(e),Ya.forEach(e),n=0;n<xs.length;n++)r=xs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<xs.length&&(n=xs[0],n.blockedOn===null);)e0(n),n.blockedOn===null&&xs.shift()}var xo=ss.ReactCurrentBatchConfig,Yc=!0;function J1(t,e,n,r){var s=ze,i=xo.transition;xo.transition=null;try{ze=1,Wf(t,e,n,r)}finally{ze=s,xo.transition=i}}function Z1(t,e,n,r){var s=ze,i=xo.transition;xo.transition=null;try{ze=4,Wf(t,e,n,r)}finally{ze=s,xo.transition=i}}function Wf(t,e,n,r){if(Yc){var s=Th(t,e,n,r);if(s===null)Ld(t,e,r,Jc,n),Dm(t,r);else if(X1(s,t,e,n,r))r.stopPropagation();else if(Dm(t,r),e&4&&-1<Q1.indexOf(t)){for(;s!==null;){var i=kl(s);if(i!==null&&Xv(i),i=Th(t,e,n,r),i===null&&Ld(t,e,r,Jc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Ld(t,e,r,null,n)}}var Jc=null;function Th(t,e,n,r){if(Jc=null,t=zf(r),t=ui(t),t!==null)if(e=Ci(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$v(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jc=t,null}function t0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(z1()){case Uf:return 1;case Gv:return 4;case Qc:case U1:return 16;case qv:return 536870912;default:return 16}default:return 16}}var Ts=null,Hf=null,Nc=null;function n0(){if(Nc)return Nc;var t,e=Hf,n=e.length,r,s="value"in Ts?Ts.value:Ts.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nc=s.slice(t,1<r?1-r:void 0)}function Ac(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lc(){return!0}function Lm(){return!1}function Dn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lc:Lm,this.isPropagationStopped=Lm,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lc)},persist:function(){},isPersistent:lc}),e}var qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gf=Dn(qo),bl=dt({},qo,{view:0,detail:0}),eE=Dn(bl),Sd,Nd,ya,zu=dt({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ya&&(ya&&t.type==="mousemove"?(Sd=t.screenX-ya.screenX,Nd=t.screenY-ya.screenY):Nd=Sd=0,ya=t),Sd)},movementY:function(t){return"movementY"in t?t.movementY:Nd}}),Om=Dn(zu),tE=dt({},zu,{dataTransfer:0}),nE=Dn(tE),rE=dt({},bl,{relatedTarget:0}),Ad=Dn(rE),sE=dt({},qo,{animationName:0,elapsedTime:0,pseudoElement:0}),iE=Dn(sE),oE=dt({},qo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aE=Dn(oE),lE=dt({},qo,{data:0}),Vm=Dn(lE),cE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dE[t])?!!e[t]:!1}function qf(){return hE}var fE=dt({},bl,{key:function(t){if(t.key){var e=cE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ac(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qf,charCode:function(t){return t.type==="keypress"?Ac(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ac(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pE=Dn(fE),mE=dt({},zu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fm=Dn(mE),gE=dt({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qf}),yE=Dn(gE),vE=dt({},qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),xE=Dn(vE),_E=dt({},zu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wE=Dn(_E),EE=[9,13,27,32],Kf=Kr&&"CompositionEvent"in window,Ma=null;Kr&&"documentMode"in document&&(Ma=document.documentMode);var bE=Kr&&"TextEvent"in window&&!Ma,r0=Kr&&(!Kf||Ma&&8<Ma&&11>=Ma),zm=" ",Um=!1;function s0(t,e){switch(t){case"keyup":return EE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var so=!1;function kE(t,e){switch(t){case"compositionend":return i0(e);case"keypress":return e.which!==32?null:(Um=!0,zm);case"textInput":return t=e.data,t===zm&&Um?null:t;default:return null}}function IE(t,e){if(so)return t==="compositionend"||!Kf&&s0(t,e)?(t=n0(),Nc=Hf=Ts=null,so=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return r0&&e.locale!=="ko"?null:e.data;default:return null}}var TE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TE[t.type]:e==="textarea"}function o0(t,e,n,r){Ov(r),e=Zc(e,"onChange"),0<e.length&&(n=new Gf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var La=null,Za=null;function SE(t){y0(t,0)}function Uu(t){var e=ao(t);if(Cv(e))return t}function NE(t,e){if(t==="change")return e}var a0=!1;if(Kr){var Cd;if(Kr){var Pd="oninput"in document;if(!Pd){var Bm=document.createElement("div");Bm.setAttribute("oninput","return;"),Pd=typeof Bm.oninput=="function"}Cd=Pd}else Cd=!1;a0=Cd&&(!document.documentMode||9<document.documentMode)}function Wm(){La&&(La.detachEvent("onpropertychange",l0),Za=La=null)}function l0(t){if(t.propertyName==="value"&&Uu(Za)){var e=[];o0(e,Za,t,zf(t)),Uv(SE,e)}}function AE(t,e,n){t==="focusin"?(Wm(),La=e,Za=n,La.attachEvent("onpropertychange",l0)):t==="focusout"&&Wm()}function CE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uu(Za)}function PE(t,e){if(t==="click")return Uu(e)}function jE(t,e){if(t==="input"||t==="change")return Uu(e)}function RE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var or=typeof Object.is=="function"?Object.is:RE;function el(t,e){if(or(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!lh.call(e,s)||!or(t[s],e[s]))return!1}return!0}function Hm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gm(t,e){var n=Hm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hm(n)}}function c0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?c0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function u0(){for(var t=window,e=Gc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gc(t.document)}return e}function Qf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DE(t){var e=u0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&c0(n.ownerDocument.documentElement,n)){if(r!==null&&Qf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Gm(n,i);var o=Gm(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ME=Kr&&"documentMode"in document&&11>=document.documentMode,io=null,Sh=null,Oa=null,Nh=!1;function qm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Nh||io==null||io!==Gc(r)||(r=io,"selectionStart"in r&&Qf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Oa&&el(Oa,r)||(Oa=r,r=Zc(Sh,"onSelect"),0<r.length&&(e=new Gf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=io)))}function cc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oo={animationend:cc("Animation","AnimationEnd"),animationiteration:cc("Animation","AnimationIteration"),animationstart:cc("Animation","AnimationStart"),transitionend:cc("Transition","TransitionEnd")},jd={},d0={};Kr&&(d0=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function $u(t){if(jd[t])return jd[t];if(!oo[t])return t;var e=oo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in d0)return jd[t]=e[n];return t}var h0=$u("animationend"),f0=$u("animationiteration"),p0=$u("animationstart"),m0=$u("transitionend"),g0=new Map,Km="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qs(t,e){g0.set(t,e),Ai(e,[t])}for(var Rd=0;Rd<Km.length;Rd++){var Dd=Km[Rd],LE=Dd.toLowerCase(),OE=Dd[0].toUpperCase()+Dd.slice(1);qs(LE,"on"+OE)}qs(h0,"onAnimationEnd");qs(f0,"onAnimationIteration");qs(p0,"onAnimationStart");qs("dblclick","onDoubleClick");qs("focusin","onFocus");qs("focusout","onBlur");qs(m0,"onTransitionEnd");So("onMouseEnter",["mouseout","mouseover"]);So("onMouseLeave",["mouseout","mouseover"]);So("onPointerEnter",["pointerout","pointerover"]);So("onPointerLeave",["pointerout","pointerover"]);Ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ia));function Qm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,L1(r,e,void 0,t),t.currentTarget=null}function y0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,h=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Qm(s,c,h),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,h=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Qm(s,c,h),i=u}}}if(Kc)throw t=bh,Kc=!1,bh=null,t}function nt(t,e){var n=e[Rh];n===void 0&&(n=e[Rh]=new Set);var r=t+"__bubble";n.has(r)||(v0(e,t,2,!1),n.add(r))}function Md(t,e,n){var r=0;e&&(r|=4),v0(n,t,r,e)}var uc="_reactListening"+Math.random().toString(36).slice(2);function tl(t){if(!t[uc]){t[uc]=!0,Iv.forEach(function(n){n!=="selectionchange"&&(VE.has(n)||Md(n,!1,t),Md(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uc]||(e[uc]=!0,Md("selectionchange",!1,e))}}function v0(t,e,n,r){switch(t0(e)){case 1:var s=J1;break;case 4:s=Z1;break;default:s=Wf}n=s.bind(null,e,n,t),s=void 0,!Eh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Ld(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=ui(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}Uv(function(){var h=i,m=zf(n),g=[];e:{var v=g0.get(t);if(v!==void 0){var k=Gf,P=t;switch(t){case"keypress":if(Ac(n)===0)break e;case"keydown":case"keyup":k=pE;break;case"focusin":P="focus",k=Ad;break;case"focusout":P="blur",k=Ad;break;case"beforeblur":case"afterblur":k=Ad;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Om;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=nE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=yE;break;case h0:case f0:case p0:k=iE;break;case m0:k=xE;break;case"scroll":k=eE;break;case"wheel":k=wE;break;case"copy":case"cut":case"paste":k=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Fm}var D=(e&4)!==0,L=!D&&t==="scroll",A=D?v!==null?v+"Capture":null:v;D=[];for(var b=h,N;b!==null;){N=b;var S=N.stateNode;if(N.tag===5&&S!==null&&(N=S,A!==null&&(S=Qa(b,A),S!=null&&D.push(nl(b,S,N)))),L)break;b=b.return}0<D.length&&(v=new k(v,P,null,n,m),g.push({event:v,listeners:D}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",v&&n!==_h&&(P=n.relatedTarget||n.fromElement)&&(ui(P)||P[Qr]))break e;if((k||v)&&(v=m.window===m?m:(v=m.ownerDocument)?v.defaultView||v.parentWindow:window,k?(P=n.relatedTarget||n.toElement,k=h,P=P?ui(P):null,P!==null&&(L=Ci(P),P!==L||P.tag!==5&&P.tag!==6)&&(P=null)):(k=null,P=h),k!==P)){if(D=Om,S="onMouseLeave",A="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(D=Fm,S="onPointerLeave",A="onPointerEnter",b="pointer"),L=k==null?v:ao(k),N=P==null?v:ao(P),v=new D(S,b+"leave",k,n,m),v.target=L,v.relatedTarget=N,S=null,ui(m)===h&&(D=new D(A,b+"enter",P,n,m),D.target=N,D.relatedTarget=L,S=D),L=S,k&&P)t:{for(D=k,A=P,b=0,N=D;N;N=Ji(N))b++;for(N=0,S=A;S;S=Ji(S))N++;for(;0<b-N;)D=Ji(D),b--;for(;0<N-b;)A=Ji(A),N--;for(;b--;){if(D===A||A!==null&&D===A.alternate)break t;D=Ji(D),A=Ji(A)}D=null}else D=null;k!==null&&Xm(g,v,k,D,!1),P!==null&&L!==null&&Xm(g,L,P,D,!0)}}e:{if(v=h?ao(h):window,k=v.nodeName&&v.nodeName.toLowerCase(),k==="select"||k==="input"&&v.type==="file")var z=NE;else if($m(v))if(a0)z=jE;else{z=CE;var G=AE}else(k=v.nodeName)&&k.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(z=PE);if(z&&(z=z(t,h))){o0(g,z,n,m);break e}G&&G(t,v,h),t==="focusout"&&(G=v._wrapperState)&&G.controlled&&v.type==="number"&&mh(v,"number",v.value)}switch(G=h?ao(h):window,t){case"focusin":($m(G)||G.contentEditable==="true")&&(io=G,Sh=h,Oa=null);break;case"focusout":Oa=Sh=io=null;break;case"mousedown":Nh=!0;break;case"contextmenu":case"mouseup":case"dragend":Nh=!1,qm(g,n,m);break;case"selectionchange":if(ME)break;case"keydown":case"keyup":qm(g,n,m)}var T;if(Kf)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else so?s0(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(r0&&n.locale!=="ko"&&(so||x!=="onCompositionStart"?x==="onCompositionEnd"&&so&&(T=n0()):(Ts=m,Hf="value"in Ts?Ts.value:Ts.textContent,so=!0)),G=Zc(h,x),0<G.length&&(x=new Vm(x,t,null,n,m),g.push({event:x,listeners:G}),T?x.data=T:(T=i0(n),T!==null&&(x.data=T)))),(T=bE?kE(t,n):IE(t,n))&&(h=Zc(h,"onBeforeInput"),0<h.length&&(m=new Vm("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:h}),m.data=T))}y0(g,e)})}function nl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Qa(t,n),i!=null&&r.unshift(nl(t,i,s)),i=Qa(t,e),i!=null&&r.push(nl(t,i,s))),t=t.return}return r}function Ji(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xm(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,h=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&h!==null&&(c=h,s?(u=Qa(n,i),u!=null&&o.unshift(nl(n,u,c))):s||(u=Qa(n,i),u!=null&&o.push(nl(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var FE=/\r\n?/g,zE=/\u0000|\uFFFD/g;function Ym(t){return(typeof t=="string"?t:""+t).replace(FE,`
`).replace(zE,"")}function dc(t,e,n){if(e=Ym(e),Ym(t)!==e&&n)throw Error(X(425))}function eu(){}var Ah=null,Ch=null;function Ph(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jh=typeof setTimeout=="function"?setTimeout:void 0,UE=typeof clearTimeout=="function"?clearTimeout:void 0,Jm=typeof Promise=="function"?Promise:void 0,$E=typeof queueMicrotask=="function"?queueMicrotask:typeof Jm<"u"?function(t){return Jm.resolve(null).then(t).catch(BE)}:jh;function BE(t){setTimeout(function(){throw t})}function Od(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ja(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ja(e)}function js(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ko=Math.random().toString(36).slice(2),yr="__reactFiber$"+Ko,rl="__reactProps$"+Ko,Qr="__reactContainer$"+Ko,Rh="__reactEvents$"+Ko,WE="__reactListeners$"+Ko,HE="__reactHandles$"+Ko;function ui(t){var e=t[yr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qr]||n[yr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zm(t);t!==null;){if(n=t[yr])return n;t=Zm(t)}return e}t=n,n=t.parentNode}return null}function kl(t){return t=t[yr]||t[Qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ao(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function Bu(t){return t[rl]||null}var Dh=[],lo=-1;function Ks(t){return{current:t}}function st(t){0>lo||(t.current=Dh[lo],Dh[lo]=null,lo--)}function Ye(t,e){lo++,Dh[lo]=t.current,t.current=e}var $s={},sn=Ks($s),yn=Ks(!1),xi=$s;function No(t,e){var n=t.type.contextTypes;if(!n)return $s;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function vn(t){return t=t.childContextTypes,t!=null}function tu(){st(yn),st(sn)}function eg(t,e,n){if(sn.current!==$s)throw Error(X(168));Ye(sn,e),Ye(yn,n)}function x0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(X(108,A1(t)||"Unknown",s));return dt({},n,r)}function nu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$s,xi=sn.current,Ye(sn,t),Ye(yn,yn.current),!0}function tg(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=x0(t,e,xi),r.__reactInternalMemoizedMergedChildContext=t,st(yn),st(sn),Ye(sn,t)):st(yn),Ye(yn,n)}var zr=null,Wu=!1,Vd=!1;function _0(t){zr===null?zr=[t]:zr.push(t)}function GE(t){Wu=!0,_0(t)}function Qs(){if(!Vd&&zr!==null){Vd=!0;var t=0,e=ze;try{var n=zr;for(ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}zr=null,Wu=!1}catch(s){throw zr!==null&&(zr=zr.slice(t+1)),Hv(Uf,Qs),s}finally{ze=e,Vd=!1}}return null}var co=[],uo=0,ru=null,su=0,Vn=[],Fn=0,_i=null,Ur=1,$r="";function ai(t,e){co[uo++]=su,co[uo++]=ru,ru=t,su=e}function w0(t,e,n){Vn[Fn++]=Ur,Vn[Fn++]=$r,Vn[Fn++]=_i,_i=t;var r=Ur;t=$r;var s=32-sr(r)-1;r&=~(1<<s),n+=1;var i=32-sr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ur=1<<32-sr(e)+s|n<<s|r,$r=i+t}else Ur=1<<i|n<<s|r,$r=t}function Xf(t){t.return!==null&&(ai(t,1),w0(t,1,0))}function Yf(t){for(;t===ru;)ru=co[--uo],co[uo]=null,su=co[--uo],co[uo]=null;for(;t===_i;)_i=Vn[--Fn],Vn[Fn]=null,$r=Vn[--Fn],Vn[Fn]=null,Ur=Vn[--Fn],Vn[Fn]=null}var Pn=null,Cn=null,it=!1,nr=null;function E0(t,e){var n=Un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ng(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,Cn=js(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,Cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_i!==null?{id:Ur,overflow:$r}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,Cn=null,!0):!1;default:return!1}}function Mh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Lh(t){if(it){var e=Cn;if(e){var n=e;if(!ng(t,e)){if(Mh(t))throw Error(X(418));e=js(n.nextSibling);var r=Pn;e&&ng(t,e)?E0(r,n):(t.flags=t.flags&-4097|2,it=!1,Pn=t)}}else{if(Mh(t))throw Error(X(418));t.flags=t.flags&-4097|2,it=!1,Pn=t}}}function rg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function hc(t){if(t!==Pn)return!1;if(!it)return rg(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ph(t.type,t.memoizedProps)),e&&(e=Cn)){if(Mh(t))throw b0(),Error(X(418));for(;e;)E0(t,e),e=js(e.nextSibling)}if(rg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cn=js(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cn=null}}else Cn=Pn?js(t.stateNode.nextSibling):null;return!0}function b0(){for(var t=Cn;t;)t=js(t.nextSibling)}function Ao(){Cn=Pn=null,it=!1}function Jf(t){nr===null?nr=[t]:nr.push(t)}var qE=ss.ReactCurrentBatchConfig;function va(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function fc(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sg(t){var e=t._init;return e(t._payload)}function k0(t){function e(A,b){if(t){var N=A.deletions;N===null?(A.deletions=[b],A.flags|=16):N.push(b)}}function n(A,b){if(!t)return null;for(;b!==null;)e(A,b),b=b.sibling;return null}function r(A,b){for(A=new Map;b!==null;)b.key!==null?A.set(b.key,b):A.set(b.index,b),b=b.sibling;return A}function s(A,b){return A=Ls(A,b),A.index=0,A.sibling=null,A}function i(A,b,N){return A.index=N,t?(N=A.alternate,N!==null?(N=N.index,N<b?(A.flags|=2,b):N):(A.flags|=2,b)):(A.flags|=1048576,b)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function c(A,b,N,S){return b===null||b.tag!==6?(b=Hd(N,A.mode,S),b.return=A,b):(b=s(b,N),b.return=A,b)}function u(A,b,N,S){var z=N.type;return z===ro?m(A,b,N.props.children,S,N.key):b!==null&&(b.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ys&&sg(z)===b.type)?(S=s(b,N.props),S.ref=va(A,b,N),S.return=A,S):(S=Lc(N.type,N.key,N.props,null,A.mode,S),S.ref=va(A,b,N),S.return=A,S)}function h(A,b,N,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==N.containerInfo||b.stateNode.implementation!==N.implementation?(b=Gd(N,A.mode,S),b.return=A,b):(b=s(b,N.children||[]),b.return=A,b)}function m(A,b,N,S,z){return b===null||b.tag!==7?(b=mi(N,A.mode,S,z),b.return=A,b):(b=s(b,N),b.return=A,b)}function g(A,b,N){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Hd(""+b,A.mode,N),b.return=A,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nc:return N=Lc(b.type,b.key,b.props,null,A.mode,N),N.ref=va(A,null,b),N.return=A,N;case no:return b=Gd(b,A.mode,N),b.return=A,b;case ys:var S=b._init;return g(A,S(b._payload),N)}if(ba(b)||fa(b))return b=mi(b,A.mode,N,null),b.return=A,b;fc(A,b)}return null}function v(A,b,N,S){var z=b!==null?b.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return z!==null?null:c(A,b,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case nc:return N.key===z?u(A,b,N,S):null;case no:return N.key===z?h(A,b,N,S):null;case ys:return z=N._init,v(A,b,z(N._payload),S)}if(ba(N)||fa(N))return z!==null?null:m(A,b,N,S,null);fc(A,N)}return null}function k(A,b,N,S,z){if(typeof S=="string"&&S!==""||typeof S=="number")return A=A.get(N)||null,c(b,A,""+S,z);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case nc:return A=A.get(S.key===null?N:S.key)||null,u(b,A,S,z);case no:return A=A.get(S.key===null?N:S.key)||null,h(b,A,S,z);case ys:var G=S._init;return k(A,b,N,G(S._payload),z)}if(ba(S)||fa(S))return A=A.get(N)||null,m(b,A,S,z,null);fc(b,S)}return null}function P(A,b,N,S){for(var z=null,G=null,T=b,x=b=0,E=null;T!==null&&x<N.length;x++){T.index>x?(E=T,T=null):E=T.sibling;var I=v(A,T,N[x],S);if(I===null){T===null&&(T=E);break}t&&T&&I.alternate===null&&e(A,T),b=i(I,b,x),G===null?z=I:G.sibling=I,G=I,T=E}if(x===N.length)return n(A,T),it&&ai(A,x),z;if(T===null){for(;x<N.length;x++)T=g(A,N[x],S),T!==null&&(b=i(T,b,x),G===null?z=T:G.sibling=T,G=T);return it&&ai(A,x),z}for(T=r(A,T);x<N.length;x++)E=k(T,A,x,N[x],S),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?x:E.key),b=i(E,b,x),G===null?z=E:G.sibling=E,G=E);return t&&T.forEach(function(R){return e(A,R)}),it&&ai(A,x),z}function D(A,b,N,S){var z=fa(N);if(typeof z!="function")throw Error(X(150));if(N=z.call(N),N==null)throw Error(X(151));for(var G=z=null,T=b,x=b=0,E=null,I=N.next();T!==null&&!I.done;x++,I=N.next()){T.index>x?(E=T,T=null):E=T.sibling;var R=v(A,T,I.value,S);if(R===null){T===null&&(T=E);break}t&&T&&R.alternate===null&&e(A,T),b=i(R,b,x),G===null?z=R:G.sibling=R,G=R,T=E}if(I.done)return n(A,T),it&&ai(A,x),z;if(T===null){for(;!I.done;x++,I=N.next())I=g(A,I.value,S),I!==null&&(b=i(I,b,x),G===null?z=I:G.sibling=I,G=I);return it&&ai(A,x),z}for(T=r(A,T);!I.done;x++,I=N.next())I=k(T,A,x,I.value,S),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?x:I.key),b=i(I,b,x),G===null?z=I:G.sibling=I,G=I);return t&&T.forEach(function(M){return e(A,M)}),it&&ai(A,x),z}function L(A,b,N,S){if(typeof N=="object"&&N!==null&&N.type===ro&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case nc:e:{for(var z=N.key,G=b;G!==null;){if(G.key===z){if(z=N.type,z===ro){if(G.tag===7){n(A,G.sibling),b=s(G,N.props.children),b.return=A,A=b;break e}}else if(G.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ys&&sg(z)===G.type){n(A,G.sibling),b=s(G,N.props),b.ref=va(A,G,N),b.return=A,A=b;break e}n(A,G);break}else e(A,G);G=G.sibling}N.type===ro?(b=mi(N.props.children,A.mode,S,N.key),b.return=A,A=b):(S=Lc(N.type,N.key,N.props,null,A.mode,S),S.ref=va(A,b,N),S.return=A,A=S)}return o(A);case no:e:{for(G=N.key;b!==null;){if(b.key===G)if(b.tag===4&&b.stateNode.containerInfo===N.containerInfo&&b.stateNode.implementation===N.implementation){n(A,b.sibling),b=s(b,N.children||[]),b.return=A,A=b;break e}else{n(A,b);break}else e(A,b);b=b.sibling}b=Gd(N,A.mode,S),b.return=A,A=b}return o(A);case ys:return G=N._init,L(A,b,G(N._payload),S)}if(ba(N))return P(A,b,N,S);if(fa(N))return D(A,b,N,S);fc(A,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,b!==null&&b.tag===6?(n(A,b.sibling),b=s(b,N),b.return=A,A=b):(n(A,b),b=Hd(N,A.mode,S),b.return=A,A=b),o(A)):n(A,b)}return L}var Co=k0(!0),I0=k0(!1),iu=Ks(null),ou=null,ho=null,Zf=null;function ep(){Zf=ho=ou=null}function tp(t){var e=iu.current;st(iu),t._currentValue=e}function Oh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _o(t,e){ou=t,Zf=ho=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gn=!0),t.firstContext=null)}function Bn(t){var e=t._currentValue;if(Zf!==t)if(t={context:t,memoizedValue:e,next:null},ho===null){if(ou===null)throw Error(X(308));ho=t,ou.dependencies={lanes:0,firstContext:t}}else ho=ho.next=t;return e}var di=null;function np(t){di===null?di=[t]:di.push(t)}function T0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,np(e)):(n.next=s.next,s.next=n),e.interleaved=n,Xr(t,r)}function Xr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vs=!1;function rp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function S0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Gr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Xr(t,n)}return s=r.interleaved,s===null?(e.next=e,np(r)):(e.next=s.next,s.next=e),r.interleaved=e,Xr(t,n)}function Cc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$f(t,n)}}function ig(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function au(t,e,n,r){var s=t.updateQueue;vs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,h=u.next;u.next=null,o===null?i=h:o.next=h,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=h:c.next=h,m.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,m=h=u=null,c=i;do{var v=c.lane,k=c.eventTime;if((r&v)===v){m!==null&&(m=m.next={eventTime:k,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var P=t,D=c;switch(v=e,k=n,D.tag){case 1:if(P=D.payload,typeof P=="function"){g=P.call(k,g,v);break e}g=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=D.payload,v=typeof P=="function"?P.call(k,g,v):P,v==null)break e;g=dt({},g,v);break e;case 2:vs=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,v=s.effects,v===null?s.effects=[c]:v.push(c))}else k={eventTime:k,lane:v,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(h=m=k,u=g):m=m.next=k,o|=v;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;v=c,c=v.next,v.next=null,s.lastBaseUpdate=v,s.shared.pending=null}}while(!0);if(m===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ei|=o,t.lanes=o,t.memoizedState=g}}function og(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(X(191,s));s.call(r)}}}var Il={},br=Ks(Il),sl=Ks(Il),il=Ks(Il);function hi(t){if(t===Il)throw Error(X(174));return t}function sp(t,e){switch(Ye(il,e),Ye(sl,t),Ye(br,Il),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yh(e,t)}st(br),Ye(br,e)}function Po(){st(br),st(sl),st(il)}function N0(t){hi(il.current);var e=hi(br.current),n=yh(e,t.type);e!==n&&(Ye(sl,t),Ye(br,n))}function ip(t){sl.current===t&&(st(br),st(sl))}var ct=Ks(0);function lu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fd=[];function op(){for(var t=0;t<Fd.length;t++)Fd[t]._workInProgressVersionPrimary=null;Fd.length=0}var Pc=ss.ReactCurrentDispatcher,zd=ss.ReactCurrentBatchConfig,wi=0,ut=null,It=null,Pt=null,cu=!1,Va=!1,ol=0,KE=0;function Yt(){throw Error(X(321))}function ap(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!or(t[n],e[n]))return!1;return!0}function lp(t,e,n,r,s,i){if(wi=i,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pc.current=t===null||t.memoizedState===null?JE:ZE,t=n(r,s),Va){i=0;do{if(Va=!1,ol=0,25<=i)throw Error(X(301));i+=1,Pt=It=null,e.updateQueue=null,Pc.current=eb,t=n(r,s)}while(Va)}if(Pc.current=uu,e=It!==null&&It.next!==null,wi=0,Pt=It=ut=null,cu=!1,e)throw Error(X(300));return t}function cp(){var t=ol!==0;return ol=0,t}function gr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?ut.memoizedState=Pt=t:Pt=Pt.next=t,Pt}function Wn(){if(It===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=It.next;var e=Pt===null?ut.memoizedState:Pt.next;if(e!==null)Pt=e,It=t;else{if(t===null)throw Error(X(310));It=t,t={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Pt===null?ut.memoizedState=Pt=t:Pt=Pt.next=t}return Pt}function al(t,e){return typeof e=="function"?e(t):e}function Ud(t){var e=Wn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=It,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,h=i;do{var m=h.lane;if((wi&m)===m)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,ut.lanes|=m,Ei|=m}h=h.next}while(h!==null&&h!==i);u===null?o=r:u.next=c,or(r,e.memoizedState)||(gn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ut.lanes|=i,Ei|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $d(t){var e=Wn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);or(i,e.memoizedState)||(gn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function A0(){}function C0(t,e){var n=ut,r=Wn(),s=e(),i=!or(r.memoizedState,s);if(i&&(r.memoizedState=s,gn=!0),r=r.queue,up(R0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Pt!==null&&Pt.memoizedState.tag&1){if(n.flags|=2048,ll(9,j0.bind(null,n,r,s,e),void 0,null),jt===null)throw Error(X(349));wi&30||P0(n,e,s)}return s}function P0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function j0(t,e,n,r){e.value=n,e.getSnapshot=r,D0(e)&&M0(t)}function R0(t,e,n){return n(function(){D0(e)&&M0(t)})}function D0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!or(t,n)}catch{return!0}}function M0(t){var e=Xr(t,1);e!==null&&ir(e,t,1,-1)}function ag(t){var e=gr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:t},e.queue=t,t=t.dispatch=YE.bind(null,ut,t),[e.memoizedState,t]}function ll(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function L0(){return Wn().memoizedState}function jc(t,e,n,r){var s=gr();ut.flags|=t,s.memoizedState=ll(1|e,n,void 0,r===void 0?null:r)}function Hu(t,e,n,r){var s=Wn();r=r===void 0?null:r;var i=void 0;if(It!==null){var o=It.memoizedState;if(i=o.destroy,r!==null&&ap(r,o.deps)){s.memoizedState=ll(e,n,i,r);return}}ut.flags|=t,s.memoizedState=ll(1|e,n,i,r)}function lg(t,e){return jc(8390656,8,t,e)}function up(t,e){return Hu(2048,8,t,e)}function O0(t,e){return Hu(4,2,t,e)}function V0(t,e){return Hu(4,4,t,e)}function F0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function z0(t,e,n){return n=n!=null?n.concat([t]):null,Hu(4,4,F0.bind(null,e,t),n)}function dp(){}function U0(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ap(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $0(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ap(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function B0(t,e,n){return wi&21?(or(n,e)||(n=Kv(),ut.lanes|=n,Ei|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gn=!0),t.memoizedState=n)}function QE(t,e){var n=ze;ze=n!==0&&4>n?n:4,t(!0);var r=zd.transition;zd.transition={};try{t(!1),e()}finally{ze=n,zd.transition=r}}function W0(){return Wn().memoizedState}function XE(t,e,n){var r=Ms(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},H0(t))G0(e,n);else if(n=T0(t,e,n,r),n!==null){var s=ln();ir(n,t,r,s),q0(n,e,r)}}function YE(t,e,n){var r=Ms(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(H0(t))G0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,or(c,o)){var u=e.interleaved;u===null?(s.next=s,np(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=T0(t,e,s,r),n!==null&&(s=ln(),ir(n,t,r,s),q0(n,e,r))}}function H0(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function G0(t,e){Va=cu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function q0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$f(t,n)}}var uu={readContext:Bn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},JE={readContext:Bn,useCallback:function(t,e){return gr().memoizedState=[t,e===void 0?null:e],t},useContext:Bn,useEffect:lg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,jc(4194308,4,F0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jc(4194308,4,t,e)},useInsertionEffect:function(t,e){return jc(4,2,t,e)},useMemo:function(t,e){var n=gr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=gr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=XE.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=gr();return t={current:t},e.memoizedState=t},useState:ag,useDebugValue:dp,useDeferredValue:function(t){return gr().memoizedState=t},useTransition:function(){var t=ag(!1),e=t[0];return t=QE.bind(null,t[1]),gr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,s=gr();if(it){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),jt===null)throw Error(X(349));wi&30||P0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lg(R0.bind(null,r,i,t),[t]),r.flags|=2048,ll(9,j0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=gr(),e=jt.identifierPrefix;if(it){var n=$r,r=Ur;n=(r&~(1<<32-sr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ol++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=KE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZE={readContext:Bn,useCallback:U0,useContext:Bn,useEffect:up,useImperativeHandle:z0,useInsertionEffect:O0,useLayoutEffect:V0,useMemo:$0,useReducer:Ud,useRef:L0,useState:function(){return Ud(al)},useDebugValue:dp,useDeferredValue:function(t){var e=Wn();return B0(e,It.memoizedState,t)},useTransition:function(){var t=Ud(al)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:C0,useId:W0,unstable_isNewReconciler:!1},eb={readContext:Bn,useCallback:U0,useContext:Bn,useEffect:up,useImperativeHandle:z0,useInsertionEffect:O0,useLayoutEffect:V0,useMemo:$0,useReducer:$d,useRef:L0,useState:function(){return $d(al)},useDebugValue:dp,useDeferredValue:function(t){var e=Wn();return It===null?e.memoizedState=t:B0(e,It.memoizedState,t)},useTransition:function(){var t=$d(al)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:C0,useId:W0,unstable_isNewReconciler:!1};function er(t,e){if(t&&t.defaultProps){e=dt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Vh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:dt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gu={isMounted:function(t){return(t=t._reactInternals)?Ci(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),s=Ms(t),i=Gr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Rs(t,i,s),e!==null&&(ir(e,t,s,r),Cc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),s=Ms(t),i=Gr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Rs(t,i,s),e!==null&&(ir(e,t,s,r),Cc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Ms(t),s=Gr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rs(t,s,r),e!==null&&(ir(e,t,r,n),Cc(e,t,r))}};function cg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!el(n,r)||!el(s,i):!0}function K0(t,e,n){var r=!1,s=$s,i=e.contextType;return typeof i=="object"&&i!==null?i=Bn(i):(s=vn(e)?xi:sn.current,r=e.contextTypes,i=(r=r!=null)?No(t,s):$s),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ug(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gu.enqueueReplaceState(e,e.state,null)}function Fh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},rp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Bn(i):(i=vn(e)?xi:sn.current,s.context=No(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Vh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Gu.enqueueReplaceState(s,s.state,null),au(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function jo(t,e){try{var n="",r=e;do n+=N1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Bd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tb=typeof WeakMap=="function"?WeakMap:Map;function Q0(t,e,n){n=Gr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){hu||(hu=!0,Xh=r),zh(t,e)},n}function X0(t,e,n){n=Gr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){zh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){zh(t,e),typeof r!="function"&&(Ds===null?Ds=new Set([this]):Ds.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=mb.bind(null,t,e,n),e.then(t,t))}function hg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Gr(-1,1),e.tag=2,Rs(n,e,1))),n.lanes|=1),t)}var nb=ss.ReactCurrentOwner,gn=!1;function an(t,e,n,r){e.child=t===null?I0(e,null,n,r):Co(e,t.child,n,r)}function pg(t,e,n,r,s){n=n.render;var i=e.ref;return _o(e,s),r=lp(t,e,n,r,i,s),n=cp(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(it&&n&&Xf(e),e.flags|=1,an(t,e,r,s),e.child)}function mg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!xp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Y0(t,e,i,r,s)):(t=Lc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:el,n(o,r)&&t.ref===e.ref)return Yr(t,e,s)}return e.flags|=1,t=Ls(i,r),t.ref=e.ref,t.return=e,e.child=t}function Y0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(el(i,r)&&t.ref===e.ref)if(gn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(gn=!0);else return e.lanes=t.lanes,Yr(t,e,s)}return Uh(t,e,n,r,s)}function J0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(po,An),An|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(po,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ye(po,An),An|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ye(po,An),An|=r;return an(t,e,s,n),e.child}function Z0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Uh(t,e,n,r,s){var i=vn(n)?xi:sn.current;return i=No(e,i),_o(e,s),n=lp(t,e,n,r,i,s),r=cp(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(it&&r&&Xf(e),e.flags|=1,an(t,e,n,s),e.child)}function gg(t,e,n,r,s){if(vn(n)){var i=!0;nu(e)}else i=!1;if(_o(e,s),e.stateNode===null)Rc(t,e),K0(e,n,r),Fh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Bn(h):(h=vn(n)?xi:sn.current,h=No(e,h));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==h)&&ug(e,o,r,h),vs=!1;var v=e.memoizedState;o.state=v,au(e,r,o,s),u=e.memoizedState,c!==r||v!==u||yn.current||vs?(typeof m=="function"&&(Vh(e,n,m,r),u=e.memoizedState),(c=vs||cg(e,n,c,r,v,u,h))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,S0(t,e),c=e.memoizedProps,h=e.type===e.elementType?c:er(e.type,c),o.props=h,g=e.pendingProps,v=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Bn(u):(u=vn(n)?xi:sn.current,u=No(e,u));var k=n.getDerivedStateFromProps;(m=typeof k=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||v!==u)&&ug(e,o,r,u),vs=!1,v=e.memoizedState,o.state=v,au(e,r,o,s);var P=e.memoizedState;c!==g||v!==P||yn.current||vs?(typeof k=="function"&&(Vh(e,n,k,r),P=e.memoizedState),(h=vs||cg(e,n,h,r,v,P,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,P,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,P,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=P),o.props=r,o.state=P,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return $h(t,e,n,r,i,s)}function $h(t,e,n,r,s,i){Z0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tg(e,n,!1),Yr(t,e,i);r=e.stateNode,nb.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Co(e,t.child,null,i),e.child=Co(e,null,c,i)):an(t,e,c,i),e.memoizedState=r.state,s&&tg(e,n,!0),e.child}function ex(t){var e=t.stateNode;e.pendingContext?eg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eg(t,e.context,!1),sp(t,e.containerInfo)}function yg(t,e,n,r,s){return Ao(),Jf(s),e.flags|=256,an(t,e,n,r),e.child}var Bh={dehydrated:null,treeContext:null,retryLane:0};function Wh(t){return{baseLanes:t,cachePool:null,transitions:null}}function tx(t,e,n){var r=e.pendingProps,s=ct.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ye(ct,s&1),t===null)return Lh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qu(o,r,0,null),t=mi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Wh(n),e.memoizedState=Bh,t):hp(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return rb(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ls(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Ls(c,i):(i=mi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Wh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Bh,r}return i=t.child,t=i.sibling,r=Ls(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function hp(t,e){return e=Qu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function pc(t,e,n,r){return r!==null&&Jf(r),Co(e,t.child,null,n),t=hp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Bd(Error(X(422))),pc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Qu({mode:"visible",children:r.children},s,0,null),i=mi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Co(e,t.child,null,o),e.child.memoizedState=Wh(o),e.memoizedState=Bh,i);if(!(e.mode&1))return pc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(X(419)),r=Bd(i,r,void 0),pc(t,e,o,r)}if(c=(o&t.childLanes)!==0,gn||c){if(r=jt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xr(t,s),ir(r,t,s,-1))}return vp(),r=Bd(Error(X(421))),pc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=gb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Cn=js(s.nextSibling),Pn=e,it=!0,nr=null,t!==null&&(Vn[Fn++]=Ur,Vn[Fn++]=$r,Vn[Fn++]=_i,Ur=t.id,$r=t.overflow,_i=e),e=hp(e,r.children),e.flags|=4096,e)}function vg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Oh(t.return,e,n)}function Wd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function nx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(an(t,e,r.children,n),r=ct.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vg(t,n,e);else if(t.tag===19)vg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ye(ct,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&lu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Wd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&lu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Wd(e,!0,n,null,i);break;case"together":Wd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ei|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=Ls(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ls(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sb(t,e,n){switch(e.tag){case 3:ex(e),Ao();break;case 5:N0(e);break;case 1:vn(e.type)&&nu(e);break;case 4:sp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ye(iu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ye(ct,ct.current&1),e.flags|=128,null):n&e.child.childLanes?tx(t,e,n):(Ye(ct,ct.current&1),t=Yr(t,e,n),t!==null?t.sibling:null);Ye(ct,ct.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return nx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ye(ct,ct.current),r)break;return null;case 22:case 23:return e.lanes=0,J0(t,e,n)}return Yr(t,e,n)}var rx,Hh,sx,ix;rx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hh=function(){};sx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,hi(br.current);var i=null;switch(n){case"input":s=fh(t,s),r=fh(t,r),i=[];break;case"select":s=dt({},s,{value:void 0}),r=dt({},r,{value:void 0}),i=[];break;case"textarea":s=gh(t,s),r=gh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=eu)}vh(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(qa.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==c&&(u!=null||c!=null))if(h==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(qa.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&nt("scroll",t),i||c===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};ix=function(t,e,n,r){n!==r&&(e.flags|=4)};function xa(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ib(t,e,n){var r=e.pendingProps;switch(Yf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(e),null;case 1:return vn(e.type)&&tu(),Jt(e),null;case 3:return r=e.stateNode,Po(),st(yn),st(sn),op(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nr!==null&&(Zh(nr),nr=null))),Hh(t,e),Jt(e),null;case 5:ip(e);var s=hi(il.current);if(n=e.type,t!==null&&e.stateNode!=null)sx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Jt(e),null}if(t=hi(br.current),hc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[yr]=e,r[rl]=i,t=(e.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(s=0;s<Ia.length;s++)nt(Ia[s],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":Sm(r,i),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},nt("invalid",r);break;case"textarea":Am(r,i),nt("invalid",r)}vh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&dc(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&dc(r.textContent,c,t),s=["children",""+c]):qa.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&nt("scroll",r)}switch(n){case"input":rc(r),Nm(r,i,!0);break;case"textarea":rc(r),Cm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=eu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Rv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[yr]=e,t[rl]=r,rx(t,e,!1,!1),e.stateNode=t;e:{switch(o=xh(n,r),n){case"dialog":nt("cancel",t),nt("close",t),s=r;break;case"iframe":case"object":case"embed":nt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ia.length;s++)nt(Ia[s],t);s=r;break;case"source":nt("error",t),s=r;break;case"img":case"image":case"link":nt("error",t),nt("load",t),s=r;break;case"details":nt("toggle",t),s=r;break;case"input":Sm(t,r),s=fh(t,r),nt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=dt({},r,{value:void 0}),nt("invalid",t);break;case"textarea":Am(t,r),s=gh(t,r),nt("invalid",t);break;default:s=r}vh(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Lv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Dv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ka(t,u):typeof u=="number"&&Ka(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&nt("scroll",t):u!=null&&Lf(t,i,u,o))}switch(n){case"input":rc(t),Nm(t,r,!1);break;case"textarea":rc(t),Cm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Us(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?go(t,!!r.multiple,i,!1):r.defaultValue!=null&&go(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=eu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jt(e),null;case 6:if(t&&e.stateNode!=null)ix(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=hi(il.current),hi(br.current),hc(e)){if(r=e.stateNode,n=e.memoizedProps,r[yr]=e,(i=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:dc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yr]=e,e.stateNode=r}return Jt(e),null;case 13:if(st(ct),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&Cn!==null&&e.mode&1&&!(e.flags&128))b0(),Ao(),e.flags|=98560,i=!1;else if(i=hc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[yr]=e}else Ao(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jt(e),i=!1}else nr!==null&&(Zh(nr),nr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ct.current&1?Tt===0&&(Tt=3):vp())),e.updateQueue!==null&&(e.flags|=4),Jt(e),null);case 4:return Po(),Hh(t,e),t===null&&tl(e.stateNode.containerInfo),Jt(e),null;case 10:return tp(e.type._context),Jt(e),null;case 17:return vn(e.type)&&tu(),Jt(e),null;case 19:if(st(ct),i=e.memoizedState,i===null)return Jt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)xa(i,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lu(t),o!==null){for(e.flags|=128,xa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ye(ct,ct.current&1|2),e.child}t=t.sibling}i.tail!==null&&mt()>Ro&&(e.flags|=128,r=!0,xa(i,!1),e.lanes=4194304)}else{if(!r)if(t=lu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!it)return Jt(e),null}else 2*mt()-i.renderingStartTime>Ro&&n!==1073741824&&(e.flags|=128,r=!0,xa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=mt(),e.sibling=null,n=ct.current,Ye(ct,r?n&1|2:n&1),e):(Jt(e),null);case 22:case 23:return yp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Jt(e),e.subtreeFlags&6&&(e.flags|=8192)):Jt(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function ob(t,e){switch(Yf(e),e.tag){case 1:return vn(e.type)&&tu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Po(),st(yn),st(sn),op(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ip(e),null;case 13:if(st(ct),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Ao()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return st(ct),null;case 4:return Po(),null;case 10:return tp(e.type._context),null;case 22:case 23:return yp(),null;case 24:return null;default:return null}}var mc=!1,tn=!1,ab=typeof WeakSet=="function"?WeakSet:Set,se=null;function fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ft(t,e,r)}else n.current=null}function Gh(t,e,n){try{n()}catch(r){ft(t,e,r)}}var xg=!1;function lb(t,e){if(Ah=Yc,t=u0(),Qf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,h=0,m=0,g=t,v=null;t:for(;;){for(var k;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(k=g.firstChild)!==null;)v=g,g=k;for(;;){if(g===t)break t;if(v===n&&++h===s&&(c=o),v===i&&++m===r&&(u=o),(k=g.nextSibling)!==null)break;g=v,v=g.parentNode}g=k}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ch={focusedElem:t,selectionRange:n},Yc=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var D=P.memoizedProps,L=P.memoizedState,A=e.stateNode,b=A.getSnapshotBeforeUpdate(e.elementType===e.type?D:er(e.type,D),L);A.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(S){ft(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return P=xg,xg=!1,P}function Fa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Gh(e,n,i)}s=s.next}while(s!==r)}}function qu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ox(t){var e=t.alternate;e!==null&&(t.alternate=null,ox(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[yr],delete e[rl],delete e[Rh],delete e[WE],delete e[HE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ax(t){return t.tag===5||t.tag===3||t.tag===4}function _g(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ax(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Kh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eu));else if(r!==4&&(t=t.child,t!==null))for(Kh(t,e,n),t=t.sibling;t!==null;)Kh(t,e,n),t=t.sibling}function Qh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qh(t,e,n),t=t.sibling;t!==null;)Qh(t,e,n),t=t.sibling}var Ft=null,tr=!1;function ms(t,e,n){for(n=n.child;n!==null;)lx(t,e,n),n=n.sibling}function lx(t,e,n){if(Er&&typeof Er.onCommitFiberUnmount=="function")try{Er.onCommitFiberUnmount(Fu,n)}catch{}switch(n.tag){case 5:tn||fo(n,e);case 6:var r=Ft,s=tr;Ft=null,ms(t,e,n),Ft=r,tr=s,Ft!==null&&(tr?(t=Ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ft.removeChild(n.stateNode));break;case 18:Ft!==null&&(tr?(t=Ft,n=n.stateNode,t.nodeType===8?Od(t.parentNode,n):t.nodeType===1&&Od(t,n),Ja(t)):Od(Ft,n.stateNode));break;case 4:r=Ft,s=tr,Ft=n.stateNode.containerInfo,tr=!0,ms(t,e,n),Ft=r,tr=s;break;case 0:case 11:case 14:case 15:if(!tn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Gh(n,e,o),s=s.next}while(s!==r)}ms(t,e,n);break;case 1:if(!tn&&(fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){ft(n,e,c)}ms(t,e,n);break;case 21:ms(t,e,n);break;case 22:n.mode&1?(tn=(r=tn)||n.memoizedState!==null,ms(t,e,n),tn=r):ms(t,e,n);break;default:ms(t,e,n)}}function wg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ab),e.forEach(function(r){var s=yb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ft=c.stateNode,tr=!1;break e;case 3:Ft=c.stateNode.containerInfo,tr=!0;break e;case 4:Ft=c.stateNode.containerInfo,tr=!0;break e}c=c.return}if(Ft===null)throw Error(X(160));lx(i,o,s),Ft=null,tr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){ft(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cx(e,t),e=e.sibling}function cx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zn(e,t),mr(t),r&4){try{Fa(3,t,t.return),qu(3,t)}catch(D){ft(t,t.return,D)}try{Fa(5,t,t.return)}catch(D){ft(t,t.return,D)}}break;case 1:Zn(e,t),mr(t),r&512&&n!==null&&fo(n,n.return);break;case 5:if(Zn(e,t),mr(t),r&512&&n!==null&&fo(n,n.return),t.flags&32){var s=t.stateNode;try{Ka(s,"")}catch(D){ft(t,t.return,D)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Pv(s,i),xh(c,o);var h=xh(c,i);for(o=0;o<u.length;o+=2){var m=u[o],g=u[o+1];m==="style"?Lv(s,g):m==="dangerouslySetInnerHTML"?Dv(s,g):m==="children"?Ka(s,g):Lf(s,m,g,h)}switch(c){case"input":ph(s,i);break;case"textarea":jv(s,i);break;case"select":var v=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var k=i.value;k!=null?go(s,!!i.multiple,k,!1):v!==!!i.multiple&&(i.defaultValue!=null?go(s,!!i.multiple,i.defaultValue,!0):go(s,!!i.multiple,i.multiple?[]:"",!1))}s[rl]=i}catch(D){ft(t,t.return,D)}}break;case 6:if(Zn(e,t),mr(t),r&4){if(t.stateNode===null)throw Error(X(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(D){ft(t,t.return,D)}}break;case 3:if(Zn(e,t),mr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ja(e.containerInfo)}catch(D){ft(t,t.return,D)}break;case 4:Zn(e,t),mr(t);break;case 13:Zn(e,t),mr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(mp=mt())),r&4&&wg(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(tn=(h=tn)||m,Zn(e,t),tn=h):Zn(e,t),mr(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!m&&t.mode&1)for(se=t,m=t.child;m!==null;){for(g=se=m;se!==null;){switch(v=se,k=v.child,v.tag){case 0:case 11:case 14:case 15:Fa(4,v,v.return);break;case 1:fo(v,v.return);var P=v.stateNode;if(typeof P.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(D){ft(r,n,D)}}break;case 5:fo(v,v.return);break;case 22:if(v.memoizedState!==null){bg(g);continue}}k!==null?(k.return=v,se=k):bg(g)}m=m.sibling}e:for(m=null,g=t;;){if(g.tag===5){if(m===null){m=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Mv("display",o))}catch(D){ft(t,t.return,D)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(D){ft(t,t.return,D)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Zn(e,t),mr(t),r&4&&wg(t);break;case 21:break;default:Zn(e,t),mr(t)}}function mr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ax(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ka(s,""),r.flags&=-33);var i=_g(t);Qh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=_g(t);Kh(t,c,o);break;default:throw Error(X(161))}}catch(u){ft(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cb(t,e,n){se=t,ux(t)}function ux(t,e,n){for(var r=(t.mode&1)!==0;se!==null;){var s=se,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||mc;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||tn;c=mc;var h=tn;if(mc=o,(tn=u)&&!h)for(se=s;se!==null;)o=se,u=o.child,o.tag===22&&o.memoizedState!==null?kg(s):u!==null?(u.return=o,se=u):kg(s);for(;i!==null;)se=i,ux(i),i=i.sibling;se=s,mc=c,tn=h}Eg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,se=i):Eg(t)}}function Eg(t){for(;se!==null;){var e=se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tn||qu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:er(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&og(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}og(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&Ja(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}tn||e.flags&512&&qh(e)}catch(v){ft(e,e.return,v)}}if(e===t){se=null;break}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}}function bg(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,se=n;break}se=e.return}}function kg(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qu(4,e)}catch(u){ft(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){ft(e,s,u)}}var i=e.return;try{qh(e)}catch(u){ft(e,i,u)}break;case 5:var o=e.return;try{qh(e)}catch(u){ft(e,o,u)}}}catch(u){ft(e,e.return,u)}if(e===t){se=null;break}var c=e.sibling;if(c!==null){c.return=e.return,se=c;break}se=e.return}}var ub=Math.ceil,du=ss.ReactCurrentDispatcher,fp=ss.ReactCurrentOwner,$n=ss.ReactCurrentBatchConfig,Re=0,jt=null,_t=null,Bt=0,An=0,po=Ks(0),Tt=0,cl=null,Ei=0,Ku=0,pp=0,za=null,mn=null,mp=0,Ro=1/0,Fr=null,hu=!1,Xh=null,Ds=null,gc=!1,Ss=null,fu=0,Ua=0,Yh=null,Dc=-1,Mc=0;function ln(){return Re&6?mt():Dc!==-1?Dc:Dc=mt()}function Ms(t){return t.mode&1?Re&2&&Bt!==0?Bt&-Bt:qE.transition!==null?(Mc===0&&(Mc=Kv()),Mc):(t=ze,t!==0||(t=window.event,t=t===void 0?16:t0(t.type)),t):1}function ir(t,e,n,r){if(50<Ua)throw Ua=0,Yh=null,Error(X(185));El(t,n,r),(!(Re&2)||t!==jt)&&(t===jt&&(!(Re&2)&&(Ku|=n),Tt===4&&_s(t,Bt)),xn(t,r),n===1&&Re===0&&!(e.mode&1)&&(Ro=mt()+500,Wu&&Qs()))}function xn(t,e){var n=t.callbackNode;q1(t,e);var r=Xc(t,t===jt?Bt:0);if(r===0)n!==null&&Rm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Rm(n),e===1)t.tag===0?GE(Ig.bind(null,t)):_0(Ig.bind(null,t)),$E(function(){!(Re&6)&&Qs()}),n=null;else{switch(Qv(r)){case 1:n=Uf;break;case 4:n=Gv;break;case 16:n=Qc;break;case 536870912:n=qv;break;default:n=Qc}n=vx(n,dx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dx(t,e){if(Dc=-1,Mc=0,Re&6)throw Error(X(327));var n=t.callbackNode;if(wo()&&t.callbackNode!==n)return null;var r=Xc(t,t===jt?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=pu(t,r);else{e=r;var s=Re;Re|=2;var i=fx();(jt!==t||Bt!==e)&&(Fr=null,Ro=mt()+500,pi(t,e));do try{fb();break}catch(c){hx(t,c)}while(!0);ep(),du.current=i,Re=s,_t!==null?e=0:(jt=null,Bt=0,e=Tt)}if(e!==0){if(e===2&&(s=kh(t),s!==0&&(r=s,e=Jh(t,s))),e===1)throw n=cl,pi(t,0),_s(t,r),xn(t,mt()),n;if(e===6)_s(t,r);else{if(s=t.current.alternate,!(r&30)&&!db(s)&&(e=pu(t,r),e===2&&(i=kh(t),i!==0&&(r=i,e=Jh(t,i))),e===1))throw n=cl,pi(t,0),_s(t,r),xn(t,mt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:li(t,mn,Fr);break;case 3:if(_s(t,r),(r&130023424)===r&&(e=mp+500-mt(),10<e)){if(Xc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=jh(li.bind(null,t,mn,Fr),e);break}li(t,mn,Fr);break;case 4:if(_s(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-sr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ub(r/1960))-r,10<r){t.timeoutHandle=jh(li.bind(null,t,mn,Fr),r);break}li(t,mn,Fr);break;case 5:li(t,mn,Fr);break;default:throw Error(X(329))}}}return xn(t,mt()),t.callbackNode===n?dx.bind(null,t):null}function Jh(t,e){var n=za;return t.current.memoizedState.isDehydrated&&(pi(t,e).flags|=256),t=pu(t,e),t!==2&&(e=mn,mn=n,e!==null&&Zh(e)),t}function Zh(t){mn===null?mn=t:mn.push.apply(mn,t)}function db(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!or(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _s(t,e){for(e&=~pp,e&=~Ku,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sr(e),r=1<<n;t[n]=-1,e&=~r}}function Ig(t){if(Re&6)throw Error(X(327));wo();var e=Xc(t,0);if(!(e&1))return xn(t,mt()),null;var n=pu(t,e);if(t.tag!==0&&n===2){var r=kh(t);r!==0&&(e=r,n=Jh(t,r))}if(n===1)throw n=cl,pi(t,0),_s(t,e),xn(t,mt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,li(t,mn,Fr),xn(t,mt()),null}function gp(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(Ro=mt()+500,Wu&&Qs())}}function bi(t){Ss!==null&&Ss.tag===0&&!(Re&6)&&wo();var e=Re;Re|=1;var n=$n.transition,r=ze;try{if($n.transition=null,ze=1,t)return t()}finally{ze=r,$n.transition=n,Re=e,!(Re&6)&&Qs()}}function yp(){An=po.current,st(po)}function pi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,UE(n)),_t!==null)for(n=_t.return;n!==null;){var r=n;switch(Yf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tu();break;case 3:Po(),st(yn),st(sn),op();break;case 5:ip(r);break;case 4:Po();break;case 13:st(ct);break;case 19:st(ct);break;case 10:tp(r.type._context);break;case 22:case 23:yp()}n=n.return}if(jt=t,_t=t=Ls(t.current,null),Bt=An=e,Tt=0,cl=null,pp=Ku=Ei=0,mn=za=null,di!==null){for(e=0;e<di.length;e++)if(n=di[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}di=null}return t}function hx(t,e){do{var n=_t;try{if(ep(),Pc.current=uu,cu){for(var r=ut.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cu=!1}if(wi=0,Pt=It=ut=null,Va=!1,ol=0,fp.current=null,n===null||n.return===null){Tt=1,cl=e,_t=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=Bt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,m=c,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var v=m.alternate;v?(m.updateQueue=v.updateQueue,m.memoizedState=v.memoizedState,m.lanes=v.lanes):(m.updateQueue=null,m.memoizedState=null)}var k=hg(o);if(k!==null){k.flags&=-257,fg(k,o,c,i,e),k.mode&1&&dg(i,h,e),e=k,u=h;var P=e.updateQueue;if(P===null){var D=new Set;D.add(u),e.updateQueue=D}else P.add(u);break e}else{if(!(e&1)){dg(i,h,e),vp();break e}u=Error(X(426))}}else if(it&&c.mode&1){var L=hg(o);if(L!==null){!(L.flags&65536)&&(L.flags|=256),fg(L,o,c,i,e),Jf(jo(u,c));break e}}i=u=jo(u,c),Tt!==4&&(Tt=2),za===null?za=[i]:za.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=Q0(i,u,e);ig(i,A);break e;case 1:c=u;var b=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Ds===null||!Ds.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=X0(i,c,e);ig(i,S);break e}}i=i.return}while(i!==null)}mx(n)}catch(z){e=z,_t===n&&n!==null&&(_t=n=n.return);continue}break}while(!0)}function fx(){var t=du.current;return du.current=uu,t===null?uu:t}function vp(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),jt===null||!(Ei&268435455)&&!(Ku&268435455)||_s(jt,Bt)}function pu(t,e){var n=Re;Re|=2;var r=fx();(jt!==t||Bt!==e)&&(Fr=null,pi(t,e));do try{hb();break}catch(s){hx(t,s)}while(!0);if(ep(),Re=n,du.current=r,_t!==null)throw Error(X(261));return jt=null,Bt=0,Tt}function hb(){for(;_t!==null;)px(_t)}function fb(){for(;_t!==null&&!V1();)px(_t)}function px(t){var e=yx(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?mx(t):_t=e,fp.current=null}function mx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ob(n,e),n!==null){n.flags&=32767,_t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,_t=null;return}}else if(n=ib(n,e,An),n!==null){_t=n;return}if(e=e.sibling,e!==null){_t=e;return}_t=e=t}while(e!==null);Tt===0&&(Tt=5)}function li(t,e,n){var r=ze,s=$n.transition;try{$n.transition=null,ze=1,pb(t,e,n,r)}finally{$n.transition=s,ze=r}return null}function pb(t,e,n,r){do wo();while(Ss!==null);if(Re&6)throw Error(X(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(K1(t,i),t===jt&&(_t=jt=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gc||(gc=!0,vx(Qc,function(){return wo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=$n.transition,$n.transition=null;var o=ze;ze=1;var c=Re;Re|=4,fp.current=null,lb(t,n),cx(n,t),DE(Ch),Yc=!!Ah,Ch=Ah=null,t.current=n,cb(n),F1(),Re=c,ze=o,$n.transition=i}else t.current=n;if(gc&&(gc=!1,Ss=t,fu=s),i=t.pendingLanes,i===0&&(Ds=null),$1(n.stateNode),xn(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(hu)throw hu=!1,t=Xh,Xh=null,t;return fu&1&&t.tag!==0&&wo(),i=t.pendingLanes,i&1?t===Yh?Ua++:(Ua=0,Yh=t):Ua=0,Qs(),null}function wo(){if(Ss!==null){var t=Qv(fu),e=$n.transition,n=ze;try{if($n.transition=null,ze=16>t?16:t,Ss===null)var r=!1;else{if(t=Ss,Ss=null,fu=0,Re&6)throw Error(X(331));var s=Re;for(Re|=4,se=t.current;se!==null;){var i=se,o=i.child;if(se.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var h=c[u];for(se=h;se!==null;){var m=se;switch(m.tag){case 0:case 11:case 15:Fa(8,m,i)}var g=m.child;if(g!==null)g.return=m,se=g;else for(;se!==null;){m=se;var v=m.sibling,k=m.return;if(ox(m),m===h){se=null;break}if(v!==null){v.return=k,se=v;break}se=k}}}var P=i.alternate;if(P!==null){var D=P.child;if(D!==null){P.child=null;do{var L=D.sibling;D.sibling=null,D=L}while(D!==null)}}se=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,se=o;else e:for(;se!==null;){if(i=se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Fa(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,se=A;break e}se=i.return}}var b=t.current;for(se=b;se!==null;){o=se;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,se=N;else e:for(o=b;se!==null;){if(c=se,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:qu(9,c)}}catch(z){ft(c,c.return,z)}if(c===o){se=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,se=S;break e}se=c.return}}if(Re=s,Qs(),Er&&typeof Er.onPostCommitFiberRoot=="function")try{Er.onPostCommitFiberRoot(Fu,t)}catch{}r=!0}return r}finally{ze=n,$n.transition=e}}return!1}function Tg(t,e,n){e=jo(n,e),e=Q0(t,e,1),t=Rs(t,e,1),e=ln(),t!==null&&(El(t,1,e),xn(t,e))}function ft(t,e,n){if(t.tag===3)Tg(t,t,n);else for(;e!==null;){if(e.tag===3){Tg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ds===null||!Ds.has(r))){t=jo(n,t),t=X0(e,t,1),e=Rs(e,t,1),t=ln(),e!==null&&(El(e,1,t),xn(e,t));break}}e=e.return}}function mb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,jt===t&&(Bt&n)===n&&(Tt===4||Tt===3&&(Bt&130023424)===Bt&&500>mt()-mp?pi(t,0):pp|=n),xn(t,e)}function gx(t,e){e===0&&(t.mode&1?(e=oc,oc<<=1,!(oc&130023424)&&(oc=4194304)):e=1);var n=ln();t=Xr(t,e),t!==null&&(El(t,e,n),xn(t,n))}function gb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gx(t,n)}function yb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),gx(t,n)}var yx;yx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)gn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gn=!1,sb(t,e,n);gn=!!(t.flags&131072)}else gn=!1,it&&e.flags&1048576&&w0(e,su,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rc(t,e),t=e.pendingProps;var s=No(e,sn.current);_o(e,n),s=lp(null,e,r,t,s,n);var i=cp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(i=!0,nu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,rp(e),s.updater=Gu,e.stateNode=s,s._reactInternals=e,Fh(e,r,t,n),e=$h(null,e,r,!0,i,n)):(e.tag=0,it&&i&&Xf(e),an(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=xb(r),t=er(r,t),s){case 0:e=Uh(null,e,r,t,n);break e;case 1:e=gg(null,e,r,t,n);break e;case 11:e=pg(null,e,r,t,n);break e;case 14:e=mg(null,e,r,er(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),Uh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),gg(t,e,r,s,n);case 3:e:{if(ex(e),t===null)throw Error(X(387));r=e.pendingProps,i=e.memoizedState,s=i.element,S0(t,e),au(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=jo(Error(X(423)),e),e=yg(t,e,r,n,s);break e}else if(r!==s){s=jo(Error(X(424)),e),e=yg(t,e,r,n,s);break e}else for(Cn=js(e.stateNode.containerInfo.firstChild),Pn=e,it=!0,nr=null,n=I0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ao(),r===s){e=Yr(t,e,n);break e}an(t,e,r,n)}e=e.child}return e;case 5:return N0(e),t===null&&Lh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ph(r,s)?o=null:i!==null&&Ph(r,i)&&(e.flags|=32),Z0(t,e),an(t,e,o,n),e.child;case 6:return t===null&&Lh(e),null;case 13:return tx(t,e,n);case 4:return sp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Co(e,null,r,n):an(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),pg(t,e,r,s,n);case 7:return an(t,e,e.pendingProps,n),e.child;case 8:return an(t,e,e.pendingProps.children,n),e.child;case 12:return an(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ye(iu,r._currentValue),r._currentValue=o,i!==null)if(or(i.value,o)){if(i.children===s.children&&!yn.current){e=Yr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Gr(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?u.next=u:(u.next=m.next,m.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Oh(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Oh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}an(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,_o(e,n),s=Bn(s),r=r(s),e.flags|=1,an(t,e,r,n),e.child;case 14:return r=e.type,s=er(r,e.pendingProps),s=er(r.type,s),mg(t,e,r,s,n);case 15:return Y0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:er(r,s),Rc(t,e),e.tag=1,vn(r)?(t=!0,nu(e)):t=!1,_o(e,n),K0(e,r,s),Fh(e,r,s,n),$h(null,e,r,!0,t,n);case 19:return nx(t,e,n);case 22:return J0(t,e,n)}throw Error(X(156,e.tag))};function vx(t,e){return Hv(t,e)}function vb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(t,e,n,r){return new vb(t,e,n,r)}function xp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xb(t){if(typeof t=="function")return xp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vf)return 11;if(t===Ff)return 14}return 2}function Ls(t,e){var n=t.alternate;return n===null?(n=Un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Lc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")xp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ro:return mi(n.children,s,i,e);case Of:o=8,s|=8;break;case ch:return t=Un(12,n,e,s|2),t.elementType=ch,t.lanes=i,t;case uh:return t=Un(13,n,e,s),t.elementType=uh,t.lanes=i,t;case dh:return t=Un(19,n,e,s),t.elementType=dh,t.lanes=i,t;case Nv:return Qu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tv:o=10;break e;case Sv:o=9;break e;case Vf:o=11;break e;case Ff:o=14;break e;case ys:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=Un(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function mi(t,e,n,r){return t=Un(7,t,r,e),t.lanes=n,t}function Qu(t,e,n,r){return t=Un(22,t,r,e),t.elementType=Nv,t.lanes=n,t.stateNode={isHidden:!1},t}function Hd(t,e,n){return t=Un(6,t,null,e),t.lanes=n,t}function Gd(t,e,n){return e=Un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _b(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Td(0),this.expirationTimes=Td(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Td(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _p(t,e,n,r,s,i,o,c,u){return t=new _b(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Un(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rp(i),t}function wb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function xx(t){if(!t)return $s;t=t._reactInternals;e:{if(Ci(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(vn(n))return x0(t,n,e)}return e}function _x(t,e,n,r,s,i,o,c,u){return t=_p(n,r,!0,t,s,i,o,c,u),t.context=xx(null),n=t.current,r=ln(),s=Ms(n),i=Gr(r,s),i.callback=e??null,Rs(n,i,s),t.current.lanes=s,El(t,s,r),xn(t,r),t}function Xu(t,e,n,r){var s=e.current,i=ln(),o=Ms(s);return n=xx(n),e.context===null?e.context=n:e.pendingContext=n,e=Gr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rs(s,e,o),t!==null&&(ir(t,s,o,i),Cc(t,s,o)),o}function mu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Sg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function wp(t,e){Sg(t,e),(t=t.alternate)&&Sg(t,e)}function Eb(){return null}var wx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ep(t){this._internalRoot=t}Yu.prototype.render=Ep.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));Xu(t,e,null,null)};Yu.prototype.unmount=Ep.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bi(function(){Xu(null,t,null,null)}),e[Qr]=null}};function Yu(t){this._internalRoot=t}Yu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Jv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<xs.length&&e!==0&&e<xs[n].priority;n++);xs.splice(n,0,t),n===0&&e0(t)}};function bp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ng(){}function bb(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=mu(o);i.call(h)}}var o=_x(e,r,t,0,null,!1,!1,"",Ng);return t._reactRootContainer=o,t[Qr]=o.current,tl(t.nodeType===8?t.parentNode:t),bi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=mu(u);c.call(h)}}var u=_p(t,0,!1,null,null,!1,!1,"",Ng);return t._reactRootContainer=u,t[Qr]=u.current,tl(t.nodeType===8?t.parentNode:t),bi(function(){Xu(e,u,n,r)}),u}function Zu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=mu(o);c.call(u)}}Xu(e,o,t,s)}else o=bb(n,e,t,s,r);return mu(o)}Xv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ka(e.pendingLanes);n!==0&&($f(e,n|1),xn(e,mt()),!(Re&6)&&(Ro=mt()+500,Qs()))}break;case 13:bi(function(){var r=Xr(t,1);if(r!==null){var s=ln();ir(r,t,1,s)}}),wp(t,1)}};Bf=function(t){if(t.tag===13){var e=Xr(t,134217728);if(e!==null){var n=ln();ir(e,t,134217728,n)}wp(t,134217728)}};Yv=function(t){if(t.tag===13){var e=Ms(t),n=Xr(t,e);if(n!==null){var r=ln();ir(n,t,e,r)}wp(t,e)}};Jv=function(){return ze};Zv=function(t,e){var n=ze;try{return ze=t,e()}finally{ze=n}};wh=function(t,e,n){switch(e){case"input":if(ph(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Bu(r);if(!s)throw Error(X(90));Cv(r),ph(r,s)}}}break;case"textarea":jv(t,n);break;case"select":e=n.value,e!=null&&go(t,!!n.multiple,e,!1)}};Fv=gp;zv=bi;var kb={usingClientEntryPoint:!1,Events:[kl,ao,Bu,Ov,Vv,gp]},_a={findFiberByHostInstance:ui,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ib={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Bv(t),t===null?null:t.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||Eb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{Fu=yc.inject(Ib),Er=yc}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kb;Rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bp(e))throw Error(X(200));return wb(t,e,null,n)};Rn.createRoot=function(t,e){if(!bp(t))throw Error(X(299));var n=!1,r="",s=wx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=_p(t,1,!1,null,null,n,!1,r,s),t[Qr]=e.current,tl(t.nodeType===8?t.parentNode:t),new Ep(e)};Rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=Bv(e),t=t===null?null:t.stateNode,t};Rn.flushSync=function(t){return bi(t)};Rn.hydrate=function(t,e,n){if(!Ju(e))throw Error(X(200));return Zu(null,t,e,!0,n)};Rn.hydrateRoot=function(t,e,n){if(!bp(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=wx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=_x(e,null,t,1,n??null,s,!1,i,o),t[Qr]=e.current,tl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Yu(e)};Rn.render=function(t,e,n){if(!Ju(e))throw Error(X(200));return Zu(null,t,e,!1,n)};Rn.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(X(40));return t._reactRootContainer?(bi(function(){Zu(null,null,t,!1,function(){t._reactRootContainer=null,t[Qr]=null})}),!0):!1};Rn.unstable_batchedUpdates=gp;Rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ju(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Zu(t,e,n,!1,r)};Rn.version="18.3.1-next-f1338f8080-20240426";function Ex(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ex)}catch(t){console.error(t)}}Ex(),Ev.exports=Rn;var Tb=Ev.exports,Ag=Tb;ah.createRoot=Ag.createRoot,ah.hydrateRoot=Ag.hydrateRoot;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Sb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),he=(t,e)=>{const n=H.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,...h},m)=>H.createElement("svg",{ref:m,...Sb,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Nb(t)}`,c].join(" "),...h},[...e.map(([g,v])=>H.createElement(g,v)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=he("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=he("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=he("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=he("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=he("ArrowUpToLine",[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=he("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=he("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=he("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=he("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=he("CircleDashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=he("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=he("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=he("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=he("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=he("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=he("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=he("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=he("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=he("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=he("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=he("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=he("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Px=he("Grip",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=he("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ip=he("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=he("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=he("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=he("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=he("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=he("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=he("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=he("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=he("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=he("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=he("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=he("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=he("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=he("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=he("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=he("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=he("StickyNote",[["path",{d:"M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z",key:"1wis1t"}],["path",{d:"M15 3v6h6",key:"edgan2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=he("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=he("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=he("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=he("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=he("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=he("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=he("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=he("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=he("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=he("Waypoints",[["circle",{cx:"12",cy:"4.5",r:"2.5",key:"r5ysbb"}],["path",{d:"m10.2 6.3-3.9 3.9",key:"1nzqf6"}],["circle",{cx:"4.5",cy:"12",r:"2.5",key:"jydg6v"}],["path",{d:"M7 12h10",key:"b7w52i"}],["circle",{cx:"19.5",cy:"12",r:"2.5",key:"1piiel"}],["path",{d:"m13.8 17.7 3.9-3.9",key:"1wyg1y"}],["circle",{cx:"12",cy:"19.5",r:"2.5",key:"13o1pw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=he("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=he("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=he("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/*! Capacitor: https://capacitorjs.com/ - MIT License */var Lo;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Lo||(Lo={}));class qd extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const qb=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Kb=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:qb(t),i=()=>s()!=="web",o=g=>{const v=h.get(g);return!!(v!=null&&v.platforms.has(s())||c(g))},c=g=>{var v;return(v=n.PluginHeaders)===null||v===void 0?void 0:v.find(k=>k.name===g)},u=g=>t.console.error(g),h=new Map,m=(g,v={})=>{const k=h.get(g);if(k)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),k.proxy;const P=s(),D=c(g);let L;const A=async()=>(!L&&P in v?L=typeof v[P]=="function"?L=await v[P]():L=v[P]:e!==null&&!L&&"web"in v&&(L=typeof v.web=="function"?L=await v.web():L=v.web),L),b=(x,E)=>{var I,R;if(D){const M=D==null?void 0:D.methods.find(C=>E===C.name);if(M)return M.rtype==="promise"?C=>n.nativePromise(g,E.toString(),C):(C,Je)=>n.nativeCallback(g,E.toString(),C,Je);if(x)return(I=x[E])===null||I===void 0?void 0:I.bind(x)}else{if(x)return(R=x[E])===null||R===void 0?void 0:R.bind(x);throw new qd(`"${g}" plugin is not implemented on ${P}`,Lo.Unimplemented)}},N=x=>{let E;const I=(...R)=>{const M=A().then(C=>{const Je=b(C,x);if(Je){const ce=Je(...R);return E=ce==null?void 0:ce.remove,ce}else throw new qd(`"${g}.${x}()" is not implemented on ${P}`,Lo.Unimplemented)});return x==="addListener"&&(M.remove=async()=>E()),M};return I.toString=()=>`${x.toString()}() { [capacitor code] }`,Object.defineProperty(I,"name",{value:x,writable:!1,configurable:!1}),I},S=N("addListener"),z=N("removeListener"),G=(x,E)=>{const I=S({eventName:x},E),R=async()=>{const C=await I;z({eventName:x,callbackId:C},E)},M=new Promise(C=>I.then(()=>C({remove:R})));return M.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await R()},M},T=new Proxy({},{get(x,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return D?G:S;case"removeListener":return z;default:return N(E)}}});return r[g]=T,h.set(g,{name:g,proxy:T,platforms:new Set([...Object.keys(v),...D?[P]:[]])}),T};return n.convertFileSrc||(n.convertFileSrc=g=>g),n.getPlatform=s,n.handleError=u,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=qd,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Qb=t=>t.Capacitor=Kb(t),of=Qb(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Sl=of.registerPlugin;class Np{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new of.Exception(e,Lo.Unimplemented)}unavailable(e="not available"){return new of.Exception(e,Lo.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const jg=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Rg=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Xb extends Np{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Rg(s).trim(),i=Rg(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=jg(e.key),r=jg(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Sl("CapacitorCookies",{web:()=>new Xb});const Yb=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),Jb=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},Zb=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let c,u;return Array.isArray(o)?(u="",o.forEach(h=>{c=e?encodeURIComponent(h):h,u+=`${i}=${c}&`}),u.slice(0,-1)):(c=e?encodeURIComponent(o):o,u=`${i}=${c}`),`${r}&${u}`},"").substr(1):null,ek=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=Jb(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,u)=>{i.append(u,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class tk extends Np{async request(e){const n=ek(e,e.webFetchExtra),r=Zb(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let u,h;switch(c){case"arraybuffer":case"blob":h=await i.blob(),u=await Yb(h);break;case"json":u=await i.json();break;case"document":case"text":default:u=await i.text()}const m={};return i.headers.forEach((g,v)=>{m[v]=g}),{data:u,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Sl("CapacitorHttp",{web:()=>new tk});var Dg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Dg||(Dg={}));var Mg;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})(Mg||(Mg={}));class nk extends Np{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Sl("SystemBars",{web:()=>new nk});var Lg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Lg||(Lg={}));var Og;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(Og||(Og={}));const rk=Sl("StatusBar"),sk="modulepreload",ik=function(t){return"/"+t},Vg={},ok=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=ik(u),u in Vg)return;Vg[u]=!0;const h=u.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":sk,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((v,k)=>{g.addEventListener("load",v),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},Fg=Sl("App",{web:()=>ok(()=>import("./web-7IE8aWlL.js"),[]).then(t=>new t.AppWeb)});var zg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ak=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Fx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,m=i>>2,g=(i&3)<<4|c>>4;let v=(c&15)<<2|h>>6,k=h&63;u||(k=64,o||(v=64)),r.push(n[m],n[g],n[v],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ak(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new lk;const v=i<<2|c>>4;if(r.push(v),h!==64){const k=c<<4&240|h>>2;if(r.push(k),g!==64){const P=h<<6&192|g;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class lk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ck=function(t){const e=Vx(t);return Fx.encodeByteArray(e,!0)},_u=function(t){return ck(t).replace(/\./g,"")},zx=function(t){try{return Fx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=()=>uk().__FIREBASE_DEFAULTS__,hk=()=>{if(typeof process>"u"||typeof zg>"u")return;const t=zg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},fk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zx(t[1]);return e&&JSON.parse(e)},ed=()=>{try{return dk()||hk()||fk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ux=t=>{var e,n;return(n=(e=ed())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},pk=t=>{const e=Ux(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$x=()=>{var t;return(t=ed())===null||t===void 0?void 0:t.config},Bx=t=>{var e;return(e=ed())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[_u(JSON.stringify(n)),_u(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(on())}function vk(){var t;const e=(t=ed())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function xk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _k(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function wk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ek(){const t=on();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function bk(){return!vk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kk(){try{return typeof indexedDB=="object"}catch{return!1}}function Ik(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk="FirebaseError";class is extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Tk,Object.setPrototypeOf(this,is.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nl.prototype.create)}}class Nl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Sk(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new is(s,c,r)}}function Sk(t,e){return t.replace(Nk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Nk=/\{\$([^}]+)}/g;function Ak(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Ug(i)&&Ug(o)){if(!wu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ug(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ck(t,e){const n=new Pk(t,e);return n.subscribe.bind(n)}class Pk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");jk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Kd),s.error===void 0&&(s.error=Kd),s.complete===void 0&&(s.complete=Kd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Kd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(t){return t&&t._delegate?t._delegate:t}class ki{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new mk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Mk(e))try{this.getOrInitializeService({instanceIdentifier:ci})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ci){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ci){return this.instances.has(e)}getOptions(e=ci){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Dk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ci){return this.component?this.component.multipleInstances?e:ci:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Dk(t){return t===ci?void 0:t}function Mk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Rk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ne||(Ne={}));const Ok={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},Vk=Ne.INFO,Fk={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},zk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Fk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ap{constructor(e){this.name=e,this._logLevel=Vk,this._logHandler=zk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ok[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const Uk=(t,e)=>e.some(n=>t instanceof n);let $g,Bg;function $k(){return $g||($g=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bk(){return Bg||(Bg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wx=new WeakMap,af=new WeakMap,Hx=new WeakMap,Qd=new WeakMap,Cp=new WeakMap;function Wk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Os(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Wx.set(n,t)}).catch(()=>{}),Cp.set(e,t),e}function Hk(t){if(af.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});af.set(t,e)}let lf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return af.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Hx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Os(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Gk(t){lf=t(lf)}function qk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xd(this),e,...n);return Hx.set(r,e.sort?e.sort():[e]),Os(r)}:Bk().includes(t)?function(...e){return t.apply(Xd(this),e),Os(Wx.get(this))}:function(...e){return Os(t.apply(Xd(this),e))}}function Kk(t){return typeof t=="function"?qk(t):(t instanceof IDBTransaction&&Hk(t),Uk(t,$k())?new Proxy(t,lf):t)}function Os(t){if(t instanceof IDBRequest)return Wk(t);if(Qd.has(t))return Qd.get(t);const e=Kk(t);return e!==t&&(Qd.set(t,e),Cp.set(e,t)),e}const Xd=t=>Cp.get(t);function Qk(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Os(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Os(o.result),u.oldVersion,u.newVersion,Os(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Xk=["get","getKey","getAll","getAllKeys","count"],Yk=["put","add","delete","clear"],Yd=new Map;function Wg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Yd.get(e))return Yd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Yk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Xk.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),s&&u.done]))[0]};return Yd.set(e,i),i}Gk(t=>({...t,get:(e,n,r)=>Wg(e,n)||t.get(e,n,r),has:(e,n)=>!!Wg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Zk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Zk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cf="@firebase/app",Hg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Ap("@firebase/app"),eI="@firebase/app-compat",tI="@firebase/analytics-compat",nI="@firebase/analytics",rI="@firebase/app-check-compat",sI="@firebase/app-check",iI="@firebase/auth",oI="@firebase/auth-compat",aI="@firebase/database",lI="@firebase/data-connect",cI="@firebase/database-compat",uI="@firebase/functions",dI="@firebase/functions-compat",hI="@firebase/installations",fI="@firebase/installations-compat",pI="@firebase/messaging",mI="@firebase/messaging-compat",gI="@firebase/performance",yI="@firebase/performance-compat",vI="@firebase/remote-config",xI="@firebase/remote-config-compat",_I="@firebase/storage",wI="@firebase/storage-compat",EI="@firebase/firestore",bI="@firebase/vertexai-preview",kI="@firebase/firestore-compat",II="firebase",TI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf="[DEFAULT]",SI={[cf]:"fire-core",[eI]:"fire-core-compat",[nI]:"fire-analytics",[tI]:"fire-analytics-compat",[sI]:"fire-app-check",[rI]:"fire-app-check-compat",[iI]:"fire-auth",[oI]:"fire-auth-compat",[aI]:"fire-rtdb",[lI]:"fire-data-connect",[cI]:"fire-rtdb-compat",[uI]:"fire-fn",[dI]:"fire-fn-compat",[hI]:"fire-iid",[fI]:"fire-iid-compat",[pI]:"fire-fcm",[mI]:"fire-fcm-compat",[gI]:"fire-perf",[yI]:"fire-perf-compat",[vI]:"fire-rc",[xI]:"fire-rc-compat",[_I]:"fire-gcs",[wI]:"fire-gcs-compat",[EI]:"fire-fst",[kI]:"fire-fst-compat",[bI]:"fire-vertex","fire-js":"fire-js",[II]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new Map,NI=new Map,df=new Map;function Gg(t,e){try{t.container.addComponent(e)}catch(n){Jr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Oo(t){const e=t.name;if(df.has(e))return Jr.debug(`There were multiple attempts to register component ${e}.`),!1;df.set(e,t);for(const n of ul.values())Gg(n,t);for(const n of NI.values())Gg(n,t);return!0}function Pp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function xr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vs=new Nl("app","Firebase",AI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ki("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=TI;function Gx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:uf,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Vs.create("bad-app-name",{appName:String(s)});if(n||(n=$x()),!n)throw Vs.create("no-options");const i=ul.get(s);if(i){if(wu(n,i.options)&&wu(r,i.config))return i;throw Vs.create("duplicate-app",{appName:s})}const o=new Lk(s);for(const u of df.values())o.addComponent(u);const c=new CI(n,r,o);return ul.set(s,c),c}function jp(t=uf){const e=ul.get(t);if(!e&&t===uf&&$x())return Gx();if(!e)throw Vs.create("no-app",{appName:t});return e}function PI(){return Array.from(ul.values())}function Fs(t,e,n){var r;let s=(r=SI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jr.warn(c.join(" "));return}Oo(new ki(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI="firebase-heartbeat-database",RI=1,dl="firebase-heartbeat-store";let Jd=null;function qx(){return Jd||(Jd=Qk(jI,RI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(dl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vs.create("idb-open",{originalErrorMessage:t.message})})),Jd}async function DI(t){try{const n=(await qx()).transaction(dl),r=await n.objectStore(dl).get(Kx(t));return await n.done,r}catch(e){if(e instanceof is)Jr.warn(e.message);else{const n=Vs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jr.warn(n.message)}}}async function qg(t,e){try{const r=(await qx()).transaction(dl,"readwrite");await r.objectStore(dl).put(e,Kx(t)),await r.done}catch(n){if(n instanceof is)Jr.warn(n.message);else{const r=Vs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jr.warn(r.message)}}}function Kx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=1024,LI=30*24*60*60*1e3;class OI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new FI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Kg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=LI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Jr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Kg(),{heartbeatsToSend:r,unsentEntries:s}=VI(this._heartbeatsCache.heartbeats),i=_u(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Jr.warn(n),""}}}function Kg(){return new Date().toISOString().substring(0,10)}function VI(t,e=MI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Qg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Qg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class FI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kk()?Ik().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await DI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qg(t){return _u(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t){Oo(new ki("platform-logger",e=>new Jk(e),"PRIVATE")),Oo(new ki("heartbeat",e=>new OI(e),"PRIVATE")),Fs(cf,Hg,t),Fs(cf,Hg,"esm2017"),Fs("fire-js","")}zI("");var UI="firebase",$I="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fs(UI,$I,"app");function Rp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Qx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BI=Qx,Xx=new Nl("auth","Firebase",Qx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu=new Ap("@firebase/auth");function WI(t,...e){Eu.logLevel<=Ne.WARN&&Eu.warn(`Auth (${Qo}): ${t}`,...e)}function Oc(t,...e){Eu.logLevel<=Ne.ERROR&&Eu.error(`Auth (${Qo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,...e){throw Dp(t,...e)}function kr(t,...e){return Dp(t,...e)}function Yx(t,e,n){const r=Object.assign(Object.assign({},BI()),{[e]:n});return new Nl("auth","Firebase",r).create(e,{appName:t.name})}function qr(t){return Yx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Xx.create(t,...e)}function ye(t,e,...n){if(!t)throw Dp(e,...n)}function Br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Oc(e),new Error(e)}function es(t,e){t||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function HI(){return Xg()==="http:"||Xg()==="https:"}function Xg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HI()||_k()||"connection"in navigator)?navigator.onLine:!0}function qI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,n){this.shortDelay=e,this.longDelay=n,es(n>e,"Short delay should be less than long delay!"),this.isMobile=yk()||wk()}get(){return GI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(t,e){es(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI=new Cl(3e4,6e4);function Pl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xo(t,e,n,r,s={}){return Zx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=Al(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},i);return xk()||(h.referrerPolicy="no-referrer"),Jx.fetch()(e_(t,t.config.apiHost,n,c),h)})}async function Zx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},KI),e);try{const s=new XI(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw vc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw vc(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw vc(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw vc(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Yx(t,m,h);Zr(t,m)}}catch(s){if(s instanceof is)throw s;Zr(t,"network-request-failed",{message:String(s)})}}async function Lp(t,e,n,r,s={}){const i=await Xo(t,e,n,r,s);return"mfaPendingCredential"in i&&Zr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function e_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Mp(t.config,s):`${t.config.apiScheme}://${s}`}class XI{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kr(this.auth,"network-request-failed")),QI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function vc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=kr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YI(t,e){return Xo(t,"POST","/v1/accounts:delete",e)}async function t_(t,e){return Xo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JI(t,e=!1){const n=wn(t),r=await n.getIdToken(e),s=Op(r);ye(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:$a(Zd(s.auth_time)),issuedAtTime:$a(Zd(s.iat)),expirationTime:$a(Zd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Zd(t){return Number(t)*1e3}function Op(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Oc("JWT malformed, contained fewer than 3 sections"),null;try{const s=zx(n);return s?JSON.parse(s):(Oc("Failed to decode base64 JWT payload"),null)}catch(s){return Oc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Yg(t){const e=Op(t);return ye(e,"internal-error"),ye(typeof e.exp<"u","internal-error"),ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof is&&ZI(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ZI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=$a(this.lastLoginAt),this.creationTime=$a(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await hl(t,t_(n,{idToken:r}));ye(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?n_(i.providerUserInfo):[],c=nT(t.providerData,o),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),m=u?h:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new ff(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function tT(t){const e=wn(t);await bu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nT(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function n_(t){return t.map(e=>{var{providerId:n}=e,r=Rp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rT(t,e){const n=await Zx(t,{},async()=>{const r=Al({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=e_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Jx.fetch()(o,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sT(t,e){return Xo(t,"POST","/v2/accounts:revokeToken",Pl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ye(e.idToken,"internal-error"),ye(typeof e.idToken<"u","internal-error"),ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ye(e.length!==0,"internal-error");const n=Yg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await rT(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new bo;return r&&(ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ye(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ye(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bo,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(t,e){ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Rp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new eT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ff(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await hl(this,this.stsTokenManager.getToken(this.auth,e));return ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return JI(this,e)}reload(){return tT(this)}_assign(e){this!==e&&(ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Wr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xr(this.auth.app))return Promise.reject(qr(this.auth));const e=await this.getIdToken();return await hl(this,YI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,c,u,h,m;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,v=(s=n.email)!==null&&s!==void 0?s:void 0,k=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,P=(o=n.photoURL)!==null&&o!==void 0?o:void 0,D=(c=n.tenantId)!==null&&c!==void 0?c:void 0,L=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,A=(h=n.createdAt)!==null&&h!==void 0?h:void 0,b=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:N,emailVerified:S,isAnonymous:z,providerData:G,stsTokenManager:T}=n;ye(N&&T,e,"internal-error");const x=bo.fromJSON(this.name,T);ye(typeof N=="string",e,"internal-error"),gs(g,e.name),gs(v,e.name),ye(typeof S=="boolean",e,"internal-error"),ye(typeof z=="boolean",e,"internal-error"),gs(k,e.name),gs(P,e.name),gs(D,e.name),gs(L,e.name),gs(A,e.name),gs(b,e.name);const E=new Wr({uid:N,auth:e,email:v,emailVerified:S,displayName:g,isAnonymous:z,photoURL:P,phoneNumber:k,tenantId:D,stsTokenManager:x,createdAt:A,lastLoginAt:b});return G&&Array.isArray(G)&&(E.providerData=G.map(I=>Object.assign({},I))),L&&(E._redirectEventId=L),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new bo;s.updateFromServerResponse(n);const i=new Wr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await bu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ye(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?n_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new bo;c.updateFromIdToken(r);const u=new Wr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ff(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg=new Map;function Hr(t){es(t instanceof Function,"Expected a class definition");let e=Jg.get(t);return e?(es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}r_.type="NONE";const Zg=r_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e,n){return`firebase:${t}:${e}:${n}`}class ko{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ko(Hr(Zg),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Hr(Zg);const o=Vc(r,e.config.apiKey,e.name);let c=null;for(const h of n)try{const m=await h._get(o);if(m){const g=Wr._fromJSON(e,m);h!==i&&(c=g),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ko(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new ko(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(a_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(s_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(c_(e))return"Blackberry";if(u_(e))return"Webos";if(i_(e))return"Safari";if((e.includes("chrome/")||o_(e))&&!e.includes("edge/"))return"Chrome";if(l_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function s_(t=on()){return/firefox\//i.test(t)}function i_(t=on()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function o_(t=on()){return/crios\//i.test(t)}function a_(t=on()){return/iemobile/i.test(t)}function l_(t=on()){return/android/i.test(t)}function c_(t=on()){return/blackberry/i.test(t)}function u_(t=on()){return/webos/i.test(t)}function Vp(t=on()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iT(t=on()){var e;return Vp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oT(){return Ek()&&document.documentMode===10}function d_(t=on()){return Vp(t)||l_(t)||u_(t)||c_(t)||/windows phone/i.test(t)||a_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(t,e=[]){let n;switch(t){case"Browser":n=ey(on());break;case"Worker":n=`${ey(on())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Qo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lT(t,e={}){return Xo(t,"GET","/v2/passwordPolicy",Pl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=6;class uT{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:cT,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ty(this),this.idTokenSubscription=new ty(this),this.beforeStateQueue=new aT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ko.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await t_(this,{idToken:e}),r=await Wr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(xr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xr(this.app))return Promise.reject(qr(this));const n=e?wn(e):null;return n&&ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xr(this.app)?Promise.reject(qr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xr(this.app)?Promise.reject(qr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lT(this),n=new uT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Nl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sT(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hr(e)||this._popupRedirectResolver;ye(n,this,"argument-error"),this.redirectPersistenceManager=await ko.create(this,[Hr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ye(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=h_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&WI(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function jl(t){return wn(t)}class ty{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ck(n=>this.observer=n)}get next(){return ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hT(t){Fp=t}function fT(t){return Fp.loadJS(t)}function pT(){return Fp.gapiScript}function mT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t,e){const n=Pp(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(wu(i,e??{}))return s;Zr(s,"already-initialized")}return n.initialize({options:e})}function yT(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function vT(t,e,n){const r=jl(t);ye(r._canInitEmulator,r,"emulator-config-failed"),ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=f_(e),{host:o,port:c}=xT(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),_T()}function f_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xT(t){const e=f_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ny(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:ny(o)}}}function ny(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _T(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,n){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t,e){return Lp(t,"POST","/v1/accounts:signInWithIdp",Pl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="http://localhost";class Ii extends p_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ii(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Rp(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ii(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Io(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Io(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Io(e,n)}buildRequest(){const e={requestUri:wT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Al(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends m_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Rl{constructor(){super("facebook.com")}static credential(e){return Ii._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.FACEBOOK_SIGN_IN_METHOD="facebook.com";ws.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Rl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ii._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Es.credential(n,r)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends Rl{constructor(){super("github.com")}static credential(e){return Ii._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bs.credential(e.oauthAccessToken)}catch{return null}}}bs.GITHUB_SIGN_IN_METHOD="github.com";bs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Rl{constructor(){super("twitter.com")}static credential(e,n){return Ii._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ks.credential(n,r)}catch{return null}}}ks.TWITTER_SIGN_IN_METHOD="twitter.com";ks.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ET(t,e){return Lp(t,"POST","/v1/accounts:signUp",Pl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Wr._fromIdTokenResponse(e,r,s),o=ry(r);return new ts({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ry(r);return new ts({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ry(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bT(t){var e;if(xr(t.app))return Promise.reject(qr(t));const n=jl(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new ts({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ET(n,{returnSecureToken:!0}),s=await ts._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends is{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ku.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ku(e,n,r,s)}}function g_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ku._fromErrorAndOperation(t,i,e,r):i})}async function kT(t,e,n=!1){const r=await hl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ts._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IT(t,e,n=!1){const{auth:r}=t;if(xr(r.app))return Promise.reject(qr(r));const s="reauthenticate";try{const i=await hl(t,g_(r,s,e,t),n);ye(i.idToken,r,"internal-error");const o=Op(i.idToken);ye(o,r,"internal-error");const{sub:c}=o;return ye(t.uid===c,r,"user-mismatch"),ts._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Zr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TT(t,e,n=!1){if(xr(t.app))return Promise.reject(qr(t));const r="signIn",s=await g_(t,r,e),i=await ts._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e){return Lp(t,"POST","/v1/accounts:signInWithCustomToken",Pl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NT(t,e){if(xr(t.app))return Promise.reject(qr(t));const n=jl(t),r=await ST(n,{token:e,returnSecureToken:!0}),s=await ts._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}function AT(t,e,n,r){return wn(t).onIdTokenChanged(e,n,r)}function CT(t,e,n){return wn(t).beforeAuthStateChanged(e,n)}function PT(t,e,n,r){return wn(t).onAuthStateChanged(e,n,r)}const Iu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Iu,"1"),this.storage.removeItem(Iu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT=1e3,RT=10;class v_ extends y_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=d_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);oT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,RT):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},jT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}v_.type="LOCAL";const DT=v_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_ extends y_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}x_.type="SESSION";const __=x_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new td(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async h=>h(n.origin,i)),u=await MT(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=zp("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const v=g;if(v.data.eventId===h)switch(v.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(v.data.response);break;default:clearTimeout(m),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(){return window}function OT(t){Ir().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(){return typeof Ir().WorkerGlobalScope<"u"&&typeof Ir().importScripts=="function"}async function VT(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FT(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function zT(){return w_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_="firebaseLocalStorageDb",UT=1,Tu="firebaseLocalStorage",b_="fbase_key";class Dl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nd(t,e){return t.transaction([Tu],e?"readwrite":"readonly").objectStore(Tu)}function $T(){const t=indexedDB.deleteDatabase(E_);return new Dl(t).toPromise()}function pf(){const t=indexedDB.open(E_,UT);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Tu,{keyPath:b_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Tu)?e(r):(r.close(),await $T(),e(await pf()))})})}async function sy(t,e,n){const r=nd(t,!0).put({[b_]:e,value:n});return new Dl(r).toPromise()}async function BT(t,e){const n=nd(t,!1).get(e),r=await new Dl(n).toPromise();return r===void 0?null:r.value}function iy(t,e){const n=nd(t,!0).delete(e);return new Dl(n).toPromise()}const WT=800,HT=3;class k_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>HT)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return w_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance(zT()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await VT(),!this.activeServiceWorker)return;this.sender=new LT(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pf();return await sy(e,Iu,"1"),await iy(e,Iu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>sy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>BT(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=nd(s,!1).getAll();return new Dl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k_.type="LOCAL";const GT=k_;new Cl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(t,e){return e?Hr(e):(ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up extends p_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Io(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Io(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Io(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function KT(t){return TT(t.auth,new Up(t),t.bypassAuthState)}function QT(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),IT(n,new Up(t),t.bypassAuthState)}async function XT(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),kT(n,new Up(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KT;case"linkViaPopup":case"linkViaRedirect":return XT;case"reauthViaPopup":case"reauthViaRedirect":return QT;default:Zr(this.auth,"internal-error")}}resolve(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT=new Cl(2e3,1e4);class mo extends I_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,mo.currentPopupAction&&mo.currentPopupAction.cancel(),mo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ye(e,this.auth,"internal-error"),e}async onExecution(){es(this.filter.length===1,"Popup operations only handle one event");const e=zp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(kr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,mo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YT.get())};e()}}mo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="pendingRedirect",Fc=new Map;class ZT extends I_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fc.get(this.auth._key());if(!e){try{const r=await e2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fc.set(this.auth._key(),e)}return this.bypassAuthState||Fc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e2(t,e){const n=r2(e),r=n2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function t2(t,e){Fc.set(t._key(),e)}function n2(t){return Hr(t._redirectPersistence)}function r2(t){return Vc(JT,t.config.apiKey,t.name)}async function s2(t,e,n=!1){if(xr(t.app))return Promise.reject(qr(t));const r=jl(t),s=qT(r,e),o=await new ZT(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=10*60*1e3;class o2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!a2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!T_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(kr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i2&&this.cachedEventUids.clear(),this.cachedEventUids.has(oy(e))}saveEventToCache(e){this.cachedEventUids.add(oy(e)),this.lastProcessedEventTime=Date.now()}}function oy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function T_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function a2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return T_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l2(t,e={}){return Xo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u2=/^https?/;async function d2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await l2(t);for(const n of e)try{if(h2(n))return}catch{}Zr(t,"unauthorized-domain")}function h2(t){const e=hf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!u2.test(n))return!1;if(c2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=new Cl(3e4,6e4);function ay(){const t=Ir().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function p2(t){return new Promise((e,n)=>{var r,s,i;function o(){ay(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ay(),n(kr(t,"network-request-failed"))},timeout:f2.get()})}if(!((s=(r=Ir().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ir().gapi)===null||i===void 0)&&i.load)o();else{const c=mT("iframefcb");return Ir()[c]=()=>{gapi.load?o():n(kr(t,"network-request-failed"))},fT(`${pT()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw zc=null,e})}let zc=null;function m2(t){return zc=zc||p2(t),zc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=new Cl(5e3,15e3),y2="__/auth/iframe",v2="emulator/auth/iframe",x2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w2(t){const e=t.config;ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Mp(e,v2):`https://${t.config.authDomain}/${y2}`,r={apiKey:e.apiKey,appName:t.name,v:Qo},s=_2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Al(r).slice(1)}`}async function E2(t){const e=await m2(t),n=Ir().gapi;return ye(n,t,"internal-error"),e.open({where:document.body,url:w2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=kr(t,"network-request-failed"),c=Ir().setTimeout(()=>{i(o)},g2.get());function u(){Ir().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k2=500,I2=600,T2="_blank",S2="http://localhost";class ly{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N2(t,e,n,r=k2,s=I2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},b2),{width:r.toString(),height:s.toString(),top:i,left:o}),h=on().toLowerCase();n&&(c=o_(h)?T2:n),s_(h)&&(e=e||S2,u.scrollbars="yes");const m=Object.entries(u).reduce((v,[k,P])=>`${v}${k}=${P},`,"");if(iT(h)&&c!=="_self")return A2(e||"",c),new ly(null);const g=window.open(e||"",c,m);ye(g,t,"popup-blocked");try{g.focus()}catch{}return new ly(g)}function A2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="__/auth/handler",P2="emulator/auth/handler",j2=encodeURIComponent("fac");async function cy(t,e,n,r,s,i){ye(t.config.authDomain,t,"auth-domain-config-required"),ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Qo,eventId:s};if(e instanceof m_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ak(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))o[m]=g}if(e instanceof Rl){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),h=u?`#${j2}=${encodeURIComponent(u)}`:"";return`${R2(t)}?${Al(c).slice(1)}${h}`}function R2({config:t}){return t.emulator?Mp(t,P2):`https://${t.authDomain}/${C2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh="webStorageSupport";class D2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=__,this._completeRedirectFn=s2,this._overrideRedirectResult=t2}async _openPopup(e,n,r,s){var i;es((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await cy(e,n,r,hf(),s);return N2(e,o,zp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cy(e,n,r,hf(),s);return OT(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(es(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await E2(e),r=new o2(e);return n.register("authEvent",s=>(ye(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(eh,{type:eh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[eh];o!==void 0&&n(!!o),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=d2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return d_()||i_()||Vp()}}const M2=D2;var uy="@firebase/auth",dy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function V2(t){Oo(new ki("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:h_(t)},h=new dT(r,s,i,u);return yT(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Oo(new ki("auth-internal",e=>{const n=jl(e.getProvider("auth").getImmediate());return(r=>new L2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(uy,dy,O2(t)),Fs(uy,dy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2=5*60,z2=Bx("authIdTokenMaxAge")||F2;let hy=null;const U2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>z2)return;const s=n==null?void 0:n.token;hy!==s&&(hy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function $2(t=jp()){const e=Pp(t,"auth");if(e.isInitialized())return e.getImmediate();const n=gT(t,{popupRedirectResolver:M2,persistence:[GT,DT,__]}),r=Bx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=U2(i.toString());CT(n,o,()=>o(n.currentUser)),AT(n,c=>o(c))}}const s=Ux("auth");return s&&vT(n,`http://${s}`),n}function B2(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}hT({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=kr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",B2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});V2("Browser");var fy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gi,S_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,x){function E(){}E.prototype=x.prototype,T.D=x.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function(I,R,M){for(var C=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)C[Je-2]=arguments[Je];return x.prototype[R].apply(I,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,x,E){E||(E=0);var I=Array(16);if(typeof x=="string")for(var R=0;16>R;++R)I[R]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(R=0;16>R;++R)I[R]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=T.g[0],E=T.g[1],R=T.g[2];var M=T.g[3],C=x+(M^E&(R^M))+I[0]+3614090360&4294967295;x=E+(C<<7&4294967295|C>>>25),C=M+(R^x&(E^R))+I[1]+3905402710&4294967295,M=x+(C<<12&4294967295|C>>>20),C=R+(E^M&(x^E))+I[2]+606105819&4294967295,R=M+(C<<17&4294967295|C>>>15),C=E+(x^R&(M^x))+I[3]+3250441966&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(M^E&(R^M))+I[4]+4118548399&4294967295,x=E+(C<<7&4294967295|C>>>25),C=M+(R^x&(E^R))+I[5]+1200080426&4294967295,M=x+(C<<12&4294967295|C>>>20),C=R+(E^M&(x^E))+I[6]+2821735955&4294967295,R=M+(C<<17&4294967295|C>>>15),C=E+(x^R&(M^x))+I[7]+4249261313&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(M^E&(R^M))+I[8]+1770035416&4294967295,x=E+(C<<7&4294967295|C>>>25),C=M+(R^x&(E^R))+I[9]+2336552879&4294967295,M=x+(C<<12&4294967295|C>>>20),C=R+(E^M&(x^E))+I[10]+4294925233&4294967295,R=M+(C<<17&4294967295|C>>>15),C=E+(x^R&(M^x))+I[11]+2304563134&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(M^E&(R^M))+I[12]+1804603682&4294967295,x=E+(C<<7&4294967295|C>>>25),C=M+(R^x&(E^R))+I[13]+4254626195&4294967295,M=x+(C<<12&4294967295|C>>>20),C=R+(E^M&(x^E))+I[14]+2792965006&4294967295,R=M+(C<<17&4294967295|C>>>15),C=E+(x^R&(M^x))+I[15]+1236535329&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(R^M&(E^R))+I[1]+4129170786&4294967295,x=E+(C<<5&4294967295|C>>>27),C=M+(E^R&(x^E))+I[6]+3225465664&4294967295,M=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(M^x))+I[11]+643717713&4294967295,R=M+(C<<14&4294967295|C>>>18),C=E+(M^x&(R^M))+I[0]+3921069994&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^M&(E^R))+I[5]+3593408605&4294967295,x=E+(C<<5&4294967295|C>>>27),C=M+(E^R&(x^E))+I[10]+38016083&4294967295,M=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(M^x))+I[15]+3634488961&4294967295,R=M+(C<<14&4294967295|C>>>18),C=E+(M^x&(R^M))+I[4]+3889429448&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^M&(E^R))+I[9]+568446438&4294967295,x=E+(C<<5&4294967295|C>>>27),C=M+(E^R&(x^E))+I[14]+3275163606&4294967295,M=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(M^x))+I[3]+4107603335&4294967295,R=M+(C<<14&4294967295|C>>>18),C=E+(M^x&(R^M))+I[8]+1163531501&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^M&(E^R))+I[13]+2850285829&4294967295,x=E+(C<<5&4294967295|C>>>27),C=M+(E^R&(x^E))+I[2]+4243563512&4294967295,M=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(M^x))+I[7]+1735328473&4294967295,R=M+(C<<14&4294967295|C>>>18),C=E+(M^x&(R^M))+I[12]+2368359562&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(E^R^M)+I[5]+4294588738&4294967295,x=E+(C<<4&4294967295|C>>>28),C=M+(x^E^R)+I[8]+2272392833&4294967295,M=x+(C<<11&4294967295|C>>>21),C=R+(M^x^E)+I[11]+1839030562&4294967295,R=M+(C<<16&4294967295|C>>>16),C=E+(R^M^x)+I[14]+4259657740&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^M)+I[1]+2763975236&4294967295,x=E+(C<<4&4294967295|C>>>28),C=M+(x^E^R)+I[4]+1272893353&4294967295,M=x+(C<<11&4294967295|C>>>21),C=R+(M^x^E)+I[7]+4139469664&4294967295,R=M+(C<<16&4294967295|C>>>16),C=E+(R^M^x)+I[10]+3200236656&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^M)+I[13]+681279174&4294967295,x=E+(C<<4&4294967295|C>>>28),C=M+(x^E^R)+I[0]+3936430074&4294967295,M=x+(C<<11&4294967295|C>>>21),C=R+(M^x^E)+I[3]+3572445317&4294967295,R=M+(C<<16&4294967295|C>>>16),C=E+(R^M^x)+I[6]+76029189&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^M)+I[9]+3654602809&4294967295,x=E+(C<<4&4294967295|C>>>28),C=M+(x^E^R)+I[12]+3873151461&4294967295,M=x+(C<<11&4294967295|C>>>21),C=R+(M^x^E)+I[15]+530742520&4294967295,R=M+(C<<16&4294967295|C>>>16),C=E+(R^M^x)+I[2]+3299628645&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(R^(E|~M))+I[0]+4096336452&4294967295,x=E+(C<<6&4294967295|C>>>26),C=M+(E^(x|~R))+I[7]+1126891415&4294967295,M=x+(C<<10&4294967295|C>>>22),C=R+(x^(M|~E))+I[14]+2878612391&4294967295,R=M+(C<<15&4294967295|C>>>17),C=E+(M^(R|~x))+I[5]+4237533241&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~M))+I[12]+1700485571&4294967295,x=E+(C<<6&4294967295|C>>>26),C=M+(E^(x|~R))+I[3]+2399980690&4294967295,M=x+(C<<10&4294967295|C>>>22),C=R+(x^(M|~E))+I[10]+4293915773&4294967295,R=M+(C<<15&4294967295|C>>>17),C=E+(M^(R|~x))+I[1]+2240044497&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~M))+I[8]+1873313359&4294967295,x=E+(C<<6&4294967295|C>>>26),C=M+(E^(x|~R))+I[15]+4264355552&4294967295,M=x+(C<<10&4294967295|C>>>22),C=R+(x^(M|~E))+I[6]+2734768916&4294967295,R=M+(C<<15&4294967295|C>>>17),C=E+(M^(R|~x))+I[13]+1309151649&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~M))+I[4]+4149444226&4294967295,x=E+(C<<6&4294967295|C>>>26),C=M+(E^(x|~R))+I[11]+3174756917&4294967295,M=x+(C<<10&4294967295|C>>>22),C=R+(x^(M|~E))+I[2]+718787259&4294967295,R=M+(C<<15&4294967295|C>>>17),C=E+(M^(R|~x))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+x&4294967295,T.g[1]=T.g[1]+(R+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+R&4294967295,T.g[3]=T.g[3]+M&4294967295}r.prototype.u=function(T,x){x===void 0&&(x=T.length);for(var E=x-this.blockSize,I=this.B,R=this.h,M=0;M<x;){if(R==0)for(;M<=E;)s(this,T,M),M+=this.blockSize;if(typeof T=="string"){for(;M<x;)if(I[R++]=T.charCodeAt(M++),R==this.blockSize){s(this,I),R=0;break}}else for(;M<x;)if(I[R++]=T[M++],R==this.blockSize){s(this,I),R=0;break}}this.h=R,this.o+=x},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var x=1;x<T.length-8;++x)T[x]=0;var E=8*this.o;for(x=T.length-8;x<T.length;++x)T[x]=E&255,E/=256;for(this.u(T),T=Array(16),x=E=0;4>x;++x)for(var I=0;32>I;I+=8)T[E++]=this.g[x]>>>I&255;return T};function i(T,x){var E=c;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=x(T)}function o(T,x){this.h=x;for(var E=[],I=!0,R=T.length-1;0<=R;R--){var M=T[R]|0;I&&M==x||(E[R]=M,I=!1)}this.g=E}var c={};function u(T){return-128<=T&&128>T?i(T,function(x){return new o([x|0],0>x?-1:0)}):new o([T|0],0>T?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return g;if(0>T)return L(h(-T));for(var x=[],E=1,I=0;T>=E;I++)x[I]=T/E|0,E*=4294967296;return new o(x,0)}function m(T,x){if(T.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(T.charAt(0)=="-")return L(m(T.substring(1),x));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=h(Math.pow(x,8)),I=g,R=0;R<T.length;R+=8){var M=Math.min(8,T.length-R),C=parseInt(T.substring(R,R+M),x);8>M?(M=h(Math.pow(x,M)),I=I.j(M).add(h(C))):(I=I.j(E),I=I.add(h(C)))}return I}var g=u(0),v=u(1),k=u(16777216);t=o.prototype,t.m=function(){if(D(this))return-L(this).m();for(var T=0,x=1,E=0;E<this.g.length;E++){var I=this.i(E);T+=(0<=I?I:4294967296+I)*x,x*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(P(this))return"0";if(D(this))return"-"+L(this).toString(T);for(var x=h(Math.pow(T,6)),E=this,I="";;){var R=S(E,x).g;E=A(E,R.j(x));var M=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=R,P(E))return M+I;for(;6>M.length;)M="0"+M;I=M+I}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function P(T){if(T.h!=0)return!1;for(var x=0;x<T.g.length;x++)if(T.g[x]!=0)return!1;return!0}function D(T){return T.h==-1}t.l=function(T){return T=A(this,T),D(T)?-1:P(T)?0:1};function L(T){for(var x=T.g.length,E=[],I=0;I<x;I++)E[I]=~T.g[I];return new o(E,~T.h).add(v)}t.abs=function(){return D(this)?L(this):this},t.add=function(T){for(var x=Math.max(this.g.length,T.g.length),E=[],I=0,R=0;R<=x;R++){var M=I+(this.i(R)&65535)+(T.i(R)&65535),C=(M>>>16)+(this.i(R)>>>16)+(T.i(R)>>>16);I=C>>>16,M&=65535,C&=65535,E[R]=C<<16|M}return new o(E,E[E.length-1]&-2147483648?-1:0)};function A(T,x){return T.add(L(x))}t.j=function(T){if(P(this)||P(T))return g;if(D(this))return D(T)?L(this).j(L(T)):L(L(this).j(T));if(D(T))return L(this.j(L(T)));if(0>this.l(k)&&0>T.l(k))return h(this.m()*T.m());for(var x=this.g.length+T.g.length,E=[],I=0;I<2*x;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<T.g.length;R++){var M=this.i(I)>>>16,C=this.i(I)&65535,Je=T.i(R)>>>16,ce=T.i(R)&65535;E[2*I+2*R]+=C*ce,b(E,2*I+2*R),E[2*I+2*R+1]+=M*ce,b(E,2*I+2*R+1),E[2*I+2*R+1]+=C*Je,b(E,2*I+2*R+1),E[2*I+2*R+2]+=M*Je,b(E,2*I+2*R+2)}for(I=0;I<x;I++)E[I]=E[2*I+1]<<16|E[2*I];for(I=x;I<2*x;I++)E[I]=0;return new o(E,0)};function b(T,x){for(;(T[x]&65535)!=T[x];)T[x+1]+=T[x]>>>16,T[x]&=65535,x++}function N(T,x){this.g=T,this.h=x}function S(T,x){if(P(x))throw Error("division by zero");if(P(T))return new N(g,g);if(D(T))return x=S(L(T),x),new N(L(x.g),L(x.h));if(D(x))return x=S(T,L(x)),new N(L(x.g),x.h);if(30<T.g.length){if(D(T)||D(x))throw Error("slowDivide_ only works with positive integers.");for(var E=v,I=x;0>=I.l(T);)E=z(E),I=z(I);var R=G(E,1),M=G(I,1);for(I=G(I,2),E=G(E,2);!P(I);){var C=M.add(I);0>=C.l(T)&&(R=R.add(E),M=C),I=G(I,1),E=G(E,1)}return x=A(T,R.j(x)),new N(R,x)}for(R=g;0<=T.l(x);){for(E=Math.max(1,Math.floor(T.m()/x.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),M=h(E),C=M.j(x);D(C)||0<C.l(T);)E-=I,M=h(E),C=M.j(x);P(M)&&(M=v),R=R.add(M),T=A(T,C)}return new N(R,T)}t.A=function(T){return S(this,T).h},t.and=function(T){for(var x=Math.max(this.g.length,T.g.length),E=[],I=0;I<x;I++)E[I]=this.i(I)&T.i(I);return new o(E,this.h&T.h)},t.or=function(T){for(var x=Math.max(this.g.length,T.g.length),E=[],I=0;I<x;I++)E[I]=this.i(I)|T.i(I);return new o(E,this.h|T.h)},t.xor=function(T){for(var x=Math.max(this.g.length,T.g.length),E=[],I=0;I<x;I++)E[I]=this.i(I)^T.i(I);return new o(E,this.h^T.h)};function z(T){for(var x=T.g.length+1,E=[],I=0;I<x;I++)E[I]=T.i(I)<<1|T.i(I-1)>>>31;return new o(E,T.h)}function G(T,x){var E=x>>5;x%=32;for(var I=T.g.length-E,R=[],M=0;M<I;M++)R[M]=0<x?T.i(M+E)>>>x|T.i(M+E+1)<<32-x:T.i(M+E);return new o(R,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,S_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,gi=o}).apply(typeof fy<"u"?fy:typeof self<"u"?self:typeof window<"u"?window:{});var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var N_,Sa,A_,Uc,mf,C_,P_,j_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,p){return l==Array.prototype||l==Object.prototype||(l[d]=p.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof xc=="object"&&xc];for(var d=0;d<l.length;++d){var p=l[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,d){if(d)e:{var p=r;l=l.split(".");for(var _=0;_<l.length-1;_++){var V=l[_];if(!(V in p))break e;p=p[V]}l=l[l.length-1],_=p[l],d=d(_),d!=_&&d!=null&&e(p,l,{configurable:!0,writable:!0,value:d})}}function i(l,d){l instanceof String&&(l+="");var p=0,_=!1,V={next:function(){if(!_&&p<l.length){var $=p++;return{value:d($,l[$]),done:!1}}return _=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(l){return l||function(){return i(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function h(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function m(l,d,p){return l.call.apply(l.bind,arguments)}function g(l,d,p){if(!l)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,_),l.apply(d,V)}}return function(){return l.apply(d,arguments)}}function v(l,d,p){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,v.apply(null,arguments)}function k(l,d){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function P(l,d){function p(){}p.prototype=d.prototype,l.aa=d.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(_,V,$){for(var te=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)te[qe-2]=arguments[qe];return d.prototype[V].apply(_,te)}}function D(l){const d=l.length;if(0<d){const p=Array(d);for(let _=0;_<d;_++)p[_]=l[_];return p}return[]}function L(l,d){for(let p=1;p<arguments.length;p++){const _=arguments[p];if(u(_)){const V=l.length||0,$=_.length||0;l.length=V+$;for(let te=0;te<$;te++)l[V+te]=_[te]}else l.push(_)}}class A{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function b(l){return/^[\s\xa0]*$/.test(l)}function N(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function S(l){return S[" "](l),l}S[" "]=function(){};var z=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function G(l,d,p){for(const _ in l)d.call(p,l[_],_,l)}function T(l,d){for(const p in l)d.call(void 0,l[p],p,l)}function x(l){const d={};for(const p in l)d[p]=l[p];return d}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(l,d){let p,_;for(let V=1;V<arguments.length;V++){_=arguments[V];for(p in _)l[p]=_[p];for(let $=0;$<E.length;$++)p=E[$],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function R(l){var d=1;l=l.split(":");const p=[];for(;0<d&&l.length;)p.push(l.shift()),d--;return l.length&&p.push(l.join(":")),p}function M(l){c.setTimeout(()=>{throw l},0)}function C(){var l=fe;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class Je{constructor(){this.h=this.g=null}add(d,p){const _=ce.get();_.set(d,p),this.h?this.h.next=_:this.g=_,this.h=_}}var ce=new A(()=>new ne,l=>l.reset());class ne{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,Z=!1,fe=new Je,ue=()=>{const l=c.Promise.resolve(void 0);Oe=()=>{l.then(Ie)}};var Ie=()=>{for(var l;l=C();){try{l.h.call(l.g)}catch(p){M(p)}var d=ce;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}Z=!1};function je(){this.s=this.s,this.C=this.C}je.prototype.s=!1,je.prototype.ma=function(){this.s||(this.s=!0,this.N())},je.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function We(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}We.prototype.h=function(){this.defaultPrevented=!0};var Rt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};c.addEventListener("test",p,d),c.removeEventListener("test",p,d)}catch{}return l}();function gt(l,d){if(We.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(z){e:{try{S(d.nodeName);var V=!0;break e}catch{}V=!1}V||(d=null)}}else p=="mouseover"?d=l.fromElement:p=="mouseout"&&(d=l.toElement);this.relatedTarget=d,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:lr[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&gt.aa.h.call(this)}}P(gt,We);var lr={2:"touch",3:"pen",4:"mouse"};gt.prototype.h=function(){gt.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Dt="closure_listenable_"+(1e6*Math.random()|0),$l=0;function Cr(l,d,p,_,V){this.listener=l,this.proxy=null,this.src=d,this.type=p,this.capture=!!_,this.ha=V,this.key=++$l,this.da=this.fa=!1}function os(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Pr(l){this.src=l,this.g={},this.h=0}Pr.prototype.add=function(l,d,p,_,V){var $=l.toString();l=this.g[$],l||(l=this.g[$]=[],this.h++);var te=jr(l,d,_,V);return-1<te?(d=l[te],p||(d.fa=!1)):(d=new Cr(d,this.src,$,!!_,V),d.fa=p,l.push(d)),d};function Ri(l,d){var p=d.type;if(p in l.g){var _=l.g[p],V=Array.prototype.indexOf.call(_,d,void 0),$;($=0<=V)&&Array.prototype.splice.call(_,V,1),$&&(os(d),l.g[p].length==0&&(delete l.g[p],l.h--))}}function jr(l,d,p,_){for(var V=0;V<l.length;++V){var $=l[V];if(!$.da&&$.listener==d&&$.capture==!!p&&$.ha==_)return V}return-1}var as="closure_lm_"+(1e6*Math.random()|0),Rr={};function dn(l,d,p,_,V){if(Array.isArray(d)){for(var $=0;$<d.length;$++)dn(l,d[$],p,_,V);return null}return p=re(p),l&&l[Dt]?l.K(d,p,h(_)?!!_.capture:!1,V):Bl(l,d,p,!1,_,V)}function Bl(l,d,p,_,V,$){if(!d)throw Error("Invalid event type");var te=h(V)?!!V.capture:!!V,qe=Dr(l);if(qe||(l[as]=qe=new Pr(l)),p=qe.add(d,p,_,te,$),p.proxy)return p;if(_=Di(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)Rt||(V=te),V===void 0&&(V=!1),l.addEventListener(d.toString(),_,V);else if(l.attachEvent)l.attachEvent(bn(d.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Di(){function l(p){return d.call(l.src,l.listener,p)}const d=na;return l}function En(l,d,p,_,V){if(Array.isArray(d))for(var $=0;$<d.length;$++)En(l,d[$],p,_,V);else _=h(_)?!!_.capture:!!_,p=re(p),l&&l[Dt]?(l=l.i,d=String(d).toString(),d in l.g&&($=l.g[d],p=jr($,p,_,V),-1<p&&(os($[p]),Array.prototype.splice.call($,p,1),$.length==0&&(delete l.g[d],l.h--)))):l&&(l=Dr(l))&&(d=l.g[d.toString()],l=-1,d&&(l=jr(d,p,_,V)),(p=-1<l?d[l]:null)&&Mi(p))}function Mi(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[Dt])Ri(d.i,l);else{var p=l.type,_=l.proxy;d.removeEventListener?d.removeEventListener(p,_,l.capture):d.detachEvent?d.detachEvent(bn(p),_):d.addListener&&d.removeListener&&d.removeListener(_),(p=Dr(d))?(Ri(p,l),p.h==0&&(p.src=null,d[as]=null)):os(l)}}}function bn(l){return l in Rr?Rr[l]:Rr[l]="on"+l}function na(l,d){if(l.da)l=!0;else{d=new gt(d,this);var p=l.listener,_=l.ha||l.src;l.fa&&Mi(l),l=p.call(_,d)}return l}function Dr(l){return l=l[as],l instanceof Pr?l:null}var Xs="__closure_events_fn_"+(1e9*Math.random()>>>0);function re(l){return typeof l=="function"?l:(l[Xs]||(l[Xs]=function(d){return l.handleEvent(d)}),l[Xs])}function Ze(){je.call(this),this.i=new Pr(this),this.M=this,this.F=null}P(Ze,je),Ze.prototype[Dt]=!0,Ze.prototype.removeEventListener=function(l,d,p,_){En(this,l,d,p,_)};function me(l,d){var p,_=l.F;if(_)for(p=[];_;_=_.F)p.push(_);if(l=l.M,_=d.type||d,typeof d=="string")d=new We(d,l);else if(d instanceof We)d.target=d.target||l;else{var V=d;d=new We(_,l),I(d,V)}if(V=!0,p)for(var $=p.length-1;0<=$;$--){var te=d.g=p[$];V=kn(te,_,!0,d)&&V}if(te=d.g=l,V=kn(te,_,!0,d)&&V,V=kn(te,_,!1,d)&&V,p)for($=0;$<p.length;$++)te=d.g=p[$],V=kn(te,_,!1,d)&&V}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var p=l.g[d],_=0;_<p.length;_++)os(p[_]);delete l.g[d],l.h--}}this.F=null},Ze.prototype.K=function(l,d,p,_){return this.i.add(String(l),d,!1,p,_)},Ze.prototype.L=function(l,d,p,_){return this.i.add(String(l),d,!0,p,_)};function kn(l,d,p,_){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var V=!0,$=0;$<d.length;++$){var te=d[$];if(te&&!te.da&&te.capture==p){var qe=te.listener,Vt=te.ha||te.src;te.fa&&Ri(l.i,te),V=qe.call(Vt,_)!==!1&&V}}return V&&!_.defaultPrevented}function we(l,d,p){if(typeof l=="function")p&&(l=v(l,p));else if(l&&typeof l.handleEvent=="function")l=v(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(l,d||0)}function cr(l){l.g=we(()=>{l.g=null,l.i&&(l.i=!1,cr(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class ls extends je{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:cr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cs(l){je.call(this),this.h=l,this.g={}}P(cs,je);var ur=[];function Li(l){G(l.g,function(d,p){this.g.hasOwnProperty(p)&&Mi(d)},l),l.g={}}cs.prototype.N=function(){cs.aa.N.call(this),Li(this)},cs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=c.JSON.stringify,Ys=c.JSON.parse,Mn=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function ot(){}ot.prototype.h=null;function In(l){return l.h||(l.h=l.i())}function Hn(){}var us={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function dr(){We.call(this,"d")}P(dr,We);function Oi(){We.call(this,"c")}P(Oi,We);var hr={},pe=null;function $e(){return pe=pe||new Ze}hr.La="serverreachability";function Tn(l){We.call(this,hr.La,l)}P(Tn,We);function Mt(l){const d=$e();me(d,new Tn(d))}hr.STAT_EVENT="statevent";function Ln(l,d){We.call(this,hr.STAT_EVENT,l),this.stat=d}P(Ln,We);function Be(l){const d=$e();me(d,new Ln(d,l))}hr.Ma="timingevent";function fr(l,d){We.call(this,hr.Ma,l),this.size=d}P(fr,We);function Mr(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},d)}function Ke(){this.g=!0}Ke.prototype.xa=function(){this.g=!1};function ds(l,d,p,_,V,$){l.info(function(){if(l.g)if($)for(var te="",qe=$.split("&"),Vt=0;Vt<qe.length;Vt++){var Me=qe[Vt].split("=");if(1<Me.length){var Qt=Me[0];Me=Me[1];var Xt=Qt.split("_");te=2<=Xt.length&&Xt[1]=="type"?te+(Qt+"="+Me+"&"):te+(Qt+"=redacted&")}}else te=null;else te=$;return"XMLHTTP REQ ("+_+") [attempt "+V+"]: "+d+`
`+p+`
`+te})}function Lr(l,d,p,_,V,$,te){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+V+"]: "+d+`
`+p+`
`+$+" "+te})}function hs(l,d,p,_){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+pd(l,p)+(_?" "+_:"")})}function Vi(l,d){l.info(function(){return"TIMEOUT: "+d})}Ke.prototype.info=function(){};function pd(l,d){if(!l.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var _=p[l];if(!(2>_.length)){var V=_[1];if(Array.isArray(V)&&!(1>V.length)){var $=V[0];if($!="noop"&&$!="stop"&&$!="close")for(var te=1;te<V.length;te++)V[te]=""}}}}return qt(p)}catch{return d}}var Gn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ra={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Js;function fs(){}P(fs,ot),fs.prototype.g=function(){return new XMLHttpRequest},fs.prototype.i=function(){return{}},Js=new fs;function On(l,d,p,_){this.j=l,this.i=d,this.l=p,this.R=_||1,this.U=new cs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fi}function Fi(){this.i=null,this.g="",this.h=!1}var qn={},sa={};function Zs(l,d,p){l.L=1,l.v=qi(Qn(d)),l.m=p,l.P=!0,zi(l,null)}function zi(l,d){l.F=Date.now(),De(l),l.A=Qn(l.v);var p=l.A,_=l.R;Array.isArray(_)||(_=[String(_)]),Yl(p.i,"t",_),l.C=0,p=l.j.J,l.h=new Fi,l.g=kt(l.j,p?d:null,!l.m),0<l.O&&(l.M=new ls(v(l.Y,l,l.g),l.O)),d=l.U,p=l.g,_=l.ca;var V="readystatechange";Array.isArray(V)||(V&&(ur[0]=V.toString()),V=ur);for(var $=0;$<V.length;$++){var te=dn(p,V[$],_||d.handleEvent,!1,d.h||d);if(!te)break;d.g[te.key]=te}d=l.H?x(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),Mt(),ds(l.i,l.u,l.A,l.l,l.R,l.m)}On.prototype.ca=function(l){l=l.target;const d=this.M;d&&B(l)==3?d.j():this.Y(l)},On.prototype.Y=function(l){try{if(l==this.g)e:{const Xt=B(this.g);var d=this.g.Ba();const Yi=this.g.Z();if(!(3>Xt)&&(Xt!=3||this.g&&(this.h.h||this.g.oa()||J(this.g)))){this.J||Xt!=4||d==7||(d==8||0>=Yi?Mt(3):Mt(2)),Hl(this);var p=this.g.Z();this.X=p;t:if(ia(this)){var _=J(this.g);l="";var V=_.length,$=B(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Sn(this),Ui(this);var te="";break t}this.h.i=new c.TextDecoder}for(d=0;d<V;d++)this.h.h=!0,l+=this.h.i.decode(_[d],{stream:!($&&d==V-1)});_.length=0,this.h.g+=l,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=p==200,Lr(this.i,this.u,this.A,this.l,this.R,Xt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,Vt=this.g;if((qe=Vt.g?Vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(qe)){var Me=qe;break t}}Me=null}if(p=Me)hs(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,hn(this,p);else{this.o=!1,this.s=3,Be(12),Sn(this),Ui(this);break e}}if(this.P){p=!0;let Jn;for(;!this.J&&this.C<te.length;)if(Jn=Wl(this,te),Jn==sa){Xt==4&&(this.s=4,Be(14),p=!1),hs(this.i,this.l,null,"[Incomplete Response]");break}else if(Jn==qn){this.s=4,Be(15),hs(this.i,this.l,te,"[Invalid Chunk]"),p=!1;break}else hs(this.i,this.l,Jn,null),hn(this,Jn);if(ia(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xt!=4||te.length!=0||this.h.h||(this.s=1,Be(16),p=!1),this.o=this.o&&p,!p)hs(this.i,this.l,te,"[Invalid Chunked Response]"),Sn(this),Ui(this);else if(0<te.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),lt(Qt),Qt.M=!0,Be(11))}}else hs(this.i,this.l,te,null),hn(this,te);Xt==4&&Sn(this),this.o&&!this.J&&(Xt==4?tt(this.j,this):(this.o=!1,De(this)))}else ee(this.g),p==400&&0<te.indexOf("Unknown SID")?(this.s=3,Be(12)):(this.s=0,Be(13)),Sn(this),Ui(this)}}}catch{}finally{}};function ia(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Wl(l,d){var p=l.C,_=d.indexOf(`
`,p);return _==-1?sa:(p=Number(d.substring(p,_)),isNaN(p)?qn:(_+=1,_+p>d.length?sa:(d=d.slice(_,_+p),l.C=_+p,d)))}On.prototype.cancel=function(){this.J=!0,Sn(this)};function De(l){l.S=Date.now()+l.I,Lt(l,l.I)}function Lt(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Mr(v(l.ba,l),d)}function Hl(l){l.B&&(c.clearTimeout(l.B),l.B=null)}On.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Vi(this.i,this.A),this.L!=2&&(Mt(),Be(17)),Sn(this),this.s=2,Ui(this)):Lt(this,this.S-l)};function Ui(l){l.j.G==0||l.J||tt(l.j,l)}function Sn(l){Hl(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,Li(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function hn(l,d){try{var p=l.j;if(p.G!=0&&(p.g==l||Bi(p.h,l))){if(!l.K&&Bi(p.h,l)&&p.G==3){try{var _=p.Da.g.parse(d)}catch{_=null}if(Array.isArray(_)&&_.length==3){var V=_;if(V[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Fe(p),Ee(p);else break e;yt(p),Be(18)}}else p.za=V[1],0<p.za-p.T&&37500>V[2]&&p.F&&p.v==0&&!p.C&&(p.C=Mr(v(p.Za,p),6e3));if(1>=oa(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else vt(p,11)}else if((l.K||p.g==l)&&Fe(p),!b(d))for(V=p.Da.g.parse(d),d=0;d<V.length;d++){let Me=V[d];if(p.T=Me[0],Me=Me[1],p.G==2)if(Me[0]=="c"){p.K=Me[1],p.ia=Me[2];const Qt=Me[3];Qt!=null&&(p.la=Qt,p.j.info("VER="+p.la));const Xt=Me[4];Xt!=null&&(p.Aa=Xt,p.j.info("SVER="+p.Aa));const Yi=Me[5];Yi!=null&&typeof Yi=="number"&&0<Yi&&(_=1.5*Yi,p.L=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const Jn=l.g;if(Jn){const ec=Jn.g?Jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var $=_.h;$.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(ti($,$.h),$.h=null))}if(_.D){const _d=Jn.g?Jn.g.getResponseHeader("X-HTTP-Session-Id"):null;_d&&(_.ya=_d,He(_.I,_.D,_d))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),_=p;var te=l;if(_.qa=Nt(_,_.J?_.ia:null,_.W),te.K){Ot(_.h,te);var qe=te,Vt=_.L;Vt&&(qe.I=Vt),qe.B&&(Hl(qe),De(qe)),_.g=te}else ge(_);0<p.i.length&&Ae(p)}else Me[0]!="stop"&&Me[0]!="close"||vt(p,7);else p.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?vt(p,7):be(p):Me[0]!="noop"&&p.l&&p.l.ta(Me),p.v=0)}}Mt(4)}catch{}}var ei=class{constructor(l,d){this.g=l,this.map=d}};function Or(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $i(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function oa(l){return l.h?1:l.g?l.g.size:0}function Bi(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function ti(l,d){l.g?l.g.add(d):l.h=d}function Ot(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}Or.prototype.cancel=function(){if(this.i=Kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Kn(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const p of l.g.values())d=d.concat(p.D);return d}return D(l.i)}function md(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var d=[],p=l.length,_=0;_<p;_++)d.push(l[_]);return d}d=[],p=0;for(_ in l)d[p++]=l[_];return d}function Vr(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var d=[];l=l.length;for(var p=0;p<l;p++)d.push(p);return d}d=[],p=0;for(const _ in l)d[p++]=_;return d}}}function Wi(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var p=Vr(l),_=md(l),V=_.length,$=0;$<V;$++)d.call(void 0,_[$],p&&p[$],l)}var Nn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gl(l,d){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var _=l[p].indexOf("="),V=null;if(0<=_){var $=l[p].substring(0,_);V=l[p].substring(_+1)}else $=l[p];d($,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Et(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Et){this.h=l.h,Hi(this,l.j),this.o=l.o,this.g=l.g,Gi(this,l.s),this.l=l.l;var d=l.i,p=new si;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),ql(this,p),this.m=l.m}else l&&(d=String(l).match(Nn))?(this.h=!1,Hi(this,d[1]||"",!0),this.o=ni(d[2]||""),this.g=ni(d[3]||"",!0),Gi(this,d[4]),this.l=ni(d[5]||"",!0),ql(this,d[6]||"",!0),this.m=ni(d[7]||"")):(this.h=!1,this.i=new si(null,this.h))}Et.prototype.toString=function(){var l=[],d=this.j;d&&l.push(ri(d,Kl,!0),":");var p=this.g;return(p||d=="file")&&(l.push("//"),(d=this.o)&&l.push(ri(d,Kl,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(ri(p,p.charAt(0)=="/"?yd:Ql,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",ri(p,aa)),l.join("")};function Qn(l){return new Et(l)}function Hi(l,d,p){l.j=p?ni(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function Gi(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function ql(l,d,p){d instanceof si?(l.i=d,Jl(l.i,l.h)):(p||(d=ri(d,Xl)),l.i=new si(d,l.h))}function He(l,d,p){l.i.set(d,p)}function qi(l){return He(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ni(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ri(l,d,p){return typeof l=="string"?(l=encodeURI(l).replace(d,gd),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function gd(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Kl=/[#\/\?@]/g,Ql=/[#\?:]/g,yd=/[#\?]/g,Xl=/[#\?@]/g,aa=/#/g;function si(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function Xn(l){l.g||(l.g=new Map,l.h=0,l.i&&Gl(l.i,function(d,p){l.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}t=si.prototype,t.add=function(l,d){Xn(this),this.i=null,l=ps(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(d),this.h+=1,this};function la(l,d){Xn(l),d=ps(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function ca(l,d){return Xn(l),d=ps(l,d),l.g.has(d)}t.forEach=function(l,d){Xn(this),this.g.forEach(function(p,_){p.forEach(function(V){l.call(d,V,_,this)},this)},this)},t.na=function(){Xn(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let _=0;_<d.length;_++){const V=l[_];for(let $=0;$<V.length;$++)p.push(d[_])}return p},t.V=function(l){Xn(this);let d=[];if(typeof l=="string")ca(this,l)&&(d=d.concat(this.g.get(ps(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)d=d.concat(l[p])}return d},t.set=function(l,d){return Xn(this),this.i=null,l=ps(this,l),ca(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function Yl(l,d,p){la(l,d),0<p.length&&(l.i=null,l.g.set(ps(l,d),D(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var _=d[p];const $=encodeURIComponent(String(_)),te=this.V(_);for(_=0;_<te.length;_++){var V=$;te[_]!==""&&(V+="="+encodeURIComponent(String(te[_]))),l.push(V)}}return this.i=l.join("&")};function ps(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function Jl(l,d){d&&!l.j&&(Xn(l),l.i=null,l.g.forEach(function(p,_){var V=_.toLowerCase();_!=V&&(la(this,_),Yl(this,V,p))},l)),l.j=d}function ua(l,d){const p=new Ke;if(c.Image){const _=new Image;_.onload=k(pr,p,"TestLoadImage: loaded",!0,d,_),_.onerror=k(pr,p,"TestLoadImage: error",!1,d,_),_.onabort=k(pr,p,"TestLoadImage: abort",!1,d,_),_.ontimeout=k(pr,p,"TestLoadImage: timeout",!1,d,_),c.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else d(!1)}function Zl(l,d){const p=new Ke,_=new AbortController,V=setTimeout(()=>{_.abort(),pr(p,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:_.signal}).then($=>{clearTimeout(V),$.ok?pr(p,"TestPingServer: ok",!0,d):pr(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(V),pr(p,"TestPingServer: error",!1,d)})}function pr(l,d,p,_,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),_(p)}catch{}}function vd(){this.g=new Mn}function xd(l,d,p){const _=p||"";try{Wi(l,function(V,$){let te=V;h(V)&&(te=qt(V)),d.push(_+$+"="+encodeURIComponent(te))})}catch(V){throw d.push(_+"type="+encodeURIComponent("_badmap")),V}}function Ki(l){this.l=l.Ub||null,this.j=l.eb||!1}P(Ki,ot),Ki.prototype.g=function(){return new Qi(this.l,this.j)},Ki.prototype.i=function(l){return function(){return l}}({});function Qi(l,d){Ze.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Qi,Ze),t=Qi.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,at(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qe(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,at(this)),this.g&&(this.readyState=3,at(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ge(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ge(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?Qe(this):at(this),this.readyState==3&&Ge(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Qe(this))},t.Qa=function(l){this.g&&(this.response=l,Qe(this))},t.ga=function(){this.g&&Qe(this)};function Qe(l){l.readyState=4,l.l=null,l.j=null,l.v=null,at(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=d.next();return l.join(`\r
`)};function at(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Qi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function da(l){let d="";return G(l,function(p,_){d+=_,d+=":",d+=p,d+=`\r
`}),d}function f(l,d,p){e:{for(_ in p){var _=!1;break e}_=!0}_||(p=da(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):He(l,d,p))}function y(l){Ze.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(y,Ze);var w=/^https?$/i,j=["POST","PUT"];t=y.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Js.g(),this.v=this.o?In(this.o):In(Js),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch($){F(this,$);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var V in _)p.set(V,_[V]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const $ of _.keys())p.set($,_.get($));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find($=>$.toLowerCase()=="content-type"),V=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(j,d,void 0))||_||V||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,te]of p)this.g.setRequestHeader($,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Q(this),this.u=!0,this.g.send(l),this.u=!1}catch($){F(this,$)}};function F(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,O(l),U(l)}function O(l){l.A||(l.A=!0,me(l,"complete"),me(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,me(this,"complete"),me(this,"abort"),U(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),U(this,!0)),y.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?W(this):this.bb())},t.bb=function(){W(this)};function W(l){if(l.h&&typeof o<"u"&&(!l.v[1]||B(l)!=4||l.Z()!=2)){if(l.u&&B(l)==4)we(l.Ea,0,l);else if(me(l,"readystatechange"),B(l)==4){l.h=!1;try{const te=l.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var _;if(_=te===0){var V=String(l.D).match(Nn)[1]||null;!V&&c.self&&c.self.location&&(V=c.self.location.protocol.slice(0,-1)),_=!w.test(V?V.toLowerCase():"")}p=_}if(p)me(l,"complete"),me(l,"success");else{l.m=6;try{var $=2<B(l)?l.g.statusText:""}catch{$=""}l.l=$+" ["+l.Z()+"]",O(l)}}finally{U(l)}}}}function U(l,d){if(l.g){Q(l);const p=l.g,_=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||me(l,"ready");try{p.onreadystatechange=_}catch{}}}function Q(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function B(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<B(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),Ys(d)}};function J(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function ee(l){const d={};l=(l.g&&2<=B(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(b(l[_]))continue;var p=R(l[_]);const V=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const $=d[V]||[];d[V]=$,$.push(p)}T(d,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ie(l,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||d}function Y(l){this.Aa=0,this.i=[],this.j=new Ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ie("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ie("baseRetryDelayMs",5e3,l),this.cb=ie("retryDelaySeedMs",1e4,l),this.Wa=ie("forwardChannelMaxRetries",2,l),this.wa=ie("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Or(l&&l.concurrentRequestLimit),this.Da=new vd,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Y.prototype,t.la=8,t.G=1,t.connect=function(l,d,p,_){Be(0),this.W=l,this.H=d||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.I=Nt(this,null,this.W),Ae(this)};function be(l){if(et(l),l.G==3){var d=l.U++,p=Qn(l.I);if(He(p,"SID",l.K),He(p,"RID",d),He(p,"TYPE","terminate"),Ce(l,p),d=new On(l,l.j,d),d.L=2,d.v=qi(Qn(p)),p=!1,c.navigator&&c.navigator.sendBeacon)try{p=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&c.Image&&(new Image().src=d.v,p=!0),p||(d.g=kt(d.j,null),d.g.ea(d.v)),d.F=Date.now(),De(d)}Yn(l)}function Ee(l){l.g&&(lt(l),l.g.cancel(),l.g=null)}function et(l){Ee(l),l.u&&(c.clearTimeout(l.u),l.u=null),Fe(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ae(l){if(!$i(l.h)&&!l.s){l.s=!0;var d=l.Ga;Oe||ue(),Z||(Oe(),Z=!0),fe.add(d,l),l.B=0}}function bt(l,d){return oa(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Mr(v(l.Ga,l,d),fn(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const V=new On(this,this.j,l);let $=this.o;if(this.S&&($?($=x($),I($,this.S)):$=this.S),this.m!==null||this.O||(V.H=$,$=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(d+=_,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=oe(this,V,d),p=Qn(this.I),He(p,"RID",l),He(p,"CVER",22),this.D&&He(p,"X-HTTP-Session-Id",this.D),Ce(this,p),$&&(this.O?d="headers="+encodeURIComponent(String(da($)))+"&"+d:this.m&&f(p,this.m,$)),ti(this.h,V),this.Ua&&He(p,"TYPE","init"),this.P?(He(p,"$req",d),He(p,"SID","null"),V.T=!0,Zs(V,p,null)):Zs(V,p,d),this.G=2}}else this.G==3&&(l?Xe(this,l):this.i.length==0||$i(this.h)||Xe(this))};function Xe(l,d){var p;d?p=d.l:p=l.U++;const _=Qn(l.I);He(_,"SID",l.K),He(_,"RID",p),He(_,"AID",l.T),Ce(l,_),l.m&&l.o&&f(_,l.m,l.o),p=new On(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),d&&(l.i=d.D.concat(l.i)),d=oe(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),ti(l.h,p),Zs(p,_,d)}function Ce(l,d){l.H&&G(l.H,function(p,_){He(d,_,p)}),l.l&&Wi({},function(p,_){He(d,_,p)})}function oe(l,d,p){p=Math.min(l.i.length,p);var _=l.l?v(l.l.Na,l.l,l):null;e:{var V=l.i;let $=-1;for(;;){const te=["count="+p];$==-1?0<p?($=V[0].g,te.push("ofs="+$)):$=0:te.push("ofs="+$);let qe=!0;for(let Vt=0;Vt<p;Vt++){let Me=V[Vt].g;const Qt=V[Vt].map;if(Me-=$,0>Me)$=Math.max(0,V[Vt].g-100),qe=!1;else try{xd(Qt,te,"req"+Me+"_")}catch{_&&_(Qt)}}if(qe){_=te.join("&");break e}}}return l=l.i.splice(0,p),d.D=l,_}function ge(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;Oe||ue(),Z||(Oe(),Z=!0),fe.add(d,l),l.v=0}}function yt(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Mr(v(l.Fa,l),fn(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Se(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Mr(v(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Be(10),Ee(this),Se(this))};function lt(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Se(l){l.g=new On(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=Qn(l.qa);He(d,"RID","rpc"),He(d,"SID",l.K),He(d,"AID",l.T),He(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&He(d,"TO",l.ja),He(d,"TYPE","xmlhttp"),Ce(l,d),l.m&&l.o&&f(d,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=qi(Qn(d)),p.m=null,p.P=!0,zi(p,l)}t.Za=function(){this.C!=null&&(this.C=null,Ee(this),yt(this),Be(19))};function Fe(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function tt(l,d){var p=null;if(l.g==d){Fe(l),lt(l),l.g=null;var _=2}else if(Bi(l.h,d))p=d.D,Ot(l.h,d),_=1;else return;if(l.G!=0){if(d.o)if(_==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var V=l.B;_=$e(),me(_,new fr(_,p)),Ae(l)}else ge(l);else if(V=d.s,V==3||V==0&&0<d.X||!(_==1&&bt(l,d)||_==2&&yt(l)))switch(p&&0<p.length&&(d=l.h,d.i=d.i.concat(p)),V){case 1:vt(l,5);break;case 4:vt(l,10);break;case 3:vt(l,6);break;default:vt(l,2)}}}function fn(l,d){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*d}function vt(l,d){if(l.j.info("Error code "+d),d==2){var p=v(l.fb,l),_=l.Xa;const V=!_;_=new Et(_||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Hi(_,"https"),qi(_),V?ua(_.toString(),p):Zl(_.toString(),p)}else Be(2);l.G=0,l.l&&l.l.sa(d),Yn(l),et(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function Yn(l){if(l.G=0,l.ka=[],l.l){const d=Kn(l.h);(d.length!=0||l.i.length!=0)&&(L(l.ka,d),L(l.ka,l.i),l.h.i.length=0,D(l.i),l.i.length=0),l.l.ra()}}function Nt(l,d,p){var _=p instanceof Et?Qn(p):new Et(p);if(_.g!="")d&&(_.g=d+"."+_.g),Gi(_,_.s);else{var V=c.location;_=V.protocol,d=d?d+"."+V.hostname:V.hostname,V=+V.port;var $=new Et(null);_&&Hi($,_),d&&($.g=d),V&&Gi($,V),p&&($.l=p),_=$}return p=l.D,d=l.ya,p&&d&&He(_,p,d),He(_,"VER",l.la),Ce(l,_),_}function kt(l,d,p){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new y(new Ki({eb:p})):new y(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ii(){}t=ii.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function oi(){}oi.prototype.g=function(l,d){return new Kt(l,d)};function Kt(l,d){Ze.call(this),this.g=new Y(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!b(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!b(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new Xi(this)}P(Kt,Ze),Kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Kt.prototype.close=function(){be(this.g)},Kt.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=qt(l),l=p);d.i.push(new ei(d.Ya++,l)),d.G==3&&Ae(d)},Kt.prototype.N=function(){this.g.l=null,delete this.j,be(this.g),delete this.g,Kt.aa.N.call(this)};function ha(l){dr.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const p in d){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}P(ha,dr);function _m(){Oi.call(this),this.status=1}P(_m,Oi);function Xi(l){this.g=l}P(Xi,ii),Xi.prototype.ua=function(){me(this.g,"a")},Xi.prototype.ta=function(l){me(this.g,new ha(l))},Xi.prototype.sa=function(l){me(this.g,new _m)},Xi.prototype.ra=function(){me(this.g,"b")},oi.prototype.createWebChannel=oi.prototype.g,Kt.prototype.send=Kt.prototype.o,Kt.prototype.open=Kt.prototype.m,Kt.prototype.close=Kt.prototype.close,j_=function(){return new oi},P_=function(){return $e()},C_=hr,mf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gn.NO_ERROR=0,Gn.TIMEOUT=8,Gn.HTTP_ERROR=6,Uc=Gn,ra.COMPLETE="complete",A_=ra,Hn.EventType=us,us.OPEN="a",us.CLOSE="b",us.ERROR="c",us.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,Sa=Hn,y.prototype.listenOnce=y.prototype.L,y.prototype.getLastError=y.prototype.Ka,y.prototype.getLastErrorCode=y.prototype.Ba,y.prototype.getStatus=y.prototype.Z,y.prototype.getResponseJson=y.prototype.Oa,y.prototype.getResponseText=y.prototype.oa,y.prototype.send=y.prototype.ea,y.prototype.setWithCredentials=y.prototype.Ha,N_=y}).apply(typeof xc<"u"?xc:typeof self<"u"?self:typeof window<"u"?window:{});const py="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=new Ap("@firebase/firestore");function wa(){return Ti.logLevel}function ae(t,...e){if(Ti.logLevel<=Ne.DEBUG){const n=e.map($p);Ti.debug(`Firestore (${Yo}): ${t}`,...n)}}function ns(t,...e){if(Ti.logLevel<=Ne.ERROR){const n=e.map($p);Ti.error(`Firestore (${Yo}): ${t}`,...n)}}function Vo(t,...e){if(Ti.logLevel<=Ne.WARN){const n=e.map($p);Ti.warn(`Firestore (${Yo}): ${t}`,...n)}}function $p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(t="Unexpected state"){const e=`FIRESTORE (${Yo}) INTERNAL ASSERTION FAILED: `+t;throw ns(e),new Error(e)}function Ue(t,e){t||ve()}function _e(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends is{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(en.UNAUTHENTICATED))}shutdown(){}}class H2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class G2{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ue(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new yi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new yi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new yi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string"),new R_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string"),new en(e)}}class q2{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class K2{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new q2(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Q2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ue(this.o===void 0);const r=i=>{i.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ae("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ue(typeof n.token=="string"),this.R=n.token,new Q2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Y2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Le(t,e){return t<e?-1:t>e?1:0}function Fo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new le(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new le(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new le(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return St.fromMillis(Date.now())}static fromDate(e){return St.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new St(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new xe(e)}static min(){return new xe(new St(0,0))}static max(){return new xe(new St(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,n,r){n===void 0?n=0:n>e.length&&ve(),r===void 0?r=e.length-n:r>e.length-n&&ve(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return fl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof fl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class rt extends fl{construct(e,n,r){return new rt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new le(q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new rt(n)}static emptyPath(){return new rt([])}}const J2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends fl{construct(e,n,r){return new $t(e,n,r)}static isValidIdentifier(e){return J2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new $t(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new le(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new le(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new le(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new le(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $t(n)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(rt.fromString(e))}static fromName(e){return new de(rt.fromString(e).popFirst(5))}static empty(){return new de(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return rt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new rt(e.slice()))}}function Z2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=xe.fromTimestamp(r===1e9?new St(n+1,0):new St(n,r));return new Ws(s,de.empty(),e)}function eS(t){return new Ws(t.readTime,t.key,-1)}class Ws{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ws(xe.min(),de.empty(),-1)}static max(){return new Ws(xe.max(),de.empty(),-1)}}function tS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=de.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t){if(t.code!==q.FAILED_PRECONDITION||t.message!==nS)throw t;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(s=>s?K.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new K((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(m=>{o[h]=m,++c,c===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new K((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function sS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ll(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Bp.oe=-1;function rd(t){return t==null}function Su(t){return t===0&&1/t==-1/0}function iS(t){return typeof t=="number"&&Number.isInteger(t)&&!Su(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function M_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||Ut.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _c(this.root,e,this.comparator,!1)}getReverseIterator(){return new _c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _c(this.root,e,this.comparator,!0)}}class _c{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ut{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ut.RED,this.left=s??Ut.EMPTY,this.right=i??Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ut(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ut.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ve();const e=this.left.check();if(e!==this.right.check())throw ve();return e+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1;Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw ve()}get value(){throw ve()}get color(){throw ve()}get left(){throw ve()}get right(){throw ve()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gy(this.data.getIterator())}getIteratorFrom(e){return new gy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Wt(this.comparator);return n.data=e,n}}class gy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.fields=e,e.sort($t.comparator)}static empty(){return new rr([])}unionWith(e){let n=new Wt($t.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new rr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Fo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new L_("Invalid base64 string: "+i):i}}(e);return new Gt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Gt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gt.EMPTY_BYTE_STRING=new Gt("");const oS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hs(t){if(Ue(!!t),typeof t=="string"){let e=0;const n=oS.exec(t);if(Ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pt(t.seconds),nanos:pt(t.nanos)}}function pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Si(t){return typeof t=="string"?Gt.fromBase64String(t):Gt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Hp(t){const e=t.mapValue.fields.__previous_value__;return Wp(e)?Hp(e):e}function pl(t){const e=Hs(t.mapValue.fields.__local_write_time__.timestampValue);return new St(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,n,r,s,i,o,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class ml{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ml("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ml&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wc={mapValue:{}};function Ni(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wp(t)?4:cS(t)?9007199254740991:lS(t)?10:11:ve()}function Ar(t,e){if(t===e)return!0;const n=Ni(t);if(n!==Ni(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pl(t).isEqual(pl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Hs(s.timestampValue),c=Hs(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Si(s.bytesValue).isEqual(Si(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return pt(s.geoPointValue.latitude)===pt(i.geoPointValue.latitude)&&pt(s.geoPointValue.longitude)===pt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return pt(s.integerValue)===pt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=pt(s.doubleValue),c=pt(i.doubleValue);return o===c?Su(o)===Su(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Fo(t.arrayValue.values||[],e.arrayValue.values||[],Ar);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(my(o)!==my(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ar(o[u],c[u])))return!1;return!0}(t,e);default:return ve()}}function gl(t,e){return(t.values||[]).find(n=>Ar(n,e))!==void 0}function zo(t,e){if(t===e)return 0;const n=Ni(t),r=Ni(e);if(n!==r)return Le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=pt(i.integerValue||i.doubleValue),u=pt(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return yy(t.timestampValue,e.timestampValue);case 4:return yy(pl(t),pl(e));case 5:return Le(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Si(i),u=Si(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const m=Le(c[h],u[h]);if(m!==0)return m}return Le(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=Le(pt(i.latitude),pt(o.latitude));return c!==0?c:Le(pt(i.longitude),pt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,u,h,m;const g=i.fields||{},v=o.fields||{},k=(c=g.value)===null||c===void 0?void 0:c.arrayValue,P=(u=v.value)===null||u===void 0?void 0:u.arrayValue,D=Le(((h=k==null?void 0:k.values)===null||h===void 0?void 0:h.length)||0,((m=P==null?void 0:P.values)===null||m===void 0?void 0:m.length)||0);return D!==0?D:vy(k,P)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===wc.mapValue&&o===wc.mapValue)return 0;if(i===wc.mapValue)return 1;if(o===wc.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},m=Object.keys(h);u.sort(),m.sort();for(let g=0;g<u.length&&g<m.length;++g){const v=Le(u[g],m[g]);if(v!==0)return v;const k=zo(c[u[g]],h[m[g]]);if(k!==0)return k}return Le(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ve()}}function yy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=Hs(t),r=Hs(e),s=Le(n.seconds,r.seconds);return s!==0?s:Le(n.nanos,r.nanos)}function vy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=zo(n[s],r[s]);if(i)return i}return Le(n.length,r.length)}function Uo(t){return gf(t)}function gf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Si(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return de.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=gf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${gf(n.fields[o])}`;return s+"}"}(t.mapValue):ve()}function xy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yf(t){return!!t&&"integerValue"in t}function Gp(t){return!!t&&"arrayValue"in t}function _y(t){return!!t&&"nullValue"in t}function wy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $c(t){return!!t&&"mapValue"in t}function lS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ba(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Jo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ba(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ba(t.arrayValue.values[n]);return e}return Object.assign({},t)}function cS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.value=e}static empty(){return new zn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$c(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ba(n)}setAll(e){let n=$t.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=Ba(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$c(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ar(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$c(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Jo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new zn(Ba(this.value))}}function O_(t){const e=[];return Jo(t.fields,(n,r)=>{const s=new $t([n]);if($c(r)){const i=O_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new rr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new nn(e,0,xe.min(),xe.min(),xe.min(),zn.empty(),0)}static newFoundDocument(e,n,r,s){return new nn(e,1,n,xe.min(),r,s,0)}static newNoDocument(e,n){return new nn(e,2,n,xe.min(),xe.min(),zn.empty(),0)}static newUnknownDocument(e,n){return new nn(e,3,n,xe.min(),xe.min(),zn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.position=e,this.inclusive=n}}function Ey(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=de.comparator(de.fromName(o.referenceValue),n.key):r=zo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function by(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ar(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n="asc"){this.field=e,this.dir=n}}function uS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{}class wt extends V_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new hS(e,n,r):n==="array-contains"?new mS(e,r):n==="in"?new gS(e,r):n==="not-in"?new yS(e,r):n==="array-contains-any"?new vS(e,r):new wt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new fS(e,r):new pS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(zo(n,this.value)):n!==null&&Ni(this.value)===Ni(n)&&this.matchesComparison(zo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ar extends V_{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ar(e,n)}matches(e){return F_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function F_(t){return t.op==="and"}function z_(t){return dS(t)&&F_(t)}function dS(t){for(const e of t.filters)if(e instanceof ar)return!1;return!0}function vf(t){if(t instanceof wt)return t.field.canonicalString()+t.op.toString()+Uo(t.value);if(z_(t))return t.filters.map(e=>vf(e)).join(",");{const e=t.filters.map(n=>vf(n)).join(",");return`${t.op}(${e})`}}function U_(t,e){return t instanceof wt?function(r,s){return s instanceof wt&&r.op===s.op&&r.field.isEqual(s.field)&&Ar(r.value,s.value)}(t,e):t instanceof ar?function(r,s){return s instanceof ar&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&U_(o,s.filters[c]),!0):!1}(t,e):void ve()}function $_(t){return t instanceof wt?function(n){return`${n.field.canonicalString()} ${n.op} ${Uo(n.value)}`}(t):t instanceof ar?function(n){return n.op.toString()+" {"+n.getFilters().map($_).join(" ,")+"}"}(t):"Filter"}class hS extends wt{constructor(e,n,r){super(e,n,r),this.key=de.fromName(r.referenceValue)}matches(e){const n=de.comparator(e.key,this.key);return this.matchesComparison(n)}}class fS extends wt{constructor(e,n){super(e,"in",n),this.keys=B_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class pS extends wt{constructor(e,n){super(e,"not-in",n),this.keys=B_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function B_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>de.fromName(r.referenceValue))}class mS extends wt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gp(n)&&gl(n.arrayValue,this.value)}}class gS extends wt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&gl(this.value.arrayValue,n)}}class yS extends wt{constructor(e,n){super(e,"not-in",n)}matches(e){if(gl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!gl(this.value.arrayValue,n)}}class vS extends wt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>gl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}}function ky(t,e=null,n=[],r=[],s=null,i=null,o=null){return new xS(t,e,n,r,s,i,o)}function qp(t){const e=_e(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),rd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Uo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Uo(r)).join(",")),e.ue=n}return e.ue}function Kp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!uS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!U_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!by(t.startAt,e.startAt)&&by(t.endAt,e.endAt)}function xf(t){return de.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function _S(t,e,n,r,s,i,o,c){return new Ol(t,e,n,r,s,i,o,c)}function Qp(t){return new Ol(t)}function Iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function W_(t){return t.collectionGroup!==null}function Wa(t){const e=_e(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Wt($t.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Au(i,r))}),n.has($t.keyField().canonicalString())||e.ce.push(new Au($t.keyField(),r))}return e.ce}function Tr(t){const e=_e(t);return e.le||(e.le=wS(e,Wa(t))),e.le}function wS(t,e){if(t.limitType==="F")return ky(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Au(s.field,i)});const n=t.endAt?new Nu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nu(t.startAt.position,t.startAt.inclusive):null;return ky(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _f(t,e){const n=t.filters.concat([e]);return new Ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function wf(t,e,n){return new Ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function sd(t,e){return Kp(Tr(t),Tr(e))&&t.limitType===e.limitType}function H_(t){return`${qp(Tr(t))}|lt:${t.limitType}`}function Zi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>$_(s)).join(", ")}]`),rd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Uo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Uo(s)).join(",")),`Target(${r})`}(Tr(t))}; limitType=${t.limitType})`}function id(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):de.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Wa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const h=Ey(o,c,u);return o.inclusive?h<=0:h<0}(r.startAt,Wa(r),s)||r.endAt&&!function(o,c,u){const h=Ey(o,c,u);return o.inclusive?h>=0:h>0}(r.endAt,Wa(r),s))}(t,e)}function ES(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function G_(t){return(e,n)=>{let r=!1;for(const s of Wa(t)){const i=bS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function bS(t,e,n){const r=t.field.isKeyField()?de.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?zo(u,h):ve()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Jo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return M_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS=new ht(de.comparator);function rs(){return kS}const q_=new ht(de.comparator);function Na(...t){let e=q_;for(const n of t)e=e.insert(n.key,n);return e}function K_(t){let e=q_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function fi(){return Ha()}function Q_(){return Ha()}function Ha(){return new Zo(t=>t.toString(),(t,e)=>t.isEqual(e))}const IS=new ht(de.comparator),TS=new Wt(de.comparator);function Te(...t){let e=TS;for(const n of t)e=e.add(n);return e}const SS=new Wt(Le);function NS(){return SS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Su(e)?"-0":e}}function X_(t){return{integerValue:""+t}}function AS(t,e){return iS(e)?X_(e):Xp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(){this._=void 0}}function CS(t,e,n){return t instanceof Cu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Wp(i)&&(i=Hp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof yl?J_(t,e):t instanceof vl?Z_(t,e):function(s,i){const o=Y_(s,i),c=Ty(o)+Ty(s.Pe);return yf(o)&&yf(s.Pe)?X_(c):Xp(s.serializer,c)}(t,e)}function PS(t,e,n){return t instanceof yl?J_(t,e):t instanceof vl?Z_(t,e):n}function Y_(t,e){return t instanceof Pu?function(r){return yf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Cu extends od{}class yl extends od{constructor(e){super(),this.elements=e}}function J_(t,e){const n=ew(e);for(const r of t.elements)n.some(s=>Ar(s,r))||n.push(r);return{arrayValue:{values:n}}}class vl extends od{constructor(e){super(),this.elements=e}}function Z_(t,e){let n=ew(e);for(const r of t.elements)n=n.filter(s=>!Ar(s,r));return{arrayValue:{values:n}}}class Pu extends od{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ty(t){return pt(t.integerValue||t.doubleValue)}function ew(t){return Gp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function jS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof yl&&s instanceof yl||r instanceof vl&&s instanceof vl?Fo(r.elements,s.elements,Ar):r instanceof Pu&&s instanceof Pu?Ar(r.Pe,s.Pe):r instanceof Cu&&s instanceof Cu}(t.transform,e.transform)}class RS{constructor(e,n){this.version=e,this.transformResults=n}}class Sr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ad{}function tw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yp(t.key,Sr.none()):new Vl(t.key,t.data,Sr.none());{const n=t.data,r=zn.empty();let s=new Wt($t.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Pi(t.key,r,new rr(s.toArray()),Sr.none())}}function DS(t,e,n){t instanceof Vl?function(s,i,o){const c=s.value.clone(),u=Ny(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Pi?function(s,i,o){if(!Bc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=Ny(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(nw(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ga(t,e,n,r){return t instanceof Vl?function(i,o,c,u){if(!Bc(i.precondition,o))return c;const h=i.value.clone(),m=Ay(i.fieldTransforms,u,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Pi?function(i,o,c,u){if(!Bc(i.precondition,o))return c;const h=Ay(i.fieldTransforms,u,o),m=o.data;return m.setAll(nw(i)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,c){return Bc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function MS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Y_(r.transform,s||null);i!=null&&(n===null&&(n=zn.empty()),n.set(r.field,i))}return n||null}function Sy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Fo(r,s,(i,o)=>jS(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Vl extends ad{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Pi extends ad{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ny(t,e,n){const r=new Map;Ue(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,PS(o,c,n[s]))}return r}function Ay(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,CS(i,o,e))}return r}class Yp extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LS extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&DS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ga(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ga(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Q_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=tw(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(xe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Te())}isEqual(e){return this.batchId===e.batchId&&Fo(this.mutations,e.mutations,(n,r)=>Sy(n,r))&&Fo(this.baseMutations,e.baseMutations,(n,r)=>Sy(n,r))}}class Jp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ue(e.mutations.length===r.length);let s=function(){return IS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Jp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt,Pe;function zS(t){switch(t){default:return ve();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0}}function rw(t){if(t===void 0)return ns("GRPC error has no .code"),q.UNKNOWN;switch(t){case xt.OK:return q.OK;case xt.CANCELLED:return q.CANCELLED;case xt.UNKNOWN:return q.UNKNOWN;case xt.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case xt.INTERNAL:return q.INTERNAL;case xt.UNAVAILABLE:return q.UNAVAILABLE;case xt.UNAUTHENTICATED:return q.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case xt.NOT_FOUND:return q.NOT_FOUND;case xt.ALREADY_EXISTS:return q.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return q.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case xt.ABORTED:return q.ABORTED;case xt.OUT_OF_RANGE:return q.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return q.UNIMPLEMENTED;case xt.DATA_LOSS:return q.DATA_LOSS;default:return ve()}}(Pe=xt||(xt={}))[Pe.OK=0]="OK",Pe[Pe.CANCELLED=1]="CANCELLED",Pe[Pe.UNKNOWN=2]="UNKNOWN",Pe[Pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pe[Pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pe[Pe.NOT_FOUND=5]="NOT_FOUND",Pe[Pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pe[Pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pe[Pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pe[Pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pe[Pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pe[Pe.ABORTED=10]="ABORTED",Pe[Pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pe[Pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pe[Pe.INTERNAL=13]="INTERNAL",Pe[Pe.UNAVAILABLE=14]="UNAVAILABLE",Pe[Pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=new gi([4294967295,4294967295],0);function Cy(t){const e=US().encode(t),n=new S_;return n.update(e),new Uint8Array(n.digest())}function Py(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new gi([n,r],0),new gi([s,i],0)]}class Zp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Aa(`Invalid padding: ${n}`);if(r<0)throw new Aa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Aa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Aa(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=gi.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(gi.fromNumber(r)));return s.compare($S)===1&&(s=new gi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Cy(e),[r,s]=Py(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Zp(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const n=Cy(e),[r,s]=Py(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Aa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Fl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ld(xe.min(),s,new ht(Le),rs(),Te())}}class Fl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Fl(r,n,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class sw{constructor(e,n){this.targetId=e,this.me=n}}class iw{constructor(e,n,r=Gt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class jy{constructor(){this.fe=0,this.ge=Dy(),this.pe=Gt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Te(),n=Te(),r=Te();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ve()}}),new Fl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Dy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class BS{constructor(e){this.Le=e,this.Be=new Map,this.ke=rs(),this.qe=Ry(),this.Qe=new ht(Le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ve()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(xf(i))if(r===0){const o=new de(i.path);this.Ue(n,o,nn.newNoDocument(o,xe.min()))}else Ue(r===1);else{const o=this.Ye(n);if(o!==r){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Si(r).toUint8Array()}catch(u){if(u instanceof L_)return Vo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Zp(o,s,i)}catch(u){return Vo(u instanceof Aa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const c=this.Je(o);if(c){if(i.current&&xf(c.target)){const u=new de(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,nn.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Te();this.qe.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ld(e,n,this.Qe,this.ke,r);return this.ke=rs(),this.qe=Ry(),this.Qe=new ht(Le),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Wt(Le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ae("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Ry(){return new ht(de.comparator)}function Dy(){return new ht(de.comparator)}const WS={asc:"ASCENDING",desc:"DESCENDING"},HS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GS={and:"AND",or:"OR"};class qS{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ef(t,e){return t.useProto3Json||rd(e)?e:{value:e}}function ju(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ow(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function KS(t,e){return ju(t,e.toTimestamp())}function Nr(t){return Ue(!!t),xe.fromTimestamp(function(n){const r=Hs(n);return new St(r.seconds,r.nanos)}(t))}function em(t,e){return bf(t,e).canonicalString()}function bf(t,e){const n=function(s){return new rt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function aw(t){const e=rt.fromString(t);return Ue(hw(e)),e}function kf(t,e){return em(t.databaseId,e.path)}function th(t,e){const n=aw(e);if(n.get(1)!==t.databaseId.projectId)throw new le(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new le(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new de(cw(n))}function lw(t,e){return em(t.databaseId,e)}function QS(t){const e=aw(t);return e.length===4?rt.emptyPath():cw(e)}function If(t){return new rt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cw(t){return Ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function My(t,e,n){return{name:kf(t,e),fields:n.value.mapValue.fields}}function XS(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ve()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,m){return h.useProto3Json?(Ue(m===void 0||typeof m=="string"),Gt.fromBase64String(m||"")):(Ue(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Gt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const m=h.code===void 0?q.UNKNOWN:rw(h.code);return new le(m,h.message||"")}(o);n=new iw(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=th(t,r.document.name),i=Nr(r.document.updateTime),o=r.document.createTime?Nr(r.document.createTime):xe.min(),c=new zn({mapValue:{fields:r.document.fields}}),u=nn.newFoundDocument(s,i,o,c),h=r.targetIds||[],m=r.removedTargetIds||[];n=new Wc(h,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=th(t,r.document),i=r.readTime?Nr(r.readTime):xe.min(),o=nn.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Wc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=th(t,r.document),i=r.removedTargetIds||[];n=new Wc([],i,s,null)}else{if(!("filter"in e))return ve();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new FS(s,i),c=r.targetId;n=new sw(c,o)}}return n}function YS(t,e){let n;if(e instanceof Vl)n={update:My(t,e.key,e.value)};else if(e instanceof Yp)n={delete:kf(t,e.key)};else if(e instanceof Pi)n={update:My(t,e.key,e.data),updateMask:oN(e.fieldMask)};else{if(!(e instanceof LS))return ve();n={verify:kf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Cu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof yl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof vl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Pu)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw ve()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:KS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ve()}(t,e.precondition)),n}function JS(t,e){return t&&t.length>0?(Ue(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Nr(s.updateTime):Nr(i);return o.isEqual(xe.min())&&(o=Nr(i)),new RS(o,s.transformResults||[])}(n,e))):[]}function ZS(t,e){return{documents:[lw(t,e.path)]}}function eN(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lw(t,s);const i=function(h){if(h.length!==0)return dw(ar.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(m=>function(v){return{field:eo(v.field),direction:rN(v.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=Ef(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function tN(t){let e=QS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ue(r===1);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(g){const v=uw(g);return v instanceof ar&&z_(v)?v.getFilters():[v]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(v=>function(P){return new Au(to(P.field),function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(v))}(n.orderBy));let c=null;n.limit&&(c=function(g){let v;return v=typeof g=="object"?g.value:g,rd(v)?null:v}(n.limit));let u=null;n.startAt&&(u=function(g){const v=!!g.before,k=g.values||[];return new Nu(k,v)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const v=!g.before,k=g.values||[];return new Nu(k,v)}(n.endAt)),_S(e,s,o,i,c,"F",u,h)}function nN(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function uw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=to(n.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=to(n.unaryFilter.field);return wt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=to(n.unaryFilter.field);return wt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=to(n.unaryFilter.field);return wt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ve()}}(t):t.fieldFilter!==void 0?function(n){return wt.create(to(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ve()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ar.create(n.compositeFilter.filters.map(r=>uw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ve()}}(n.compositeFilter.op))}(t):ve()}function rN(t){return WS[t]}function sN(t){return HS[t]}function iN(t){return GS[t]}function eo(t){return{fieldPath:t.canonicalString()}}function to(t){return $t.fromServerFormat(t.fieldPath)}function dw(t){return t instanceof wt?function(n){if(n.op==="=="){if(wy(n.value))return{unaryFilter:{field:eo(n.field),op:"IS_NAN"}};if(_y(n.value))return{unaryFilter:{field:eo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wy(n.value))return{unaryFilter:{field:eo(n.field),op:"IS_NOT_NAN"}};if(_y(n.value))return{unaryFilter:{field:eo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eo(n.field),op:sN(n.op),value:n.value}}}(t):t instanceof ar?function(n){const r=n.getFilters().map(s=>dw(s));return r.length===1?r[0]:{compositeFilter:{op:iN(n.op),filters:r}}}(t):ve()}function oN(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n,r,s,i=xe.min(),o=xe.min(),c=Gt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.ct=e}}function lN(t){const e=tN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this.un=new uN}addToCollectionParentIndex(e,n){return this.un.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve(Ws.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class uN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Wt(rt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Wt(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new $o(0)}static kn(){return new $o(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.changes=new Zo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,nn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ga(r.mutation,s,rr.empty(),St.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Te()){const s=fi();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Na();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=fi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Te()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=rs();const o=Ha(),c=function(){return Ha()}();return n.forEach((u,h)=>{const m=r.get(h.key);s.has(h.key)&&(m===void 0||m.mutation instanceof Pi)?i=i.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),Ga(m.mutation,h,m.mutation.getFieldMask(),St.now())):o.set(h.key,rr.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,m)=>o.set(h,m)),n.forEach((h,m)=>{var g;return c.set(h,new hN(m,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=Ha();let s=new ht((o,c)=>o-c),i=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let m=r.get(u)||rr.empty();m=c.applyToLocalView(h,m),r.set(u,m);const g=(s.get(c.batchId)||Te()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,m=u.value,g=Q_();m.forEach(v=>{if(!i.has(v)){const k=tw(n.get(v),r.get(v));k!==null&&g.set(v,k),i=i.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return de.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):W_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):K.resolve(fi());let c=-1,u=i;return o.next(h=>K.forEach(h,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(m)?K.resolve():this.remoteDocumentCache.getEntry(e,m).next(v=>{u=u.insert(m,v)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,Te())).next(m=>({batchId:c,changes:K_(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new de(n)).next(r=>{let s=Na();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Na();return this.indexManager.getCollectionParents(e,i).next(c=>K.forEach(c,u=>{const h=function(g,v){return new Ol(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(m=>{m.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,h)=>{const m=h.getKey();o.get(m)===null&&(o=o.insert(m,nn.newInvalidDocument(m)))});let c=Na();return o.forEach((u,h)=>{const m=i.get(u);m!==void 0&&Ga(m.mutation,h,rr.empty(),St.now()),id(n,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return K.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Nr(s.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:lN(s.bundledQuery),readTime:Nr(s.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(){this.overlays=new ht(de.comparator),this.Ir=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=fi();return K.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const s=fi(),i=n.length+1,o=new de(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ht((h,m)=>h-m);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let m=i.get(h.largestBatchId);m===null&&(m=fi(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=fi(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,m)=>c.set(h,m)),!(c.size()>=s)););return K.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new VS(n,r));let i=this.Ir.get(n);i===void 0&&(i=Te(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(){this.sessionToken=Gt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(){this.Tr=new Wt(Ct.Er),this.dr=new Wt(Ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ct(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ct(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new de(new rt([])),r=new Ct(n,e),s=new Ct(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new de(new rt([])),r=new Ct(n,e),s=new Ct(n,e+1);let i=Te();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ct(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ct{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return de.comparator(e.key,n.key)||Le(e.wr,n.wr)}static Ar(e,n){return Le(e.wr,n.wr)||de.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Wt(Ct.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new OS(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new Ct(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ct(n,0),s=new Ct(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);i.push(c)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Wt(Le);return n.forEach(s=>{const i=new Ct(s,0),o=new Ct(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],c=>{r=r.add(c.wr)})}),K.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;de.isDocumentKey(i)||(i=i.child(""));const o=new Ct(new de(i),0);let c=new Wt(Le);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.wr)),!0)},o),K.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ue(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return K.forEach(n.mutations,s=>{const i=new Ct(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ct(n,0),s=this.br.firstAfterOrEqual(r);return K.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e){this.Mr=e,this.docs=function(){return new ht(de.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():nn.newInvalidDocument(n))}getEntries(e,n){let r=rs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():nn.newInvalidDocument(s))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=rs();const o=n.path,c=new de(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:m}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||tS(eS(m),r)<=0||(s.has(m.key)||id(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ve()}Or(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xN(this)}getSize(e){return K.resolve(this.size)}}class xN extends dN{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e){this.persistence=e,this.Nr=new Zo(n=>qp(n),Kp),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new tm,this.targetCount=0,this.kr=$o.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),K.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new $o(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.Kn(n),K.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Bp(0),this.Kr=!1,this.Kr=!0,this.$r=new gN,this.referenceDelegate=e(this),this.Ur=new _N(this),this.indexManager=new cN,this.remoteDocumentCache=function(s){return new vN(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new aN(n),this.Gr=new pN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mN,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new yN(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ae("MemoryPersistence","Starting transaction:",e);const s=new EN(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return K.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class EN extends rS{constructor(e){super(),this.currentSequenceNumber=e}}class nm{constructor(e){this.persistence=e,this.Jr=new tm,this.Yr=null}static Zr(e){return new nm(e)}get Xr(){if(this.Yr)return this.Yr;throw ve()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),K.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,r=>{const s=de.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,xe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return K.or([()=>K.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Te(),s=Te();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new rm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return bk()?8:sS(on())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new bN;return this.Xi(e,n,o).next(c=>{if(i.result=c,this.zi)return this.es(e,n,o,c.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(wa()<=Ne.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",Zi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(wa()<=Ne.DEBUG&&ae("QueryEngine","Query:",Zi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(wa()<=Ne.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",Zi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tr(n))):K.resolve())}Yi(e,n){if(Iy(n))return K.resolve(null);let r=Tr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=wf(n,null,"F"),r=Tr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Te(...i);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,c);return this.ns(n,h,o,u.readTime)?this.Yi(e,wf(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return Iy(n)||s.isEqual(xe.min())?K.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?K.resolve(null):(wa()<=Ne.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Zi(n)),this.rs(e,o,n,Z2(s,-1)).next(c=>c))})}ts(e,n){let r=new Wt(G_(e));return n.forEach((s,i)=>{id(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return wa()<=Ne.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",Zi(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ws.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ht(Le),this._s=new Zo(i=>qp(i),Kp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function TN(t,e,n,r){return new IN(t,e,n,r)}async function fw(t,e){const n=_e(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=Te();for(const h of s){o.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}for(const h of i){c.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:c}))})})}function SN(t,e){const n=_e(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,m){const g=h.batch,v=g.keys();let k=K.resolve();return v.forEach(P=>{k=k.next(()=>m.getEntry(u,P)).next(D=>{const L=h.docVersions.get(P);Ue(L!==null),D.version.compareTo(L)<0&&(g.applyToRemoteDocument(D,h),D.isValidDocument()&&(D.setReadTime(h.commitVersion),m.addEntry(D)))})}),k.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Te();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function pw(t){const e=_e(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function NN(t,e){const n=_e(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((m,g)=>{const v=s.get(g);if(!v)return;c.push(n.Ur.removeMatchingKeys(i,m.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,m.addedDocuments,g)));let k=v.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?k=k.withResumeToken(Gt.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):m.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(m.resumeToken,r)),s=s.insert(g,k),function(D,L,A){return D.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(v,k,m)&&c.push(n.Ur.updateTargetData(i,k))});let u=rs(),h=Te();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(AN(i,o,e.documentUpdates).next(m=>{u=m.Ps,h=m.Is})),!r.isEqual(xe.min())){const m=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(m)}return K.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function AN(t,e,n){let r=Te(),s=Te();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=rs();return n.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ae("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function CN(t,e){const n=_e(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function PN(t,e){const n=_e(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,K.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ns(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Tf(t,e,n){const r=_e(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ll(o))throw o;ae("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ly(t,e,n){const r=_e(t);let s=xe.min(),i=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,m){const g=_e(u),v=g._s.get(m);return v!==void 0?K.resolve(g.os.get(v)):g.Ur.getTargetData(h,m)}(r,o,Tr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:xe.min(),n?i:Te())).next(c=>(jN(r,ES(e),c),{documents:c,Ts:i})))}function jN(t,e,n){let r=t.us.get(e)||xe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Oy{constructor(){this.activeTargetIds=NS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RN{constructor(){this.so=new Oy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Oy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ae("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ae("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ec=null;function nh(){return Ec===null?Ec=function(){return 268435456+Math.round(2147483648*Math.random())}():Ec++,"0x"+Ec.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class ON extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const c=nh(),u=this.xo(n,r.toUriEncodedString());ae("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,o),this.No(n,u,h,s).then(m=>(ae("RestConnection",`Received RPC '${n}' ${c}: `,m),m),m=>{throw Vo("RestConnection",`RPC '${n}' ${c} failed with error: `,m,"url: ",u,"request:",s),m})}Lo(n,r,s,i,o,c){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Yo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=MN[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=nh();return new Promise((o,c)=>{const u=new N_;u.setWithCredentials(!0),u.listenOnce(A_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Uc.NO_ERROR:const m=u.getResponseJson();ae(Zt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(m)),o(m);break;case Uc.TIMEOUT:ae(Zt,`RPC '${e}' ${i} timed out`),c(new le(q.DEADLINE_EXCEEDED,"Request time out"));break;case Uc.HTTP_ERROR:const g=u.getStatus();if(ae(Zt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const k=v==null?void 0:v.error;if(k&&k.status&&k.message){const P=function(L){const A=L.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(A)>=0?A:q.UNKNOWN}(k.status);c(new le(P,k.message))}else c(new le(q.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new le(q.UNAVAILABLE,"Connection failed."));break;default:ve()}}finally{ae(Zt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ae(Zt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=nh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=j_(),c=P_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=i.join("");ae(Zt,`Creating RPC '${e}' stream ${s}: ${m}`,u);const g=o.createWebChannel(m,u);let v=!1,k=!1;const P=new LN({Io:L=>{k?ae(Zt,`Not sending because RPC '${e}' stream ${s} is closed:`,L):(v||(ae(Zt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),v=!0),ae(Zt,`RPC '${e}' stream ${s} sending:`,L),g.send(L))},To:()=>g.close()}),D=(L,A,b)=>{L.listen(A,N=>{try{b(N)}catch(S){setTimeout(()=>{throw S},0)}})};return D(g,Sa.EventType.OPEN,()=>{k||(ae(Zt,`RPC '${e}' stream ${s} transport opened.`),P.yo())}),D(g,Sa.EventType.CLOSE,()=>{k||(k=!0,ae(Zt,`RPC '${e}' stream ${s} transport closed`),P.So())}),D(g,Sa.EventType.ERROR,L=>{k||(k=!0,Vo(Zt,`RPC '${e}' stream ${s} transport errored:`,L),P.So(new le(q.UNAVAILABLE,"The operation could not be completed")))}),D(g,Sa.EventType.MESSAGE,L=>{var A;if(!k){const b=L.data[0];Ue(!!b);const N=b,S=N.error||((A=N[0])===null||A===void 0?void 0:A.error);if(S){ae(Zt,`RPC '${e}' stream ${s} received error:`,S);const z=S.status;let G=function(E){const I=xt[E];if(I!==void 0)return rw(I)}(z),T=S.message;G===void 0&&(G=q.INTERNAL,T="Unknown error status: "+z+" with message "+S.message),k=!0,P.So(new le(G,T)),g.close()}else ae(Zt,`RPC '${e}' stream ${s} received:`,b),P.bo(b)}}),D(c,C_.STAT_EVENT,L=>{L.stat===mf.PROXY?ae(Zt,`RPC '${e}' stream ${s} detected buffering proxy`):L.stat===mf.NOPROXY&&ae(Zt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}}function rh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){return new qS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ae("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n,r,s,i,o,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new mw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===q.RESOURCE_EXHAUSTED?(ns(n.toString()),ns("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new le(q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ae("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ae("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class VN extends gw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=XS(this.serializer,e),r=function(i){if(!("targetChange"in i))return xe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?xe.min():o.readTime?Nr(o.readTime):xe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=If(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=xf(u)?{documents:ZS(i,u)}:{query:eN(i,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=ow(i,o.resumeToken);const h=Ef(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(xe.min())>0){c.readTime=ju(i,o.snapshotVersion.toTimestamp());const h=Ef(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const r=nN(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=If(this.serializer),n.removeTarget=e,this.a_(n)}}class FN extends gw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=JS(e.writeResults,e.commitTime),r=Nr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=If(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>YS(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new le(q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,bf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new le(q.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,bf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new le(q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class UN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ns(n),this.D_=!1):ae("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{ji(this)&&(ae("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=_e(u);h.L_.add(4),await zl(h),h.q_.set("Unknown"),h.L_.delete(4),await ud(h)}(this))})}),this.q_=new UN(r,s)}}async function ud(t){if(ji(t))for(const e of t.B_)await e(!0)}async function zl(t){for(const e of t.B_)await e(!1)}function yw(t,e){const n=_e(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),am(n)?om(n):ea(n).r_()&&im(n,e))}function sm(t,e){const n=_e(t),r=ea(n);n.N_.delete(e),r.r_()&&vw(n,e),n.N_.size===0&&(r.r_()?r.o_():ji(n)&&n.q_.set("Unknown"))}function im(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ea(t).A_(e)}function vw(t,e){t.Q_.xe(e),ea(t).R_(e)}function om(t){t.Q_=new BS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ea(t).start(),t.q_.v_()}function am(t){return ji(t)&&!ea(t).n_()&&t.N_.size>0}function ji(t){return _e(t).L_.size===0}function xw(t){t.Q_=void 0}async function BN(t){t.q_.set("Online")}async function WN(t){t.N_.forEach((e,n)=>{im(t,e)})}async function HN(t,e){xw(t),am(t)?(t.q_.M_(e),om(t)):t.q_.set("Unknown")}async function GN(t,e,n){if(t.q_.set("Online"),e instanceof iw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){ae("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ru(t,r)}else if(e instanceof Wc?t.Q_.Ke(e):e instanceof sw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(xe.min()))try{const r=await pw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Q_.rt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const m=i.N_.get(h);m&&i.N_.set(h,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const m=i.N_.get(u);if(!m)return;i.N_.set(u,m.withResumeToken(Gt.EMPTY_BYTE_STRING,m.snapshotVersion)),vw(i,u);const g=new Ns(m.target,u,h,m.sequenceNumber);im(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ae("RemoteStore","Failed to raise snapshot:",r),await Ru(t,r)}}async function Ru(t,e,n){if(!Ll(e))throw e;t.L_.add(1),await zl(t),t.q_.set("Offline"),n||(n=()=>pw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ae("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await ud(t)})}function _w(t,e){return e().catch(n=>Ru(t,n,e))}async function dd(t){const e=_e(t),n=Gs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;qN(e);)try{const s=await CN(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,KN(e,s)}catch(s){await Ru(e,s)}ww(e)&&Ew(e)}function qN(t){return ji(t)&&t.O_.length<10}function KN(t,e){t.O_.push(e);const n=Gs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function ww(t){return ji(t)&&!Gs(t).n_()&&t.O_.length>0}function Ew(t){Gs(t).start()}async function QN(t){Gs(t).p_()}async function XN(t){const e=Gs(t);for(const n of t.O_)e.m_(n.mutations)}async function YN(t,e,n){const r=t.O_.shift(),s=Jp.from(r,e,n);await _w(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await dd(t)}async function JN(t,e){e&&Gs(t).V_&&await async function(r,s){if(function(o){return zS(o)&&o!==q.ABORTED}(s.code)){const i=r.O_.shift();Gs(r).s_(),await _w(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await dd(r)}}(t,e),ww(t)&&Ew(t)}async function Fy(t,e){const n=_e(t);n.asyncQueue.verifyOperationInProgress(),ae("RemoteStore","RemoteStore received new credentials");const r=ji(n);n.L_.add(3),await zl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ud(n)}async function ZN(t,e){const n=_e(t);e?(n.L_.delete(2),await ud(n)):e||(n.L_.add(2),await zl(n),n.q_.set("Unknown"))}function ea(t){return t.K_||(t.K_=function(n,r,s){const i=_e(n);return i.w_(),new VN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:BN.bind(null,t),Ro:WN.bind(null,t),mo:HN.bind(null,t),d_:GN.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),am(t)?om(t):t.q_.set("Unknown")):(await t.K_.stop(),xw(t))})),t.K_}function Gs(t){return t.U_||(t.U_=function(n,r,s){const i=_e(n);return i.w_(),new FN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:QN.bind(null,t),mo:JN.bind(null,t),f_:XN.bind(null,t),g_:YN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await dd(t)):(await t.U_.stop(),t.O_.length>0&&(ae("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new lm(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cm(t,e){if(ns("AsyncQueue",`${e}: ${t}`),Ll(t))return new le(q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this.comparator=e?(n,r)=>e(n,r)||de.comparator(n.key,r.key):(n,r)=>de.comparator(n.key,r.key),this.keyedMap=Na(),this.sortedSet=new ht(this.comparator)}static emptySet(e){return new To(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof To)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new To;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(){this.W_=new ht(de.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ve():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Bo{constructor(e,n,r,s,i,o,c,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Bo(e,n,To.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class tA{constructor(){this.queries=Uy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=_e(n),i=s.queries;s.queries=Uy(),i.forEach((o,c)=>{for(const u of c.j_)u.onError(r)})})(this,new le(q.ABORTED,"Firestore shutting down"))}}function Uy(){return new Zo(t=>H_(t),sd)}async function nA(t,e){const n=_e(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new eA,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=cm(o,`Initialization of query '${Zi(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&um(n)}async function rA(t,e){const n=_e(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function sA(t,e){const n=_e(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&um(n)}function iA(t,e,n){const r=_e(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function um(t){t.Y_.forEach(e=>{e.next()})}var Sf,$y;($y=Sf||(Sf={})).ea="default",$y.Cache="cache";class oA{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Bo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e){this.key=e}}class kw{constructor(e){this.key=e}}class aA{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Te(),this.mutatedKeys=Te(),this.Aa=G_(e),this.Ra=new To(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new zy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,g)=>{const v=s.get(m),k=id(this.query,g)?g:null,P=!!v&&this.mutatedKeys.has(v.key),D=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let L=!1;v&&k?v.data.isEqual(k.data)?P!==D&&(r.track({type:3,doc:k}),L=!0):this.ga(v,k)||(r.track({type:2,doc:k}),L=!0,(u&&this.Aa(k,u)>0||h&&this.Aa(k,h)<0)&&(c=!0)):!v&&k?(r.track({type:0,doc:k}),L=!0):v&&!k&&(r.track({type:1,doc:v}),L=!0,(u||h)&&(c=!0)),L&&(k?(o=o.add(k),i=D?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:c,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,g)=>function(k,P){const D=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve()}};return D(k)-D(P)}(m.type,g.type)||this.Aa(m.doc,g.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new Bo(this.query,e.Ra,i,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new zy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Te(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new kw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new bw(r))}),n}ba(e){this.Ta=e.Ts,this.da=Te();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Bo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class lA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class cA{constructor(e){this.key=e,this.va=!1}}class uA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Zo(c=>H_(c),sd),this.Ma=new Map,this.xa=new Set,this.Oa=new ht(de.comparator),this.Na=new Map,this.La=new tm,this.Ba={},this.ka=new Map,this.qa=$o.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function dA(t,e,n=!0){const r=Cw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Iw(r,e,n,!0),s}async function hA(t,e){const n=Cw(t);await Iw(n,e,!0,!1)}async function Iw(t,e,n,r){const s=await PN(t.localStore,Tr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await fA(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&yw(t.remoteStore,s),c}async function fA(t,e,n,r,s){t.Ka=(g,v,k)=>async function(D,L,A,b){let N=L.view.ma(A);N.ns&&(N=await Ly(D.localStore,L.query,!1).then(({documents:T})=>L.view.ma(T,N)));const S=b&&b.targetChanges.get(L.targetId),z=b&&b.targetMismatches.get(L.targetId)!=null,G=L.view.applyChanges(N,D.isPrimaryClient,S,z);return Wy(D,L.targetId,G.wa),G.snapshot}(t,g,v,k);const i=await Ly(t.localStore,e,!0),o=new aA(e,i.Ts),c=o.ma(i.documents),u=Fl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);Wy(t,n,h.wa);const m=new lA(e,n,o);return t.Fa.set(e,m),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function pA(t,e,n){const r=_e(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!sd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Tf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&sm(r.remoteStore,s.targetId),Nf(r,s.targetId)}).catch(Ml)):(Nf(r,s.targetId),await Tf(r.localStore,s.targetId,!0))}async function mA(t,e){const n=_e(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),sm(n.remoteStore,r.targetId))}async function gA(t,e,n){const r=bA(t);try{const s=await function(o,c){const u=_e(o),h=St.now(),m=c.reduce((k,P)=>k.add(P.key),Te());let g,v;return u.persistence.runTransaction("Locally write mutations","readwrite",k=>{let P=rs(),D=Te();return u.cs.getEntries(k,m).next(L=>{P=L,P.forEach((A,b)=>{b.isValidDocument()||(D=D.add(A))})}).next(()=>u.localDocuments.getOverlayedDocuments(k,P)).next(L=>{g=L;const A=[];for(const b of c){const N=MS(b,g.get(b.key).overlayedDocument);N!=null&&A.push(new Pi(b.key,N,O_(N.value.mapValue),Sr.exists(!0)))}return u.mutationQueue.addMutationBatch(k,h,A,c)}).next(L=>{v=L;const A=L.applyToLocalDocumentSet(g,D);return u.documentOverlayCache.saveOverlays(k,L.batchId,A)})}).then(()=>({batchId:v.batchId,changes:K_(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new ht(Le)),h=h.insert(c,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await Ul(r,s.changes),await dd(r.remoteStore)}catch(s){const i=cm(s,"Failed to persist write");n.reject(i)}}async function Tw(t,e){const n=_e(t);try{const r=await NN(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ue(o.va):s.removedDocuments.size>0&&(Ue(o.va),o.va=!1))}),await Ul(n,r,e)}catch(r){await Ml(r)}}function By(t,e,n){const r=_e(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=_e(o);u.onlineState=c;let h=!1;u.queries.forEach((m,g)=>{for(const v of g.j_)v.Z_(c)&&(h=!0)}),h&&um(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function yA(t,e,n){const r=_e(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ht(de.comparator);o=o.insert(i,nn.newNoDocument(i,xe.min()));const c=Te().add(i),u=new ld(xe.min(),new Map,new ht(Le),o,c);await Tw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),dm(r)}else await Tf(r.localStore,e,!1).then(()=>Nf(r,e,n)).catch(Ml)}async function vA(t,e){const n=_e(t),r=e.batch.batchId;try{const s=await SN(n.localStore,e);Nw(n,r,null),Sw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ul(n,s)}catch(s){await Ml(s)}}async function xA(t,e,n){const r=_e(t);try{const s=await function(o,c){const u=_e(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(Ue(g!==null),m=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>u.localDocuments.getDocuments(h,m))})}(r.localStore,e);Nw(r,e,n),Sw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ul(r,s)}catch(s){await Ml(s)}}function Sw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Nw(t,e,n){const r=_e(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Nf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Aw(t,r)})}function Aw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(sm(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),dm(t))}function Wy(t,e,n){for(const r of n)r instanceof bw?(t.La.addReference(r.key,e),_A(t,r)):r instanceof kw?(ae("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Aw(t,r.key)):ve()}function _A(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ae("SyncEngine","New document in limbo: "+n),t.xa.add(r),dm(t))}function dm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new de(rt.fromString(e)),r=t.qa.next();t.Na.set(r,new cA(n)),t.Oa=t.Oa.insert(n,r),yw(t.remoteStore,new Ns(Tr(Qp(n.path)),r,"TargetPurposeLimboResolution",Bp.oe))}}async function Ul(t,e,n){const r=_e(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{o.push(r.Ka(u,e,n).then(h=>{var m;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=rm.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const m=_e(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>K.forEach(h,v=>K.forEach(v.$i,k=>m.persistence.referenceDelegate.addReference(g,v.targetId,k)).next(()=>K.forEach(v.Ui,k=>m.persistence.referenceDelegate.removeReference(g,v.targetId,k)))))}catch(g){if(!Ll(g))throw g;ae("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const v=g.targetId;if(!g.fromCache){const k=m.os.get(v),P=k.snapshotVersion,D=k.withLastLimboFreeSnapshotVersion(P);m.os=m.os.insert(v,D)}}}(r.localStore,i))}async function wA(t,e){const n=_e(t);if(!n.currentUser.isEqual(e)){ae("SyncEngine","User change. New user:",e.toKey());const r=await fw(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new le(q.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ul(n,r.hs)}}function EA(t,e){const n=_e(t),r=n.Na.get(e);if(r&&r.va)return Te().add(r.key);{let s=Te();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const c=n.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function Cw(t){const e=_e(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Tw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=EA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yA.bind(null,e),e.Ca.d_=sA.bind(null,e.eventManager),e.Ca.$a=iA.bind(null,e.eventManager),e}function bA(t){const e=_e(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xA.bind(null,e),e}class Du{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return TN(this.persistence,new kN,e.initialUser,this.serializer)}Ga(e){return new wN(nm.Zr,this.serializer)}Wa(e){return new RN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Du.provider={build:()=>new Du};class Af{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>By(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wA.bind(null,this.syncEngine),await ZN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new tA}()}createDatastore(e){const n=cd(e.databaseInfo.databaseId),r=function(i){return new ON(i)}(e.databaseInfo);return function(i,o,c,u){return new zN(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new $N(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>By(this.syncEngine,n,0),function(){return Vy.D()?new Vy:new DN}())}createSyncEngine(e,n){return function(s,i,o,c,u,h,m){const g=new uA(s,i,o,c,u,h);return m&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=_e(s);ae("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await zl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Af.provider={build:()=>new Af};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ns("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=D_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ae("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ae("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=cm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function sh(t,e){t.asyncQueue.verifyOperationInProgress(),ae("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await fw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Hy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await TA(t);ae("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Fy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Fy(e.remoteStore,s)),t._onlineComponents=e}async function TA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ae("FirestoreClient","Using user provided OfflineComponentProvider");try{await sh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===q.FAILED_PRECONDITION||s.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Vo("Error using user provided cache. Falling back to memory cache: "+n),await sh(t,new Du)}}else ae("FirestoreClient","Using default OfflineComponentProvider"),await sh(t,new Du);return t._offlineComponents}async function Pw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ae("FirestoreClient","Using user provided OnlineComponentProvider"),await Hy(t,t._uninitializedComponentsProvider._online)):(ae("FirestoreClient","Using default OnlineComponentProvider"),await Hy(t,new Af))),t._onlineComponents}function SA(t){return Pw(t).then(e=>e.syncEngine)}async function Gy(t){const e=await Pw(t),n=e.eventManager;return n.onListen=dA.bind(null,e.syncEngine),n.onUnlisten=pA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=hA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=mA.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(t,e,n){if(!n)throw new le(q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function NA(t,e,n,r){if(e===!0&&r===!0)throw new le(q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ky(t){if(!de.isDocumentKey(t))throw new le(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(de.isDocumentKey(t))throw new le(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ve()}function vi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new le(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hd(t);throw new le(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new le(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new le(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new le(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new le(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new le(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new W2;switch(r.type){case"firstParty":return new K2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new le(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=qy.get(n);r&&(ae("ComponentProvider","Removing Datastore"),qy.delete(n),r.terminate())}(this),Promise.resolve()}}function AA(t,e,n,r={}){var s;const i=(t=vi(t,fd))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Vo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=en.MOCK_USER;else{c=gk(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new le(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new en(h)}t._authCredentials=new H2(new R_(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ta(this.firestore,e,this._query)}}class _n{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _n(this.firestore,e,this._key)}}class zs extends ta{constructor(e,n,r){super(e,n,Qp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new de(e))}withConverter(e){return new zs(this.firestore,e,this._path)}}function CA(t,e,...n){if(t=wn(t),Rw("collection","path",e),t instanceof fd){const r=rt.fromString(e,...n);return Qy(r),new zs(t,null,r)}{if(!(t instanceof _n||t instanceof zs))throw new le(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(rt.fromString(e,...n));return Qy(r),new zs(t.firestore,null,r)}}function ih(t,e,...n){if(t=wn(t),arguments.length===1&&(e=D_.newId()),Rw("doc","path",e),t instanceof fd){const r=rt.fromString(e,...n);return Ky(r),new _n(t,null,new de(r))}{if(!(t instanceof _n||t instanceof zs))throw new le(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(rt.fromString(e,...n));return Ky(r),new _n(t.firestore,t instanceof zs?t.converter:null,new de(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new mw(this,"async_queue_retry"),this.Vu=()=>{const r=rh();r&&ae("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=rh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=rh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new yi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ll(e))throw e;ae("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw ns("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=lm.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Jy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class xl extends fd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Yy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yy(e),this._firestoreClient=void 0,await e}}}function PA(t,e){const n=typeof t=="object"?t:jp(),r=typeof t=="string"?t:"(default)",s=Pp(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=pk("firestore");i&&AA(s,...i)}return s}function Dw(t){if(t._terminated)throw new le(q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||jA(t),t._firestoreClient}function jA(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,h,m){return new aS(c,u,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,jw(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new IA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wo(Gt.fromBase64String(e))}catch(n){throw new le(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Wo(Gt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new le(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new le(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new le(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA=/^__.*__$/;class DA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Pi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Vl(e,this.data,n,this.fieldTransforms)}}function Lw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve()}}class mm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new mm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Mu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Lw(this.Cu)&&RA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class MA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||cd(e)}Qu(e,n,r,s=!1){return new mm({Cu:e,methodName:n,qu:r,path:$t.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ow(t){const e=t._freezeSettings(),n=cd(t._databaseId);return new MA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function LA(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);zw("Data must be an object, but it was:",o,r);const c=Vw(r,o);let u,h;if(i.merge)u=new rr(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const v=VA(e,g,n);if(!o.contains(v))throw new le(q.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);zA(m,v)||m.push(v)}u=new rr(m),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new DA(new zn(c),u,h)}function OA(t,e,n,r=!1){return gm(n,t.Qu(r?4:3,e))}function gm(t,e){if(Fw(t=wn(t)))return zw("Unsupported field value:",e,t),Vw(t,e);if(t instanceof Mw)return function(r,s){if(!Lw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=gm(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=wn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=St.fromDate(r);return{timestampValue:ju(s.serializer,i)}}if(r instanceof St){const i=new St(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ju(s.serializer,i)}}if(r instanceof fm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Wo)return{bytesValue:ow(s.serializer,r._byteString)};if(r instanceof _n){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:em(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof pm)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return Xp(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${hd(r)}`)}(t,e)}function Vw(t,e){const n={};return M_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jo(t,(r,s)=>{const i=gm(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Fw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof St||t instanceof fm||t instanceof Wo||t instanceof _n||t instanceof Mw||t instanceof pm)}function zw(t,e,n){if(!Fw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=hd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function VA(t,e,n){if((e=wn(e))instanceof hm)return e._internalPath;if(typeof e=="string")return Uw(t,e);throw Mu("Field path arguments must be of type string or ",t,!1,void 0,n)}const FA=new RegExp("[~\\*/\\[\\]]");function Uw(t,e,n){if(e.search(FA)>=0)throw Mu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hm(...e.split("."))._internalPath}catch{throw Mu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new le(q.INVALID_ARGUMENT,c+t+u)}function zA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Bw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class UA extends $w{data(){return super.data()}}function Bw(t,e){return typeof e=="string"?Uw(t,e):e instanceof hm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new le(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ym{}class BA extends ym{}function WA(t,e,...n){let r=[];e instanceof ym&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof xm).length,c=i.filter(u=>u instanceof vm).length;if(o>1||o>0&&c>0)throw new le(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class vm extends BA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new vm(e,n,r)}_apply(e){const n=this._parse(e);return Ww(e._query,n),new ta(e.firestore,e.converter,_f(e._query,n))}_parse(e){const n=Ow(e.firestore);return function(i,o,c,u,h,m,g){let v;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new le(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){ev(g,m);const k=[];for(const P of g)k.push(Zy(u,i,P));v={arrayValue:{values:k}}}else v=Zy(u,i,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||ev(g,m),v=OA(c,o,g,m==="in"||m==="not-in");return wt.create(h,m,v)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class xm extends ym{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new xm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ar.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)Ww(o,u),o=_f(o,u)}(e._query,n),new ta(e.firestore,e.converter,_f(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Zy(t,e,n){if(typeof(n=wn(n))=="string"){if(n==="")throw new le(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!W_(e)&&n.indexOf("/")!==-1)throw new le(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(rt.fromString(n));if(!de.isDocumentKey(r))throw new le(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xy(t,new de(r))}if(n instanceof _n)return xy(t,n._key);throw new le(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hd(n)}.`)}function ev(t,e){if(!Array.isArray(t)||t.length===0)throw new le(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ww(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new le(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new le(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class HA{convertValue(e,n="none"){switch(Ni(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Si(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ve()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Jo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>pt(o.doubleValue));return new pm(i)}convertGeoPoint(e){return new fm(pt(e.latitude),pt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Hp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pl(e));default:return null}}convertTimestamp(e){const n=Hs(e);return new St(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=rt.fromString(e);Ue(hw(r));const s=new ml(r.get(1),r.get(3)),i=new de(r.popFirst(5));return s.isEqual(n)||ns(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hw extends $w{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Hc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Bw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Hc extends Hw{data(e={}){return super.data(e)}}class qA{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ca(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Hc(this._firestore,this._userDataWriter,r.key,r,new Ca(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new le(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new Hc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ca(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Hc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ca(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,m=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:KA(c.type),doc:u,oldIndex:h,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function KA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve()}}class Gw extends HA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,n)}}function tv(t,e,n){t=vi(t,_n);const r=vi(t.firestore,xl),s=GA(t.converter,e,n);return qw(r,[LA(Ow(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Sr.none())])}function QA(t){return qw(vi(t.firestore,xl),[new Yp(t._key,Sr.none())])}function XA(t,...e){var n,r,s;t=wn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Jy(e[o])||(i=e[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Jy(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,h,m;if(t instanceof _n)h=vi(t.firestore,xl),m=Qp(t._key.path),u={next:g=>{e[o]&&e[o](YA(h,t,g))},error:e[o+1],complete:e[o+2]};else{const g=vi(t,ta);h=vi(g.firestore,xl),m=g._query;const v=new Gw(h);u={next:k=>{e[o]&&e[o](new qA(h,v,g,k))},error:e[o+1],complete:e[o+2]},$A(t._query)}return function(v,k,P,D){const L=new kA(D),A=new oA(k,L,P);return v.asyncQueue.enqueueAndForget(async()=>nA(await Gy(v),A)),()=>{L.Za(),v.asyncQueue.enqueueAndForget(async()=>rA(await Gy(v),A))}}(Dw(h),m,c,u)}function qw(t,e){return function(r,s){const i=new yi;return r.asyncQueue.enqueueAndForget(async()=>gA(await SA(r),s,i)),i.promise}(Dw(t),e)}function YA(t,e,n){const r=n.docs.get(e._key),s=new Gw(t);return new Hw(t,s,e._key,r,new Ca(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Yo=s})(Qo),Oo(new ki("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new xl(new G2(r.getProvider("auth-internal")),new X2(r.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new le(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ml(h.options.projectId,m)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Fs(py,"4.7.3",e),Fs(py,"4.7.3","esm2017")})();const rn={marriage:{label:"Matrimonio",color:"#000000",lineStyle:"solid",renderType:"standard"},secret:{label:"Relazione Segreta",color:"#000000",lineStyle:"solid",renderType:"triangle-up-center"},cohabitation:{label:"Convivenza",color:"#000000",lineStyle:"dashed",renderType:"standard"},couple:{label:"Relazione di Coppia",color:"#000000",lineStyle:"dashed",renderType:"standard"},"divorce-commit":{label:"Divorzio Impegno Emot.",color:"#000000",lineStyle:"solid",renderType:"dashed-inner"},separation:{label:"Separazione",color:"#000000",lineStyle:"solid",renderType:"oblique"},"separation-repaired":{label:"Separazione Riparata",color:"#000000",lineStyle:"solid",renderType:"x-cross"},"separation-cohab":{label:"Separazione (Conv.)",color:"#000000",lineStyle:"dashed",renderType:"oblique"},divorce:{label:"Divorzio (2 Tagli)",color:"#000000",lineStyle:"solid",renderType:"oblique-double"},"divorce-repaired":{label:"Divorzio Riparato",color:"#000000",lineStyle:"solid",renderType:"oblique-double-crossed"},"re-marriage":{label:"Risposati",color:"#000000",lineStyle:"solid",renderType:"standard"},affair:{label:"Relazione Extra/Amante",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},"one-night":{label:"Avventura",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},engagement:{label:"Fidanzamento",color:"#0000FF",lineStyle:"dashed",renderType:"standard"},"child-bio":{label:"Figlio Biologico",color:"#000000",lineStyle:"solid",renderType:"standard"},"child-adopted":{label:"Adozione",color:"#0000FF",lineStyle:"dotted",renderType:"standard"},"child-foster":{label:"Affido",color:"#000000",lineStyle:"dashed",renderType:"standard"},"twin-dizygotic":{label:"Gemelli Dizigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link"},"twin-monozygotic":{label:"Gemelli Monozigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link-bar"},pregnancy:{label:"Gravidanza",color:"#000000",lineStyle:"solid",renderType:"standard"},correlated:{label:"Correlato/Collegamento",color:"#000000",lineStyle:"solid",renderType:"standard"},harmony:{label:"Armonia",color:"#008000",lineStyle:"solid",renderType:"standard"},friendship:{label:"Amicizia",color:"#008000",lineStyle:"dashed",renderType:"standard"},"best-friend":{label:"Migliore Amico",color:"#008000",lineStyle:"dotted",renderType:"double"},close:{label:"Invischiamento/Molto Uniti",color:"#008000",lineStyle:"solid",renderType:"double"},fusion:{label:"Fusione",color:"#008000",lineStyle:"solid",renderType:"triple"},"in-love":{label:"Innamorati",color:"#008000",lineStyle:"solid",renderType:"two-circles-center"},fan:{label:"Ammiratore",color:"#008000",lineStyle:"dashed",renderType:"arrow"},spiritual:{label:"Conn. Spirituale",color:"#800080",lineStyle:"dashed",renderType:"standard"},distance:{label:"Distanza",color:"#808080",lineStyle:"dashed",renderType:"standard"},poor:{label:"Povera",color:"#808080",lineStyle:"dotted",renderType:"standard"},hostile:{label:"Ostile",color:"#FF0000",lineStyle:"zigzag",renderType:"standard"},"close-hostile":{label:"Vicini-Ostile",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag-center"},"fusion-hostile":{label:"Fusione & Conflitto",color:"#000000",lineStyle:"solid",renderType:"fusion-hostile"},hate:{label:"Odio",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag"},cutoff:{label:"Rottura/Taglio (//)",color:"#FF0000",lineStyle:"solid",renderType:"cutoff"},restored:{label:"Relazione Ristabilita",color:"#008000",lineStyle:"solid",renderType:"cutoff-repaired-circle"},"violence-psychological":{label:"Violenza Psicologica",color:"#FF0000",lineStyle:"zigzag",renderType:"arrow-open-end"},"violence-physical":{label:"Violenza Fisica",color:"#FF0000",lineStyle:"zigzag-thick",renderType:"arrow-open-end"},"violence-sexual":{label:"Violenza Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"triple-zigzag-center-arrow"},"abuse-physical":{label:"Abuso Fisico",color:"#800000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-emotional":{label:"Abuso Emotivo",color:"#800000",lineStyle:"dashed",renderType:"arrow"},"abuse-sexual":{label:"Abuso Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"arrow-double-bar-center"},focused:{label:"Focalizzato sul",color:"#0000FF",lineStyle:"solid",renderType:"arrow-end"},"focused-negative":{label:"Focalizzato Negativamente",color:"#FF0000",lineStyle:"zigzag",renderType:"arrow-end"},companions:{label:"Accompagnatori",color:"#000000",lineStyle:"solid",renderType:"arrow-open-end"},manipulative:{label:"Manipolativo",color:"#FF0000",lineStyle:"solid",renderType:"arrow-x-center"},controlling:{label:"Controllante",color:"#800080",lineStyle:"solid",renderType:"arrow-box-center"},keeper:{label:"Custode/Caregiver",color:"#008080",lineStyle:"solid",renderType:"arrow-diamond-center"},neglect:{label:"Trascuratezza",color:"#808080",lineStyle:"dashed",renderType:"standard"},custom:{label:"Personalizzata",color:"#000000",lineStyle:"solid",renderType:"standard"}},_r={"Struttura / Coppia":["marriage","secret","cohabitation","couple","divorce-commit","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","re-marriage","engagement","affair","one-night"],Figli:["child-bio","child-adopted","child-foster","twin-dizygotic","twin-monozygotic","pregnancy"],"Interazione / Affettive":["correlated","harmony","friendship","best-friend","close","fusion","in-love","fan","spiritual"],"Conflitto e Distanza":["distance","poor","hostile","close-hostile","fusion-hostile","hate","cutoff","restored"],"Violenza, Abuso e Potere":["violence-psychological","violence-physical","violence-sexual","abuse-physical","abuse-emotional","abuse-sexual","neglect","focused","focused-negative","companions","manipulative","controlling","keeper"],Altro:["custom"]},nv={home:Ob,heart:Do,user:Wb,users:Mo,grad:Lb,book:Cb,briefcase:Pb,folder:Mb,help:Ip,tag:sf},JA=[{id:"family",label:"Famiglie",color:"#3b82f6",iconKey:"home"},{id:"couple",label:"Coppie",color:"#ec4899",iconKey:"heart"},{id:"individual",label:"Individuali",color:"#10b981",iconKey:"user"},{id:"school",label:"Scolastico",color:"#f59e0b",iconKey:"grad"},{id:"exercise",label:"Esercitazioni",color:"#6366f1",iconKey:"book"},{id:"work",label:"Lavoro/Org",color:"#64748b",iconKey:"briefcase"},{id:"other",label:"Altro",color:"#94a3b8",iconKey:"folder"}],Kw=["#bfdbfe","#bbf7d0","#fbcfe8","#fde68a","#ddd6fe","#fed7aa","#e2e8f0"],Qw=["#3b82f6","#22c55e","#ec4899","#f59e0b","#8b5cf6","#f97316","#64748b"],ZA=["#ffffff","#f3f4f6","#d1d5db","#9ca3af","#4b5563","#1f2937","#000000"],eC=["#78350f","#92400e","#b45309","#d97706","#f59e0b","#fcd34d","#fffbeb"],tC=["#f8fafc","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#475569","#1e293b"],Pa={Classico:["#fef3c7","#d1fae5","#dbeafe","#fce7f3","#f3f4f6","#ffedd5","#e0e7ff"],Pastello:Kw,Vivido:Qw,Terra:eC,Monocromo:tC},nC=["#1f2937","#000000","#ffffff","#dc2626","#2563eb","#16a34a","#d97706","#57534e"],Xw=[{label:"App Default",value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},{label:"Handwriting",value:'"Comic Sans MS", "Chalkboard SE", sans-serif'},{label:"Sans Serif",value:"ui-sans-serif, system-ui, sans-serif"},{label:"Serif",value:"ui-serif, Georgia, serif"},{label:"Monospace",value:"ui-monospace, monospace"}],Is=[{id:"light",label:"Light (Default)",type:"light",colors:{bgMain:"#f9fafb",bgPanel:"#ffffff",border:"#e5e7eb",text:"#111827",textMuted:"#6b7280",accent:"#2563eb"}},{id:"sepia",label:"Vintage Sepia",type:"light",colors:{bgMain:"#fdf6e3",bgPanel:"#eee8d5",border:"#d2b48c",text:"#433422",textMuted:"#93a1a1",accent:"#b58900"}},{id:"nordic",label:"Nordic Snow",type:"light",colors:{bgMain:"#eceff4",bgPanel:"#e5e9f0",border:"#d8dee9",text:"#2e3440",textMuted:"#4c566a",accent:"#5e81ac"}},{id:"dark",label:"Dark (Classic)",type:"dark",colors:{bgMain:"#111827",bgPanel:"#1f2937",border:"#374151",text:"#f9fafb",textMuted:"#9ca3af",accent:"#3b82f6"}},{id:"onedark",label:"One Dark Pro",type:"dark",colors:{bgMain:"#282c34",bgPanel:"#21252b",border:"#3e4451",text:"#abb2bf",textMuted:"#5c6370",accent:"#61afef"}},{id:"dracula",label:"Dracula",type:"dark",colors:{bgMain:"#282a36",bgPanel:"#44475a",border:"#6272a4",text:"#f8f8f2",textMuted:"#bd93f9",accent:"#ff79c6"}},{id:"nightowl",label:"Night Owl",type:"dark",colors:{bgMain:"#011627",bgPanel:"#0b2942",border:"#5f7e97",text:"#d6deeb",textMuted:"#7e57c2",accent:"#82aaff"}},{id:"forest",label:"Forest Night",type:"dark",colors:{bgMain:"#0d1117",bgPanel:"#161b22",border:"#30363d",text:"#c9d1d9",textMuted:"#8b949e",accent:"#238636"}}],pn=20,ja=8e3,At=ja/2,zt=40,wr=40,Ho=20,Yw=40,rC=Ho+Yw,bc=40,Ve=()=>Math.random().toString(36).substr(2,9),Jw=t=>{if(!t)return null;const e=t.split(/[\/\-\.]/);if(e.length===3){const n=parseInt(e[0]),r=parseInt(e[1])-1,s=parseInt(e[2]);if(!isNaN(n)&&!isNaN(r)&&!isNaN(s)){const i=s<100?s>30?1900+s:2e3+s:s;return new Date(i,r,n)}}if(/^\d{4}$/.test(t))return new Date(parseInt(t),0,1);if(/^\d{1,3}$/.test(t)){const n=parseInt(t);if(n<=150)return new Date(new Date().getFullYear()-n,0,1)}return null},_l=t=>{if(!t)return"?";const e=t.trim();if(/^\d{1,3}$/.test(e)&&parseInt(e)<=150)return e;const n=Jw(t);if(!n)return"?";const r=new Date;let s=r.getFullYear()-n.getFullYear();const i=r.getMonth()-n.getMonth();return(i<0||i===0&&r.getDate()<n.getDate())&&s--,s.toString()},rv=(t,e)=>e.find(n=>(n.fromId===t||n.toId===t)&&["marriage","cohabitation","separation","divorce","affair","re-marriage"].includes(n.type)),sC=(t,e)=>Math.max(t,e)+Yw,Zw=(t,e)=>{const n=e.filter(c=>t.memberIds.includes(c.id));if(!n.length)return null;const r=Math.min(...n.map(c=>c.x)),s=Math.max(...n.map(c=>c.x+zt)),i=Math.min(...n.map(c=>c.y)),o=Math.max(...n.map(c=>c.y+wr));return{x:r-bc,y:i-bc,w:s-r+bc*2,h:o-i+bc*2,cx:(r+s)/2,cy:(i+o)/2}},sv=(t,e,n)=>{const r=e.find(i=>i.id===t);if(r)return{x:r.x+Ho,y:r.y+Ho};const s=n.find(i=>i.id===t);if(s){const i=Zw(s,e);if(i)return{x:i.x+i.w/2,y:i.y+i.h/2}}return null},iv=(t,e,n)=>(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),iC=t=>{t.sort((r,s)=>r.x===s.x?r.y-s.y:r.x-s.x);const e=[];for(let r=0;r<t.length;r++){for(;e.length>=2&&iv(e[e.length-2],e[e.length-1],t[r])<=0;)e.pop();e.push(t[r])}const n=[];for(let r=t.length-1;r>=0;r--){for(;n.length>=2&&iv(n[n.length-2],n[n.length-1],t[r])<=0;)n.pop();n.push(t[r])}return[...e.slice(0,-1),...n.slice(0,-1)]},oC=(t,e)=>{if(t.length<3)return{d:"",cx:0,cy:0,expandedPoints:[],controlPoints:[]};const n=t.reduce((u,h)=>u+h.x,0)/t.length,r=t.reduce((u,h)=>u+h.y,0)/t.length,s=t.map(u=>{const h=Math.atan2(u.y-r,u.x-n),m=Math.hypot(u.x-n,u.y-r);return{x:n+Math.cos(h)*(m+e),y:r+Math.sin(h)*(m+e)}}),i=s.length,o=s.map((u,h)=>{const m=s[(h+1)%i];return{x:(u.x+m.x)/2,y:(u.y+m.y)/2}});let c=`M ${o[0].x} ${o[0].y}`;for(let u=0;u<i;u++){const h=s[(u+1)%i],m=o[(u+1)%i];c+=` Q ${h.x} ${h.y} ${m.x} ${m.y}`}return c+=" Z",{d:c,cx:n,cy:r,expandedPoints:o,controlPoints:s}},ov=(t,e)=>{let n=1/0,r=e;for(let s=0;s<t.length;s++){const i=t[s],o=t[(s+1)%t.length],c=(i.x-o.x)**2+(i.y-o.y)**2;if(c===0)continue;let u=((e.x-i.x)*(o.x-i.x)+(e.y-i.y)*(o.y-i.y))/c;u=Math.max(0,Math.min(1,u));const h=i.x+u*(o.x-i.x),m=i.y+u*(o.y-i.y),g=(e.x-h)**2+(e.y-m)**2;g<n&&(n=g,r={x:h,y:m})}return r},av=(t,e)=>{const n=t.length;if(n<3)return t[0];const s=e*n,i=Math.floor(s)%n,o=s-Math.floor(s),c=t[(i+1)%n],u=t[i],h=t[(i+2)%n],m={x:(u.x+c.x)/2,y:(u.y+c.y)/2},g={x:(c.x+h.x)/2,y:(c.y+h.y)/2},v=c,k=1-o,P=k*k*m.x+2*k*o*v.x+o*o*g.x,D=k*k*m.y+2*k*o*v.y+o*o*g.y;return{x:P,y:D}},kc=(t,e)=>{const n=e.filter(o=>t.memberIds.includes(o.id));if(n.length===0)return null;let r=[];n.forEach(o=>{const u=Math.max(80,o.name.length*8)/2,h=o.x+zt/2,m=o.y-25;r.push({x:h-u,y:m}),r.push({x:h+u,y:m});const g=o.y+wr+10;r.push({x:h-u,y:g}),r.push({x:h+u,y:g}),r.push({x:o.x-5,y:o.y+wr/2}),r.push({x:o.x+zt+5,y:o.y+wr/2})});const s=iC(r),i=t.customPadding||23;return oC(s,i)},vr=(t,e,n,r,s=4,i=12)=>{const o=n-t,c=r-e,u=Math.sqrt(o*o+c*c);if(u===0)return`M ${t} ${e}`;const h=o/u,m=c/u,g=-m,v=h,k=Math.max(1,Math.round(u/i)),P=u/k;let D=`M ${t} ${e}`;for(let L=1;L<k;L++){const A=L*P,b=t+h*A,N=e+m*A,S=L%2!==0?s:-s;D+=` L ${b+g*S} ${N+v*S}`}return D+=` L ${n} ${r}`,D},Lu=t=>{if(!t)return 0;const e=t.match(/\d{4}/);return e?parseInt(e[0]):0},aC=({x:t,y:e,darkMode:n,nodes:r,edges:s})=>{const i=n?"#1f2937":"#ffffff",o=n?"#f3f4f6":"#1f2937",c=n?"#374151":"#e5e7eb",u=n?"#9ca3af":"#6b7280",h=Array.from(new Set(r.map(x=>x.gender))).sort(),m=r.some(x=>x.deceased),g=r.some(x=>x.indexPerson),v=Array.from(new Set(s.map(x=>x.type))).sort(),k=15,P=24,D=140,L=30,A=h.length+(m?1:0)+(g?1:0),b=v.length,N=A+b>8,S=N?D*2+k*3:D+k*2,z=L+k+Math.max(A,N?b:A+b)*P+(N?0:20),G=x=>{const E=o,I="none",R=1.5;return x==="M"?a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:E,fill:I,strokeWidth:R}):x==="F"?a.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:E,fill:I,strokeWidth:R}):x==="Pet"?a.jsx("path",{d:"M8 2 L14 8 L8 14 L2 8 Z",stroke:E,fill:I,strokeWidth:R}):x==="Pregnancy"?a.jsx("path",{d:"M8 2 L14 14 L2 14 Z",stroke:E,fill:I,strokeWidth:R}):a.jsx("text",{x:"8",y:"12",textAnchor:"middle",fontSize:"10",fill:E,fontFamily:"sans-serif",children:"?"})},T=x=>a.jsx(Ou,{type:x,width:30,darkMode:n,transparent:!0});return a.jsxs("g",{transform:`translate(${t}, ${e})`,children:[a.jsx("rect",{width:S,height:z,rx:"8",fill:i,stroke:c,strokeWidth:"1",filter:"drop-shadow(0 4px 6px rgb(0 0 0 / 0.1))"}),a.jsx("text",{x:k,y:22,fontWeight:"bold",fill:o,fontSize:"12",letterSpacing:"0.5px",fontFamily:"sans-serif",children:"LEGENDA"}),a.jsx("line",{x1:k,y1:L,x2:S-k,y2:L,stroke:c,strokeWidth:"1"}),a.jsxs("g",{transform:`translate(${k}, ${L+15})`,children:[a.jsxs("g",{children:[A>0&&a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Persone"}),h.map((x,E)=>a.jsxs("g",{transform:`translate(0, ${E*P})`,children:[G(x),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:x==="M"?"Maschio":x==="F"?"Femmina":x})]},x)),m&&a.jsxs("g",{transform:`translate(0, ${h.length*P})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("line",{x1:"2",y1:"2",x2:"14",y2:"14",stroke:o}),a.jsx("line",{x1:"14",y1:"2",x2:"2",y2:"14",stroke:o}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Deceduto"})]}),g&&a.jsxs("g",{transform:`translate(0, ${(h.length+(m?1:0))*P})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("rect",{x:"4",y:"4",width:"8",height:"8",stroke:o,fill:"none"}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Paz. Designato"})]})]}),v.length>0&&a.jsxs("g",{transform:`translate(${N?D+k:0}, ${N?0:A*P+15})`,children:[a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Relazioni"}),v.map((x,E)=>{var R;const I=((R=rn[x])==null?void 0:R.label)||"Custom";return a.jsxs("g",{transform:`translate(0, ${E*P})`,children:[T(x),a.jsx("text",{x:"35",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:I})]},x)})]})]})]})},Ou=({type:t,width:e=50,darkMode:n=!1,transparent:r=!1})=>{const s=rn[t]||rn.custom;if(!s)return null;let i=s.color;i==="#000000"&&n&&(i="#ffffff"),(s.renderType.includes("hostile")||s.renderType.includes("triple-zigzag")||s.lineStyle==="zigzag-thick")&&(i="#ef4444");let o=e;const c=e/2,u=7,h=s.renderType.includes("arrow")&&!s.renderType.includes("center")||s.renderType==="triple-zigzag-center-arrow";let m=6;s.renderType==="arrow-thick"&&(m=8),h&&(o-=m);let g=`M 0 ${u} L ${o} ${u}`,v="2";if(s.lineStyle.startsWith("zigzag")){let z=e>30?3:2,G=e>30?8:6;s.lineStyle==="zigzag-thick"&&(z=e>30?4:3,G=e>30?6:4),g=vr(0,u,o,u,z,G),v="1.5"}const k=s.lineStyle==="dashed"?"6,3":s.lineStyle==="dotted"?"2,2":"",P=c,D=u,L=i,A=`translate(${o}, ${u})`,b=`translate(${c}, ${u})`,N=()=>s.renderType==="fusion"||s.renderType==="triple"?a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, -3)",fill:"none"})]}):s.renderType==="fusion-hostile"?a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:vr(0,u,o,u),stroke:"red",strokeWidth:1.5,fill:"none"})]}):s.renderType==="triple-zigzag"?a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:vr(0,u,o,u),stroke:"red",strokeWidth:1.5,fill:"none"})]}):s.renderType==="double"||s.renderType==="double-zigzag"||s.renderType==="best-friend"?a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, 3)",fill:"none",strokeDasharray:k}):s.renderType==="oblique"?a.jsx("line",{x1:P+3,y1:D-6,x2:P-3,y2:D+6,stroke:L,strokeWidth:2}):s.renderType==="oblique-double"?a.jsxs("g",{children:[a.jsx("line",{x1:P+1,y1:D-6,x2:P-5,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("line",{x1:P+5,y1:D-6,x2:P-1,y2:D+6,stroke:L,strokeWidth:2})]}):s.renderType==="x-cross"?a.jsxs("g",{children:[a.jsx("line",{x1:P+4,y1:D-6,x2:P-4,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("line",{x1:P-4,y1:D-6,x2:P+4,y2:D+6,stroke:L,strokeWidth:2})]}):s.renderType==="oblique-double-crossed"?a.jsxs("g",{children:[a.jsx("line",{x1:P-1,y1:D-6,x2:P-7,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("line",{x1:P+7,y1:D-6,x2:P+1,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("line",{x1:P-7,y1:D-6,x2:P+7,y2:D+6,stroke:L,strokeWidth:2})]}):s.renderType==="cutoff-double"?a.jsxs("g",{children:[a.jsx("line",{x1:P-3,y1:D-6,x2:P-3,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("line",{x1:P+3,y1:D-6,x2:P+3,y2:D+6,stroke:L,strokeWidth:2})]}):s.renderType==="cutoff"?a.jsx("line",{x1:P,y1:D-6,x2:P,y2:D+6,stroke:L,strokeWidth:3}):s.renderType==="cutoff-repaired-circle"?a.jsxs("g",{children:[a.jsx("line",{x1:P-3,y1:D-6,x2:P-9,y2:D+6,stroke:L,strokeWidth:2}),a.jsx("circle",{cx:P,cy:D,r:4,fill:"none",stroke:L,strokeWidth:1.5}),a.jsx("line",{x1:P+9,y1:D-6,x2:P+3,y2:D+6,stroke:L,strokeWidth:2})]}):s.renderType==="dashed-inner"?a.jsx("g",{children:a.jsx("path",{d:g,stroke:L,strokeWidth:1.5,strokeDasharray:"3,3",fill:"none",transform:"translate(0, 4)"})}):s.renderType==="triple-zigzag-center-arrow"?a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:L,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:vr(0,u,o,u,3,8),stroke:"red",strokeWidth:1.5,fill:"none"}),a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:"red",transform:A})]}):s.renderType==="triangle-up-center"?a.jsx("polygon",{points:"-5,0 5,0 0,-8",fill:L,transform:b}):s.renderType==="arrow-thick"?a.jsx("polygon",{points:"-6,-6 4,0 -6,6",fill:L,transform:A}):s.renderType.includes("arrow")&&!s.renderType.includes("center")?a.jsx("g",{children:a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:L,transform:A})}):s.renderType==="arrow-x-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:L,transform:A}),a.jsxs("g",{transform:b,children:[a.jsx("line",{x1:"-4",y1:"-4",x2:"4",y2:"4",stroke:L,strokeWidth:2}),a.jsx("line",{x1:"-4",y1:"4",x2:"4",y2:"-4",stroke:L,strokeWidth:2})]})]}):s.renderType==="arrow-box-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:L,transform:A}),a.jsx("rect",{x:"-4",y:"-4",width:"8",height:"8",stroke:L,strokeWidth:2,fill:"white",transform:b})]}):s.renderType==="arrow-diamond-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:L,transform:A}),a.jsx("polygon",{points:"0,-4 4,0 0,4 -4,0",stroke:L,strokeWidth:2,fill:"white",transform:b})]}):s.renderType==="arrow-double-bar-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:L,transform:A}),a.jsxs("g",{transform:b,children:[a.jsx("line",{x1:"-2",y1:"-6",x2:"-2",y2:"6",stroke:L,strokeWidth:2}),a.jsx("line",{x1:"2",y1:"-6",x2:"2",y2:"6",stroke:L,strokeWidth:2})]})]}):null,S=r?"shrink-0 mr-2 overflow-visible":"shrink-0 mr-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 overflow-visible";return a.jsxs("svg",{width:e,height:"14",className:S,children:[s.type!=="best-friend"&&a.jsx("path",{d:g,stroke:L,strokeWidth:v,strokeDasharray:k,fill:"none"}),a.jsx(N,{})]})},lC=({value:t,onChange:e,className:n})=>{const[r,s]=H.useState(!1),i=rn[t]||rn.custom||{label:t};return a.jsxs("div",{className:`relative ${n}`,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between p-2 border rounded bg-white text-gray-900 dark:text-gray-100 dark:bg-gray-700 text-xs hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[a.jsxs("div",{className:"flex items-center overflow-hidden",children:[a.jsx(Ou,{type:t}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsx(Tx,{size:14,className:"opacity-50 shrink-0 ml-1"})]}),r&&a.jsxs("div",{className:"absolute top-full left-0 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded shadow-xl max-h-60 overflow-y-auto z-50 text-gray-900 dark:text-gray-100 text-left",children:[Object.entries(_r).map(([o,c])=>a.jsxs("div",{children:[a.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-900 text-[9px] font-bold uppercase text-gray-500 sticky top-0 border-b border-gray-200 dark:border-gray-700",children:o}),c.map(u=>{const h=rn[u];return h?a.jsxs("button",{onClick:()=>{e(u),s(!1)},className:`w-full flex items-center p-2 text-xs hover:bg-blue-50 dark:hover:bg-blue-900/30 text-left border-b border-gray-50 dark:border-gray-700 ${t===u?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[a.jsx(Ou,{type:u}),a.jsx("span",{children:h.label})]},u):null})]},o)),a.jsx("div",{className:"p-1 sticky bottom-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:a.jsx("button",{onClick:()=>s(!1),className:"w-full py-1 text-center text-gray-400 hover:text-red-500 text-[10px]",children:"Chiudi"})})]})]})},cC=({edge:t,start:e,end:n,isSelected:r,darkMode:s,customConfig:i,onSelect:o,onAddChild:c,isTargetGroup:u,tNode:h})=>{let m=rn[t.type];!m&&i&&(m=i.config),m||(m={color:"#000",lineStyle:"solid",renderType:"standard"});const g=t.color||m.color,v=m.renderType,k=r?"#3b82f6":s&&g==="#000000"?"#ffffff":g,P=["marriage","secret","couple","divorce-commit","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","cohabitation","affair","re-marriage","engagement","one-night"].includes(t.type),D=sC(e.y,n.y);let L=(e.x+n.x)/2,A=(e.y+n.y)/2;P&&(A=D);let b="";const N=P?0:Math.atan2(n.y-e.y,n.x-e.x)*180/Math.PI;let S=20;if(h&&!u){const ce=e.x-n.x,ne=e.y-n.y;let Oe=20;if(["M","F","TransWoman","TransMan","NonBinary"].includes(h.gender)||(Oe=15),h.gender!=="F"&&(Math.abs(ce)>.01||Math.abs(ne)>.01)){const Z=Math.atan2(ne,ce),fe=Math.abs(Math.cos(Z)),ue=Math.abs(Math.sin(Z));Oe=Math.min(Oe/(fe||1),Oe/(ue||1)),Oe>30&&(Oe=30)}S=Oe}const z=v.includes("arrow-thick")?4:6,G=(u?0:S)+z,T=`translate(${n.x},${n.y}) rotate(${N}) translate(-${G},0)`,x=`translate(${L},${A}) rotate(${N})`;let E=n.x,I=n.y;if((v.includes("arrow")&&!v.includes("center")||v==="triple-zigzag-center-arrow")&&!P){const ce=G+4,ne=Math.atan2(n.y-e.y,n.x-e.x);E=n.x-Math.cos(ne)*ce,I=n.y-Math.sin(ne)*ce}if(P)b=`M ${e.x} ${e.y+Ho} L ${e.x} ${D} L ${n.x} ${D} L ${n.x} ${n.y+Ho}`;else if(t.type.startsWith("child")||t.type.startsWith("twin"))t.type.startsWith("twin")?b=`M ${e.x} ${e.y} L ${E} ${I}`:b=`M ${e.x} ${e.y} L ${E} ${e.y} L ${E} ${I}`;else if(m.lineStyle.startsWith("zigzag")){let ce=4,ne=12;m.lineStyle==="zigzag-thick"&&(ce=6,ne=10),b=vr(e.x,e.y,E,I,ce,ne)}else b=`M ${e.x} ${e.y} Q ${L} ${A} ${E} ${I}`;const M=m.lineStyle==="dashed"?"8,4":m.lineStyle==="dotted"?"2,2":"0",C=()=>{let ce=L,ne=A;return t.type==="best-friend"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]}):v==="fusion"||v==="triple"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]}):v==="fusion-hostile"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:vr(e.x,e.y,E,I),stroke:"red",strokeWidth:1.5,fill:"none"})]}):v==="triple-zigzag"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:vr(e.x,e.y,E,I),stroke:"red",strokeWidth:1.5,fill:"none"})]}):v==="double"||v==="double-zigzag"||v==="best-friend"?a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none",strokeDasharray:M}):v==="oblique"?a.jsx("line",{x1:ce+5,y1:ne-10,x2:ce-5,y2:ne+10,stroke:k,strokeWidth:2}):v==="oblique-double"?a.jsxs("g",{children:[a.jsx("line",{x1:ce+2,y1:ne-10,x2:ce-8,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:ce+8,y1:ne-10,x2:ce-2,y2:ne+10,stroke:k,strokeWidth:2})]}):v==="x-cross"?a.jsxs("g",{children:[a.jsx("line",{x1:ce+5,y1:ne-10,x2:ce-5,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:ce-5,y1:ne-10,x2:ce+5,y2:ne+10,stroke:k,strokeWidth:2})]}):v==="oblique-double-crossed"?a.jsxs("g",{children:[a.jsx("line",{x1:ce+2,y1:ne-10,x2:ce-8,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:ce+8,y1:ne-10,x2:ce-2,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:ce-8,y1:ne-10,x2:ce+8,y2:ne+10,stroke:k,strokeWidth:2})]}):v==="cutoff-double"?a.jsxs("g",{children:[a.jsx("line",{x1:ce-3,y1:ne-10,x2:ce-3,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:ce+3,y1:ne-10,x2:ce+3,y2:ne+10,stroke:k,strokeWidth:2})]}):v==="cutoff"?a.jsx("line",{x1:ce,y1:ne-10,x2:ce,y2:ne+10,stroke:k,strokeWidth:3}):v==="cutoff-repaired-circle"?a.jsxs("g",{children:[a.jsx("line",{x1:ce-4,y1:ne-10,x2:ce-14,y2:ne+10,stroke:k,strokeWidth:2}),a.jsx("circle",{cx:ce,cy:ne,r:5,fill:"none",stroke:k,strokeWidth:1.5}),a.jsx("line",{x1:ce+14,y1:ne-10,x2:ce+4,y2:ne+10,stroke:k,strokeWidth:2})]}):v==="dashed-inner"?a.jsx("g",{children:a.jsx("path",{d:b,stroke:k,strokeWidth:1.5,strokeDasharray:"4,4",fill:"none",transform:"translate(0, 6)"})}):v==="triple-zigzag-center"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(6,6)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-6,-6)",fill:"none"}),a.jsx("path",{d:vr(e.x,e.y,E,I,4,12),stroke:"red",strokeWidth:1.5,fill:"none"})]}):v==="triangle-up-center"?a.jsx("polygon",{points:"-6,0 6,0 0,-10",fill:k,transform:`translate(${L},${A})`}):v==="arrow-x-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T}),a.jsxs("g",{transform:x,children:[a.jsx("line",{x1:"-6",y1:"-6",x2:"6",y2:"6",stroke:k,strokeWidth:2}),a.jsx("line",{x1:"-6",y1:"6",x2:"6",y2:"-6",stroke:k,strokeWidth:2})]})]}):v==="arrow-box-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T}),a.jsx("rect",{x:"-6",y:"-6",width:"12",height:"12",stroke:k,strokeWidth:2,fill:"white",transform:x})]}):v==="arrow-diamond-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T}),a.jsx("polygon",{points:"0,-6 6,0 0,6 -6,0",stroke:k,strokeWidth:2,fill:"white",transform:x})]}):v==="arrow-double-bar-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T}),a.jsxs("g",{transform:x,children:[a.jsx("line",{x1:"-3",y1:"-8",x2:"-3",y2:"8",stroke:k,strokeWidth:2}),a.jsx("line",{x1:"3",y1:"-8",x2:"3",y2:"8",stroke:k,strokeWidth:2})]})]}):v.includes("arrow")&&!v.includes("center")&&!v.includes("thick")?a.jsx("g",{children:a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T})}):v==="arrow-thick"?a.jsx("polygon",{points:"-8,-8 4,0 -8,8",fill:k,transform:T}):v==="arrow-end"?a.jsx("g",{children:a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:T})}):v==="arrow-open-end"?a.jsx("g",{children:a.jsx("polyline",{points:"-6,-6 6,0 -6,6",stroke:k,strokeWidth:2,fill:"none",transform:T})}):v==="arrow-open-center"?a.jsx("g",{children:a.jsx("polyline",{points:"-6,-6 6,0 -6,6",stroke:k,strokeWidth:2,fill:"none",transform:x})}):v==="triple-zigzag-center-arrow"?a.jsxs("g",{children:[a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(6,6)",fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:1,transform:"translate(-6,-6)",fill:"none"}),a.jsx("path",{d:vr(e.x,e.y,E,I,4,12),stroke:"red",strokeWidth:1.5,fill:"none"}),a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:"red",transform:T})]}):null},Je=ce=>{ce.stopPropagation(),ce.preventDefault(),c(ce,t.id)};return a.jsxs("g",{className:"group hover:opacity-80 cursor-pointer",onClick:o,children:[a.jsx("path",{d:b,stroke:"transparent",strokeWidth:20,fill:"none"}),a.jsx("path",{d:b,stroke:k,strokeWidth:r||m.lineStyle==="zigzag-thick"?3:2,strokeDasharray:M,fill:"none"}),a.jsx(C,{}),t.label&&a.jsx("text",{x:L,y:A-15,textAnchor:"middle",fill:k,className:"text-[10px] bg-white dark:bg-gray-800 px-1",children:t.label}),r&&P&&a.jsxs("g",{transform:`translate(${L}, ${D})`,onPointerDown:Je,style:{touchAction:"none"},children:[a.jsx("circle",{r:12,fill:"#10b981",stroke:"white"}),a.jsx(Tl,{size:12,x:-6,y:-6,stroke:"white",strokeWidth:3}),a.jsx("title",{children:"Aggiungi Figlio alla Coppia"})]})]})},uC=({node:t,isSelected:e,showLabelType:n,darkMode:r,onHandleDown:s,selectionMode:i,onRename:o})=>{const[c,u]=H.useState(!1),[h,m]=H.useState(t.name),g=H.useRef(null);H.useEffect(()=>{c&&g.current&&(g.current.focus(),g.current.select())},[c]);const v=ne=>{ne.stopPropagation(),m(t.name),u(!0)},k=()=>{u(!1),h.trim()!==""&&h!==t.name&&o(t.id,h)},P=ne=>{ne.key==="Enter"&&k(),ne.key==="Escape"&&u(!1)},D=r?"#ffffff":"#000000",L=e||t.indexPerson?3:1.5,A=e?r?"#374151":"#e0f2fe":r?"#1f2937":"#ffffff",b=r?"#ffffff":"#000000",N=r?"#111827":"#ffffff",S=zt,z=wr,G=Ho;let T;switch(t.gender){case"M":T=a.jsx("rect",{x:0,y:0,width:S,height:z,stroke:D,strokeWidth:L,fill:A});break;case"F":T=a.jsx("circle",{cx:S/2,cy:z/2,r:S/2,stroke:D,strokeWidth:L,fill:A});break;case"TransWoman":T=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:S,height:z,stroke:D,strokeWidth:L,fill:A}),a.jsx("circle",{cx:S/2,cy:z/2,r:S/3,stroke:D,strokeWidth:1,fill:"none"})]});break;case"TransMan":T=a.jsxs("g",{children:[a.jsx("circle",{cx:S/2,cy:z/2,r:S/2,stroke:D,strokeWidth:L,fill:A}),a.jsx("rect",{x:10,y:10,width:S-20,height:z-20,stroke:D,strokeWidth:1,fill:"none"})]});break;case"NonBinary":T=a.jsx("polygon",{points:`${S/2},0 ${S},${z/2} ${S/2},${z} 0,${z/2}`,stroke:D,strokeWidth:L,fill:A});break;case"Pet":T=a.jsx("path",{d:`M${S/2} 0 L${S} ${z/2} L${S/2} ${z} L0 ${z/2} Z`,stroke:D,strokeWidth:L,fill:A});break;case"Pregnancy":T=a.jsx("path",{d:`M${S/2} 0 L${S} ${z} L0 ${z} Z`,stroke:D,strokeWidth:L,fill:A});break;case"Miscarriage":T=a.jsx("circle",{cx:S/2,cy:z/2,r:8,fill:D});break;case"Abortion":T=a.jsx("g",{children:a.jsx("path",{d:`M5 5 L${S-5} ${z-5} M${S-5} 5 L5 ${z-5}`,stroke:D,strokeWidth:2})});break;case"Stillbirth":T=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:S,height:z,stroke:D,strokeWidth:L,fill:A}),a.jsx("path",{d:`M0 0 L${S} ${z} M${S} 0 L0 ${z}`,stroke:D,strokeWidth:1})]});break;default:T=a.jsx("rect",{x:5,y:5,width:S-10,height:z-10,stroke:D,strokeWidth:L,fill:A,strokeDasharray:"4 2"});break}const x=()=>a.jsxs("g",{className:"pointer-events-none",children:[t.substanceAbuse&&(t.gender==="M"?a.jsx("rect",{x:0,y:z/2,width:S,height:z/2,fill:"#f97316",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M 0 ${z/2} A ${G} ${G} 0 0 0 ${S} ${z/2} Z`,fill:"#f97316",fillOpacity:"0.8",stroke:"none"})),t.mentalIssue&&(t.gender==="M"?a.jsx("rect",{x:0,y:0,width:S/3,height:z,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M ${G} 0 A ${G} ${G} 0 0 0 ${G} ${z} Z`,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"})),t.gayLesbian&&a.jsx("path",{d:`M ${S/2-7} ${z-12} L ${S/2+7} ${z-12} L ${S/2} ${z} Z`,fill:"#ec4899",stroke:A,strokeWidth:1})]}),E=t.deceased?a.jsxs("g",{stroke:D,strokeWidth:1.5,children:[a.jsx("line",{x1:0,y1:0,x2:S,y2:z}),a.jsx("line",{x1:S,y1:0,x2:0,y2:z})]}):null,I=t.indexPerson?t.gender==="M"?a.jsx("rect",{x:6,y:6,width:S-12,height:z-12,stroke:D,strokeWidth:1.5,fill:"none"}):a.jsx("circle",{cx:S/2,cy:z/2,r:S/2-6,stroke:D,strokeWidth:1.5,fill:"none"}):null,R=t.birthDate&&t.birthDate.trim()!=="",M=t.showAge!==!1;let C="";if(R&&M)if(n==="age")C=_l(t.birthDate);else if(n==="year"){const ne=Jw(t.birthDate);ne&&(C=ne.getFullYear().toString())}else n==="date"&&(C=t.birthDate);const Je=(ne,Oe)=>{ne.stopPropagation(),ne.preventDefault(),s(ne,Oe,t.id)},ce=({y:ne,text:Oe,size:Z,bold:fe})=>{if(!Oe)return null;const ue=Z*.65,Ie=Oe.length*ue+8,je=Z+4;return a.jsxs("g",{pointerEvents:"none",children:[a.jsx("rect",{x:S/2-Ie/2,y:ne-je/2,width:Ie,height:je,fill:N,fillOpacity:"0.9",rx:"3"}),a.jsx("text",{x:S/2,y:ne,dominantBaseline:"middle",textAnchor:"middle",fill:b,className:`text-[${Z}px] font-sans ${fe?"font-bold":""} select-none`,style:{fontSize:Z},children:Oe})]})};return a.jsxs("g",{transform:`translate(${t.x},${t.y})`,className:"cursor-pointer group",onDoubleClick:v,children:[T," ",a.jsx(x,{})," ",I," ",E,c?a.jsx("foreignObject",{x:-40,y:-30,width:120,height:30,children:a.jsx("input",{ref:g,value:h,onChange:ne=>m(ne.target.value),onBlur:k,onKeyDown:P,style:{width:"100%",height:"100%",border:"1px solid #3b82f6",borderRadius:"4px",padding:"2px",fontSize:"12px",textAlign:"center",background:N,color:b,outline:"none"}})}):a.jsx(ce,{y:-10,text:t.name,size:11,bold:!0}),C&&a.jsx("text",{x:S/2,y:z/2,dominantBaseline:"middle",textAnchor:"middle",fill:b,className:"text-[11px] font-bold select-none pointer-events-none opacity-80",children:C}),t.label&&a.jsx(ce,{y:z+14,text:t.label,size:9}),t.notes&&t.notes.length>0&&a.jsx("circle",{cx:S+5,cy:0,r:4,fill:"#ef4444",stroke:"white",strokeWidth:1}),e&&!i&&!c&&a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${S+20}, ${G})`,onPointerDown:ne=>Je(ne,"spouse"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#db2777",strokeWidth:2}),a.jsx(Do,{size:14,x:-7,y:-7,fill:"#db2777",stroke:"#db2777"}),a.jsx("title",{children:"Coniuge"})]}),a.jsxs("g",{transform:`translate(${G}, ${z+25})`,onPointerDown:ne=>Je(ne,"child"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#10b981",strokeWidth:2}),a.jsx(Tl,{size:14,x:-7,y:-7,color:"#10b981",strokeWidth:3}),a.jsx("title",{children:"Figlio"})]}),a.jsxs("g",{transform:`translate(${G}, -25)`,onPointerDown:ne=>Je(ne,"parents"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#8b5cf6",strokeWidth:2}),a.jsx(Mo,{size:14,x:-7,y:-7,color:"#8b5cf6"}),a.jsx("title",{children:"Genitori"})]}),a.jsxs("g",{transform:`translate(-20, ${G})`,onPointerDown:ne=>Je(ne,"link"),className:"cursor-alias hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:1}),a.jsx(Sp,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Relazione"})]})]})]})},dC=({x:t,y:e,mode:n,customPresets:r,onSelect:s,onClose:i})=>{let o=[];n==="child"||n==="parents"?o=_r.Figli||[]:n==="spouse"?o=_r["Struttura / Coppia"]||[]:o=["Interazione / Affettive","Conflitto e Distanza","Violenza, Abuso e Potere","Simboli (Immagini)"].reduce((m,g)=>m.concat(_r[g]||[]),[]);const c=[...o.map(h=>{const m=rn[h];return m?{type:h,label:m.label}:null}).filter(Boolean),...r.map(h=>({type:h.id,label:h.name}))],u={left:t,top:e};return t>window.innerWidth-260&&(u.left=t-260),e>window.innerHeight-300&&(u.top=e-300),a.jsxs("div",{className:"fixed theme-panel shadow-2xl rounded-lg p-2 w-64 border theme-border z-[9999] flex flex-col max-h-80",style:u,children:[a.jsxs("div",{className:"text-[10px] font-bold opacity-50 uppercase px-2 py-1 rounded sticky top-0 flex justify-between items-center z-10 mb-1",style:{backgroundColor:"rgba(127,127,127,0.1)"},children:[a.jsx("span",{children:"Seleziona Tipo"}),a.jsx("button",{onClick:i,className:"hover:text-red-500",children:a.jsx(Bs,{size:12})})]}),a.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:c.map(h=>h&&a.jsxs("button",{onClick:()=>s(h.type),className:"w-full flex items-center gap-2 p-2 text-xs theme-hover text-left border-b theme-border last:border-0",children:[a.jsx("div",{className:"shrink-0",children:a.jsx(Ou,{type:h.type})}),a.jsx("span",{className:"truncate",children:h.label})]},h.type))})]})},hC={Pastello:Kw,Vividi:Qw,Neutri:ZA},fC=({value:t,onChange:e})=>{const n=H.useRef(null);return a.jsxs("div",{className:"space-y-2",children:[Object.entries(hC).map(([r,s])=>a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1",children:r}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.map(i=>a.jsx("button",{onClick:()=>e(i),className:"w-6 h-6 rounded-full border border-black/10 dark:border-white/10 transition-transform hover:scale-110 flex items-center justify-center relative",style:{backgroundColor:i},title:i,children:t.toLowerCase()===i.toLowerCase()&&a.jsx("div",{className:`w-2 h-2 rounded-full ${["#ffffff","#f3f4f6","#fbcfe8","#fde68a"].includes(i)?"bg-black":"bg-white"}`})},i))})]},r)),a.jsxs("div",{className:"pt-2 border-t theme-border mt-2",children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},className:"w-full flex items-center justify-center gap-2 p-1.5 text-xs rounded border theme-border theme-hover opacity-70 hover:opacity-100",children:[a.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:t}}),a.jsx("span",{children:"Colore Personalizzato..."})]}),a.jsx("input",{ref:n,type:"color",className:"hidden",value:t,onChange:r=>e(r.target.value)})]})]})},oh=({notes:t,onChange:e})=>{const[n,r]=H.useState(""),[s,i]=H.useState(""),[o,c]=H.useState(null),u=H.useMemo(()=>[...t].sort((g,v)=>{const k=Lu(g.date);return Lu(v.date)-k}),[t]),h=()=>{if(!n.trim())return;const g=s||new Date().toLocaleDateString();o?(e(t.map(v=>v.id===o?{...v,text:n,date:g}:v)),c(null)):e([...t,{id:Ve(),text:n,date:g}]),r(""),i("")},m=g=>{c(g.id),r(g.text),i(g.date)};return a.jsxs("div",{className:"border-t theme-border pt-2 mt-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1 theme-text",children:"Diario Clinico / Note"}),a.jsx("div",{className:"space-y-1 mb-2 max-h-32 overflow-y-auto custom-scrollbar",children:u.map(g=>a.jsxs("div",{className:"p-2 rounded text-xs relative group border theme-border bg-yellow-50/10 border-yellow-200/50 dark:border-yellow-900/30",children:[a.jsx("div",{className:"absolute inset-0 bg-yellow-500 opacity-10 rounded pointer-events-none"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("div",{className:"font-bold opacity-50 text-[10px] theme-text",children:g.date||"Senza data"}),a.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:()=>m(g),className:"theme-text hover:bg-black/10 dark:hover:bg-white/10 rounded p-0.5",children:a.jsx(vu,{size:10})}),a.jsx("button",{onClick:()=>e(t.filter(v=>v.id!==g.id)),className:"text-red-500 hover:bg-red-100 rounded p-0.5",children:a.jsx(Bs,{size:10})})]})]}),a.jsx("div",{className:"whitespace-pre-wrap theme-text",children:g.text})]})]},g.id))}),a.jsxs("div",{className:"flex flex-col gap-1 border theme-border p-1 rounded bg-black/5 dark:bg-white/5",children:[a.jsx("input",{type:"text",className:"w-full text-[10px] border-b theme-border bg-transparent p-1 outline-none theme-text placeholder-opacity-50 placeholder-current",value:s,onChange:g=>i(g.target.value),placeholder:"Data (es. Gennaio 2025, 12/05/98)"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("textarea",{className:"flex-1 border-none bg-transparent text-xs p-1 outline-none resize-none h-12 theme-text placeholder-opacity-50 placeholder-current",value:n,onChange:g=>r(g.target.value),placeholder:o?"Modifica nota...":"Nuova nota...",onKeyDown:g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),h())}}),a.jsx("button",{onClick:h,className:"bg-blue-600 text-white p-1 rounded self-end hover:bg-blue-700",children:o?a.jsx(Ix,{size:14}):a.jsx(Tl,{size:14})}),o&&a.jsx("button",{onClick:()=>{c(null),r(""),i("")},className:"bg-gray-200 text-gray-600 p-1 rounded self-end hover:bg-gray-300",children:a.jsx(Bs,{size:14})})]})]})]})},pC=({onClose:t,nodes:e,edges:n,groups:r})=>{const[s,i]=H.useState(null),[o,c]=H.useState(""),u=H.useMemo(()=>{if(!s)return null;const m=e.find(N=>N.id===s);if(!m)return null;const v=n.filter(N=>(N.fromId===s||N.toId===s)&&_r.Struttura.includes(N.type)).map(N=>{const S=N.fromId===s?N.toId:N.fromId,z=e.find(T=>T.id===S),G=rn[N.type];return{name:z?z.name:"Sconosciuto",type:G?G.label:N.type}}),P=n.filter(N=>N.fromId===s||N.toId===s).map(N=>{if(_r.Struttura.includes(N.type))return null;const S=N.fromId===s?N.toId:N.fromId;let z="Sconosciuto";const G=e.find(x=>x.id===S);if(G)z=G.name;else{const x=r.find(E=>E.id===S);if(x){const E=e.filter(I=>x.memberIds.includes(I.id)).map(I=>I.name).join(", ");z=`Gruppo: ${x.label} (Membri: ${E})`}}const T=rn[N.type];return{id:N.id,with:z,type:T?T.label:N.type,notes:N.notes}}).filter(Boolean),L=n.filter(N=>N.toId===s&&N.type.startsWith("child")).map(N=>{const S=e.find(z=>z.id===N.fromId);return S?S.name:"Ignoto"}),b=n.filter(N=>N.fromId===s&&N.type.startsWith("child")).map(N=>{const S=e.find(z=>z.id===N.toId);return S?S.name:"Ignoto"});return{person:m,relations:P,parents:L,children:b,spouses:v}},[s,e,n,r]),h=e.filter(m=>m.name.toLowerCase().includes(o.toLowerCase()));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel border theme-border rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex overflow-hidden",children:[a.jsxs("div",{className:"w-1/3 border-r theme-border flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h2",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(Eo,{})," Report"]}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx(xu,{className:"absolute left-2 top-2.5 opacity-50 theme-text",size:14}),a.jsx("input",{className:"w-full pl-8 p-2 text-sm border rounded bg-transparent theme-border theme-text placeholder-opacity-50 placeholder-current focus:outline-none focus:ring-1 focus:ring-[var(--theme-accent)]",placeholder:"Cerca persona...",value:o,onChange:m=>c(m.target.value)})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:h.map(m=>a.jsxs("button",{onClick:()=>i(m.id),className:`w-full text-left p-3 border-b theme-border theme-hover transition-colors ${s===m.id?"bg-black/10 dark:bg-white/10 border-l-4 border-l-[var(--theme-accent)]":""}`,children:[a.jsx("div",{className:"font-bold text-sm theme-text",children:m.name}),a.jsxs("div",{className:"text-xs opacity-50 theme-text",children:[m.gender,"  ",_l(m.birthDate)," anni"]})]},m.id))})]}),a.jsxs("div",{className:"flex-1 flex flex-col bg-black/5 dark:bg-white/5",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center theme-panel border-b theme-border",children:[a.jsx("h3",{className:"font-bold theme-text",children:"Dettagli Scheda"}),a.jsx("button",{onClick:t,className:"theme-text theme-hover p-1 rounded",children:a.jsx(Bs,{})})]}),a.jsx("div",{className:"p-6 overflow-y-auto flex-1 custom-scrollbar",children:u?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsx("div",{className:`w-16 h-16 flex items-center justify-center rounded-full text-2xl font-bold shadow-sm border theme-border ${["M","TransMan"].includes(u.person.gender)?"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200":["F","TransWoman"].includes(u.person.gender)?"bg-pink-100 text-pink-600 dark:bg-pink-900 dark:text-pink-200":"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-200"}`,children:u.person.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold theme-text",children:u.person.name}),a.jsxs("div",{className:"text-sm opacity-70 theme-text",children:["Nato/a: ",u.person.birthDate||"?","  Et: ",_l(u.person.birthDate)]})]})]}),u.spouses.length>0&&a.jsxs("div",{className:"p-4 rounded shadow-sm border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h4",{className:"font-bold mb-2 text-sm uppercase opacity-70 theme-text flex items-center gap-2",children:[a.jsx(Do,{size:12})," Partner / Coniugi"]}),u.spouses.map((m,g)=>a.jsxs("div",{className:"font-medium theme-text",children:[" ",m.name," ",a.jsxs("span",{className:"opacity-60 text-xs",children:["(",m.type,")"]})]},g))]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Genitori"}),u.parents.length?u.parents.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Figli"}),u.children.length?u.children.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsxs("h4",{className:"font-bold mb-3 text-sm uppercase opacity-50 theme-text",children:["Altre Relazioni (",u.relations.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[u.relations.map(m=>a.jsxs("div",{className:"flex justify-between items-center p-2 border theme-border rounded theme-hover",children:[a.jsxs("span",{className:"font-medium theme-text",children:[m.type," ",a.jsx("span",{className:"font-normal opacity-70",children:"con"})," ",m.with]}),m.notes.length>0&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100 px-2 py-0.5 rounded border border-yellow-200 dark:border-yellow-700",children:"Note"})]},m.id)),u.relations.length===0&&a.jsx("div",{className:"text-sm opacity-50 theme-text",children:"Nessuna altra relazione registrata"})]})]})]}):a.jsx("div",{className:"opacity-50 text-center mt-20 theme-text",children:"Seleziona una persona per vedere il report"})})]})]})})},mC=({onClose:t,onExport:e,onImport:n,setCustomUser:r,customUser:s,setFirebaseConfig:i,firebaseConfig:o})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel p-6 rounded-lg shadow-xl w-96 space-y-4 border theme-border",children:[a.jsxs("h2",{className:"font-bold text-lg flex justify-between items-center",children:["Impostazioni ",a.jsx("button",{onClick:t,children:a.jsx(Bs,{size:20})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"ID Utente (Opzionale)"}),a.jsx("input",{className:"w-full border theme-border p-2 rounded bg-transparent text-sm",value:s,onChange:c=>r(c.target.value),placeholder:"Tuo ID univoco per sync"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Configurazione Firebase (JSON)"}),a.jsx("textarea",{className:"w-full border theme-border p-2 rounded bg-transparent text-[10px] h-24 font-mono",value:o,onChange:c=>i(c.target.value),placeholder:'{"apiKey": "...", ...}'})]}),a.jsxs("div",{className:"pt-4 border-t theme-border flex flex-col gap-2",children:[a.jsxs("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm flex items-center justify-center gap-2",children:[a.jsx(kp,{size:14})," Backup Dati (JSON)"]}),a.jsxs("label",{className:"w-full border theme-border py-2 rounded text-sm flex items-center justify-center gap-2 cursor-pointer theme-hover",children:[a.jsx(Bb,{size:14})," Ripristina Backup",a.jsx("input",{type:"file",onChange:n,className:"hidden",accept:".json"})]})]})]})}),gC=({onClose:t,firebaseConfig:e})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-4xl h-[90vh] rounded-xl shadow-2xl flex flex-col overflow-hidden border theme-border",children:[a.jsxs("div",{className:"p-4 border-b theme-border flex justify-between items-center bg-black/5 dark:bg-white/5 shrink-0",children:[a.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2 theme-text",children:[a.jsx(Ip,{className:"text-[var(--theme-accent)]"})," Manuale Utente"]}),a.jsx("button",{onClick:t,className:"p-1 theme-hover rounded theme-text",children:a.jsx(Bs,{})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar leading-relaxed",children:[a.jsx("style",{children:`
                        .manual-section { margin-bottom: 40px; }
                        .manual-h2 { font-size: 1.4rem; font-weight: 700; color: var(--theme-accent); border-left: 4px solid var(--theme-accent); padding-left: 12px; margin-bottom: 1.5rem; margin-top: 1rem; background: rgba(125,125,125,0.05); padding-top:8px; padding-bottom:8px; border-radius: 0 8px 8px 0; }
                        .manual-h3 { font-size: 1.1rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.8rem; opacity: 0.9; color: var(--theme-text); border-bottom: 1px dashed var(--theme-border); padding-bottom: 4px; }
                        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; margin-top: 15px; }
                        .tool-card { border: 1px solid var(--theme-border); border-radius: 8px; padding: 16px; display: flex; gap: 16px; background: rgba(125,125,125,0.03); align-items: flex-start; transition: transform 0.2s; }
                        .tool-card:hover { background: rgba(125,125,125,0.06); }
                        .key-badge { background: rgba(125,125,125,0.1); border: 1px solid var(--theme-border); padding: 2px 8px; border-radius: 6px; font-family: monospace; font-weight: bold; font-size: 0.9em; color: var(--theme-text); display: inline-block; min-width: 24px; text-align: center; }
                        .theme-text-desc { color: var(--theme-text); opacity: 0.7; font-size: 0.9rem; margin-top: 4px; line-height: 1.4; }
                        .icon-box { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: rgba(125,125,125,0.1); }
                        ul.manual-list { list-style: disc; margin-left: 20px; color: var(--theme-text); opacity: 0.9; }
                        ul.manual-list li { margin-bottom: 6px; }
                        strong { color: var(--theme-text); opacity: 1; }
                    `}),a.jsxs("div",{className:"text-center mb-10",children:[a.jsx("h1",{className:"text-3xl font-bold theme-text mb-2",children:"GenoPro Web"}),a.jsx("p",{className:"opacity-60 theme-text text-lg",children:"Guida completa alle funzionalit, strumenti e simbologia."})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"1. Dashboard e Temi"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(tf,{className:"text-blue-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Categorie"}),a.jsx("div",{className:"theme-text-desc",children:"Filtra per Famiglie, Coppie, Individuali, Lavoro, ecc."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Tp,{className:"text-orange-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Temi Grafici"}),a.jsxs("div",{className:"theme-text-desc",children:["Scegli tra vari stili: ",a.jsx("b",{children:"Light"}),", ",a.jsx("b",{children:"Dark"}),", ",a.jsx("b",{children:"Sepia"}),", ",a.jsx("b",{children:"Dracula"}),", ",a.jsx("b",{children:"Nordic"})," e altri."]})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(xu,{className:"text-purple-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Ricerca"}),a.jsx("div",{className:"theme-text-desc",children:"Cerca genogrammi velocemente per titolo."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"2. Navigazione Touch (Tablet & iPad)"}),a.jsx("p",{className:"theme-text mb-4 opacity-80",children:"L'interfaccia  ottimizzata per l'uso con le dita e supporta gesture avanzate."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 rounded border theme-border bg-blue-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scorrimento (Pan)"}),a.jsx("p",{className:"theme-text-desc",children:"Trascina un dito su un'area vuota per spostarti nel grafico."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-green-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Zoom (Pinch)"}),a.jsx("p",{className:"theme-text-desc",children:"Usa due dita (pizzico) per ingrandire o rimpicciolire la vista."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-purple-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiunta Rapida (Long Press)"}),a.jsxs("p",{className:"theme-text-desc",children:["Tocca e ",a.jsx("b",{children:"tieni premuto"})," un dito su un punto vuoto per aprire il menu rapido (M/F)."]})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-orange-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Selezione Multipla"}),a.jsxs("p",{className:"theme-text-desc",children:["Attiva ",a.jsx("strong",{children:"Mod. Selezione"})," nella toolbar, poi trascina per creare un rettangolo."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"3. Costruzione Rapida"}),a.jsx("p",{className:"mb-4 theme-text opacity-80",children:"Seleziona una persona per vedere le 4 maniglie colorate:"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-pink-100 dark:bg-pink-900/30 border border-pink-200 dark:border-pink-800",children:a.jsx(Do,{size:20,className:"text-pink-600 dark:text-pink-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Destra: Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un coniuge/partner a destra."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800",children:a.jsx(Tl,{size:20,className:"text-green-600 dark:text-green-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Basso: Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio (collegato alla coppia se presente)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-purple-100 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800",children:a.jsx(Mo,{size:20,className:"text-purple-600 dark:text-purple-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Alto: Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Genera automaticamente la coppia di genitori sopra il soggetto."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800",children:a.jsx(Sp,{size:20,className:"text-orange-600 dark:text-orange-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Sinistra: Link"}),a.jsxs("div",{className:"theme-text-desc",children:["Trascina verso un'altra persona ",a.jsx("b",{children:"o un Gruppo"})," per creare una relazione manuale."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"4. Propriet e Simbologia"}),a.jsx("h3",{className:"manual-h3",children:" Propriet Persona"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Dati Anagrafici:"}),' Nome, Data (es. "1980" o "12/05/1980").']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Mostra Et:"})," Checkbox per nascondere/mostrare l'et calcolata."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Marcatori Clinici:"})," Deceduto (X), Pz. Designato (Doppio bordo), Abuso Sostanze (Arancio), Problema Psi (Viola), Omosessualit (Triangolo Rosa)."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Relazione"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Tipo Relazione:"})," Scegli tra decine di stili (Conflitto, Armonia, Abuso, Distanza, ecc.)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Ancoraggio Gruppi:"})," Se colleghi un gruppo, usa lo ",a.jsx("strong",{children:"Slider (0-100%)"})," nella sidebar per spostare la freccia lungo il bordo curvo."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Gruppo"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Palette Colori:"})," Selettore rapido (Pastello, Vividi, Neutri)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Forma Organica:"})," Si adatta automaticamente al contenuto."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Viola (Basso):"})," Trascina per regolare la grandezza (padding)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Gialla (Sinistra):"})," Trascina per creare relazioni dal gruppo."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"5. Strumenti della Toolbar"}),a.jsx("p",{className:"theme-text opacity-80 mb-4",children:"Ecco la spiegazione di tutti i pulsanti presenti nella barra in alto, da sinistra a destra."}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(nf,{size:20,className:"text-[var(--theme-accent)]"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Maschio"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto maschio al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(ef,{size:20,className:"text-pink-600"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuova Femmina"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto femmina al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ox,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Crea i genitori sopra la persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Do,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un coniuge a fianco della persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ax,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio sotto la selezione (se coppia, collega a entrambi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Mo,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Gruppo"}),a.jsx("div",{className:"theme-text-desc",children:'Raggruppa le persone selezionate in una "Household" o sottosistema.'})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Dx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Auto-Layout"}),a.jsx("div",{className:"theme-text-desc",children:"Riorganizza automaticamente l'intero albero genealogico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(gu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Orizzontale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa riga (Y)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(gu,{size:20,className:"theme-text rotate-90"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Verticale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa colonna (X)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(bx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Figli"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i figli selezionati esattamente sotto al centro dei genitori."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(kx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i genitori selezionati esattamente sopra al centro dei figli."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Sx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Cerchio"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi selezionati in cerchio (utile per sociogrammi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Cx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Ordina i nodi selezionati in una griglia compatta."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Lx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scala / Diagonale"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi in diagonale (utile per linee temporali)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Px,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Snap Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Attiva/Disattiva l'aggancio magnetico dei nodi alla griglia."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Rx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Mod. Selezione"}),a.jsx("div",{className:"theme-text-desc",children:"Permette di selezionare pi elementi trascinando un rettangolo blu."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(vu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Designer Stili"}),a.jsx("div",{className:"theme-text-desc",children:"Editor per creare nuovi tipi di linee o simboli relazionali."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(yu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Legenda"}),a.jsx("div",{className:"theme-text-desc",children:"Mostra o nasconde la legenda automatica sul grafico."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"6. Esportazione"}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-yellow-500/10 mb-4 flex gap-3 items-center",children:[a.jsx(yu,{size:24,className:"text-yellow-600 dark:text-yellow-400 shrink-0"}),a.jsxs("p",{className:"theme-text text-sm",children:[a.jsx("strong",{children:"Nota Importante:"})," L'esportazione mantiene i colori del ",a.jsx("strong",{children:"Tema Attuale"}),'. Se sei in "Dark Mode", il PDF/Immagine avr sfondo scuro. Passa a "Light Mode" prima di esportare se desideri uno sfondo bianco per la stampa.']})]}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"PNG / JPEG:"})," Immagine raster ad alta risoluzione (supporta zoom impostabile da 1x a 6x)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"PDF Vettoriale:"})," Scarica solo il grafico in vettoriale. Perfetto per stampe professionali o tesi (non sgrana mai)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Report Clinico:"})," Genera un documento PDF multipagina con grafico, legenda simboli e scheda testuale dettagliata per ogni persona."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"7. Impostazioni, Backup e Cloud"}),a.jsx("p",{className:"theme-text opacity-80 mb-6",children:"Gestisci i tuoi dati, salvali al sicuro o sincronizzali tra pi dispositivi."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-600",children:a.jsx(kp,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Backup Locale"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Salva tutti i tuoi genogrammi in un unico file (JSON) sul tuo computer. Utile per creare copie di sicurezza o trasferire i dati manualmente."}),a.jsxs("ul",{className:"manual-list text-sm",children:[a.jsxs("li",{children:["Clicca su ",a.jsx(Mx,{size:12,className:"inline"})," ",a.jsx("strong",{children:"Impostazioni"}),"."]}),a.jsxs("li",{children:["Premi ",a.jsx("strong",{children:"Backup Dati"})," per scaricare il file."]}),a.jsxs("li",{children:["Usa ",a.jsx("strong",{children:"Ripristina"})," per caricare un backup salvato."]})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-orange-100 dark:bg-orange-900/30 text-orange-600",children:a.jsx(Nx,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Sincronizzazione Cloud"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Collega un database personale per salvare i dati online e accedervi da PC, iPad e Tablet contemporaneamente."}),a.jsxs("div",{className:"p-3 rounded bg-green-500/10 border border-green-500/20 text-xs theme-text",children:[a.jsx("strong",{className:"text-green-600 dark:text-green-400",children:"Stato:"})," ",e?" Connesso":" Non configurato (Salvataggio solo locale)"]})]})]}),a.jsxs("div",{className:"p-5 rounded-xl border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h3",{className:"text-base font-bold theme-text mb-4 flex items-center gap-2",children:[a.jsx(jb,{size:18,className:"text-[var(--theme-accent)]"}),"Guida: Come creare il tuo Cloud Personale (Gratis)"]}),a.jsxs("div",{className:"space-y-4 text-sm theme-text opacity-90",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"1"}),a.jsxs("div",{children:["Vai su ",a.jsx("a",{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Firebase Console"})," e accedi con il tuo account Google."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"2"}),a.jsxs("div",{children:["Clicca ",a.jsx("strong",{children:'"Crea un progetto"'}),' (chiamalo es. "GenoPro-Mio"). Disabilita Google Analytics per fare prima.']})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"3"}),a.jsxs("div",{children:["Nel menu a sinistra, vai su ",a.jsx("strong",{children:'"Build" > "Firestore Database"'})," e clicca su ",a.jsx("strong",{children:'"Crea Database"'}),".",a.jsx("br",{}),a.jsxs("span",{className:"opacity-70 text-xs",children:["(Seleziona una localit vicina, es. eur3, e scegli avvia in ",a.jsx("strong",{children:"Modalit Test"}),")."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"4"}),a.jsxs("div",{children:["Torna alla ",a.jsx("strong",{children:"Home del Progetto"}),` (icona ingranaggio in alto a sx > Impostazioni progetto). Scorri in basso fino a "Le tue app" e clicca sull'icona `,a.jsx("strong",{children:"Web (</>)"}),"."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"5"}),a.jsxs("div",{children:["Dai un nome all'app e registrala. Ti verr mostrato un codice. Copia tutto il contenuto tra le parentesi graffe:",a.jsxs("div",{className:"mt-2 p-2 bg-gray-200 dark:bg-gray-800 rounded font-mono text-[10px] opacity-70",children:['apiKey: "AIzaSy...",',a.jsx("br",{}),'authDomain: "...",',a.jsx("br",{}),'projectId: "...",',a.jsx("br",{}),"..."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"6"}),a.jsxs("div",{children:["Torna qui in GenoPro, apri ",a.jsx("strong",{children:"Impostazioni"}),' e incolla il codice nel box "Configurazione Firebase".']})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"Scorciatoie da Tastiera"}),a.jsxs("div",{className:"border theme-border rounded overflow-hidden text-sm mt-4",children:[a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 bg-black/5 dark:bg-white/5 font-bold theme-text",children:[a.jsx("span",{children:"Azione"})," ",a.jsx("span",{children:"Tasti"})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Maschio / Femmina"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"M"})," / ",a.jsx("span",{className:"key-badge",children:"F"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Partner"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"S"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Figlio"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"C"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Genitori"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"P"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Seleziona Tutto"}),a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"A"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Cerchio"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"C"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Griglia"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"G"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Scala"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"D"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Allinea Orizz./Vert."})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"H"})," / ",a.jsx("span",{className:"key-badge",children:"V"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Legenda"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"I"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Elimina"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"Canc"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Salva"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"S"})]})]})]})]})]})," ",a.jsx("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 text-center shrink-0",children:a.jsx("button",{onClick:t,className:"px-8 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md transition-all font-medium",children:"Chiudi Manuale"})})]})}),yC=({onClose:t,onSave:e})=>{const[n,r]=H.useState("Nuovo Stile"),[s,i]=H.useState("#000000"),[o,c]=H.useState("solid"),[u,h]=H.useState("standard"),m=()=>{e({id:`custom-${Ve()}`,name:n,type:"relationship",config:{color:s,lineStyle:o,renderType:u,decorator:""}}),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-96 space-y-4 text-black dark:text-white",children:[a.jsx("h3",{className:"font-bold text-lg",children:"Designer Relazioni"}),a.jsx("input",{className:"w-full border p-2 rounded dark:bg-gray-700",value:n,onChange:g=>r(g.target.value),placeholder:"Nome stile"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Colore"}),a.jsx("input",{type:"color",className:"w-full h-8",value:s,onChange:g=>i(g.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Tratteggio"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:o,onChange:g=>c(g.target.value),children:[a.jsx("option",{value:"solid",children:"Solido"}),a.jsx("option",{value:"dashed",children:"Tratteggiato"}),a.jsx("option",{value:"dotted",children:"Puntinato"}),a.jsx("option",{value:"zigzag",children:"ZigZag"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Decorazione"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:u,onChange:g=>h(g.target.value),children:[a.jsx("option",{value:"standard",children:"Nessuna"}),a.jsx("option",{value:"arrow",children:"Freccia Singola"}),a.jsx("option",{value:"arrow-double",children:"Freccia Doppia"}),a.jsx("option",{value:"fusion",children:"Fusione"}),a.jsx("option",{value:"cutoff",children:"Taglio"})]})]}),a.jsx("div",{className:"p-4 border rounded bg-gray-50 dark:bg-gray-900 flex justify-center items-center h-20",children:a.jsx("svg",{width:"200",height:"20",children:a.jsx("line",{x1:"0",y1:"10",x2:"200",y2:"10",stroke:s,strokeWidth:"2",strokeDasharray:o==="dashed"?"5,5":o==="dotted"?"2,2":""})})}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500",children:"Annulla"}),a.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Salva Preset"})]})]})})},vC=t=>{try{if(!t)return null;let e=t.trim();const n=e.indexOf("{"),r=e.lastIndexOf("}");return n===-1||r===-1||(e=e.substring(n,r+1),e=e.replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2":'),e=e.replace(/'/g,'"'),e=e.replace(/,(\s*[}\]])/g,"$1")),JSON.parse(e)}catch(e){console.error("Errore parsing config string:",e);try{return JSON.parse(t)}catch{return null}}},xC=({nodes:t,selectedIds:e,onHandleDown:n,onMove:r})=>{if(e.length<2)return null;const s=t.filter(P=>e.includes(P.id));if(s.length===0)return null;const i=Math.min(...s.map(P=>P.x)),o=Math.max(...s.map(P=>P.x+zt)),c=Math.min(...s.map(P=>P.y)),u=Math.max(...s.map(P=>P.y+wr)),h=20,m=i-h,g=c-h,v=o-i+h*2,k=u-c+h*2;return a.jsxs("g",{pointerEvents:"visible",children:[a.jsx("rect",{x:m,y:g,width:v,height:k,fill:"black",fillOpacity:"0.01",stroke:"#3b82f6",strokeWidth:1,strokeDasharray:"5,5",className:"cursor-move",style:{touchAction:"none"},onPointerDown:r}),a.jsxs("g",{transform:`translate(${m+v/2}, ${g})`,className:"cursor-grab active:cursor-grabbing",onPointerDown:P=>{n(P,"rotate")},style:{touchAction:"none"},children:[a.jsx("line",{x1:0,y1:0,x2:0,y2:-25,stroke:"#3b82f6",strokeWidth:1}),a.jsx("circle",{cx:0,cy:-25,r:5,fill:"white",stroke:"#3b82f6",strokeWidth:2})]}),a.jsx("g",{transform:`translate(${m+v}, ${g+k})`,className:"cursor-nwse-resize",onPointerDown:P=>{n(P,"scale")},style:{touchAction:"none"},children:a.jsx("rect",{x:-6,y:-6,width:12,height:12,fill:"white",stroke:"#3b82f6",strokeWidth:2})})]})},lv=({currentThemeId:t,onChange:e,placement:n="bottom"})=>{const[r,s]=H.useState(!1),i=Is.find(c=>c.id===t)||Is[0],o=H.useRef(null);return H.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&s(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),a.jsxs("div",{className:"relative w-full",ref:o,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors border theme-border theme-panel hover:brightness-95 overflow-hidden",children:[a.jsxs("span",{className:"flex items-center gap-2 truncate min-w-0",children:[i.type==="dark"?a.jsx(jx,{size:14,className:"shrink-0"}):a.jsx(Tp,{size:14,className:"shrink-0"}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsxs("div",{className:"flex gap-1 ml-2 shrink-0",children:[a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.bgMain}}),a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.accent}})]})]}),r&&a.jsxs("div",{className:`absolute left-0 w-64 max-h-80 overflow-y-auto theme-panel border theme-border shadow-xl rounded-lg p-1 z-[100] ${n==="top"?"bottom-full mb-2":"top-full mt-2"}`,children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 px-2 py-1 uppercase theme-text",children:"Seleziona Tema"}),Is.map(c=>a.jsxs("button",{onClick:()=>{e(c.id),s(!1)},className:`w-full flex items-center justify-between p-2 rounded text-xs theme-hover mb-1 ${t===c.id?"border theme-border bg-black/5 dark:bg-white/5":""}`,children:[a.jsx("span",{className:"font-medium theme-text",children:c.label}),a.jsxs("div",{className:"flex gap-1 shrink-0",children:[a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgMain},title:"Sfondo"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgPanel},title:"Pannelli"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.accent},title:"Accento"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20 flex items-center justify-center",style:{background:c.colors.bgMain},children:a.jsx("span",{style:{color:c.colors.text,fontSize:"8px"},children:"A"})})]})]},c.id))]})]})},_C=({note:t,onUpdate:e,onDelete:n})=>{const[r,s]=H.useState("Classico"),[i,o]=H.useState("Classico");return a.jsxs("div",{onPointerDown:c=>c.stopPropagation(),className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b theme-border",children:[a.jsx(rf,{className:"text-yellow-500"}),a.jsx("span",{className:"font-bold",children:"Nota Adesiva"})]}),a.jsxs("div",{className:"bg-black/5 dark:bg-white/5 p-1 rounded flex text-xs font-bold mb-2",children:[a.jsx("button",{onClick:()=>e({variant:"classic"}),className:`flex-1 py-1.5 rounded transition-all ${!t.variant||t.variant==="classic"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Post-it"}),a.jsx("button",{onClick:()=>e({variant:"label"}),className:`flex-1 py-1.5 rounded transition-all ${t.variant==="label"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Etichetta"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Contenuto"}),a.jsx("textarea",{className:"w-full h-24 p-2 rounded border bg-white/50 dark:bg-black/20 theme-border text-sm resize-none focus:ring-2 focus:ring-blue-500 outline-none",style:{fontFamily:t.fontFamily,color:t.textColor},value:t.text,onChange:c=>e({text:c.target.value}),placeholder:"Scrivi qui..."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Sfondo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:r,onChange:c=>s(c.target.value),children:Object.keys(Pa).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:[Pa[r].map(c=>a.jsx("button",{onClick:()=>e({color:c}),className:`w-6 h-6 rounded-full border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.color===c?"ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-800 scale-110":""}`,style:{backgroundColor:c}},c)),a.jsx("button",{onClick:()=>e({color:"transparent",opacity:0}),className:"w-6 h-6 rounded-full border border-dashed border-gray-400 flex items-center justify-center text-[8px] opacity-70 hover:opacity-100",title:"Trasparente",children:"/"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold opacity-50 block mb-1 flex justify-between",children:["Opacit ",a.jsxs("span",{children:[Math.round(t.opacity*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",className:"w-full accent-blue-500",value:t.opacity,onChange:c=>e({opacity:parseFloat(c.target.value)})})]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 my-2"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Font"}),a.jsx("select",{className:"w-full p-2 rounded border bg-transparent theme-border text-sm",value:t.fontFamily,onChange:c=>e({fontFamily:c.target.value}),children:Xw.map(c=>a.jsx("option",{value:c.value,className:"text-black",style:{fontFamily:c.value},children:c.label},c.value))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Testo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:i,onChange:c=>o(c.target.value),children:Object.keys(Pa).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsx("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:Pa[i].map(c=>a.jsx("button",{onClick:()=>e({textColor:c}),className:`w-6 h-6 rounded-md border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.textColor===c?"ring-2 ring-blue-500 ring-offset-1 scale-110":""}`,style:{backgroundColor:c}},c))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"W"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.width,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"H"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.height,readOnly:!0})]})]}),a.jsx("div",{className:"pt-4 border-t theme-border mt-auto",children:a.jsxs("button",{onClick:n,className:"w-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 py-2 rounded text-xs hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Nota"]})})]})},wC=({note:t,isSelected:e,onPointerDown:n,onUpdate:r,zoom:s=1})=>{const[i,o]=H.useState(null);H.useEffect(()=>{if(!i||!i.active)return;const v=P=>{if(i.pointerId!==void 0&&P.pointerId!==void 0&&i.pointerId!==P.pointerId)return;const D=(P.clientX-i.startX)/s,L=(P.clientY-i.startY)/s;let A=i.startW,b=i.startH;i.handle.includes("e")&&(A=Math.max(30,i.startW+D)),i.handle.includes("s")&&(b=Math.max(30,i.startH+L)),r({...t,width:Math.round(A),height:Math.round(b)})},k=P=>{i.pointerId!==void 0&&P.pointerId!==void 0&&i.pointerId!==P.pointerId||o(null)};return window.addEventListener("pointermove",v),window.addEventListener("pointerup",k),()=>{window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",k)}},[i,t,r]);const c=(v,k)=>{v.stopPropagation(),v.preventDefault();try{v.target.setPointerCapture(v.pointerId)}catch{}o({active:!0,handle:k,startX:v.clientX,startY:v.clientY,startW:t.width,startH:t.height,pointerId:v.pointerId})},u=({x:v,y:k,cursor:P,handle:D})=>a.jsx("rect",{x:v-8,y:k-8,width:16,height:16,fill:"white",stroke:"#3b82f6",strokeWidth:1,style:{cursor:P,touchAction:"none"},onPointerDown:L=>c(L,D)}),h=t.variant==="label",m=h?8:1,g=h&&t.opacity===0&&(e||(i==null?void 0:i.active));return a.jsxs("g",{transform:`translate(${t.x}, ${t.y})`,onPointerDown:n,className:"cursor-move group",children:[!h&&a.jsx("rect",{x:3,y:3,width:t.width,height:t.height,fill:"black",fillOpacity:.15*t.opacity,rx:2,pointerEvents:"none"}),a.jsx("rect",{width:t.width,height:t.height,fill:t.color,fillOpacity:t.opacity,stroke:e?"#3b82f6":g?"#ccc":"rgba(0,0,0,0.05)",strokeWidth:e?2:1,strokeDasharray:g?"4,2":"",rx:m,style:h?{}:{filter:`drop-shadow(0 1px 2px rgba(0,0,0,${.1*t.opacity}))`}}),!h&&a.jsx("rect",{x:0,y:0,width:t.width,height:20,fill:"black",fillOpacity:.05*t.opacity,pointerEvents:"none"}),a.jsx("foreignObject",{x:5,y:5,width:t.width-10,height:t.height-10,style:{pointerEvents:"none"},children:a.jsx("div",{className:"w-full h-full text-sm whitespace-pre-wrap overflow-hidden leading-snug flex items-center justify-center",style:{fontFamily:t.fontFamily||"sans-serif",fontSize:"13px",color:t.textColor||"#000",opacity:t.opacity<.3&&t.textColor==="#000000"?1:.9,textAlign:h?"center":"left",alignItems:h?"center":"flex-start",display:"flex"},children:a.jsx("span",{className:"w-full",children:t.text||(h?"Etichetta":"Nuova nota...")})})}),e&&a.jsxs(a.Fragment,{children:[a.jsx(u,{x:t.width,y:t.height/2,cursor:"ew-resize",handle:"e"}),a.jsx(u,{x:t.width/2,y:t.height,cursor:"ns-resize",handle:"s"}),a.jsx(u,{x:t.width,y:t.height,cursor:"nwse-resize",handle:"se"})]})]})},EC=({onClose:t,onConfirm:e})=>{const[n,r]=H.useState({onlyPeopleWithNotes:!1,showGender:!0,showBirthDate:!0,showAge:!0,showClinical:!0,showGroups:!0,showFamily:!0,showRelations:!0,showNotes:!0}),s=i=>r(o=>({...o,[i]:!o[i]}));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-md rounded-xl shadow-2xl border theme-border overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5 flex justify-between items-center",children:[a.jsxs("h3",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(Eo,{size:18})," Configura Report"]}),a.jsx("button",{onClick:t,children:a.jsx(Bs,{size:18,className:"theme-text opacity-50 hover:opacity-100"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 rounded-lg",children:a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600 shrink-0",checked:n.onlyPeopleWithNotes,onChange:()=>s("onlyPeopleWithNotes")}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm text-blue-900 dark:text-blue-100",children:"Includi solo persone con note"}),a.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300 opacity-80",children:"Esclude dal report chi non ha voci nel diario clinico."})]})]})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Dati Anagrafici"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGender,onChange:()=>s("showGender"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Genere"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showBirthDate,onChange:()=>s("showBirthDate"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Data Nascita"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showAge,onChange:()=>s("showAge"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Et"})]})]}),a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Altri Contenuti"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showClinical,onChange:()=>s("showClinical"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Marcatori Clinici (Simboli, Deceduto, ecc)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGroups,onChange:()=>s("showGroups"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Appartenenza a Gruppi"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showFamily,onChange:()=>s("showFamily"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Legami Familiari (Partner, Genitori, Figli)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showRelations,onChange:()=>s("showRelations"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Altre Relazioni (Amicizie, Conflitti, ecc.)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showNotes,onChange:()=>s("showNotes"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Diario Clinico / Note"})]})]})]})]}),a.jsxs("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 flex justify-end gap-2",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm rounded hover:bg-black/10 dark:hover:bg-white/10 theme-text",children:"Annulla"}),a.jsxs("button",{onClick:()=>e(n),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded shadow-sm flex items-center gap-2",children:[a.jsx(Eo,{size:16})," Genera PDF"]})]})]})})};function bC(){var da;const t=H.useRef(null),e=H.useRef(null),n=H.useRef(null),r=H.useRef({clientX:0,clientY:0}),s=H.useRef(!1),i=H.useRef(null),[o,c]=H.useState(null),[u,h]=H.useState([]),[m,g]=H.useState([]),[v,k]=H.useState(!1),P=H.useRef(null),D=f=>{if(f.touches.length===2){s.current=!0;const y=f.touches[0],w=f.touches[1],j=Math.hypot(y.clientX-w.clientX,y.clientY-w.clientY);P.current={dist:j}}},L=f=>{if(f.touches.length===2&&P.current){s.current=!0;const y=f.touches[0],w=f.touches[1],j=Math.hypot(y.clientX-w.clientX,y.clientY-w.clientY),F=j/P.current.dist,O=Math.min(Math.max(ei*F,.1),5);Or(O),P.current={dist:j}}},A=f=>{f.touches.length<2&&(P.current=null,setTimeout(()=>{s.current=!1},100))};H.useEffect(()=>{const f=async()=>{if(!document.fullscreenElement)try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&await document.documentElement.webkitRequestFullscreen()}catch(w){console.log("Fullscreen request blocked/ignored",w)}};f();const y=()=>{f(),window.removeEventListener("touchstart",y),window.removeEventListener("mousedown",y)};return window.addEventListener("touchstart",y),window.addEventListener("mousedown",y),()=>{window.removeEventListener("touchstart",y),window.removeEventListener("mousedown",y)}},[]),H.useEffect(()=>{(async()=>{try{await rk.hide()}catch{console.log("Status bar hide not supported on web")}})()},[]),H.useEffect(()=>{const f=y=>{console.log("S PEN NATIVE:",y);const{clientX:w,clientY:j}=r.current,{x:F,y:O}=z(w,j);Oe({x:w,y:j,gx:F,gy:O})};return window.addEventListener("sPenNativeEvent",f),()=>{window.removeEventListener("sPenNativeEvent",f)}},[]),H.useEffect(()=>{const f=y=>{r.current={clientX:y.clientX,clientY:y.clientY}};return window.addEventListener("mousemove",f),()=>window.removeEventListener("mousemove",f)},[]);const b=()=>{var w;const{clientX:f,clientY:y}=r.current;if(f===0&&y===0)return{x:At,y:At};if(t.current&&e.current){const j=t.current.createSVGPoint();j.x=f,j.y=y;const F=j.matrixTransform((w=e.current.getScreenCTM())==null?void 0:w.inverse());return Lr?{x:Math.round(F.x/pn)*pn,y:Math.round(F.y/pn)*pn}:{x:F.x,y:F.y}}return{x:At,y:At}},N=(f,y)=>{let w,j;if(f!==void 0&&y!==void 0)w=f,j=y;else{const W=b();w=W.x,j=W.y}const F={id:Ve(),x:w,y:j,width:160,height:140,text:"Nuova nota...",color:Pa.Classico[0],fontFamily:Xw[0].value,opacity:1,textColor:nC[0],variant:"classic"},O=[...u,F];h(O),Mn(re,me,we,O)},S=H.useRef(null),z=(f,y)=>{var w;if(t.current&&e.current){const j=t.current.createSVGPoint();return j.x=f,j.y=y,j.matrixTransform((w=e.current.getScreenCTM())==null?void 0:w.inverse())}return{x:0,y:0}},[G,T]=H.useState(null),[x,E]=H.useState("dashboard"),[I,R]=H.useState(localStorage.getItem("genopro_custom_user")||""),[M,C]=H.useState(localStorage.getItem("genopro_firebase_config")||""),[Je,ce]=H.useState(null);H.useRef(null);const[ne,Oe]=H.useState(null),[Z,fe]=H.useState(!1),[ue,Ie]=H.useState("offline"),je=H.useRef(!1),[We,Rt]=H.useState([]),[gt,lr]=H.useState(()=>{const f=localStorage.getItem("genopro_categories");return f?JSON.parse(f):JA}),[Dt,$l]=H.useState("ALL"),[Cr,os]=H.useState("date_desc"),[Pr,Ri]=H.useState(""),[jr,as]=H.useState(!1),{auth:Rr,db:dn}=H.useMemo(()=>{try{let f=null;if(M?f=vC(M):typeof window.__firebase_config<"u"&&(f=JSON.parse(window.__firebase_config)),!f||!f.apiKey)return{auth:null,db:null};const y=PI().length?jp():Gx(f);return{auth:$2(y),db:PA(y)}}catch(f){return console.error("Firebase Init Error:",f),{auth:null,db:null}}},[M]),Bl=H.useMemo(()=>We.filter(f=>{const y=f.title.toLowerCase().includes(Pr.toLowerCase()),w=Dt==="ALL"||f.category===Dt||Dt==="other"&&!gt.some(j=>j.id===f.category);return y&&w}).sort((f,y)=>Cr==="date_desc"?y.lastModified-f.lastModified:Cr==="date_asc"?f.lastModified-y.lastModified:Cr==="name_asc"?f.title.localeCompare(y.title):0),[We,Dt,Cr,Pr,gt]);H.useEffect(()=>{localStorage.setItem("genopro_categories",JSON.stringify(gt))},[gt]),H.useEffect(()=>{localStorage.setItem("genopro_custom_user",I)},[I]),H.useEffect(()=>{localStorage.setItem("genopro_firebase_config",M)},[M]);const Di=typeof window.__app_id<"u"?window.__app_id:"default-app-id",[En,Mi]=H.useState(null),[bn,na]=H.useState("Nuovo Genogramma"),[Dr,Xs]=H.useState("family"),[re,Ze]=H.useState([]),[me,kn]=H.useState([]),[we,cr]=H.useState([]),[ls,cs]=H.useState([]),[ur,Li]=H.useState([]),[qt,Ys]=H.useState(-1),Mn=H.useCallback((f,y,w,j)=>{const F=JSON.stringify({nodes:f,edges:y,groups:w,stickyNotes:j});Li(O=>[...O.slice(0,qt+1),F]),Ys(O=>O+1)},[qt]),ot=f=>{const y=typeof f=="function"?f(re):f;Ze(y),Mn(y,me,we)},In=f=>{const y=typeof f=="function"?f(me):f;kn(y),Mn(re,y,we)},Hn=f=>{const y=typeof f=="function"?f(we):f;cr(y),Mn(re,me,y)},us=(f,y,w,j)=>{Ze(f),kn(y),cr(w),h(j),Mn(f,y,w,j)},dr=(f,y,w,j)=>{us(f,y,w,j||u)},Oi=()=>{if(qt>0){const f=qt-1,y=JSON.parse(ur[f]);Ze(y.nodes),kn(y.edges),cr(y.groups),Ys(f)}},hr=()=>{if(qt<ur.length-1){const f=qt+1,y=JSON.parse(ur[f]);Ze(y.nodes),kn(y.edges),cr(y.groups),Ys(f)}};H.useEffect(()=>{ur.length===0&&x==="editor"&&Mn(re,me,we)},[x]);const[pe,$e]=H.useState([]),[Tn,Mt]=H.useState([]),[Ln,Be]=H.useState([]),[fr,Mr]=H.useState(()=>localStorage.getItem("genopro_theme_id")||"light"),Ke=H.useMemo(()=>Is.find(f=>f.id===fr)||Is[0],[fr]),ds=Ke.type==="dark";H.useEffect(()=>{localStorage.setItem("genopro_theme_id",fr)},[fr]);const[Lr,hs]=H.useState(()=>localStorage.getItem("genopro_snap")!=="false"),[Vi,pd]=H.useState(()=>localStorage.getItem("genopro_labels")||"age"),[Gn,ra]=H.useState(()=>localStorage.getItem("genopro_legend")==="true");H.useEffect(()=>{localStorage.setItem("genopro_snap",String(Lr))},[Lr]),H.useEffect(()=>{localStorage.setItem("genopro_labels",Vi)},[Vi]),H.useEffect(()=>{localStorage.setItem("genopro_legend",String(Gn))},[Gn]);const[Js,fs]=H.useState(!1),[On,Fi]=H.useState(!1),[qn,sa]=H.useState(!1),[Zs,zi]=H.useState(!1),[ia,Wl]=H.useState(!1),[De,Lt]=H.useState(null),[Hl,Ui]=H.useState(null),[Sn,hn]=H.useState(null),[ei,Or]=H.useState(1),[$i,oa]=H.useState(4),Bi=H.useRef({view:x,showSettings:Js,showReport:On,showReportConfig:v,showDesigner:Zs,showHelp:Z,showCategoryMenu:jr,editingGroupId:o,selectedNodeIds:pe,selectedEdgeIds:Tn,selectedGroupIds:Ln,selectedNoteIds:m});H.useEffect(()=>{Bi.current={view:x,showSettings:Js,showReport:On,showReportConfig:v,showDesigner:Zs,showHelp:Z,showCategoryMenu:jr,editingGroupId:o,selectedNodeIds:pe,selectedEdgeIds:Tn,selectedGroupIds:Ln,selectedNoteIds:m}});const ti=H.useCallback(async()=>{const f=Bi.current;let y=!1;return f.showSettings?(fs(!1),y=!0):f.showReport?(Fi(!1),y=!0):f.showReportConfig?(k(!1),y=!0):f.showDesigner?(zi(!1),y=!0):f.showHelp?(fe(!1),y=!0):f.showCategoryMenu?(as(!1),y=!0):f.editingGroupId!==null?(c(null),y=!0):f.selectedNodeIds.length>0?($e([]),y=!0):f.selectedEdgeIds.length>0?(Mt([]),y=!0):f.selectedGroupIds.length>0?(Be([]),y=!0):f.selectedNoteIds.length>0?(g([]),y=!0):f.view==="editor"&&(E("dashboard"),y=!0),y},[]);H.useEffect(()=>{let f=null;(async()=>{try{f=await Fg.addListener("backButton",async j=>{await ti()||Fg.exitApp()})}catch(j){console.log("Capacitor backButton non supportato",j)}})();const w=async j=>{await ti()&&window.history.pushState(null,"",window.location.href)};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",w),()=>{f&&f.remove(),window.removeEventListener("popstate",w)}},[ti]),H.useEffect(()=>{if(x!=="editor")return;if(!G||!dn||!En){Ie("offline");return}if(je.current){je.current=!1;return}const f=I||G.uid;if(!f){Ie("error");return}Ie("syncing");const w=setTimeout(async()=>{try{const j=ih(dn,"artifacts",Di,"users",f,"genograms",En);await tv(j,{id:En,title:bn,category:Dr,lastModified:Date.now(),data:{nodes:re,edges:me,groups:we,presets:ls,stickyNotes:u}},{merge:!0}),Ie("synced")}catch(j){console.error("Errore Salvataggio:",j),Ie("error")}},1500);return()=>clearTimeout(w)},[re,me,we,bn,Dr,ls,I,G,dn,x,En]),H.useEffect(()=>{const f=y=>{y.key==="i"&&!["INPUT","TEXTAREA"].includes(y.target.tagName)&&ra(w=>!w)};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[]),H.useEffect(()=>{const f=O=>{if(O.ctrlKey){O.preventDefault();const U=-O.deltaY*.008;Or(Q=>{const B=Q+U;return Math.min(3,Math.max(.2,B))})}},y=O=>{O.preventDefault()},w=O=>{O.preventDefault();const U=(O.scale-1)*.05;Or(Q=>Math.min(3,Math.max(.2,Q+U)))},j=O=>O.preventDefault(),F={passive:!1};return document.addEventListener("wheel",f,F),document.addEventListener("gesturestart",y,F),document.addEventListener("gesturechange",w,F),document.addEventListener("gestureend",j,F),()=>{document.removeEventListener("wheel",f),document.removeEventListener("gesturestart",y),document.removeEventListener("gesturechange",w),document.removeEventListener("gestureend",j)}},[]);const Ot=H.useRef(re);H.useEffect(()=>{Ot.current=re},[re]);const Kn=H.useRef(me);H.useEffect(()=>{Kn.current=me},[me]);const md=H.useRef(pe);H.useEffect(()=>{md.current=pe},[pe]);const Vr=H.useRef(we);H.useEffect(()=>{Vr.current=we},[we]);const Wi=H.useRef(u);H.useEffect(()=>{Wi.current=u},[u]);const Nn=f=>{if(pe.length===0)return;const y=re.filter(W=>pe.includes(W.id)),w=y.reduce((W,U)=>W+U.x,0)/y.length,j=y.reduce((W,U)=>W+U.y,0)/y.length,F=[...y];f==="circle"?F.sort((W,U)=>{const Q=Math.atan2(W.y-j,W.x-w),B=Math.atan2(U.y-j,U.x-w);return Q-B}):f==="h"?F.sort((W,U)=>W.x-U.x):f==="v"?F.sort((W,U)=>W.y-U.y):f==="diagonal"?F.sort((W,U)=>W.x+W.y-(U.x+U.y)):f==="grid"&&F.sort((W,U)=>Math.abs(W.y-U.y)>40?W.y-U.y:W.x-U.x);let O=150;if(f==="circle"){const W=y.reduce((Q,B)=>Q+Math.hypot(B.x-w,B.y-j),0)/y.length,U=prompt("Inserisci raggio cerchio (px):",Math.round(W).toString());if(U!==null)O=parseInt(U)||150;else return}ot(W=>W.map(U=>{if(!pe.includes(U.id))return U;const Q=F.findIndex(B=>B.id===U.id);if(f==="h")return{...U,y:Math.round(j/20)*20};if(f==="v")return{...U,x:Math.round(w/20)*20};if(f==="circle"){if(y.length<2)return U;const B=2*Math.PI/y.length,J=F[0],ie=Math.atan2(J.y-j,J.x-w)+B*Q;return{...U,x:Math.round((w+O*Math.cos(ie))/20)*20,y:Math.round((j+O*Math.sin(ie))/20)*20}}if(f==="grid"){const B=Math.ceil(Math.sqrt(y.length)),J=Math.floor(Q/B),ee=Q%B,ie=(B-1)*120,Y=(Math.ceil(y.length/B)-1)*120,be=w-ie/2,Ee=j-Y/2;return{...U,x:Math.round((be+ee*120)/20)*20,y:Math.round((Ee+J*120)/20)*20}}if(f==="diagonal"){const B=(Q-(y.length-1)/2)*80;return{...U,x:Math.round((w+B)/20)*20,y:Math.round((j+B)/20)*20}}return U}))},Gl=f=>{const y=re.filter(B=>pe.includes(B.id));if(y.length<2)return;const w=[...y].sort((B,J)=>B.y-J.y),j=[];let F=[w[0]];for(let B=1;B<w.length;B++){const J=w[B],ee=w[B-1];Math.abs(J.y-ee.y)<50?F.push(J):(j.push(F),F=[J])}if(j.push(F),j.length<2)return alert("Seleziona persone di almeno due generazioni diverse");const O=j[0],W=j[j.length-1];O.sort((B,J)=>B.x-J.x),W.sort((B,J)=>B.x-J.x);const U=40,Q=zt+U;ot(B=>B.map(J=>{if(!pe.includes(J.id))return J;if(f==="align-children"&&W.some(ee=>ee.id===J.id)){const ee=O[0].x,ie=O[O.length-1].x+zt,Y=(ee+ie)/2,be=W.length*zt+(W.length-1)*U,Ee=Y-be/2,et=W.findIndex(Ae=>Ae.id===J.id);return{...J,x:Ee+et*Q,y:O[0].y+180}}if(f==="align-parents"&&O.some(ee=>ee.id===J.id)){const ee=W[0].x,ie=W[W.length-1].x+zt,Y=(ee+ie)/2,be=O.length*zt+(O.length-1)*U,Ee=Y-be/2,et=O.findIndex(Ae=>Ae.id===J.id);return{...J,x:Ee+et*Q}}return J}))};H.useEffect(()=>{const f=w=>{if(!["INPUT","TEXTAREA","SELECT"].includes(w.target.tagName)){if(w.code==="Space"&&(w.preventDefault(),Wl(!0)),(w.ctrlKey||w.metaKey)&&w.key.toLowerCase()==="a"){w.preventDefault(),$e(Ot.current.map(j=>j.id));return}if((w.ctrlKey||w.metaKey)&&w.key.toLowerCase()==="z"){w.preventDefault(),Oi();return}if((w.ctrlKey||w.metaKey)&&w.key.toLowerCase()==="y"){w.preventDefault(),hr();return}if((w.ctrlKey||w.metaKey)&&w.key==="s"){w.preventDefault(),Kl();return}if(w.altKey&&pe.length>1)switch(w.code){case"KeyH":w.preventDefault(),Nn("h");break;case"KeyV":w.preventDefault(),Nn("v");break;case"KeyC":w.preventDefault(),Nn("circle");break;case"KeyG":w.preventDefault(),Nn("grid");break;case"KeyD":w.preventDefault(),Nn("diagonal");break}if((w.key==="Backspace"||w.key==="Delete")&&(pe.length>0||Tn.length>0||Ln.length>0)&&confirm("Eliminare gli elementi selezionati?")){let j=Ot.current.filter(U=>!pe.includes(U.id)),F=Kn.current.filter(U=>!pe.includes(U.fromId)&&!pe.includes(U.toId)&&!Tn.includes(U.id)),O=Vr.current.filter(U=>!Ln.includes(U.id)),W=u.filter(U=>!m.includes(U.id));dr(j,F,O,W),$e([]),Mt([]),Be([]),g([])}if((w.key==="Esc"||w.key==="Escape")&&($e([]),Mt([]),Be([]),hn(null)),(w.key.toLowerCase()==="m"||w.key.toLowerCase()==="f")&&pe.length===0&&!w.altKey&&!w.ctrlKey){const{x:j,y:F}=b();aa(w.key.toLowerCase()==="m"?"M":"F",j,F)}if(w.key.toLowerCase()==="n"&&!w.altKey&&!w.ctrlKey&&N(),pe.length===1&&!w.altKey&&!w.ctrlKey){const j=pe[0];Ot.current.find(F=>F.id===j)&&(w.key.toLowerCase()==="s"&&la(),w.key.toLowerCase()==="c"&&ca(),w.key.toLowerCase()==="p"&&Xn())}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(w.key)&&pe.length>0){w.preventDefault();const j=w.shiftKey?10:1,F=w.key==="ArrowLeft"?-j:w.key==="ArrowRight"?j:0,O=w.key==="ArrowUp"?-j:w.key==="ArrowDown"?j:0;ot(W=>W.map(U=>pe.includes(U.id)?{...U,x:U.x+F,y:U.y+O}:U))}}},y=w=>{w.code==="Space"&&Wl(!1)};return window.addEventListener("keydown",f),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",f),window.removeEventListener("keyup",y)}},[pe,Tn,Ln,qt,ur,ei]);const Et=f=>{let y,w;f.touches&&f.touches.length>0?(y=f.touches[0].clientX,w=f.touches[0].clientY):f.changedTouches&&f.changedTouches.length>0?(y=f.changedTouches[0].clientX,w=f.changedTouches[0].clientY):(y=f.clientX,w=f.clientY);const j=z(y,w);return{x:j.x,y:j.y,cx:y,cy:w}},Qn=(f,y,w)=>{const{x:j,y:F}=Et(f);S.current={active:!0,type:y,sourceId:w,startX:j,startY:F,currX:j,currY:F,pointerId:f.pointerId},Lt({...S.current}),hn(null)},Hi=f=>{f.stopPropagation(),f.preventDefault();const{x:y,y:w}=Et(f),j={};Ot.current.forEach(F=>{pe.includes(F.id)&&(j[F.id]={x:F.x,y:F.y})}),S.current={active:!0,type:"move",sourceId:"selection-group",startX:y,startY:w,currX:y,currY:w,initialNodePositions:j,pointerId:f.pointerId},Lt({...S.current})},Gi=(f,y)=>{f.stopPropagation(),f.preventDefault();const{x:w,y:j}=Et(f),F=re.filter(Q=>pe.includes(Q.id)),O=F.reduce((Q,B)=>Q+B.x,0)/F.length,W=F.reduce((Q,B)=>Q+B.y,0)/F.length,U={};F.forEach(Q=>U[Q.id]={x:Q.x,y:Q.y}),S.current={active:!0,type:`transform-${y}`,sourceId:"group",startX:w,startY:j,currX:w,currY:j,initialNodePositions:U,centerX:O,centerY:W,startAngle:Math.atan2(j-W,w-O),startDist:Math.hypot(w-O,j-W),pointerId:f.pointerId},Lt({...S.current})},ql=(f,y)=>{const{x:w,y:j}=Et(f),F=Kn.current.find(O=>O.id===y);if(F){const O=Ve(),W=w-zt/2,U=j+50,Q={id:O,x:W,y:U,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},B={id:Ve(),fromId:F.fromId,toId:O,type:"child-bio",label:"",notes:[]},J={id:Ve(),fromId:F.toId,toId:O,type:"child-bio",label:"",notes:[]};dr([...Ot.current,Q],[...Kn.current,B,J],Vr.current),hn({x:f.clientX,y:f.clientY,edgeId:O,mode:"child"})}},He=f=>{var Q,B;if(f.target.tagName!=="svg")return;if(i.current&&clearTimeout(i.current),f.pointerType==="touch"&&f.isPrimary){const J=f.clientX,ee=f.clientY;i.current=setTimeout(()=>{S.current={active:!1,...S.current},Lt(null);const{x:ie,y:Y}=z(J,ee);Oe({x:J,y:ee,gx:ie,gy:Y})},500)}if(f.isPrimary&&f.preventDefault(),o){c(null);return}ne&&Oe(null),!f.shiftKey&&!qn&&($e([]),Mt([]),Be([]),g([]));const{x:y,y:w,cx:j,cy:F}=Et(f);let O="pan";!ia&&(f.pointerType==="mouse"||f.pointerType==="pen"||qn)&&(O="box");const W=((Q=n.current)==null?void 0:Q.scrollLeft)||0,U=((B=n.current)==null?void 0:B.scrollTop)||0;S.current={active:!0,type:O,sourceId:"",startX:y,startY:w,currX:y,currY:w,clientStartX:j,clientStartY:F,initialScrollLeft:W,initialScrollTop:U,pointerId:f.pointerId},Lt({...S.current}),hn(null)},qi=(f,y)=>{f.stopPropagation(),f.preventDefault();const{x:w,y:j}=Et(f),F=f.shiftKey||qn;let O=[...m];F?(O.includes(y)?O=O.filter(U=>U!==y):O.push(y),g(O)):($e([]),Mt([]),Be([]),O=[y],g(O));const W={};O.forEach(U=>{const Q=u.find(B=>B.id===U);Q&&(W[U]={x:Q.x,y:Q.y})}),S.current={active:!0,type:"move-note",sourceId:y,startX:w,startY:j,currX:w,currY:j,initialNodePositions:W,pointerId:f.pointerId},Lt({...S.current})},ni=(f,y)=>{if(f.stopPropagation(),f.preventDefault(),o){Hn(U=>U.map(Q=>{if(Q.id!==o)return Q;const B=Q.memberIds.includes(y);return{...Q,memberIds:B?Q.memberIds.filter(J=>J!==y):[...Q.memberIds,y]}}));return}const{x:w,y:j}=Et(f),F=f.shiftKey||qn;let O=pe;F?O=pe.includes(y)?pe.filter(U=>U!==y):[...pe,y]:pe.includes(y)||(O=[y],Mt([]),Be([]),g([])),$e(O);const W={};Ot.current.forEach(U=>{O.includes(U.id)&&(W[U.id]={x:U.x,y:U.y})}),S.current={active:!0,type:"move",sourceId:y,startX:w,startY:j,currX:w,currY:j,initialNodePositions:W,pointerId:f.pointerId},Lt({...S.current}),hn(null)},ri=(f,y)=>{f.stopPropagation(),f.preventDefault();const{x:w,y:j}=Et(f);S.current={active:!0,type:"link",sourceId:y,startX:w,startY:j,currX:w,currY:j,pointerId:f.pointerId},Lt({...S.current}),hn(null)},gd=(f,y)=>{y.stopPropagation(),Mt([f]),$e([]);const w=me.find(j=>j.id===f);w&&["marriage","cohabitation","separation","divorce"].includes(w.type)&&$e([w.fromId,w.toId])};H.useEffect(()=>{const f=j=>{var et;if(s.current||(r.current={clientX:j.clientX,clientY:j.clientY},i.current&&S.current&&S.current.active&&Math.hypot(j.clientX-(S.current.clientStartX||0),j.clientY-(S.current.clientStartY||0))>10&&(clearTimeout(i.current),i.current=null),S.current&&S.current.active&&S.current.pointerId!==void 0&&j.pointerId!==void 0&&j.pointerId!==S.current.pointerId)||!S.current||!S.current.active)return;j.preventDefault();const{currX:F,currY:O,startX:W,startY:U,clientStartX:Q,clientStartY:B,initialScrollLeft:J,initialScrollTop:ee}=S.current,{x:ie,y:Y,cx:be,cy:Ee}=Et(j);if(S.current.currX=ie,S.current.currY=Y,S.current.type==="pan"&&n.current){const Ae=be-(Q||0),bt=Ee-(B||0);n.current.scrollLeft=(J||0)-Ae,n.current.scrollTop=(ee||0)-bt}else if(S.current.type==="box")Lt({...S.current,currX:ie,currY:Y});else if(S.current.type==="move"){const Ae=ie-W,bt=Y-U;Ze(Xe=>Xe.map(Ce=>{var oe;if(pe.includes(Ce.id)){const ge=((oe=S.current.initialNodePositions)==null?void 0:oe[Ce.id])||{x:Ce.x,y:Ce.y};return{...Ce,x:ge.x+Ae,y:ge.y+bt}}return Ce}))}else if(S.current.type==="move-note"){const Ae=ie-W,bt=Y-U;h(Xe=>Xe.map(Ce=>{var oe;if(m.includes(Ce.id)){const ge=((oe=S.current.initialNodePositions)==null?void 0:oe[Ce.id])||{x:Ce.x,y:Ce.y};return{...Ce,x:ge.x+Ae,y:ge.y+bt}}return Ce}))}else if(["spouse","child","parents","link","group-label","group-padding","transform-scale","transform-rotate"].includes(S.current.type)){if(S.current.type==="group-padding"){const Ae=ie-W,bt=Y-U,Xe=S.current.initialPadding||20,Ce=Math.max(10,Xe+Math.max(Ae,bt));cr(oe=>oe.map(ge=>ge.id===S.current.sourceId?{...ge,customPadding:Ce}:ge))}else if(S.current.type==="group-label"){const Ae=ie-W,bt=Y-U,Xe=(et=S.current.initialNodePositions)==null?void 0:et[S.current.sourceId];Xe&&cr(Ce=>Ce.map(oe=>oe.id===S.current.sourceId?{...oe,labelPos:{x:Xe.x+Ae,y:Xe.y+bt}}:oe))}Lt({...S.current,currX:ie,currY:Y})}},y=j=>{if(S.current&&S.current.active&&S.current.pointerId!==void 0&&j.pointerId!==void 0&&j.pointerId!==S.current.pointerId||(i.current&&(clearTimeout(i.current),i.current=null),!S.current||!S.current.active))return;if((S.current.type==="move"||S.current.type==="move-note"||S.current.type==="group-label"||S.current.type==="group-padding"||S.current.type==="transform-scale"||S.current.type==="transform-rotate"||S.current.type==="selection-group")&&Mn(Ot.current,Kn.current,Vr.current,Wi.current),S.current.type==="box"){const O=Math.min(S.current.startX,S.current.currX),W=Math.max(S.current.startX,S.current.currX),U=Math.min(S.current.startY,S.current.currY),Q=Math.max(S.current.startY,S.current.currY);if(Math.abs(W-O)>5||Math.abs(Q-U)>5){const B=[],J=[];Ot.current.forEach(ee=>{ee.x>=O&&ee.x<=W&&ee.y>=U&&ee.y<=Q&&B.push(ee.id)}),Wi.current.forEach(ee=>{ee.x>=O&&ee.x<=W&&ee.y>=U&&ee.y<=Q&&J.push(ee.id)}),j.shiftKey?($e(ee=>[...new Set([...ee,...B])]),g(ee=>[...new Set([...ee,...J])])):($e(B),g(J),Mt([]),Be([]))}}if(["spouse","child","parents","link"].includes(S.current.type)){const{currX:O,currY:W,sourceId:U,type:Q}=S.current,B=Ot.current.find(ee=>O>=ee.x-20&&O<=ee.x+80&&W>=ee.y-20&&W<=ee.y+80&&ee.id!==U),J=Ot.current.find(ee=>ee.id===U);if(B&&J){let ee=U,ie=B.id,Y="friendship";Q==="spouse"?Y="marriage":Q==="child"?Y="child-bio":Q==="parents"&&(ee=B.id,ie=U,Y="child-bio");const be={id:Ve(),fromId:ee,toId:ie,type:Y,label:"",notes:[]},Ee=[...Kn.current,be];kn(Ee),Mn(Ot.current,Ee,Vr.current,u),hn({x:j.clientX,y:j.clientY,edgeId:be.id,mode:Q})}else if(J){const ee=Math.hypot(O-S.current.startX,W-S.current.startY)<10;let ie=O-30,Y=W-30;if(ee&&Q==="parents"){const yt=U,lt=Ve(),Se=Ve(),Fe={id:lt,x:J.x-80,y:J.y-120,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},tt={id:Se,x:J.x+80,y:J.y-120,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},fn=[{id:Ve(),fromId:lt,toId:Se,type:"marriage",label:"",notes:[]},{id:Ve(),fromId:lt,toId:yt,type:"child-bio",label:"",notes:[]},{id:Ve(),fromId:Se,toId:yt,type:"child-bio",label:"",notes:[]}],vt=[...Ot.current,Fe,tt],Yn=[...Kn.current,...fn];Ze(vt),kn(Yn),Mn(vt,Yn,Vr.current,u),$e([lt,Se]),S.current={...S.current,active:!1},Lt(null);return}else ee&&(Q==="child"?(ie=J.x,Y=J.y+120):Q==="spouse"&&(ie=J.x+120,Y=J.y));const be=Ve(),Ee=Q==="spouse"?J.gender==="M"?"F":"M":"Unknown",et={id:be,x:ie,y:Y,gender:Ee,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};let Ae=U,bt=be,Xe="friendship";Q==="spouse"?Xe="marriage":Q==="child"&&(Xe="child-bio");const Ce={id:Ve(),fromId:Ae,toId:bt,type:Xe,label:"",notes:[]},oe=[...Kn.current,Ce],ge=[...Ot.current,et];Ze(ge),kn(oe),Mn(ge,oe,Vr.current,u),hn({x:j.clientX,y:j.clientY,edgeId:Ce.id,mode:Q})}}S.current={active:!1,type:"pan",sourceId:"",startX:0,startY:0,currX:0,currY:0,clientStartX:0,clientStartY:0},Lt(null)},w=()=>{};return window.addEventListener("pointermove",f),window.addEventListener("pointerup",y),window.addEventListener("pointercancel",y),window.addEventListener("resize",w),()=>{window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",y),window.removeEventListener("pointercancel",y),window.removeEventListener("resize",w)}},[pe,m,qn]),H.useEffect(()=>Rr?((async()=>{const y=window.__initial_auth_token;y?await NT(Rr,y).catch(w=>console.error("Token Auth Error:",w)):await bT(Rr).catch(w=>console.error("Anon Auth Error:",w))})(),PT(Rr,y=>{T(y)})):void 0,[Rr]),H.useEffect(()=>{const f=localStorage.getItem("genopro_local_index"),w=(f?JSON.parse(f):[]).map(F=>{try{return JSON.parse(localStorage.getItem(`genopro_data_${F.id}`)||JSON.stringify(F))}catch{return F}});if(!G||!dn){Rt(w);return}const j=I||G.uid;if(!j){Rt(w);return}try{const F=WA(CA(dn,"artifacts",Di,"users",j,"genograms")),O=XA(F,W=>{const U=[];W.forEach(B=>U.push({id:B.id,...B.data()}));const Q=new Map;w.forEach(B=>Q.set(B.id,B)),U.forEach(B=>{const J=Q.get(B.id);(!J||B.lastModified>=J.lastModified)&&(Q.set(B.id,B),localStorage.setItem(`genopro_data_${B.id}`,JSON.stringify(B)))}),Rt(Array.from(Q.values()))},W=>{console.error("Dashboard offline, uso cache locale"),Rt(w)});return()=>O()}catch{Rt(w)}},[G,dn,I]),H.useEffect(()=>{if(!En||re.length===0&&me.length===0&&qt<=0)return;const f=setTimeout(()=>{const y={id:En,title:bn,category:Dr,lastModified:Date.now(),data:{nodes:re,edges:me,groups:we,presets:ls,stickyNotes:u}};localStorage.setItem(`genopro_data_${En}`,JSON.stringify(y));const w=localStorage.getItem("genopro_local_index");let j=w?JSON.parse(w):[];const F=j.findIndex(O=>O.id===En);if(F>=0?j[F]=y:j.push(y),localStorage.setItem("genopro_local_index",JSON.stringify(j)),G&&dn&&ue!=="offline"){const O=I||G.uid;Ie("syncing"),tv(ih(dn,"artifacts",Di,"users",O,"genograms",En),y).then(()=>Ie("synced")).catch(()=>Ie("error"))}else Ie("offline")},1500);return()=>clearTimeout(f)},[re,me,we,u,En,bn,Dr,ls,G,dn,I]),H.useLayoutEffect(()=>{x==="editor"&&n.current&&setTimeout(()=>{n.current&&n.current.scrollTo(At-n.current.clientWidth/2,At-n.current.clientHeight/2)},100)},[x]);const Kl=()=>{alert("I tuoi salvataggi sono gestiti in modo completamente automatico e avvengono ogni volta che compi un'azione!")},Ql=(f,y,w,j=[])=>{Ze(f),kn(y),cr(w),h(j),Li([]),Ys(-1),setTimeout(()=>{const F=JSON.stringify({nodes:f,edges:y,groups:w,stickyNotes:j});Li([F]),Ys(0)},0)},yd=()=>{Mi(Ve()),na("Nuovo Genogramma"),Xs("family"),Ql([],[],[]),E("editor")},Xl=f=>{const y={id:Ve(),x:At,y:At,gender:f,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};ot(w=>[...w,y]),$e([y.id])},aa=(f,y,w)=>{Lr&&(y=Math.round(y/pn)*pn,w=Math.round(w/pn)*pn);const j={id:Ve(),x:y,y:w,gender:f,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};ot(F=>[...F,j]),$e([j.id])},si=()=>{if(pe.length===0)return alert("Seleziona nodi");const f={id:Ve(),memberIds:[...pe],type:"household",label:"Nuovo Gruppo",color:"#000000",notes:[]};Hn(y=>[...y,f]),Be([f.id]),$e([])},Xn=()=>{if(pe.length!==1)return alert("Seleziona una persona");const f=pe[0],y=re.find(U=>U.id===f);if(!y)return;const w=Ve(),j=Ve(),F={id:w,x:y.x-80,y:y.y-150,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},O={id:j,x:y.x+80,y:y.y-150,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},W=[{id:Ve(),fromId:w,toId:j,type:"marriage",label:"",notes:[]},{id:Ve(),fromId:w,toId:f,type:"child-bio",label:"",notes:[]},{id:Ve(),fromId:j,toId:f,type:"child-bio",label:"",notes:[]}];dr([...re,F,O],[...me,...W],we),$e([w,j])},la=()=>{if(pe.length!==1)return alert("Seleziona una persona");const f=pe[0],y=re.find(O=>O.id===f);if(!y)return;const w=Ve(),j={id:w,x:y.x+120,y:y.y,gender:y.gender==="M"?"F":"M",name:"Partner",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},F={id:Ve(),fromId:f,toId:w,type:"marriage",label:"",notes:[]};dr([...re,j],[...me,F],we),$e([w])},ca=()=>{if(Tn.length===1){const f=me.find(y=>y.id===Tn[0]);if(f&&_r.Struttura.includes(f.type)){const y=re.find(U=>U.id===f.fromId),w=re.find(U=>U.id===f.toId);if(!y||!w)return;const j=Ve(),F={id:j,x:(y.x+w.x)/2,y:Math.max(y.y,w.y)+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},O={id:Ve(),fromId:f.fromId,toId:j,type:"child-bio",label:"",notes:[]},W={id:Ve(),fromId:f.toId,toId:j,type:"child-bio",label:"",notes:[]};dr([...re,F],[...me,O,W],we),$e([j]),Mt([]);return}}if(pe.length===1){const f=pe[0],y=re.find(W=>W.id===f);if(!y)return;const w=rv(f,me),j=Ve(),F={id:j,x:y.x,y:y.y+150,gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},O=[{id:Ve(),fromId:f,toId:j,type:"child-bio",label:"",notes:[]}];if(w){const W=w.fromId===f?w.toId:w.fromId;O.push({id:Ve(),fromId:W,toId:j,type:"child-bio",label:"",notes:[]})}dr([...re,F],[...me,...O],we),$e([j])}else alert("Seleziona una coppia o un genitore")},Yl=()=>{const f=pe.length>0?re.filter(oe=>pe.includes(oe.id)):re;if(f.length===0)return;const y=JSON.parse(JSON.stringify(re)),w=new Map(y.map(oe=>[oe.id,oe])),j=180,F=60,O=80,W=100,U=250,Q=oe=>me.filter(ge=>(ge.fromId===oe||ge.toId===oe)&&_r.Struttura.includes(ge.type)).map(ge=>ge.fromId===oe?ge.toId:ge.fromId),B=oe=>{const ge=me.filter(yt=>yt.toId===oe&&yt.type.startsWith("child"));return[...new Set(ge.map(yt=>yt.fromId))]},J=oe=>{const ge=me.filter(lt=>oe.includes(lt.fromId)&&lt.type.startsWith("child"));return[...new Set(ge.map(lt=>lt.toId))]},ee=new Map;f.forEach(oe=>ee.set(oe.id,-1));const ie=(oe,ge=new Set)=>{if(ge.has(oe))return 0;if(ee.get(oe)!==-1)return ee.get(oe);ge.add(oe);const yt=J([oe]),lt=Q(oe);let Se=-1;const Fe=new Set(yt);if(lt.forEach(fn=>J([fn]).forEach(vt=>Fe.add(vt))),Fe.size>0){const fn=Array.from(Fe).map(vt=>ie(vt,new Set(ge)));Se=Math.max(...fn)}const tt=Se+1;return ee.set(oe,tt),tt};f.forEach(oe=>ie(oe.id));let Y=!0;for(;Y;)Y=!1,f.forEach(oe=>{const ge=ee.get(oe.id)||0;Q(oe.id).forEach(yt=>{const lt=ee.get(yt)||0;if(ge!==lt){const Se=Math.max(ge,lt);ee.set(oe.id,Se),ee.set(yt,Se),Y=!0}})});const be=Math.max(...Array.from(ee.values())),Ee=new Map;ee.forEach((oe,ge)=>Ee.set(ge,be-oe)),[...f].sort((oe,ge)=>Lu(oe.birthDate||"")-Lu(ge.birthDate||"")).forEach((oe,ge)=>{oe.x=ge*(F+20)});for(let oe=0;oe<U;oe++){const ge=new Map;f.forEach(Se=>{let Fe=0,tt=0;if(B(Se.id).forEach(Nt=>{const kt=w.get(Nt);kt&&(Fe+=kt.x,tt++)}),J([Se.id]).forEach(Nt=>{const kt=w.get(Nt);kt&&(Fe+=kt.x,tt++)}),Q(Se.id).forEach(Nt=>{const kt=w.get(Nt);kt&&(Fe+=kt.x,tt++)}),tt>0){const Nt=Fe/tt,kt=.5*(1-oe/U);ge.set(Se.id,(Nt-Se.x)*kt)}}),f.forEach(Se=>{ge.has(Se.id)&&(Se.x+=ge.get(Se.id))});const yt=new Set;f.forEach(Se=>{if(yt.has(Se.id))return;const Fe=Q(Se.id);if(Fe.length>0){const tt=[Se.id,...Fe];tt.forEach(Nt=>yt.add(Nt)),tt.sort((Nt,kt)=>{var Kt,ha;const ii=(Kt=w.get(Nt))==null?void 0:Kt.gender,oi=(ha=w.get(kt))==null?void 0:ha.gender;return ii==="M"&&oi!=="M"?-1:ii!=="M"&&oi==="M"?1:0});const fn=tt.reduce((Nt,kt)=>Nt+w.get(kt).x,0)/tt.length,vt=(tt.length-1)*O;let Yn=fn-vt/2;tt.forEach((Nt,kt)=>{const ii=w.get(Nt);ii.x=Yn+kt*O})}});const lt=new Map;f.forEach(Se=>{const Fe=Ee.get(Se.id)||0;lt.has(Fe)||lt.set(Fe,[]),lt.get(Fe).push(Se)}),lt.forEach(Se=>{Se.sort((Fe,tt)=>Fe.x-tt.x);for(let Fe=0;Fe<Se.length-1;Fe++){const tt=Se[Fe],fn=Se[Fe+1],vt=fn.x-tt.x;if(vt<W){const Yn=(W-vt)/2;tt.x-=Yn,fn.x+=Yn}}})}const Ae=f.map(oe=>oe.x),bt=Math.min(...Ae),Xe=Math.max(...Ae),Ce=At-(bt+Xe)/2;f.forEach(oe=>{oe.x=Math.round((oe.x+Ce)/20)*20;const ge=Ee.get(oe.id)||0;oe.y=Math.round((At+ge*j)/20)*20}),ot(y)},ps=()=>{Or(1),n.current&&n.current.scrollTo({left:At-n.current.clientWidth/2,top:At-n.current.clientHeight/2,behavior:"smooth"})},Jl=H.useCallback(()=>{let f=1/0,y=1/0,w=-1/0,j=-1/0;return re.length===0?{minX:At-400,minY:At-300,maxX:At+400,maxY:At+300}:(re.forEach(F=>{f=Math.min(f,F.x),y=Math.min(y,F.y),w=Math.max(w,F.x+zt),j=Math.max(j,F.y+wr)}),we.forEach(F=>{const O=Zw(F,re);O&&(f=Math.min(f,O.x),y=Math.min(y,O.y),w=Math.max(w,O.x+O.w),j=Math.max(j,O.y+O.h))}),{minX:f,minY:y,maxX:w,maxY:j})},[re,we]),ua=()=>{let{minX:f,minY:y,maxX:w,maxY:j}=Jl();if(Gn){const W=new Set(re.map(ee=>ee.gender)).size+(re.some(ee=>ee.deceased)?1:0)+(re.some(ee=>ee.indexPerson)?1:0),U=new Set(me.map(ee=>ee.type)).size,Q=80+Math.max(W,U)*24+20,B=f-220-50,J=y;f=Math.min(f,B),y=Math.min(y,J),w=Math.max(w,f+220+(w-f)),j=Math.max(j,J+Q)}const F=100;return{x:f-F,y:y-F,w:w-f+F*2,h:j-y+F*2}},Zl=async f=>{if(!t.current)return;const y=ua(),w=$i,j=t.current.cloneNode(!0),F=j.querySelector("g");F&&(F.setAttribute("transform",""),F.style.transform=""),j.setAttribute("viewBox",`${y.x} ${y.y} ${y.w} ${y.h}`),j.setAttribute("width",`${y.w*w}`),j.setAttribute("height",`${y.h*w}`),j.style.fontFamily="sans-serif";const O=new XMLSerializer().serializeToString(j),W=document.createElement("canvas"),U=W.getContext("2d"),Q=new Image,B=new Blob([O],{type:"image/svg+xml;charset=utf-8"}),J=URL.createObjectURL(B),ee=new Date,ie=`${bn.replace(/\s+/g,"_")}_${ee.toISOString().slice(0,10)}.${f}`;Q.onload=()=>{W.width=y.w*w,W.height=y.h*w,U&&(U.font="12px sans-serif",f==="jpeg"&&(U.fillStyle=ds?"#111827":"#ffffff",U.fillRect(0,0,W.width,W.height)),U.drawImage(Q,0,0),W.toBlob(async Y=>{if(!Y)return;if(navigator.canShare&&navigator.share)try{const et=new File([Y],ie,{type:`image/${f}`});if(navigator.canShare({files:[et]})){await navigator.share({files:[et],title:bn,text:"Esportazione Genogramma"}),URL.revokeObjectURL(J);return}}catch(et){console.warn("Share fallito, provo download classico",et)}const be=URL.createObjectURL(Y),Ee=document.createElement("a");Ee.href=be,Ee.download=ie,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),URL.revokeObjectURL(be),URL.revokeObjectURL(J)},`image/${f}`,1))},Q.src=J},pr=()=>{const f=window.open("","_blank");if(f&&t.current){const y=ua(),w=t.current.cloneNode(!0),j=ds?"#111827":"#ffffff",F=document.createElementNS("http://www.w3.org/2000/svg","rect");F.setAttribute("x",String(y.x)),F.setAttribute("y",String(y.y)),F.setAttribute("width",String(y.w)),F.setAttribute("height",String(y.h)),F.setAttribute("fill",j),w.firstChild?w.insertBefore(F,w.firstChild):w.appendChild(F),w.setAttribute("viewBox",`${y.x} ${y.y} ${y.w} ${y.h}`),w.setAttribute("width",`${y.w}px`),w.setAttribute("height",`${y.h}px`);const O=w.querySelector("g");O&&(O.setAttribute("transform",""),O.style.transform=""),w.style.display="block",w.style.overflow="visible";const W=new XMLSerializer().serializeToString(w);f.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${bn} - Vettoriale</title>
                    <style>
                        @page { 
                            size: ${y.w}px ${y.h}px; 
                            margin: 0; 
                        }
                        body { 
                            margin: 0; 
                            padding: 0; 
                            width: ${y.w}px;
                            height: ${y.h}px;
                            overflow: hidden;
                            background-color: ${j};
                            /* FORZA STAMPA COLORI SFONDO */
                            -webkit-print-color-adjust: exact; 
                            print-color-adjust: exact;
                        }
                        svg { 
                            width: 100%; 
                            height: 100%; 
                            display: block;
                        }
                        /* FIX FONT */
                        text { 
                            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important; 
                        }
                    </style>
                </head>
                <body>
                    ${W}
                </body>
                </html>
            `),f.document.close(),f.onload=()=>{setTimeout(()=>{f.focus(),f.print()},500)}}},vd=(f,y,w,j)=>{const F=f.filter(O=>j.onlyPeopleWithNotes?O.notes&&O.notes.length>0:!0);return F.length===0?'<div style="padding:20px; text-align:center; color:#666;">Nessuna persona corrisponde ai criteri selezionati.</div>':F.map(O=>{const W=y.filter(Y=>(Y.fromId===O.id||Y.toId===O.id)&&_r.Struttura.includes(Y.type)).map(Y=>{const be=Y.fromId===O.id?Y.toId:Y.fromId,Ee=f.find(Ae=>Ae.id===be),et=rn[Y.type];return Ee?`<b>${Ee.name}</b> (${et.label})`:null}).filter(Boolean).join(", "),U=y.filter(Y=>Y.fromId===O.id&&Y.type.startsWith("child")).map(Y=>{const be=f.find(Ee=>Ee.id===Y.toId);return be?be.name:null}).filter(Boolean).join(", "),Q=y.filter(Y=>(Y.fromId===O.id||Y.toId===O.id)&&!_r.Struttura.includes(Y.type)&&!Y.type.startsWith("child")).map(Y=>{const be=Y.fromId===O.id?Y.toId:Y.fromId,Ee=f.find(Xe=>Xe.id===be),et=Ee?null:w.find(Xe=>Xe.id===be),Ae=Ee?Ee.name:et?`Gruppo: ${et.label}`:"Sconosciuto";return`<li>${(rn[Y.type]||{label:Y.type}).label} con <b>${Ae}</b>${Y.notes.length?` (Note: ${Y.notes.map(Xe=>Xe.text).join("; ")})`:""}</li>`}).join(""),B=w.filter(Y=>Y.memberIds.includes(O.id)).map(Y=>Y.label).join(", ");let J=[];j.showGender&&J.push(O.gender),j.showBirthDate&&O.birthDate&&J.push(O.birthDate),j.showAge&&O.birthDate&&J.push(`${_l(O.birthDate)} anni`);const ee=J.length>0?`<small style="font-weight:normal; color:#666;">(${J.join(", ")})</small>`:"";let ie=[];return O.deceased&&ie.push("Deceduto"),O.indexPerson&&ie.push("Paziente Designato"),O.substanceAbuse&&ie.push("Abuso Sostanze"),O.mentalIssue&&ie.push("Problema Psicologico"),O.physicalIssue&&ie.push("Problema Fisico"),O.gayLesbian&&ie.push("Omosessuale"),`
            <div class="person-card">
                <h3>${O.name} ${ee}</h3>
                
                ${j.showClinical&&ie.length>0?`<p class="clinical-tags"><strong>Clinica:</strong> ${ie.join(", ")}</p>`:""}

                ${j.showGroups&&B?`<p><strong>Gruppi:</strong> ${B}</p>`:""}
                
                ${j.showFamily&&(W||U)?`
                    <div style="margin-top:10px; padding-top:10px; border-top:1px solid #eee;">
                        ${W?`<p><strong>Partner:</strong> ${W}</p>`:""}
                        ${U?`<p><strong>Figli:</strong> ${U}</p>`:""}
                    </div>
                `:""}

                ${j.showRelations&&Q?`<p><strong>Altre Relazioni:</strong></p><ul>${Q}</ul>`:""}
                
                ${j.showNotes&&O.notes.length>0?`<div class="notes-section"><strong>Diario Clinico:</strong><ul>${O.notes.map(Y=>`<li><span class="note-date">${Y.date}</span>: ${Y.text}</li>`).join("")}</ul></div>`:""}
            </div>
          `}).join("")},xd=f=>{const y=window.open("","_blank");if(y&&t.current){const w=ua(),j=t.current.cloneNode(!0),F=j.querySelector("g");F&&(F.setAttribute("transform",""),F.style.transform=""),j.setAttribute("viewBox",`${w.x} ${w.y} ${w.w} ${w.h}`),j.setAttribute("width","100%"),j.setAttribute("height","50vh");const O=new XMLSerializer().serializeToString(j),W=vd(re,me,we,f),U=Array.from(new Set(me.map(ie=>ie.type))),Q=Array.from(new Set(re.map(ie=>ie.gender))),B=ie=>{const Y=rn[ie]||rn.custom;if(!Y)return"";let be=Y.color;(Y.renderType.includes("hostile")||Y.renderType.includes("triple-zigzag")||Y.lineStyle==="zigzag-thick")&&(be="#ef4444");let Ee=30;const et=Y.renderType.includes("arrow")&&!Y.renderType.includes("center")||Y.renderType==="triple-zigzag-center-arrow";et&&(Ee-=6);let Ae=`M 0 7 L ${Ee} 7`;Y.lineStyle.startsWith("zigzag")&&(Ae=vr(0,7,Ee,7,3,8));const bt=Y.lineStyle==="dashed"?'stroke-dasharray="4,2"':Y.lineStyle==="dotted"?'stroke-dasharray="1,2"':"",Xe=Y.lineStyle.startsWith("zigzag")?"1.5":"2";let Ce="";return Y.type!=="best-friend"&&(Ce=`<path d="${Ae}" stroke="${be}" stroke-width="${Xe}" ${bt} fill="none" />`),(Y.renderType==="fusion"||Y.renderType==="triple")&&(Ce+=`<g><path d="${Ae}" stroke="${be}" stroke-width="1" transform="translate(0, 3)" fill="none"/><path d="${Ae}" stroke="${be}" stroke-width="1" transform="translate(0, -3)" fill="none"/></g>`),(Y.renderType==="double"||Y.renderType==="double-zigzag"||Y.renderType==="best-friend")&&(Ce+=`<path d="${Ae}" stroke="${be}" stroke-width="1" transform="translate(0, 3)" fill="none" ${bt}/>`),et&&(Ce+=`<polygon points="-5,-4 5,0 -5,4" fill="${be}" transform="translate(${Ee}, 7)" />`),`<svg width="30" height="14" style="vertical-align:middle; margin-right:5px; overflow:visible">${Ce}</svg>`},J=ie=>`<svg width="16" height="16" style="vertical-align:middle; margin-right:5px">${ie==="M"?'<rect x="2" y="2" width="12" height="12" stroke="black" fill="white"/>':'<circle cx="8" cy="8" r="6" stroke="black" fill="white"/>'}</svg>`,ee=`
              <div style="margin-top: 20px; border: 1px solid #eee; padding: 10px; border-radius: 8px; background: #fcfcfc; page-break-inside: avoid; font-size: 0.8em;">
                  <h4 style="margin:0 0 10px 0;">Legenda Rapida</h4>
                  <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                      <div>${Q.map(ie=>`<span style="margin-right:10px">${J(ie)} ${ie}</span>`).join("")}</div>
                      <div>${U.map(ie=>{var Y;return`<span style="margin-right:10px">${B(ie)} ${((Y=rn[ie])==null?void 0:Y.label)||ie}</span>`}).join("")}</div>
                  </div>
              </div>
          `;y.document.write(`
              <html>
              <head>
                  <title>${bn} - Report</title>
                  <style>
                      body { font-family: 'Segoe UI', sans-serif; padding: 40px; color: #333; max-width: 1000px; margin: 0 auto; background: white; }
                      h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; color: #111; }
                      .diagram-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; margin-bottom: 30px; text-align: center; background: white; }
                      .person-card { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3b82f6; page-break-inside: avoid; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
                      .person-card h3 { margin: 0 0 5px 0; font-size: 1.1em; color: #1e293b; }
                      .clinical-tags { font-size: 0.85em; color: #e11d48; margin-bottom: 5px; }
                      .notes-section { margin-top: 8px; padding-top: 8px; border-top: 1px dashed #cbd5e1; font-size: 0.9em; background: #fffbeb; padding: 10px; border-radius: 4px; }
                      .note-date { font-weight: bold; color: #b45309; }
                      ul { margin: 5px 0 0 20px; padding: 0; }
                      @media print { body { padding: 0; } }
                  </style>
              </head>
              <body>
                  <h1>${bn}</h1>
                  <p style="color:#666; font-size:0.9em">Generato il ${new Date().toLocaleDateString()}</p>
                  
                  <div class="diagram-container">
                      ${O}
                  </div>
                  ${ee}
                  
                  <h2 style="margin-top:30px; border-bottom:1px solid #eee;">Dettaglio Clinico</h2>
                  ${W}
              </body>
              </html>
          `),y.document.close(),setTimeout(()=>{y.focus(),y.print()},500)}},Ki=f=>{var j;const y=(j=f.target.files)==null?void 0:j[0];if(!y)return;const w=new FileReader;w.onload=F=>{var O;try{const W=JSON.parse((O=F.target)==null?void 0:O.result);Array.isArray(W)&&(Rt(U=>[...U,...W]),alert("Importazione completata!"))}catch{alert("Errore file")}},w.readAsText(y)},Qi=()=>{const f=new Blob([JSON.stringify(We)],{type:"application/json"}),y=URL.createObjectURL(f),w=document.createElement("a");w.href=y,w.download="backup_genopro.json",w.click()},Ge=pe.length===1?re.find(f=>f.id===pe[0]):null,Qe=me.find(f=>f.id===Tn[0]),at=we.find(f=>f.id===Ln[0]);return x==="dashboard"?a.jsxs("div",{className:"h-screen flex flex-col transition-colors duration-300",style:{backgroundColor:Ke.colors.bgMain,color:Ke.colors.text,"--theme-bg-main":Ke.colors.bgMain,"--theme-bg-panel":Ke.colors.bgPanel,"--theme-border":Ke.colors.border,"--theme-text":Ke.colors.text,"--theme-text-muted":Ke.colors.textMuted,"--theme-accent":Ke.colors.accent},children:[a.jsx("style",{children:`
                .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
                .theme-border { border-color: var(--theme-border); }
                .theme-text { color: var(--theme-text); }
                .theme-text-muted { color: var(--theme-text-muted); }
                .theme-hover:hover { background-color: rgba(127,127,127, 0.1); }
              `}),Z&&a.jsx(gC,{onClose:()=>fe(!1),firebaseConfig:M}),Js&&a.jsx(mC,{onClose:()=>fs(!1),onExport:Qi,onImport:Ki,setCustomUser:R,customUser:I,setFirebaseConfig:C,firebaseConfig:M}),a.jsxs("div",{className:"flex h-full",children:[a.jsxs("div",{className:"w-64 border-r p-4 flex flex-col gap-4 theme-panel theme-border",children:[a.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl mb-2",style:{color:"var(--theme-accent)"},children:[a.jsx(Ab,{})," GenoPro"]}),a.jsxs("button",{onClick:yd,className:"text-white px-4 py-2 rounded flex items-center justify-center gap-2 font-medium transition-colors shadow-sm hover:opacity-90",style:{backgroundColor:"var(--theme-accent)"},children:[a.jsx(Tl,{size:18})," Nuovo"]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-xs font-bold uppercase opacity-50 mb-2 mt-4 px-2 theme-text",children:"Categorie"}),a.jsxs("button",{onClick:()=>$l("ALL"),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${Dt==="ALL"?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,style:Dt==="ALL"?{color:"var(--theme-accent)"}:{},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tf,{size:16})," Tutti"]}),a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:We.length})]}),gt.map(f=>{const y=nv[f.iconKey]||sf,w=We.filter(F=>F.category===f.id).length,j=Dt===f.id;return a.jsxs("button",{onClick:()=>$l(f.id),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${j?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,children:[a.jsxs("span",{className:"flex items-center gap-2",style:{color:j?void 0:f.color},children:[a.jsx(y,{size:16,color:f.color})," ",f.label]}),w>0&&a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:w})]},f.id)})]}),a.jsxs("div",{className:"mt-auto border-t theme-border pt-4 space-y-2",children:[a.jsx(lv,{currentThemeId:fr,onChange:Mr,placement:"top"}),a.jsxs("button",{onClick:()=>fe(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(Ip,{size:16})," Istruzioni"]}),a.jsxs("button",{onClick:()=>fs(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(Mx,{size:16})," Impostazioni"]})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{backgroundColor:Ke.colors.bgMain},children:[a.jsx("div",{className:"h-16 border-b flex items-center justify-between px-8 theme-panel theme-border",children:a.jsxs("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(xu,{className:"absolute left-3 top-1/2 -translate-y-1/2 opacity-50",size:18}),a.jsx("input",{className:"w-full pl-10 pr-4 py-2 rounded-lg border theme-border bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 theme-text placeholder-opacity-50 placeholder-current",placeholder:"Cerca genogramma...",value:Pr,onChange:f=>Ri(f.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2 border-l pl-4 theme-border",children:[a.jsx("span",{className:"text-xs uppercase font-bold opacity-50 theme-text",children:"Ordina"}),a.jsx("button",{onClick:()=>os("date_desc"),className:`p-1.5 rounded ${Cr==="date_desc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Recenti",children:a.jsx(Cg,{className:"rotate-180",size:18})}),a.jsx("button",{onClick:()=>os("date_asc"),className:`p-1.5 rounded ${Cr==="date_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Vecchi",children:a.jsx(Cg,{size:18})}),a.jsx("button",{onClick:()=>os("name_asc"),className:`p-1.5 rounded ${Cr==="name_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Alfabetico",children:a.jsx(Db,{size:18})})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[Bl.map(f=>{var j;const y=gt.find(F=>F.id===f.category)||gt[gt.length-1],w=nv[y.iconKey]||sf;return a.jsxs("div",{onClick:()=>{Mi(f.id),na(f.title),Xs(f.category),cs(f.data.presets||[]),Ql(f.data.nodes||[],f.data.edges||[],f.data.groups||[],f.data.stickyNotes||[]),E("editor")},className:"group relative theme-panel rounded-xl shadow-sm hover:shadow-md transition-all border theme-border cursor-pointer overflow-hidden flex flex-col h-48",children:[a.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:y.color}}),a.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider",style:{color:y.color},children:[a.jsx(w,{size:12})," ",y.label]}),a.jsx("button",{onClick:F=>{if(F.stopPropagation(),confirm("Eliminare?")){dn&&QA(ih(dn,"artifacts",Di,"users",I||(G==null?void 0:G.uid)||"anon","genograms",f.id)),localStorage.removeItem(`genopro_data_${f.id}`);const O=localStorage.getItem("genopro_local_index");if(O){const W=JSON.parse(O).filter(U=>U.id!==f.id);localStorage.setItem("genopro_local_index",JSON.stringify(W)),Rt(U=>U.filter(Q=>Q.id!==f.id))}}},className:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(Ta,{size:16})})]}),a.jsx("h3",{className:"text-lg font-bold mb-1 line-clamp-2 theme-text",children:f.title}),a.jsxs("div",{className:"mt-auto pt-4 flex items-center justify-between text-xs opacity-60 border-t theme-border",children:[a.jsx("span",{children:new Date(f.lastModified).toLocaleDateString()}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Mo,{size:12})," ",((j=f.data.nodes)==null?void 0:j.length)||0]})]})]})]},f.id)}),Bl.length===0&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 opacity-40 border-2 border-dashed theme-border rounded-xl",children:[a.jsx(xu,{size:48,className:"mb-4"}),a.jsx("p",{children:"Nessun genogramma trovato"}),Pr&&a.jsx("button",{onClick:()=>Ri(""),className:"hover:underline mt-2 text-sm",style:{color:"var(--theme-accent)"},children:"Pulisci ricerca"})]})]})})]})]})]}):a.jsxs("div",{className:"h-screen flex flex-col overflow-hidden transition-colors duration-300 relative",style:{backgroundColor:Ke.colors.bgMain,color:Ke.colors.text,"--theme-bg-main":Ke.colors.bgMain,"--theme-bg-panel":Ke.colors.bgPanel,"--theme-border":Ke.colors.border,"--theme-text":Ke.colors.text,"--theme-text-muted":Ke.colors.textMuted,"--theme-accent":Ke.colors.accent,touchAction:"none"},children:[a.jsx("style",{children:`
         .no-scrollbar::-webkit-scrollbar { display: none; }
         .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
         
         /* Classi di utilit per i temi */
         .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
         .theme-border { border-color: var(--theme-border); }
         .theme-text { color: var(--theme-text); }
         .theme-text-muted { color: var(--theme-text-muted); }
         .theme-hover:hover { background-color: rgba(128,128,128, 0.1); }
       `}),Zs&&a.jsx(yC,{onClose:()=>zi(!1),onSave:f=>cs(y=>[...y,f])}),On&&a.jsx(pC,{onClose:()=>Fi(!1),nodes:re,edges:me,groups:we}),v&&a.jsx(EC,{onClose:()=>k(!1),onConfirm:f=>{k(!1),xd(f)}}),Sn&&a.jsx(dC,{x:Sn.x,y:Sn.y,mode:Sn.mode,customPresets:ls,onClose:()=>hn(null),onSelect:f=>{In(y=>y.map(w=>w.id===Sn.edgeId?{...w,type:f}:w)),hn(null)}}),jr&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>as(!1)}),a.jsxs("div",{className:"h-14 border-b flex items-center px-2 md:px-4 justify-between shrink-0 gap-2 relative z-50 overflow-visible theme-panel border-b theme-border",children:[a.jsxs("div",{className:"flex gap-2 md:gap-3 items-center shrink-0",children:[a.jsx("button",{onClick:()=>E("dashboard"),className:"p-2 theme-hover rounded",children:a.jsx(tf,{size:20})}),a.jsxs("div",{className:"flex flex-col ml-1",children:[a.jsx("input",{value:bn,onChange:f=>na(f.target.value),className:"bg-transparent font-bold text-sm w-24 md:w-40 outline-none theme-text truncate",placeholder:"Titolo"}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>as(!jr),className:"flex items-center gap-1 text-[10px] uppercase font-bold theme-text-muted hover:text-[var(--theme-accent)]",children:[(da=gt.find(f=>f.id===Dr))==null?void 0:da.label," ",a.jsx(Tx,{size:10})]}),jr&&a.jsx("div",{className:"absolute top-full left-0 mt-1 shadow-lg rounded-lg p-1 w-40 z-50 theme-panel border theme-border",children:gt.map(f=>a.jsxs("button",{onClick:()=>{Xs(f.id),as(!1)},className:"w-full text-left px-2 py-1.5 text-xs rounded theme-hover flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:f.color}})," ",f.label]},f.id))})]})]}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"})]}),a.jsx("div",{className:"flex-1 min-w-0 flex justify-start md:justify-center px-2",children:a.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar w-full md:w-auto md:max-w-full",children:[a.jsx("button",{onClick:()=>Xl("M"),title:"Nuovo Maschio (M)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(nf,{style:{color:"var(--theme-accent)"},size:20})}),a.jsx("button",{onClick:()=>Xl("F"),title:"Nuova Femmina (F)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(ef,{className:"text-pink-600",size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:Xn,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Genitori",children:a.jsx(Ox,{size:18})}),a.jsx("button",{onClick:la,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Partner",children:a.jsx(Do,{size:18})}),a.jsx("button",{onClick:ca,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Figlio",children:a.jsx(Ax,{size:18})}),a.jsx("button",{onClick:si,title:"Gruppo",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(Mo,{size:20})}),a.jsx("button",{onClick:N,title:"Aggiungi Nota (N)",className:"p-1.5 theme-hover rounded shrink-0",style:{color:"#f59e0b"},children:a.jsx(rf,{size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:Yl,className:"p-1.5 theme-hover rounded shrink-0",style:{color:"var(--theme-accent)"},title:"Auto-Layout",children:a.jsx(Dx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>Nn("h"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Orizzontale",children:a.jsx(gu,{size:18})}),a.jsx("button",{onClick:()=>Nn("v"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Verticale",children:a.jsx(gu,{className:"rotate-90",size:18})}),a.jsx("button",{onClick:()=>Gl("align-children"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Figli",children:a.jsx(bx,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("button",{onClick:()=>Gl("align-parents"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Genitori",children:a.jsx(kx,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>Nn("circle"),className:"p-1.5 theme-hover rounded shrink-0",title:"Cerchio",children:a.jsx(Sx,{size:18})}),a.jsx("button",{onClick:()=>Nn("grid"),className:"p-1.5 theme-hover rounded shrink-0",title:"Griglia",children:a.jsx(Cx,{size:18})}),a.jsx("button",{onClick:()=>Nn("diagonal"),className:"p-1.5 theme-hover rounded shrink-0",title:"Diagonale",children:a.jsx(Lx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>hs(!Lr),className:`p-1.5 rounded shrink-0 ${Lr?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Snap Griglia",children:a.jsx(Px,{size:18})}),a.jsx("button",{onClick:()=>sa(!qn),className:`p-1.5 rounded shrink-0 ${qn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mod. Selezione",children:a.jsx(Rx,{size:18})}),a.jsx("button",{onClick:()=>zi(!0),className:"p-1.5 theme-hover rounded shrink-0",title:"Stili",children:a.jsx(vu,{size:18})}),a.jsxs("div",{className:"flex items-center gap-1 border-l pl-2 dark:border-gray-700",children:[a.jsx("label",{className:"text-xs text-gray-500 whitespace-nowrap ml-1",children:"Testo Nodo:"}),a.jsxs("select",{value:Vi,onChange:f=>pd(f.target.value),className:"bg-transparent text-xs p-1 rounded border hover:bg-black/5 dark:border-gray-600 dark:hover:bg-white/5 outline-none",children:[a.jsx("option",{value:"age",className:"text-black",children:"Et"}),a.jsx("option",{value:"year",className:"text-black",children:"Anno"}),a.jsx("option",{value:"date",className:"text-black",children:"Data"}),a.jsx("option",{value:"none",className:"text-black",children:"Nessuno"})]})]}),a.jsx("button",{onClick:()=>ra(!Gn),className:`p-1.5 rounded shrink-0 ${Gn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mostra Legenda",children:a.jsx(yu,{size:18})})]})}),a.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[a.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm mr-2 theme-border theme-panel",title:"Stato Sync",children:[ue==="synced"&&a.jsx(Nx,{className:"text-green-500",size:16}),ue==="syncing"&&a.jsx(Fb,{className:"text-orange-500 animate-spin",size:16}),ue==="error"&&a.jsx(Pg,{className:"text-red-500",size:16}),ue==="offline"&&a.jsx(Pg,{className:"opacity-50",size:16}),a.jsx("span",{className:`text-[10px] font-bold uppercase ${ue==="synced"?"text-green-600":"opacity-50"}`,children:ue==="synced"?"SYNC":ue==="syncing"?"SAVING":"OFFLINE"})]}),a.jsx("button",{onClick:Oi,disabled:qt<=0,className:`p-1.5 rounded ${qt<=0?"opacity-30":"theme-hover"}`,title:"Annulla",children:a.jsx(zb,{size:18})}),a.jsx("button",{onClick:hr,disabled:qt>=ur.length-1,className:`p-1.5 rounded ${qt>=ur.length-1?"opacity-30":"theme-hover"}`,title:"Ripristina",children:a.jsx(Ub,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"}),a.jsx("button",{onClick:ps,className:"p-1.5 theme-hover rounded hidden md:block",title:"Ricentra",children:a.jsx($b,{size:18})}),a.jsx("button",{onClick:()=>Or(f=>Math.max(.2,f-.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(Gb,{size:18})}),a.jsxs("span",{className:"text-xs w-8 text-center hidden md:block",children:[Math.round(ei*100),"%"]}),a.jsx("button",{onClick:()=>Or(f=>Math.min(3,f+.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(Hb,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1"}),a.jsxs("div",{className:"w-10 md:w-32",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(lv,{currentThemeId:fr,onChange:Mr,placement:"bottom"})}),a.jsx("div",{className:"md:hidden",children:a.jsx("button",{onClick:()=>{const f=Is.findIndex(w=>w.id===fr),y=Is[(f+1)%Is.length];Mr(y.id)},className:"p-1.5 theme-hover rounded",children:Ke.type==="dark"?a.jsx(jx,{size:18}):a.jsx(Tp,{size:18})})})]}),a.jsx("button",{onClick:()=>Fi(!0),className:"p-1.5 theme-hover rounded hidden sm:block",style:{color:"var(--theme-accent)"},title:"Report",children:a.jsx(Eo,{size:20})}),a.jsxs("div",{className:"relative group z-50",children:[a.jsx("button",{className:"p-1.5 theme-hover rounded font-bold",style:{color:"var(--theme-accent)"},title:"Esporta",children:a.jsx(kp,{size:20})}),a.jsxs("div",{className:"absolute right-0 top-full theme-panel border theme-border shadow-lg rounded p-3 hidden group-hover:block w-64 z-[70]",children:[a.jsxs("div",{className:"mb-3 pb-3 border-b theme-border",children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-2",children:"Qualit Immagine"}),a.jsxs("div",{className:"flex bg-black/5 dark:bg-white/5 rounded p-1 gap-1 items-center",children:[[1,2,4,6].map(f=>a.jsxs("button",{onClick:y=>{y.stopPropagation(),oa(f)},className:`flex-1 text-[10px] py-1.5 rounded transition-all font-medium ${$i===f?"theme-panel shadow text-[var(--theme-accent)]":"opacity-50"}`,children:[f,"x"]},f)),a.jsx("div",{className:"w-px h-4 bg-gray-300 opacity-30 mx-0.5"}),a.jsx("div",{className:"relative group/input",children:a.jsx("input",{type:"number",min:"1",max:"12",value:$i,onClick:f=>f.stopPropagation(),onChange:f=>{const y=parseInt(f.target.value);isNaN(y)||oa(Math.max(1,Math.min(12,y)))},className:"w-10 text-[10px] py-1 rounded border-none bg-transparent text-center outline-none font-bold text-[var(--theme-accent)]",placeholder:"#"})})]})]}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Immagini"}),a.jsxs("button",{onClick:()=>Zl("png"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Vb,{size:14})," Scarica PNG"]}),a.jsxs("button",{onClick:()=>Zl("jpeg"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Rb,{size:14})," Scarica JPEG"]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-600 my-2 opacity-30"}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Documenti"}),a.jsxs("button",{onClick:pr,className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Eo,{size:14})," PDF Vettoriale (Solo Grafico)"]}),a.jsxs("button",{onClick:()=>k(!0),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Eo,{size:14})," Report Clinico (Completo)"]})]})]})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden relative print:overflow-visible",children:[a.jsx("div",{ref:n,className:"flex-1 overflow-auto relative",style:{touchAction:"none"},children:a.jsxs("div",{style:{width:ja,height:ja},className:"relative print:w-full print:h-full",children:[a.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none print:hidden",style:{backgroundImage:"radial-gradient(currentColor 1px, transparent 1px)",backgroundSize:`${pn}px ${pn}px`,color:"var(--theme-text-muted)"}}),a.jsx("svg",{ref:t,width:ja,height:ja,className:`block touch-none ${ia?De!=null&&De.active?"cursor-grabbing":"cursor-grab":""}`,style:{touchAction:"none"},onContextMenu:f=>{f.preventDefault(),f.stopPropagation()},onPointerDown:He,onTouchStart:D,onTouchMove:L,onTouchEnd:A,children:a.jsxs("g",{ref:e,transform:`scale(${ei})`,style:{transformOrigin:`${At}px ${At}px`},children:[we.map(f=>{const y=kc(f,re);if(!y)return null;const{d:w,cx:j,cy:F}=y,O=Ln.includes(f.id),W=f.color==="#000000"&&ds?"#ffffff":f.color,U=f.labelPos?f.labelPos.x:j,Q=f.labelPos?f.labelPos.y:Math.min(...y.expandedPoints.map(B=>B.y))-20;return a.jsxs("g",{onClick:B=>{B.stopPropagation(),Be([f.id]),$e([])},children:[a.jsx("path",{d:w,fill:W,fillOpacity:.05,stroke:W,strokeDasharray:"10,5",strokeWidth:O?3:2,strokeLinejoin:"round",className:O?"stroke-blue-500 cursor-move":"cursor-pointer",onPointerDown:B=>{B.stopPropagation(),Be([f.id]),$e([])}}),f.showLabel!==!1&&a.jsxs("g",{transform:`translate(${U}, ${Q})`,className:"cursor-move",onPointerDown:B=>{B.stopPropagation(),B.preventDefault();const{x:J,y:ee}=Et(B);S.current={active:!0,type:"group-label",sourceId:f.id,startX:J,startY:ee,currX:J,currY:ee,initialNodePositions:{[f.id]:{x:U,y:Q}},pointerId:B.pointerId},Lt({...S.current})},children:[a.jsx("rect",{x:-(f.label.length*4)-10,y:"-12",width:f.label.length*8+20,height:"24",fill:Ke.colors.bgPanel,fillOpacity:"0.8",rx:"4",stroke:O?"blue":"transparent"}),a.jsx("text",{textAnchor:"middle",dy:"5",fill:W,className:"text-xs font-bold uppercase select-none pointer-events-none",children:f.label})]})]},f.id)}),me.map(f=>{let y=sv(f.fromId,re,we),w=sv(f.toId,re,we);if(!y||!w)return null;const j=we.find(B=>B.id===f.toId);if(j){const B=kc(j,re);B&&(f.toAnchor!==void 0?w=av(B.controlPoints,f.toAnchor):w=ov(B.expandedPoints,y))}const F=we.find(B=>B.id===f.fromId);if(F){const B=kc(F,re);B&&(f.fromAnchor!==void 0?y=av(B.controlPoints,f.fromAnchor):y=ov(B.expandedPoints,w))}const O=re.find(B=>B.id===f.fromId),W=re.find(B=>B.id===f.toId),U=f.type.startsWith("twin");if((f.type.startsWith("child")||U)&&O&&W){const B=rv(f.fromId,me);if(B){const J=re.find(ie=>ie.id===B.fromId),ee=re.find(ie=>ie.id===B.toId);J&&ee&&(y={x:(J.x+ee.x+zt)/2,y:Math.max(J.y,ee.y)+rC})}else y={x:O.x+zt/2,y:O.y+wr}}const Q=ls.find(B=>B.id===f.type);return a.jsx("g",{onClick:B=>{B.stopPropagation(),gd(f.id,B)},children:a.jsx(cC,{edge:f,start:y,end:w,isSelected:Tn.includes(f.id),darkMode:ds,customConfig:Q,onAddChild:(B,J)=>ql(B,J),isTargetGroup:we.some(B=>B.id===f.toId),tNode:W})},f.id)}),De&&De.type!=="move"&&De.type!=="box"&&De.type!=="pan"&&a.jsx("line",{x1:De.startX,y1:De.startY,x2:De.currX,y2:De.currY,stroke:"gray",strokeDasharray:"5,5"}),De&&De.type==="move"&&pe.map(f=>{var U,Q;if(!re.find(B=>B.id===f))return null;const w=(Q=(U=S.current)==null?void 0:U.initialNodePositions)==null?void 0:Q[f];if(!w)return null;const j=De.currX-De.startX,F=De.currY-De.startY;let O=w.x+j,W=w.y+F;return Lr&&(O=Math.round(O/pn)*pn,W=Math.round(W/pn)*pn),a.jsx("rect",{x:O,y:W,width:zt,height:wr,fill:"none",stroke:"gray",strokeDasharray:"2,2"},f)}),re.map(f=>{var w;const y=o?(w=we.find(j=>j.id===o))==null?void 0:w.memberIds.includes(f.id):!1;return a.jsxs("g",{onPointerDown:j=>ni(j,f.id),style:{touchAction:"none"},children:[o&&a.jsx("circle",{cx:f.x+zt/2,cy:f.y+wr/2,r:zt,fill:"none",stroke:y?"#22c55e":"transparent",strokeWidth:3,strokeDasharray:y?"":"4,2",className:"pointer-events-none transition-all duration-300",opacity:y?1:.3}),a.jsx(uC,{node:f,isSelected:pe.includes(f.id),showLabelType:Vi,darkMode:ds,onHandleDown:Qn,selectionMode:qn,onRename:(j,F)=>ot(O=>O.map(W=>W.id===j?{...W,name:F}:W))})]},f.id)}),(()=>{if(!Gn)return null;const f=Jl();return a.jsx(aC,{x:f.minX-350,y:f.minY,darkMode:ds,nodes:re,edges:me})})(),De&&De.type==="box"&&a.jsx("rect",{x:Math.min(De.startX,De.currX),y:Math.min(De.startY,De.currY),width:Math.abs(De.currX-De.startX),height:Math.abs(De.currY-De.startY),fill:"rgba(0,0,255,0.1)",stroke:"blue"}),we.map(f=>{if(!Ln.includes(f.id))return null;const y=kc(f,re);if(!y)return null;const{cx:w,cy:j}=y,F=f.customPadding||50;return a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${w-F-20}, ${j})`,className:"cursor-crosshair",style:{touchAction:"none"},onPointerDown:O=>{O.stopPropagation(),O.preventDefault(),ri(O,f.id)},children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx(Sp,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Crea Relazione"})]}),a.jsxs("g",{transform:`translate(${w}, ${j+F+10})`,className:"cursor-ns-resize",style:{touchAction:"none"},onPointerDown:O=>{O.stopPropagation(),O.preventDefault();const{x:W,y:U}=Et(O);S.current={active:!0,type:"group-padding",sourceId:f.id,startX:W,startY:U,currX:W,currY:U,initialPadding:F,pointerId:O.pointerId},Lt({...S.current})},children:[a.jsx("path",{d:"M0 -8 L8 0 L0 8 L-8 0 Z",fill:"#8b5cf6",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx("title",{children:"Regola Grandezza"})]})]},`handles-${f.id}`)}),u.map(f=>a.jsx(wC,{note:f,zoom:ei,isSelected:m.includes(f.id),onPointerDown:y=>qi(y,f.id),onUpdate:y=>{h(w=>w.map(j=>j.id===y.id?y:j))}},f.id)),a.jsx(xC,{nodes:re,selectedIds:pe,onHandleDown:Gi,onMove:Hi})]})})]})}),(pe.length>0||Tn.length>0||Ln.length>0||m.length>0)&&a.jsxs("div",{className:"w-80 border-l p-4 overflow-y-auto theme-panel theme-border print:hidden flex flex-col h-full shadow-xl z-50",children:[a.jsxs("h3",{className:"font-bold mb-4 flex justify-between items-center shrink-0",children:["Propriet",a.jsx("button",{onClick:()=>{$e([]),Mt([]),Be([]),g([])},className:"p-1 hover:bg-red-100 hover:text-red-600 rounded transition-colors",children:a.jsx(Bs,{size:18})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-6",children:[Ge&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border font-bold",value:Ge.name,onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,name:f.target.value}:y)),placeholder:"Nome"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ge.label||"",onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,label:f.target.value}:y)),placeholder:"Etichetta (es. Padre)"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ge.birthDate,onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,birthDate:f.target.value}:y)),placeholder:"Nascita (Data, Anno o inserisci direttamente un'Et)"}),a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("input",{type:"checkbox",id:"showAge",checked:Ge.showAge!==!1,onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,showAge:f.target.checked}:y))}),a.jsx("label",{htmlFor:"showAge",className:"text-xs opacity-70",children:"Mostra Et"})]}),a.jsxs("div",{className:"text-xs opacity-50",children:["Et: ",_l(Ge.birthDate)]}),a.jsxs("select",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Ge.gender,onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,gender:f.target.value}:y)),children:[a.jsx("option",{value:"M",className:"text-black",children:"Maschio"}),a.jsx("option",{value:"F",className:"text-black",children:"Femmina"}),a.jsx("option",{value:"TransWoman",className:"text-black",children:"Donna Trans (MTF)"}),a.jsx("option",{value:"TransMan",className:"text-black",children:"Uomo Trans (FTM)"}),a.jsx("option",{value:"NonBinary",className:"text-black",children:"Non-Binary/Genderqueer"}),a.jsx("option",{value:"Pet",className:"text-black",children:"Animale"}),a.jsx("option",{value:"Pregnancy",className:"text-black",children:"Gravidanza"}),a.jsx("option",{value:"Miscarriage",className:"text-black",children:"Aborto Spontaneo"}),a.jsx("option",{value:"Abortion",className:"text-black",children:"Aborto Volontario"}),a.jsx("option",{value:"Stillbirth",className:"text-black",children:"Morto alla nascita"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ge.deceased?"bg-black text-white dark:bg-white dark:text-black":"theme-border hover:bg-black/5"}`,onClick:()=>ot(re.map(f=>f.id===Ge.id?{...f,deceased:!f.deceased}:f)),children:"Deceduto"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ge.indexPerson?"bg-blue-600 text-white":"theme-border hover:bg-blue-50"}`,onClick:()=>ot(re.map(f=>f.id===Ge.id?{...f,indexPerson:!f.indexPerson}:f)),children:"Pz. Designato"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ge.substanceAbuse?"bg-orange-500 text-white":"theme-border hover:bg-orange-50"}`,onClick:()=>ot(re.map(f=>f.id===Ge.id?{...f,substanceAbuse:!f.substanceAbuse}:f)),children:"Abuso Sost."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ge.mentalIssue?"bg-purple-500 text-white":"theme-border hover:bg-purple-50"}`,onClick:()=>ot(re.map(f=>f.id===Ge.id?{...f,mentalIssue:!f.mentalIssue}:f)),children:"Problema Psi."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${Ge.gayLesbian?"bg-pink-500 text-white":"theme-border hover:bg-pink-50"}`,onClick:()=>ot(re.map(f=>f.id===Ge.id?{...f,gayLesbian:!f.gayLesbian}:f)),children:"Omosessuale"})]}),a.jsx(oh,{notes:Ge.notes,onChange:f=>ot(re.map(y=>y.id===Ge.id?{...y,notes:f}:y))}),a.jsxs("button",{onClick:()=>{ot(re.filter(f=>!pe.includes(f.id))),In(me.filter(f=>!pe.includes(f.fromId)&&!pe.includes(f.toId))),$e([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Persona"]})]}),Qe&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[we.some(f=>f.id===Qe.fromId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Partenza"}),a.jsxs("span",{children:[Math.round((Qe.fromAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(Qe.fromAnchor??-1)===-1?0:Qe.fromAnchor*100,onChange:f=>{const y=parseInt(f.target.value)/100;In(w=>w.map(j=>j.id===Qe.id?{...j,fromAnchor:y}:j))}}),a.jsx("button",{onClick:()=>In(f=>f.map(y=>y.id===Qe.id?{...y,fromAnchor:void 0}:y)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),we.some(f=>f.id===Qe.toId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Arrivo"}),a.jsxs("span",{children:[Math.round((Qe.toAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(Qe.toAnchor??-1)===-1?0:Qe.toAnchor*100,onChange:f=>{const y=parseInt(f.target.value)/100;In(w=>w.map(j=>j.id===Qe.id?{...j,toAnchor:y}:j))}}),a.jsx("button",{onClick:()=>In(f=>f.map(y=>y.id===Qe.id?{...y,toAnchor:void 0}:y)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),a.jsx("label",{className:"text-xs opacity-50 font-bold block",children:"Tipo Relazione"}),a.jsx(lC,{value:Qe.type,onChange:f=>{const y=rn[f]||{};In(w=>w.map(j=>j.id===Qe.id?{...j,type:f,color:y.color,lineStyle:y.lineStyle,decorator:y.decorator}:j))},className:"text-black"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Qe.label,onChange:f=>In(y=>y.map(w=>w.id===Qe.id?{...w,label:f.target.value}:w)),placeholder:"Etichetta"}),a.jsx(oh,{notes:Qe.notes,onChange:f=>In(y=>y.map(w=>w.id===Qe.id?{...w,notes:f}:w))}),a.jsxs("button",{onClick:()=>{In(me.filter(f=>f.id!==Qe.id)),Mt([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Relazione"]})]}),at&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("label",{className:"text-xs opacity-50 font-bold",children:"Tipo Gruppo"}),a.jsxs("select",{className:"w-full p-2 rounded border bg-transparent theme-border",value:at.type,onChange:f=>Hn(we.map(y=>y.id===at.id?{...y,type:f.target.value}:y)),children:[a.jsx("option",{value:"household",className:"text-black",children:"Household"}),a.jsx("option",{value:"subsystem",className:"text-black",children:"Sottosistema"})]}),a.jsxs("button",{onClick:()=>c(at.id),className:`w-full py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors border ${o===at.id?"bg-green-100 text-green-700 border-green-300":"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100"}`,children:[o===at.id?a.jsx(Ix,{size:14}):a.jsx(vu,{size:14}),o===at.id?"Fine Modifica Membri":"Modifica Membri"]}),o===at.id&&a.jsxs("div",{className:"text-[10px] opacity-70 text-center bg-yellow-50 dark:bg-yellow-900/10 p-2 rounded text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-800",children:[a.jsx(yu,{size:10,className:"inline mr-1"})," Clicca sulle persone nel grafico per aggiungerle o rimuoverle dal gruppo."]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2 pt-2 border-t theme-border",children:[a.jsx("input",{type:"checkbox",id:"showLabel",checked:at.showLabel!==!1,onChange:f=>Hn(we.map(y=>y.id===at.id?{...y,showLabel:f.target.checked}:y))}),a.jsx("label",{htmlFor:"showLabel",className:"text-xs",children:"Mostra Etichetta"})]}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:at.label,onChange:f=>Hn(we.map(y=>y.id===at.id?{...y,label:f.target.value}:y)),placeholder:"Etichetta Gruppo"}),a.jsx("div",{className:"border theme-border rounded p-2 bg-black/5 dark:bg-white/5",children:a.jsx(fC,{value:at.color,onChange:f=>Hn(we.map(y=>y.id===at.id?{...y,color:f}:y))})}),a.jsx(oh,{notes:at.notes,onChange:f=>Hn(we.map(y=>y.id===at.id?{...y,notes:f}:y))}),a.jsxs("button",{onClick:()=>{Hn(we.filter(f=>f.id!==at.id)),Be([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Gruppo"]})]}),m.length===1&&(()=>{const f=u.find(y=>y.id===m[0]);return f?a.jsx(_C,{note:f,onUpdate:y=>{h(w=>w.map(j=>j.id===f.id?{...j,...y}:j))},onDelete:()=>{if(confirm("Eliminare questa nota?")){const y=u.filter(w=>w.id!==f.id);us(re,me,we,y),g([])}}}):null})()]})]}),ne&&a.jsxs("div",{className:"fixed z-[9999] flex flex-col gap-2 p-3 rounded-xl shadow-2xl theme-panel theme-border border animate-in fade-in zoom-in duration-200",style:{left:ne.x-75,top:ne.y-100},children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 text-center uppercase mb-1",children:"Aggiungi"}),a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsxs("button",{onClick:()=>{aa("M",ne.gx,ne.gy),Oe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(nf,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"M"})]}),a.jsxs("button",{onClick:()=>{aa("F",ne.gx,ne.gy),Oe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-pink-50 dark:hover:bg-pink-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-full shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(ef,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"F"})]}),a.jsxs("button",{onClick:()=>{N(ne.gx,ne.gy),Oe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-yellow-50 dark:hover:bg-yellow-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(rf,{size:20,className:"text-yellow-500"})}),a.jsx("span",{className:"text-xs font-bold",children:"Nota"})]})]}),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 w-3 h-3 bg-inherit border-b border-r theme-border rotate-45 transform"}),a.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>Oe(null)})]})]})," "]})}class kC extends _v.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Errore Critico di Avvio:",e,n)}render(){var e,n;return this.state.hasError?a.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[a.jsx("h1",{style:{color:"#dc2626",fontSize:"1.5rem",marginBottom:"1rem"},children:"Si  verificato un errore critico"}),a.jsx("p",{style:{marginBottom:"1rem",color:"#4b5563"},children:"L'applicazione non  riuscita ad avviarsi. Ecco i dettagli tecnici:"}),a.jsxs("div",{style:{backgroundColor:"#f3f4f6",padding:"1rem",borderRadius:"0.5rem",overflow:"auto",border:"1px solid #e5e7eb"},children:[a.jsx("code",{style:{color:"#dc2626",fontSize:"0.875rem"},children:(e=this.state.error)==null?void 0:e.message}),a.jsx("pre",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"#374151"},children:(n=this.state.error)==null?void 0:n.stack})]}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1.5rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontWeight:"bold"},children:"Ricarica Applicazione"})]}):this.props.children}}const cv=document.getElementById("root");cv?ah.createRoot(cv).render(a.jsx(_v.StrictMode,{children:a.jsx(kC,{children:a.jsx(bC,{})})})):document.body.innerHTML=`<div style="color: red; padding: 20px; font-weight: bold;">ERRORE FATALE: Impossibile trovare l'elemento con id="root" nel file index.html.</div>`;export{Np as W};
