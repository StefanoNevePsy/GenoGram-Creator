(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function e1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uv={exports:{}},Vu={},dv={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _l=Symbol.for("react.element"),t1=Symbol.for("react.portal"),n1=Symbol.for("react.fragment"),r1=Symbol.for("react.strict_mode"),s1=Symbol.for("react.profiler"),i1=Symbol.for("react.provider"),o1=Symbol.for("react.context"),a1=Symbol.for("react.forward_ref"),l1=Symbol.for("react.suspense"),c1=Symbol.for("react.memo"),u1=Symbol.for("react.lazy"),_m=Symbol.iterator;function d1(t){return t===null||typeof t!="object"?null:(t=_m&&t[_m]||t["@@iterator"],typeof t=="function"?t:null)}var hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fv=Object.assign,pv={};function qo(t,e,n){this.props=t,this.context=e,this.refs=pv,this.updater=n||hv}qo.prototype.isReactComponent={};qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mv(){}mv.prototype=qo.prototype;function Nf(t,e,n){this.props=t,this.context=e,this.refs=pv,this.updater=n||hv}var Af=Nf.prototype=new mv;Af.constructor=Nf;fv(Af,qo.prototype);Af.isPureReactComponent=!0;var wm=Array.isArray,gv=Object.prototype.hasOwnProperty,Cf={current:null},yv={key:!0,ref:!0,__self:!0,__source:!0};function vv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)gv.call(e,r)&&!yv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),h=0;h<c;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:_l,type:t,key:i,ref:o,props:s,_owner:Cf.current}}function h1(t,e){return{$$typeof:_l,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Pf(t){return typeof t=="object"&&t!==null&&t.$$typeof===_l}function f1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Em=/\/+/g;function _d(t,e){return typeof t=="object"&&t!==null&&t.key!=null?f1(""+t.key):e.toString(36)}function Ic(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _l:case t1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+_d(o,0):r,wm(s)?(n="",t!=null&&(n=t.replace(Em,"$&/")+"/"),Ic(s,e,n,"",function(h){return h})):s!=null&&(Pf(s)&&(s=h1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Em,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wm(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+_d(i,c);o+=Ic(i,e,n,u,s)}else if(u=d1(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+_d(i,c++),o+=Ic(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function tc(t,e,n){if(t==null)return t;var r=[],s=0;return Ic(t,r,"","",function(i){return e.call(n,i,s++)}),r}function p1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dn={current:null},Tc={transition:null},m1={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:Cf};function xv(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:tc,forEach:function(t,e,n){tc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return tc(t,function(){e++}),e},toArray:function(t){return tc(t,function(e){return e})||[]},only:function(t){if(!Pf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=qo;Te.Fragment=n1;Te.Profiler=s1;Te.PureComponent=Nf;Te.StrictMode=r1;Te.Suspense=l1;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m1;Te.act=xv;Te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Cf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)gv.call(e,u)&&!yv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:_l,type:t.type,key:s,ref:i,props:r,_owner:o}};Te.createContext=function(t){return t={$$typeof:o1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:i1,_context:t},t.Consumer=t};Te.createElement=vv;Te.createFactory=function(t){var e=vv.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:a1,render:t}};Te.isValidElement=Pf;Te.lazy=function(t){return{$$typeof:u1,_payload:{_status:-1,_result:t},_init:p1}};Te.memo=function(t,e){return{$$typeof:c1,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=Tc.transition;Tc.transition={};try{t()}finally{Tc.transition=e}};Te.unstable_act=xv;Te.useCallback=function(t,e){return dn.current.useCallback(t,e)};Te.useContext=function(t){return dn.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return dn.current.useDeferredValue(t)};Te.useEffect=function(t,e){return dn.current.useEffect(t,e)};Te.useId=function(){return dn.current.useId()};Te.useImperativeHandle=function(t,e,n){return dn.current.useImperativeHandle(t,e,n)};Te.useInsertionEffect=function(t,e){return dn.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return dn.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return dn.current.useMemo(t,e)};Te.useReducer=function(t,e,n){return dn.current.useReducer(t,e,n)};Te.useRef=function(t){return dn.current.useRef(t)};Te.useState=function(t){return dn.current.useState(t)};Te.useSyncExternalStore=function(t,e,n){return dn.current.useSyncExternalStore(t,e,n)};Te.useTransition=function(){return dn.current.useTransition()};Te.version="18.3.1";dv.exports=Te;var H=dv.exports;const _v=e1(H);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1=H,y1=Symbol.for("react.element"),v1=Symbol.for("react.fragment"),x1=Object.prototype.hasOwnProperty,_1=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w1={key:!0,ref:!0,__self:!0,__source:!0};function wv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)x1.call(e,r)&&!w1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:y1,type:t,key:i,ref:o,props:s,_owner:_1.current}}Vu.Fragment=v1;Vu.jsx=wv;Vu.jsxs=wv;uv.exports=Vu;var a=uv.exports,ih={},Ev={exports:{}},Cn={},bv={exports:{}},kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,ae){var fe=Z.length;Z.push(ae);e:for(;0<fe;){var De=fe-1>>>1,Se=Z[De];if(0<s(Se,ae))Z[De]=ae,Z[fe]=Se,fe=De;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var ae=Z[0],fe=Z.pop();if(fe!==ae){Z[0]=fe;e:for(var De=0,Se=Z.length,Fe=Se>>>1;De<Fe;){var on=2*(De+1)-1,jn=Z[on],an=on+1,Mt=Z[an];if(0>s(jn,fe))an<Se&&0>s(Mt,jn)?(Z[De]=Mt,Z[an]=fe,De=an):(Z[De]=jn,Z[on]=fe,De=on);else if(an<Se&&0>s(Mt,fe))Z[De]=Mt,Z[an]=fe,De=an;else break e}}return ae}function s(Z,ae){var fe=Z.sortIndex-ae.sortIndex;return fe!==0?fe:Z.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,g=null,y=3,k=!1,C=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Z){for(var ae=n(h);ae!==null;){if(ae.callback===null)r(h);else if(ae.startTime<=Z)r(h),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=n(h)}}function M(Z){if(R=!1,N(Z),!C)if(n(u)!==null)C=!0,re(z);else{var ae=n(h);ae!==null&&We(M,ae.startTime-Z)}}function z(Z,ae){C=!1,R&&(R=!1,A(_),_=-1),k=!0;var fe=y;try{for(N(ae),g=n(u);g!==null&&(!(g.expirationTime>ae)||Z&&!j());){var De=g.callback;if(typeof De=="function"){g.callback=null,y=g.priorityLevel;var Se=De(g.expirationTime<=ae);ae=t.unstable_now(),typeof Se=="function"?g.callback=Se:g===n(u)&&r(u),N(ae)}else r(u);g=n(u)}if(g!==null)var Fe=!0;else{var on=n(h);on!==null&&We(M,on.startTime-ae),Fe=!1}return Fe}finally{g=null,y=fe,k=!1}}var G=!1,x=null,_=-1,E=5,T=-1;function j(){return!(t.unstable_now()-T<E)}function L(){if(x!==null){var Z=t.unstable_now();T=Z;var ae=!0;try{ae=x(!0,Z)}finally{ae?S():(G=!1,x=null)}}else G=!1}var S;if(typeof I=="function")S=function(){I(L)};else if(typeof MessageChannel<"u"){var Je=new MessageChannel,oe=Je.port2;Je.port1.onmessage=L,S=function(){oe.postMessage(null)}}else S=function(){D(L,0)};function re(Z){x=Z,G||(G=!0,S())}function We(Z,ae){_=D(function(){Z(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){C||k||(C=!0,re(z))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Z){switch(y){case 1:case 2:case 3:var ae=3;break;default:ae=y}var fe=y;y=ae;try{return Z()}finally{y=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,ae){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var fe=y;y=Z;try{return ae()}finally{y=fe}},t.unstable_scheduleCallback=function(Z,ae,fe){var De=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?De+fe:De):fe=De,Z){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=fe+Se,Z={id:m++,callback:ae,priorityLevel:Z,startTime:fe,expirationTime:Se,sortIndex:-1},fe>De?(Z.sortIndex=fe,e(h,Z),n(u)===null&&Z===n(h)&&(R?(A(_),_=-1):R=!0,We(M,fe-De))):(Z.sortIndex=Se,e(u,Z),C||k||(C=!0,re(z))),Z},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(Z){var ae=y;return function(){var fe=y;y=ae;try{return Z.apply(this,arguments)}finally{y=fe}}}})(kv);bv.exports=kv;var E1=bv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1=H,An=E1;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Iv=new Set,Ga={};function Mi(t,e){No(t,e),No(t+"Capture",e)}function No(t,e){for(Ga[t]=e,t=0;t<e.length;t++)Iv.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oh=Object.prototype.hasOwnProperty,k1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bm={},km={};function I1(t){return oh.call(km,t)?!0:oh.call(bm,t)?!1:k1.test(t)?km[t]=!0:(bm[t]=!0,!1)}function T1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function S1(t,e,n,r){if(e===null||typeof e>"u"||T1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bt[t]=new hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Bt[e]=new hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bt[t]=new hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bt[t]=new hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bt[t]=new hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bt[t]=new hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bt[t]=new hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bt[t]=new hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bt[t]=new hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var jf=/[\-:]([a-z])/g;function Rf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(jf,Rf);Bt[e]=new hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(jf,Rf);Bt[e]=new hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(jf,Rf);Bt[e]=new hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bt[t]=new hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Bt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bt[t]=new hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Df(t,e,n,r){var s=Bt.hasOwnProperty(e)?Bt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(S1(e,n,s,r)&&(n=null),r||s===null?I1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var rs=b1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nc=Symbol.for("react.element"),ro=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),Mf=Symbol.for("react.strict_mode"),ah=Symbol.for("react.profiler"),Tv=Symbol.for("react.provider"),Sv=Symbol.for("react.context"),Lf=Symbol.for("react.forward_ref"),lh=Symbol.for("react.suspense"),ch=Symbol.for("react.suspense_list"),Of=Symbol.for("react.memo"),ms=Symbol.for("react.lazy"),Nv=Symbol.for("react.offscreen"),Im=Symbol.iterator;function fa(t){return t===null||typeof t!="object"?null:(t=Im&&t[Im]||t["@@iterator"],typeof t=="function"?t:null)}var ht=Object.assign,wd;function Ea(t){if(wd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);wd=e&&e[1]||""}return`
`+wd+t}var Ed=!1;function bd(t,e){if(!t||Ed)return"";Ed=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{Ed=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ea(t):""}function N1(t){switch(t.tag){case 5:return Ea(t.type);case 16:return Ea("Lazy");case 13:return Ea("Suspense");case 19:return Ea("SuspenseList");case 0:case 2:case 15:return t=bd(t.type,!1),t;case 11:return t=bd(t.type.render,!1),t;case 1:return t=bd(t.type,!0),t;default:return""}}function uh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case ro:return"Portal";case ah:return"Profiler";case Mf:return"StrictMode";case lh:return"Suspense";case ch:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sv:return(t.displayName||"Context")+".Consumer";case Tv:return(t._context.displayName||"Context")+".Provider";case Lf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Of:return e=t.displayName||null,e!==null?e:uh(t.type)||"Memo";case ms:e=t._payload,t=t._init;try{return uh(t(e))}catch{}}return null}function A1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uh(e);case 8:return e===Mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Av(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function C1(t){var e=Av(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rc(t){t._valueTracker||(t._valueTracker=C1(t))}function Cv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Av(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function dh(t,e){var n=e.checked;return ht({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Tm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Fs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Pv(t,e){e=e.checked,e!=null&&Df(t,"checked",e,!1)}function hh(t,e){Pv(t,e);var n=Fs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fh(t,e.type,n):e.hasOwnProperty("defaultValue")&&fh(t,e.type,Fs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fh(t,e,n){(e!=="number"||Gc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ba=Array.isArray;function yo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Fs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ph(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return ht({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Nm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(ba(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Fs(n)}}function jv(t,e){var n=Fs(e.value),r=Fs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Am(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Rv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Rv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sc,Dv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sc=sc||document.createElement("div"),sc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P1=["Webkit","ms","Moz","O"];Object.keys(ja).forEach(function(t){P1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ja[e]=ja[t]})});function Mv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ja.hasOwnProperty(t)&&ja[t]?(""+e).trim():e+"px"}function Lv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Mv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var j1=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gh(t,e){if(e){if(j1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function yh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vh=null;function Vf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xh=null,vo=null,xo=null;function Cm(t){if(t=bl(t)){if(typeof xh!="function")throw Error(X(280));var e=t.stateNode;e&&(e=Bu(e),xh(t.stateNode,t.type,e))}}function Ov(t){vo?xo?xo.push(t):xo=[t]:vo=t}function Vv(){if(vo){var t=vo,e=xo;if(xo=vo=null,Cm(t),e)for(t=0;t<e.length;t++)Cm(e[t])}}function Fv(t,e){return t(e)}function zv(){}var kd=!1;function Uv(t,e,n){if(kd)return t(e,n);kd=!0;try{return Fv(t,e,n)}finally{kd=!1,(vo!==null||xo!==null)&&(zv(),Vv())}}function Ka(t,e){var n=t.stateNode;if(n===null)return null;var r=Bu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var _h=!1;if(qr)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){_h=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{_h=!1}function R1(t,e,n,r,s,i,o,c,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(m){this.onError(m)}}var Ra=!1,qc=null,Kc=!1,wh=null,D1={onError:function(t){Ra=!0,qc=t}};function M1(t,e,n,r,s,i,o,c,u){Ra=!1,qc=null,R1.apply(D1,arguments)}function L1(t,e,n,r,s,i,o,c,u){if(M1.apply(this,arguments),Ra){if(Ra){var h=qc;Ra=!1,qc=null}else throw Error(X(198));Kc||(Kc=!0,wh=h)}}function Li(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $v(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Pm(t){if(Li(t)!==t)throw Error(X(188))}function O1(t){var e=t.alternate;if(!e){if(e=Li(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Pm(s),t;if(i===r)return Pm(s),e;i=i.sibling}throw Error(X(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function Bv(t){return t=O1(t),t!==null?Wv(t):null}function Wv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Wv(t);if(e!==null)return e;t=t.sibling}return null}var Hv=An.unstable_scheduleCallback,jm=An.unstable_cancelCallback,V1=An.unstable_shouldYield,F1=An.unstable_requestPaint,vt=An.unstable_now,z1=An.unstable_getCurrentPriorityLevel,Ff=An.unstable_ImmediatePriority,Gv=An.unstable_UserBlockingPriority,Qc=An.unstable_NormalPriority,U1=An.unstable_LowPriority,qv=An.unstable_IdlePriority,Fu=null,kr=null;function $1(t){if(kr&&typeof kr.onCommitFiberRoot=="function")try{kr.onCommitFiberRoot(Fu,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:H1,B1=Math.log,W1=Math.LN2;function H1(t){return t>>>=0,t===0?32:31-(B1(t)/W1|0)|0}var ic=64,oc=4194304;function ka(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Yc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=ka(c):(i&=o,i!==0&&(r=ka(i)))}else o=n&~s,o!==0?r=ka(o):i!==0&&(r=ka(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lr(e),s=1<<n,r|=t[n],e&=~s;return r}function G1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-lr(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=G1(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function Eh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Kv(){var t=ic;return ic<<=1,!(ic&4194240)&&(ic=64),t}function Id(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=n}function K1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-lr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function zf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var $e=0;function Qv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Yv,Uf,Xv,Jv,Zv,bh=!1,ac=[],Ss=null,Ns=null,As=null,Qa=new Map,Ya=new Map,ys=[],Q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rm(t,e){switch(t){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":As=null;break;case"pointerover":case"pointerout":Qa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ya.delete(e.pointerId)}}function ma(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=bl(e),e!==null&&Uf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Y1(t,e,n,r,s){switch(e){case"focusin":return Ss=ma(Ss,t,e,n,r,s),!0;case"dragenter":return Ns=ma(Ns,t,e,n,r,s),!0;case"mouseover":return As=ma(As,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Qa.set(i,ma(Qa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ya.set(i,ma(Ya.get(i)||null,t,e,n,r,s)),!0}return!1}function e0(t){var e=gi(t.target);if(e!==null){var n=Li(e);if(n!==null){if(e=n.tag,e===13){if(e=$v(n),e!==null){t.blockedOn=e,Zv(t.priority,function(){Xv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=kh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);vh=r,n.target.dispatchEvent(r),vh=null}else return e=bl(n),e!==null&&Uf(e),t.blockedOn=n,!1;e.shift()}return!0}function Dm(t,e,n){Sc(t)&&n.delete(e)}function X1(){bh=!1,Ss!==null&&Sc(Ss)&&(Ss=null),Ns!==null&&Sc(Ns)&&(Ns=null),As!==null&&Sc(As)&&(As=null),Qa.forEach(Dm),Ya.forEach(Dm)}function ga(t,e){t.blockedOn===e&&(t.blockedOn=null,bh||(bh=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,X1)))}function Xa(t){function e(s){return ga(s,t)}if(0<ac.length){ga(ac[0],t);for(var n=1;n<ac.length;n++){var r=ac[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ss!==null&&ga(Ss,t),Ns!==null&&ga(Ns,t),As!==null&&ga(As,t),Qa.forEach(e),Ya.forEach(e),n=0;n<ys.length;n++)r=ys[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ys.length&&(n=ys[0],n.blockedOn===null);)e0(n),n.blockedOn===null&&ys.shift()}var _o=rs.ReactCurrentBatchConfig,Xc=!0;function J1(t,e,n,r){var s=$e,i=_o.transition;_o.transition=null;try{$e=1,$f(t,e,n,r)}finally{$e=s,_o.transition=i}}function Z1(t,e,n,r){var s=$e,i=_o.transition;_o.transition=null;try{$e=4,$f(t,e,n,r)}finally{$e=s,_o.transition=i}}function $f(t,e,n,r){if(Xc){var s=kh(t,e,n,r);if(s===null)Md(t,e,r,Jc,n),Rm(t,r);else if(Y1(s,t,e,n,r))r.stopPropagation();else if(Rm(t,r),e&4&&-1<Q1.indexOf(t)){for(;s!==null;){var i=bl(s);if(i!==null&&Yv(i),i=kh(t,e,n,r),i===null&&Md(t,e,r,Jc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Md(t,e,r,null,n)}}var Jc=null;function kh(t,e,n,r){if(Jc=null,t=Vf(r),t=gi(t),t!==null)if(e=Li(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$v(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jc=t,null}function t0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(z1()){case Ff:return 1;case Gv:return 4;case Qc:case U1:return 16;case qv:return 536870912;default:return 16}default:return 16}}var ks=null,Bf=null,Nc=null;function n0(){if(Nc)return Nc;var t,e=Bf,n=e.length,r,s="value"in ks?ks.value:ks.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nc=s.slice(t,1<r?1-r:void 0)}function Ac(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lc(){return!0}function Mm(){return!1}function Pn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lc:Mm,this.isPropagationStopped=Mm,this}return ht(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lc)},persist:function(){},isPersistent:lc}),e}var Ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wf=Pn(Ko),El=ht({},Ko,{view:0,detail:0}),eE=Pn(El),Td,Sd,ya,zu=ht({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ya&&(ya&&t.type==="mousemove"?(Td=t.screenX-ya.screenX,Sd=t.screenY-ya.screenY):Sd=Td=0,ya=t),Td)},movementY:function(t){return"movementY"in t?t.movementY:Sd}}),Lm=Pn(zu),tE=ht({},zu,{dataTransfer:0}),nE=Pn(tE),rE=ht({},El,{relatedTarget:0}),Nd=Pn(rE),sE=ht({},Ko,{animationName:0,elapsedTime:0,pseudoElement:0}),iE=Pn(sE),oE=ht({},Ko,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aE=Pn(oE),lE=ht({},Ko,{data:0}),Om=Pn(lE),cE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dE[t])?!!e[t]:!1}function Hf(){return hE}var fE=ht({},El,{key:function(t){if(t.key){var e=cE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ac(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hf,charCode:function(t){return t.type==="keypress"?Ac(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ac(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pE=Pn(fE),mE=ht({},zu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vm=Pn(mE),gE=ht({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hf}),yE=Pn(gE),vE=ht({},Ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),xE=Pn(vE),_E=ht({},zu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wE=Pn(_E),EE=[9,13,27,32],Gf=qr&&"CompositionEvent"in window,Da=null;qr&&"documentMode"in document&&(Da=document.documentMode);var bE=qr&&"TextEvent"in window&&!Da,r0=qr&&(!Gf||Da&&8<Da&&11>=Da),Fm=" ",zm=!1;function s0(t,e){switch(t){case"keyup":return EE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var io=!1;function kE(t,e){switch(t){case"compositionend":return i0(e);case"keypress":return e.which!==32?null:(zm=!0,Fm);case"textInput":return t=e.data,t===Fm&&zm?null:t;default:return null}}function IE(t,e){if(io)return t==="compositionend"||!Gf&&s0(t,e)?(t=n0(),Nc=Bf=ks=null,io=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return r0&&e.locale!=="ko"?null:e.data;default:return null}}var TE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Um(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TE[t.type]:e==="textarea"}function o0(t,e,n,r){Ov(r),e=Zc(e,"onChange"),0<e.length&&(n=new Wf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ma=null,Ja=null;function SE(t){y0(t,0)}function Uu(t){var e=lo(t);if(Cv(e))return t}function NE(t,e){if(t==="change")return e}var a0=!1;if(qr){var Ad;if(qr){var Cd="oninput"in document;if(!Cd){var $m=document.createElement("div");$m.setAttribute("oninput","return;"),Cd=typeof $m.oninput=="function"}Ad=Cd}else Ad=!1;a0=Ad&&(!document.documentMode||9<document.documentMode)}function Bm(){Ma&&(Ma.detachEvent("onpropertychange",l0),Ja=Ma=null)}function l0(t){if(t.propertyName==="value"&&Uu(Ja)){var e=[];o0(e,Ja,t,Vf(t)),Uv(SE,e)}}function AE(t,e,n){t==="focusin"?(Bm(),Ma=e,Ja=n,Ma.attachEvent("onpropertychange",l0)):t==="focusout"&&Bm()}function CE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uu(Ja)}function PE(t,e){if(t==="click")return Uu(e)}function jE(t,e){if(t==="input"||t==="change")return Uu(e)}function RE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:RE;function Za(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!oh.call(e,s)||!ur(t[s],e[s]))return!1}return!0}function Wm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hm(t,e){var n=Wm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wm(n)}}function c0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?c0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function u0(){for(var t=window,e=Gc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gc(t.document)}return e}function qf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DE(t){var e=u0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&c0(n.ownerDocument.documentElement,n)){if(r!==null&&qf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Hm(n,i);var o=Hm(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ME=qr&&"documentMode"in document&&11>=document.documentMode,oo=null,Ih=null,La=null,Th=!1;function Gm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Th||oo==null||oo!==Gc(r)||(r=oo,"selectionStart"in r&&qf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),La&&Za(La,r)||(La=r,r=Zc(Ih,"onSelect"),0<r.length&&(e=new Wf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=oo)))}function cc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ao={animationend:cc("Animation","AnimationEnd"),animationiteration:cc("Animation","AnimationIteration"),animationstart:cc("Animation","AnimationStart"),transitionend:cc("Transition","TransitionEnd")},Pd={},d0={};qr&&(d0=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function $u(t){if(Pd[t])return Pd[t];if(!ao[t])return t;var e=ao[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in d0)return Pd[t]=e[n];return t}var h0=$u("animationend"),f0=$u("animationiteration"),p0=$u("animationstart"),m0=$u("transitionend"),g0=new Map,qm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(t,e){g0.set(t,e),Mi(e,[t])}for(var jd=0;jd<qm.length;jd++){var Rd=qm[jd],LE=Rd.toLowerCase(),OE=Rd[0].toUpperCase()+Rd.slice(1);Hs(LE,"on"+OE)}Hs(h0,"onAnimationEnd");Hs(f0,"onAnimationIteration");Hs(p0,"onAnimationStart");Hs("dblclick","onDoubleClick");Hs("focusin","onFocus");Hs("focusout","onBlur");Hs(m0,"onTransitionEnd");No("onMouseEnter",["mouseout","mouseover"]);No("onMouseLeave",["mouseout","mouseover"]);No("onPointerEnter",["pointerout","pointerover"]);No("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ia));function Km(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,L1(r,e,void 0,t),t.currentTarget=null}function y0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,h=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Km(s,c,h),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,h=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Km(s,c,h),i=u}}}if(Kc)throw t=wh,Kc=!1,wh=null,t}function it(t,e){var n=e[Ph];n===void 0&&(n=e[Ph]=new Set);var r=t+"__bubble";n.has(r)||(v0(e,t,2,!1),n.add(r))}function Dd(t,e,n){var r=0;e&&(r|=4),v0(n,t,r,e)}var uc="_reactListening"+Math.random().toString(36).slice(2);function el(t){if(!t[uc]){t[uc]=!0,Iv.forEach(function(n){n!=="selectionchange"&&(VE.has(n)||Dd(n,!1,t),Dd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uc]||(e[uc]=!0,Dd("selectionchange",!1,e))}}function v0(t,e,n,r){switch(t0(e)){case 1:var s=J1;break;case 4:s=Z1;break;default:s=$f}n=s.bind(null,e,n,t),s=void 0,!_h||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Md(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=gi(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}Uv(function(){var h=i,m=Vf(n),g=[];e:{var y=g0.get(t);if(y!==void 0){var k=Wf,C=t;switch(t){case"keypress":if(Ac(n)===0)break e;case"keydown":case"keyup":k=pE;break;case"focusin":C="focus",k=Nd;break;case"focusout":C="blur",k=Nd;break;case"beforeblur":case"afterblur":k=Nd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Lm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=nE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=yE;break;case h0:case f0:case p0:k=iE;break;case m0:k=xE;break;case"scroll":k=eE;break;case"wheel":k=wE;break;case"copy":case"cut":case"paste":k=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Vm}var R=(e&4)!==0,D=!R&&t==="scroll",A=R?y!==null?y+"Capture":null:y;R=[];for(var I=h,N;I!==null;){N=I;var M=N.stateNode;if(N.tag===5&&M!==null&&(N=M,A!==null&&(M=Ka(I,A),M!=null&&R.push(tl(I,M,N)))),D)break;I=I.return}0<R.length&&(y=new k(y,C,null,n,m),g.push({event:y,listeners:R}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",y&&n!==vh&&(C=n.relatedTarget||n.fromElement)&&(gi(C)||C[Kr]))break e;if((k||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,k?(C=n.relatedTarget||n.toElement,k=h,C=C?gi(C):null,C!==null&&(D=Li(C),C!==D||C.tag!==5&&C.tag!==6)&&(C=null)):(k=null,C=h),k!==C)){if(R=Lm,M="onMouseLeave",A="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(R=Vm,M="onPointerLeave",A="onPointerEnter",I="pointer"),D=k==null?y:lo(k),N=C==null?y:lo(C),y=new R(M,I+"leave",k,n,m),y.target=D,y.relatedTarget=N,M=null,gi(m)===h&&(R=new R(A,I+"enter",C,n,m),R.target=N,R.relatedTarget=D,M=R),D=M,k&&C)t:{for(R=k,A=C,I=0,N=R;N;N=Zi(N))I++;for(N=0,M=A;M;M=Zi(M))N++;for(;0<I-N;)R=Zi(R),I--;for(;0<N-I;)A=Zi(A),N--;for(;I--;){if(R===A||A!==null&&R===A.alternate)break t;R=Zi(R),A=Zi(A)}R=null}else R=null;k!==null&&Qm(g,y,k,R,!1),C!==null&&D!==null&&Qm(g,D,C,R,!0)}}e:{if(y=h?lo(h):window,k=y.nodeName&&y.nodeName.toLowerCase(),k==="select"||k==="input"&&y.type==="file")var z=NE;else if(Um(y))if(a0)z=jE;else{z=CE;var G=AE}else(k=y.nodeName)&&k.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(z=PE);if(z&&(z=z(t,h))){o0(g,z,n,m);break e}G&&G(t,y,h),t==="focusout"&&(G=y._wrapperState)&&G.controlled&&y.type==="number"&&fh(y,"number",y.value)}switch(G=h?lo(h):window,t){case"focusin":(Um(G)||G.contentEditable==="true")&&(oo=G,Ih=h,La=null);break;case"focusout":La=Ih=oo=null;break;case"mousedown":Th=!0;break;case"contextmenu":case"mouseup":case"dragend":Th=!1,Gm(g,n,m);break;case"selectionchange":if(ME)break;case"keydown":case"keyup":Gm(g,n,m)}var x;if(Gf)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else io?s0(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(r0&&n.locale!=="ko"&&(io||_!=="onCompositionStart"?_==="onCompositionEnd"&&io&&(x=n0()):(ks=m,Bf="value"in ks?ks.value:ks.textContent,io=!0)),G=Zc(h,_),0<G.length&&(_=new Om(_,t,null,n,m),g.push({event:_,listeners:G}),x?_.data=x:(x=i0(n),x!==null&&(_.data=x)))),(x=bE?kE(t,n):IE(t,n))&&(h=Zc(h,"onBeforeInput"),0<h.length&&(m=new Om("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:h}),m.data=x))}y0(g,e)})}function tl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ka(t,n),i!=null&&r.unshift(tl(t,i,s)),i=Ka(t,e),i!=null&&r.push(tl(t,i,s))),t=t.return}return r}function Zi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qm(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,h=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&h!==null&&(c=h,s?(u=Ka(n,i),u!=null&&o.unshift(tl(n,u,c))):s||(u=Ka(n,i),u!=null&&o.push(tl(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var FE=/\r\n?/g,zE=/\u0000|\uFFFD/g;function Ym(t){return(typeof t=="string"?t:""+t).replace(FE,`
`).replace(zE,"")}function dc(t,e,n){if(e=Ym(e),Ym(t)!==e&&n)throw Error(X(425))}function eu(){}var Sh=null,Nh=null;function Ah(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ch=typeof setTimeout=="function"?setTimeout:void 0,UE=typeof clearTimeout=="function"?clearTimeout:void 0,Xm=typeof Promise=="function"?Promise:void 0,$E=typeof queueMicrotask=="function"?queueMicrotask:typeof Xm<"u"?function(t){return Xm.resolve(null).then(t).catch(BE)}:Ch;function BE(t){setTimeout(function(){throw t})}function Ld(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Xa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Xa(e)}function Cs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),xr="__reactFiber$"+Qo,nl="__reactProps$"+Qo,Kr="__reactContainer$"+Qo,Ph="__reactEvents$"+Qo,WE="__reactListeners$"+Qo,HE="__reactHandles$"+Qo;function gi(t){var e=t[xr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kr]||n[xr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jm(t);t!==null;){if(n=t[xr])return n;t=Jm(t)}return e}t=n,n=t.parentNode}return null}function bl(t){return t=t[xr]||t[Kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function lo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function Bu(t){return t[nl]||null}var jh=[],co=-1;function Gs(t){return{current:t}}function at(t){0>co||(t.current=jh[co],jh[co]=null,co--)}function nt(t,e){co++,jh[co]=t.current,t.current=e}var zs={},rn=Gs(zs),xn=Gs(!1),Ii=zs;function Ao(t,e){var n=t.type.contextTypes;if(!n)return zs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function _n(t){return t=t.childContextTypes,t!=null}function tu(){at(xn),at(rn)}function Zm(t,e,n){if(rn.current!==zs)throw Error(X(168));nt(rn,e),nt(xn,n)}function x0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(X(108,A1(t)||"Unknown",s));return ht({},n,r)}function nu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zs,Ii=rn.current,nt(rn,t),nt(xn,xn.current),!0}function eg(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=x0(t,e,Ii),r.__reactInternalMemoizedMergedChildContext=t,at(xn),at(rn),nt(rn,t)):at(xn),nt(xn,n)}var Fr=null,Wu=!1,Od=!1;function _0(t){Fr===null?Fr=[t]:Fr.push(t)}function GE(t){Wu=!0,_0(t)}function qs(){if(!Od&&Fr!==null){Od=!0;var t=0,e=$e;try{var n=Fr;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fr=null,Wu=!1}catch(s){throw Fr!==null&&(Fr=Fr.slice(t+1)),Hv(Ff,qs),s}finally{$e=e,Od=!1}}return null}var uo=[],ho=0,ru=null,su=0,zn=[],Un=0,Ti=null,zr=1,Ur="";function hi(t,e){uo[ho++]=su,uo[ho++]=ru,ru=t,su=e}function w0(t,e,n){zn[Un++]=zr,zn[Un++]=Ur,zn[Un++]=Ti,Ti=t;var r=zr;t=Ur;var s=32-lr(r)-1;r&=~(1<<s),n+=1;var i=32-lr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,zr=1<<32-lr(e)+s|n<<s|r,Ur=i+t}else zr=1<<i|n<<s|r,Ur=t}function Kf(t){t.return!==null&&(hi(t,1),w0(t,1,0))}function Qf(t){for(;t===ru;)ru=uo[--ho],uo[ho]=null,su=uo[--ho],uo[ho]=null;for(;t===Ti;)Ti=zn[--Un],zn[Un]=null,Ur=zn[--Un],zn[Un]=null,zr=zn[--Un],zn[Un]=null}var Nn=null,Sn=null,ct=!1,or=null;function E0(t,e){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,Sn=Cs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,Sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ti!==null?{id:zr,overflow:Ur}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nn=t,Sn=null,!0):!1;default:return!1}}function Rh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Dh(t){if(ct){var e=Sn;if(e){var n=e;if(!tg(t,e)){if(Rh(t))throw Error(X(418));e=Cs(n.nextSibling);var r=Nn;e&&tg(t,e)?E0(r,n):(t.flags=t.flags&-4097|2,ct=!1,Nn=t)}}else{if(Rh(t))throw Error(X(418));t.flags=t.flags&-4097|2,ct=!1,Nn=t}}}function ng(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function hc(t){if(t!==Nn)return!1;if(!ct)return ng(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ah(t.type,t.memoizedProps)),e&&(e=Sn)){if(Rh(t))throw b0(),Error(X(418));for(;e;)E0(t,e),e=Cs(e.nextSibling)}if(ng(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sn=Cs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sn=null}}else Sn=Nn?Cs(t.stateNode.nextSibling):null;return!0}function b0(){for(var t=Sn;t;)t=Cs(t.nextSibling)}function Co(){Sn=Nn=null,ct=!1}function Yf(t){or===null?or=[t]:or.push(t)}var qE=rs.ReactCurrentBatchConfig;function va(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function fc(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function rg(t){var e=t._init;return e(t._payload)}function k0(t){function e(A,I){if(t){var N=A.deletions;N===null?(A.deletions=[I],A.flags|=16):N.push(I)}}function n(A,I){if(!t)return null;for(;I!==null;)e(A,I),I=I.sibling;return null}function r(A,I){for(A=new Map;I!==null;)I.key!==null?A.set(I.key,I):A.set(I.index,I),I=I.sibling;return A}function s(A,I){return A=Ds(A,I),A.index=0,A.sibling=null,A}function i(A,I,N){return A.index=N,t?(N=A.alternate,N!==null?(N=N.index,N<I?(A.flags|=2,I):N):(A.flags|=2,I)):(A.flags|=1048576,I)}function o(A){return t&&A.alternate===null&&(A.flags|=2),A}function c(A,I,N,M){return I===null||I.tag!==6?(I=Wd(N,A.mode,M),I.return=A,I):(I=s(I,N),I.return=A,I)}function u(A,I,N,M){var z=N.type;return z===so?m(A,I,N.props.children,M,N.key):I!==null&&(I.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ms&&rg(z)===I.type)?(M=s(I,N.props),M.ref=va(A,I,N),M.return=A,M):(M=Lc(N.type,N.key,N.props,null,A.mode,M),M.ref=va(A,I,N),M.return=A,M)}function h(A,I,N,M){return I===null||I.tag!==4||I.stateNode.containerInfo!==N.containerInfo||I.stateNode.implementation!==N.implementation?(I=Hd(N,A.mode,M),I.return=A,I):(I=s(I,N.children||[]),I.return=A,I)}function m(A,I,N,M,z){return I===null||I.tag!==7?(I=wi(N,A.mode,M,z),I.return=A,I):(I=s(I,N),I.return=A,I)}function g(A,I,N){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Wd(""+I,A.mode,N),I.return=A,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case nc:return N=Lc(I.type,I.key,I.props,null,A.mode,N),N.ref=va(A,null,I),N.return=A,N;case ro:return I=Hd(I,A.mode,N),I.return=A,I;case ms:var M=I._init;return g(A,M(I._payload),N)}if(ba(I)||fa(I))return I=wi(I,A.mode,N,null),I.return=A,I;fc(A,I)}return null}function y(A,I,N,M){var z=I!==null?I.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return z!==null?null:c(A,I,""+N,M);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case nc:return N.key===z?u(A,I,N,M):null;case ro:return N.key===z?h(A,I,N,M):null;case ms:return z=N._init,y(A,I,z(N._payload),M)}if(ba(N)||fa(N))return z!==null?null:m(A,I,N,M,null);fc(A,N)}return null}function k(A,I,N,M,z){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(N)||null,c(I,A,""+M,z);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case nc:return A=A.get(M.key===null?N:M.key)||null,u(I,A,M,z);case ro:return A=A.get(M.key===null?N:M.key)||null,h(I,A,M,z);case ms:var G=M._init;return k(A,I,N,G(M._payload),z)}if(ba(M)||fa(M))return A=A.get(N)||null,m(I,A,M,z,null);fc(I,M)}return null}function C(A,I,N,M){for(var z=null,G=null,x=I,_=I=0,E=null;x!==null&&_<N.length;_++){x.index>_?(E=x,x=null):E=x.sibling;var T=y(A,x,N[_],M);if(T===null){x===null&&(x=E);break}t&&x&&T.alternate===null&&e(A,x),I=i(T,I,_),G===null?z=T:G.sibling=T,G=T,x=E}if(_===N.length)return n(A,x),ct&&hi(A,_),z;if(x===null){for(;_<N.length;_++)x=g(A,N[_],M),x!==null&&(I=i(x,I,_),G===null?z=x:G.sibling=x,G=x);return ct&&hi(A,_),z}for(x=r(A,x);_<N.length;_++)E=k(x,A,_,N[_],M),E!==null&&(t&&E.alternate!==null&&x.delete(E.key===null?_:E.key),I=i(E,I,_),G===null?z=E:G.sibling=E,G=E);return t&&x.forEach(function(j){return e(A,j)}),ct&&hi(A,_),z}function R(A,I,N,M){var z=fa(N);if(typeof z!="function")throw Error(X(150));if(N=z.call(N),N==null)throw Error(X(151));for(var G=z=null,x=I,_=I=0,E=null,T=N.next();x!==null&&!T.done;_++,T=N.next()){x.index>_?(E=x,x=null):E=x.sibling;var j=y(A,x,T.value,M);if(j===null){x===null&&(x=E);break}t&&x&&j.alternate===null&&e(A,x),I=i(j,I,_),G===null?z=j:G.sibling=j,G=j,x=E}if(T.done)return n(A,x),ct&&hi(A,_),z;if(x===null){for(;!T.done;_++,T=N.next())T=g(A,T.value,M),T!==null&&(I=i(T,I,_),G===null?z=T:G.sibling=T,G=T);return ct&&hi(A,_),z}for(x=r(A,x);!T.done;_++,T=N.next())T=k(x,A,_,T.value,M),T!==null&&(t&&T.alternate!==null&&x.delete(T.key===null?_:T.key),I=i(T,I,_),G===null?z=T:G.sibling=T,G=T);return t&&x.forEach(function(L){return e(A,L)}),ct&&hi(A,_),z}function D(A,I,N,M){if(typeof N=="object"&&N!==null&&N.type===so&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case nc:e:{for(var z=N.key,G=I;G!==null;){if(G.key===z){if(z=N.type,z===so){if(G.tag===7){n(A,G.sibling),I=s(G,N.props.children),I.return=A,A=I;break e}}else if(G.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ms&&rg(z)===G.type){n(A,G.sibling),I=s(G,N.props),I.ref=va(A,G,N),I.return=A,A=I;break e}n(A,G);break}else e(A,G);G=G.sibling}N.type===so?(I=wi(N.props.children,A.mode,M,N.key),I.return=A,A=I):(M=Lc(N.type,N.key,N.props,null,A.mode,M),M.ref=va(A,I,N),M.return=A,A=M)}return o(A);case ro:e:{for(G=N.key;I!==null;){if(I.key===G)if(I.tag===4&&I.stateNode.containerInfo===N.containerInfo&&I.stateNode.implementation===N.implementation){n(A,I.sibling),I=s(I,N.children||[]),I.return=A,A=I;break e}else{n(A,I);break}else e(A,I);I=I.sibling}I=Hd(N,A.mode,M),I.return=A,A=I}return o(A);case ms:return G=N._init,D(A,I,G(N._payload),M)}if(ba(N))return C(A,I,N,M);if(fa(N))return R(A,I,N,M);fc(A,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,I!==null&&I.tag===6?(n(A,I.sibling),I=s(I,N),I.return=A,A=I):(n(A,I),I=Wd(N,A.mode,M),I.return=A,A=I),o(A)):n(A,I)}return D}var Po=k0(!0),I0=k0(!1),iu=Gs(null),ou=null,fo=null,Xf=null;function Jf(){Xf=fo=ou=null}function Zf(t){var e=iu.current;at(iu),t._currentValue=e}function Mh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function wo(t,e){ou=t,Xf=fo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vn=!0),t.firstContext=null)}function Hn(t){var e=t._currentValue;if(Xf!==t)if(t={context:t,memoizedValue:e,next:null},fo===null){if(ou===null)throw Error(X(308));fo=t,ou.dependencies={lanes:0,firstContext:t}}else fo=fo.next=t;return e}var yi=null;function ep(t){yi===null?yi=[t]:yi.push(t)}function T0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,ep(e)):(n.next=s.next,s.next=n),e.interleaved=n,Qr(t,r)}function Qr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gs=!1;function tp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function S0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ps(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Qr(t,n)}return s=r.interleaved,s===null?(e.next=e,ep(r)):(e.next=s.next,s.next=e),r.interleaved=e,Qr(t,n)}function Cc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zf(t,n)}}function sg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function au(t,e,n,r){var s=t.updateQueue;gs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,h=u.next;u.next=null,o===null?i=h:o.next=h,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=h:c.next=h,m.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,m=h=u=null,c=i;do{var y=c.lane,k=c.eventTime;if((r&y)===y){m!==null&&(m=m.next={eventTime:k,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var C=t,R=c;switch(y=e,k=n,R.tag){case 1:if(C=R.payload,typeof C=="function"){g=C.call(k,g,y);break e}g=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=R.payload,y=typeof C=="function"?C.call(k,g,y):C,y==null)break e;g=ht({},g,y);break e;case 2:gs=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[c]:y.push(c))}else k={eventTime:k,lane:y,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(h=m=k,u=g):m=m.next=k,o|=y;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;y=c,c=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(m===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ni|=o,t.lanes=o,t.memoizedState=g}}function ig(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(X(191,s));s.call(r)}}}var kl={},Ir=Gs(kl),rl=Gs(kl),sl=Gs(kl);function vi(t){if(t===kl)throw Error(X(174));return t}function np(t,e){switch(nt(sl,e),nt(rl,t),nt(Ir,kl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=mh(e,t)}at(Ir),nt(Ir,e)}function jo(){at(Ir),at(rl),at(sl)}function N0(t){vi(sl.current);var e=vi(Ir.current),n=mh(e,t.type);e!==n&&(nt(rl,t),nt(Ir,n))}function rp(t){rl.current===t&&(at(Ir),at(rl))}var ut=Gs(0);function lu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vd=[];function sp(){for(var t=0;t<Vd.length;t++)Vd[t]._workInProgressVersionPrimary=null;Vd.length=0}var Pc=rs.ReactCurrentDispatcher,Fd=rs.ReactCurrentBatchConfig,Si=0,dt=null,St=null,Rt=null,cu=!1,Oa=!1,il=0,KE=0;function Yt(){throw Error(X(321))}function ip(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function op(t,e,n,r,s,i){if(Si=i,dt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pc.current=t===null||t.memoizedState===null?JE:ZE,t=n(r,s),Oa){i=0;do{if(Oa=!1,il=0,25<=i)throw Error(X(301));i+=1,Rt=St=null,e.updateQueue=null,Pc.current=eb,t=n(r,s)}while(Oa)}if(Pc.current=uu,e=St!==null&&St.next!==null,Si=0,Rt=St=dt=null,cu=!1,e)throw Error(X(300));return t}function ap(){var t=il!==0;return il=0,t}function vr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?dt.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function Gn(){if(St===null){var t=dt.alternate;t=t!==null?t.memoizedState:null}else t=St.next;var e=Rt===null?dt.memoizedState:Rt.next;if(e!==null)Rt=e,St=t;else{if(t===null)throw Error(X(310));St=t,t={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Rt===null?dt.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function ol(t,e){return typeof e=="function"?e(t):e}function zd(t){var e=Gn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=St,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,h=i;do{var m=h.lane;if((Si&m)===m)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,dt.lanes|=m,Ni|=m}h=h.next}while(h!==null&&h!==i);u===null?o=r:u.next=c,ur(r,e.memoizedState)||(vn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,dt.lanes|=i,Ni|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ud(t){var e=Gn(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ur(i,e.memoizedState)||(vn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function A0(){}function C0(t,e){var n=dt,r=Gn(),s=e(),i=!ur(r.memoizedState,s);if(i&&(r.memoizedState=s,vn=!0),r=r.queue,lp(R0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,al(9,j0.bind(null,n,r,s,e),void 0,null),Dt===null)throw Error(X(349));Si&30||P0(n,e,s)}return s}function P0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=dt.updateQueue,e===null?(e={lastEffect:null,stores:null},dt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function j0(t,e,n,r){e.value=n,e.getSnapshot=r,D0(e)&&M0(t)}function R0(t,e,n){return n(function(){D0(e)&&M0(t)})}function D0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function M0(t){var e=Qr(t,1);e!==null&&cr(e,t,1,-1)}function og(t){var e=vr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:t},e.queue=t,t=t.dispatch=XE.bind(null,dt,t),[e.memoizedState,t]}function al(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=dt.updateQueue,e===null?(e={lastEffect:null,stores:null},dt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function L0(){return Gn().memoizedState}function jc(t,e,n,r){var s=vr();dt.flags|=t,s.memoizedState=al(1|e,n,void 0,r===void 0?null:r)}function Hu(t,e,n,r){var s=Gn();r=r===void 0?null:r;var i=void 0;if(St!==null){var o=St.memoizedState;if(i=o.destroy,r!==null&&ip(r,o.deps)){s.memoizedState=al(e,n,i,r);return}}dt.flags|=t,s.memoizedState=al(1|e,n,i,r)}function ag(t,e){return jc(8390656,8,t,e)}function lp(t,e){return Hu(2048,8,t,e)}function O0(t,e){return Hu(4,2,t,e)}function V0(t,e){return Hu(4,4,t,e)}function F0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function z0(t,e,n){return n=n!=null?n.concat([t]):null,Hu(4,4,F0.bind(null,e,t),n)}function cp(){}function U0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ip(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $0(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ip(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function B0(t,e,n){return Si&21?(ur(n,e)||(n=Kv(),dt.lanes|=n,Ni|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vn=!0),t.memoizedState=n)}function QE(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=Fd.transition;Fd.transition={};try{t(!1),e()}finally{$e=n,Fd.transition=r}}function W0(){return Gn().memoizedState}function YE(t,e,n){var r=Rs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},H0(t))G0(e,n);else if(n=T0(t,e,n,r),n!==null){var s=un();cr(n,t,r,s),q0(n,e,r)}}function XE(t,e,n){var r=Rs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(H0(t))G0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,ur(c,o)){var u=e.interleaved;u===null?(s.next=s,ep(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=T0(t,e,s,r),n!==null&&(s=un(),cr(n,t,r,s),q0(n,e,r))}}function H0(t){var e=t.alternate;return t===dt||e!==null&&e===dt}function G0(t,e){Oa=cu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function q0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zf(t,n)}}var uu={readContext:Hn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},JE={readContext:Hn,useCallback:function(t,e){return vr().memoizedState=[t,e===void 0?null:e],t},useContext:Hn,useEffect:ag,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,jc(4194308,4,F0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jc(4194308,4,t,e)},useInsertionEffect:function(t,e){return jc(4,2,t,e)},useMemo:function(t,e){var n=vr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=vr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=YE.bind(null,dt,t),[r.memoizedState,t]},useRef:function(t){var e=vr();return t={current:t},e.memoizedState=t},useState:og,useDebugValue:cp,useDeferredValue:function(t){return vr().memoizedState=t},useTransition:function(){var t=og(!1),e=t[0];return t=QE.bind(null,t[1]),vr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=dt,s=vr();if(ct){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),Dt===null)throw Error(X(349));Si&30||P0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ag(R0.bind(null,r,i,t),[t]),r.flags|=2048,al(9,j0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=vr(),e=Dt.identifierPrefix;if(ct){var n=Ur,r=zr;n=(r&~(1<<32-lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=il++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=KE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZE={readContext:Hn,useCallback:U0,useContext:Hn,useEffect:lp,useImperativeHandle:z0,useInsertionEffect:O0,useLayoutEffect:V0,useMemo:$0,useReducer:zd,useRef:L0,useState:function(){return zd(ol)},useDebugValue:cp,useDeferredValue:function(t){var e=Gn();return B0(e,St.memoizedState,t)},useTransition:function(){var t=zd(ol)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:C0,useId:W0,unstable_isNewReconciler:!1},eb={readContext:Hn,useCallback:U0,useContext:Hn,useEffect:lp,useImperativeHandle:z0,useInsertionEffect:O0,useLayoutEffect:V0,useMemo:$0,useReducer:Ud,useRef:L0,useState:function(){return Ud(ol)},useDebugValue:cp,useDeferredValue:function(t){var e=Gn();return St===null?e.memoizedState=t:B0(e,St.memoizedState,t)},useTransition:function(){var t=Ud(ol)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:A0,useSyncExternalStore:C0,useId:W0,unstable_isNewReconciler:!1};function sr(t,e){if(t&&t.defaultProps){e=ht({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Lh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ht({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gu={isMounted:function(t){return(t=t._reactInternals)?Li(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=un(),s=Rs(t),i=Hr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ps(t,i,s),e!==null&&(cr(e,t,s,r),Cc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=un(),s=Rs(t),i=Hr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ps(t,i,s),e!==null&&(cr(e,t,s,r),Cc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=un(),r=Rs(t),s=Hr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ps(t,s,r),e!==null&&(cr(e,t,r,n),Cc(e,t,r))}};function lg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Za(n,r)||!Za(s,i):!0}function K0(t,e,n){var r=!1,s=zs,i=e.contextType;return typeof i=="object"&&i!==null?i=Hn(i):(s=_n(e)?Ii:rn.current,r=e.contextTypes,i=(r=r!=null)?Ao(t,s):zs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function cg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gu.enqueueReplaceState(e,e.state,null)}function Oh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},tp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Hn(i):(i=_n(e)?Ii:rn.current,s.context=Ao(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Lh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Gu.enqueueReplaceState(s,s.state,null),au(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ro(t,e){try{var n="",r=e;do n+=N1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function $d(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tb=typeof WeakMap=="function"?WeakMap:Map;function Q0(t,e,n){n=Hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){hu||(hu=!0,Kh=r),Vh(t,e)},n}function Y0(t,e,n){n=Hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Vh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Vh(t,e),typeof r!="function"&&(js===null?js=new Set([this]):js.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ug(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=mb.bind(null,t,e,n),e.then(t,t))}function dg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function hg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hr(-1,1),e.tag=2,Ps(n,e,1))),n.lanes|=1),t)}var nb=rs.ReactCurrentOwner,vn=!1;function cn(t,e,n,r){e.child=t===null?I0(e,null,n,r):Po(e,t.child,n,r)}function fg(t,e,n,r,s){n=n.render;var i=e.ref;return wo(e,s),r=op(t,e,n,r,i,s),n=ap(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(ct&&n&&Kf(e),e.flags|=1,cn(t,e,r,s),e.child)}function pg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!yp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,X0(t,e,i,r,s)):(t=Lc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Za,n(o,r)&&t.ref===e.ref)return Yr(t,e,s)}return e.flags|=1,t=Ds(i,r),t.ref=e.ref,t.return=e,e.child=t}function X0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Za(i,r)&&t.ref===e.ref)if(vn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(vn=!0);else return e.lanes=t.lanes,Yr(t,e,s)}return Fh(t,e,n,r,s)}function J0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(mo,Tn),Tn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nt(mo,Tn),Tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,nt(mo,Tn),Tn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,nt(mo,Tn),Tn|=r;return cn(t,e,s,n),e.child}function Z0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Fh(t,e,n,r,s){var i=_n(n)?Ii:rn.current;return i=Ao(e,i),wo(e,s),n=op(t,e,n,r,i,s),r=ap(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(ct&&r&&Kf(e),e.flags|=1,cn(t,e,n,s),e.child)}function mg(t,e,n,r,s){if(_n(n)){var i=!0;nu(e)}else i=!1;if(wo(e,s),e.stateNode===null)Rc(t,e),K0(e,n,r),Oh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Hn(h):(h=_n(n)?Ii:rn.current,h=Ao(e,h));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==h)&&cg(e,o,r,h),gs=!1;var y=e.memoizedState;o.state=y,au(e,r,o,s),u=e.memoizedState,c!==r||y!==u||xn.current||gs?(typeof m=="function"&&(Lh(e,n,m,r),u=e.memoizedState),(c=gs||lg(e,n,c,r,y,u,h))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,S0(t,e),c=e.memoizedProps,h=e.type===e.elementType?c:sr(e.type,c),o.props=h,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Hn(u):(u=_n(n)?Ii:rn.current,u=Ao(e,u));var k=n.getDerivedStateFromProps;(m=typeof k=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||y!==u)&&cg(e,o,r,u),gs=!1,y=e.memoizedState,o.state=y,au(e,r,o,s);var C=e.memoizedState;c!==g||y!==C||xn.current||gs?(typeof k=="function"&&(Lh(e,n,k,r),C=e.memoizedState),(h=gs||lg(e,n,h,r,y,C,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return zh(t,e,n,r,i,s)}function zh(t,e,n,r,s,i){Z0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&eg(e,n,!1),Yr(t,e,i);r=e.stateNode,nb.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Po(e,t.child,null,i),e.child=Po(e,null,c,i)):cn(t,e,c,i),e.memoizedState=r.state,s&&eg(e,n,!0),e.child}function ex(t){var e=t.stateNode;e.pendingContext?Zm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zm(t,e.context,!1),np(t,e.containerInfo)}function gg(t,e,n,r,s){return Co(),Yf(s),e.flags|=256,cn(t,e,n,r),e.child}var Uh={dehydrated:null,treeContext:null,retryLane:0};function $h(t){return{baseLanes:t,cachePool:null,transitions:null}}function tx(t,e,n){var r=e.pendingProps,s=ut.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),nt(ut,s&1),t===null)return Dh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qu(o,r,0,null),t=wi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=$h(n),e.memoizedState=Uh,t):up(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return rb(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ds(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Ds(c,i):(i=wi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?$h(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Uh,r}return i=t.child,t=i.sibling,r=Ds(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function up(t,e){return e=Qu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function pc(t,e,n,r){return r!==null&&Yf(r),Po(e,t.child,null,n),t=up(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=$d(Error(X(422))),pc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Qu({mode:"visible",children:r.children},s,0,null),i=wi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Po(e,t.child,null,o),e.child.memoizedState=$h(o),e.memoizedState=Uh,i);if(!(e.mode&1))return pc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(X(419)),r=$d(i,r,void 0),pc(t,e,o,r)}if(c=(o&t.childLanes)!==0,vn||c){if(r=Dt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Qr(t,s),cr(r,t,s,-1))}return gp(),r=$d(Error(X(421))),pc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=gb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Sn=Cs(s.nextSibling),Nn=e,ct=!0,or=null,t!==null&&(zn[Un++]=zr,zn[Un++]=Ur,zn[Un++]=Ti,zr=t.id,Ur=t.overflow,Ti=e),e=up(e,r.children),e.flags|=4096,e)}function yg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Mh(t.return,e,n)}function Bd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function nx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(cn(t,e,r.children,n),r=ut.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yg(t,n,e);else if(t.tag===19)yg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(nt(ut,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&lu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Bd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&lu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Bd(e,!0,n,null,i);break;case"together":Bd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ni|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=Ds(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ds(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sb(t,e,n){switch(e.tag){case 3:ex(e),Co();break;case 5:N0(e);break;case 1:_n(e.type)&&nu(e);break;case 4:np(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;nt(iu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(nt(ut,ut.current&1),e.flags|=128,null):n&e.child.childLanes?tx(t,e,n):(nt(ut,ut.current&1),t=Yr(t,e,n),t!==null?t.sibling:null);nt(ut,ut.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return nx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),nt(ut,ut.current),r)break;return null;case 22:case 23:return e.lanes=0,J0(t,e,n)}return Yr(t,e,n)}var rx,Bh,sx,ix;rx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Bh=function(){};sx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,vi(Ir.current);var i=null;switch(n){case"input":s=dh(t,s),r=dh(t,r),i=[];break;case"select":s=ht({},s,{value:void 0}),r=ht({},r,{value:void 0}),i=[];break;case"textarea":s=ph(t,s),r=ph(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=eu)}gh(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Ga.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==c&&(u!=null||c!=null))if(h==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Ga.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&it("scroll",t),i||c===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};ix=function(t,e,n,r){n!==r&&(e.flags|=4)};function xa(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ib(t,e,n){var r=e.pendingProps;switch(Qf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(e),null;case 1:return _n(e.type)&&tu(),Xt(e),null;case 3:return r=e.stateNode,jo(),at(xn),at(rn),sp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(Xh(or),or=null))),Bh(t,e),Xt(e),null;case 5:rp(e);var s=vi(sl.current);if(n=e.type,t!==null&&e.stateNode!=null)sx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Xt(e),null}if(t=vi(Ir.current),hc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[xr]=e,r[nl]=i,t=(e.mode&1)!==0,n){case"dialog":it("cancel",r),it("close",r);break;case"iframe":case"object":case"embed":it("load",r);break;case"video":case"audio":for(s=0;s<Ia.length;s++)it(Ia[s],r);break;case"source":it("error",r);break;case"img":case"image":case"link":it("error",r),it("load",r);break;case"details":it("toggle",r);break;case"input":Tm(r,i),it("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},it("invalid",r);break;case"textarea":Nm(r,i),it("invalid",r)}gh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&dc(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&dc(r.textContent,c,t),s=["children",""+c]):Ga.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&it("scroll",r)}switch(n){case"input":rc(r),Sm(r,i,!0);break;case"textarea":rc(r),Am(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=eu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Rv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xr]=e,t[nl]=r,rx(t,e,!1,!1),e.stateNode=t;e:{switch(o=yh(n,r),n){case"dialog":it("cancel",t),it("close",t),s=r;break;case"iframe":case"object":case"embed":it("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ia.length;s++)it(Ia[s],t);s=r;break;case"source":it("error",t),s=r;break;case"img":case"image":case"link":it("error",t),it("load",t),s=r;break;case"details":it("toggle",t),s=r;break;case"input":Tm(t,r),s=dh(t,r),it("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ht({},r,{value:void 0}),it("invalid",t);break;case"textarea":Nm(t,r),s=ph(t,r),it("invalid",t);break;default:s=r}gh(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Lv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Dv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&qa(t,u):typeof u=="number"&&qa(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ga.hasOwnProperty(i)?u!=null&&i==="onScroll"&&it("scroll",t):u!=null&&Df(t,i,u,o))}switch(n){case"input":rc(t),Sm(t,r,!1);break;case"textarea":rc(t),Am(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Fs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?yo(t,!!r.multiple,i,!1):r.defaultValue!=null&&yo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=eu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xt(e),null;case 6:if(t&&e.stateNode!=null)ix(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=vi(sl.current),vi(Ir.current),hc(e)){if(r=e.stateNode,n=e.memoizedProps,r[xr]=e,(i=r.nodeValue!==n)&&(t=Nn,t!==null))switch(t.tag){case 3:dc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=e,e.stateNode=r}return Xt(e),null;case 13:if(at(ut),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&Sn!==null&&e.mode&1&&!(e.flags&128))b0(),Co(),e.flags|=98560,i=!1;else if(i=hc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[xr]=e}else Co(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xt(e),i=!1}else or!==null&&(Xh(or),or=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ut.current&1?Nt===0&&(Nt=3):gp())),e.updateQueue!==null&&(e.flags|=4),Xt(e),null);case 4:return jo(),Bh(t,e),t===null&&el(e.stateNode.containerInfo),Xt(e),null;case 10:return Zf(e.type._context),Xt(e),null;case 17:return _n(e.type)&&tu(),Xt(e),null;case 19:if(at(ut),i=e.memoizedState,i===null)return Xt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)xa(i,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lu(t),o!==null){for(e.flags|=128,xa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return nt(ut,ut.current&1|2),e.child}t=t.sibling}i.tail!==null&&vt()>Do&&(e.flags|=128,r=!0,xa(i,!1),e.lanes=4194304)}else{if(!r)if(t=lu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ct)return Xt(e),null}else 2*vt()-i.renderingStartTime>Do&&n!==1073741824&&(e.flags|=128,r=!0,xa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=vt(),e.sibling=null,n=ut.current,nt(ut,r?n&1|2:n&1),e):(Xt(e),null);case 22:case 23:return mp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Tn&1073741824&&(Xt(e),e.subtreeFlags&6&&(e.flags|=8192)):Xt(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function ob(t,e){switch(Qf(e),e.tag){case 1:return _n(e.type)&&tu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jo(),at(xn),at(rn),sp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rp(e),null;case 13:if(at(ut),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Co()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return at(ut),null;case 4:return jo(),null;case 10:return Zf(e.type._context),null;case 22:case 23:return mp(),null;case 24:return null;default:return null}}var mc=!1,en=!1,ab=typeof WeakSet=="function"?WeakSet:Set,ie=null;function po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gt(t,e,r)}else n.current=null}function Wh(t,e,n){try{n()}catch(r){gt(t,e,r)}}var vg=!1;function lb(t,e){if(Sh=Xc,t=u0(),qf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,h=0,m=0,g=t,y=null;t:for(;;){for(var k;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(k=g.firstChild)!==null;)y=g,g=k;for(;;){if(g===t)break t;if(y===n&&++h===s&&(c=o),y===i&&++m===r&&(u=o),(k=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=k}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nh={focusedElem:t,selectionRange:n},Xc=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var R=C.memoizedProps,D=C.memoizedState,A=e.stateNode,I=A.getSnapshotBeforeUpdate(e.elementType===e.type?R:sr(e.type,R),D);A.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(M){gt(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return C=vg,vg=!1,C}function Va(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Wh(e,n,i)}s=s.next}while(s!==r)}}function qu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ox(t){var e=t.alternate;e!==null&&(t.alternate=null,ox(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xr],delete e[nl],delete e[Ph],delete e[WE],delete e[HE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ax(t){return t.tag===5||t.tag===3||t.tag===4}function xg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ax(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eu));else if(r!==4&&(t=t.child,t!==null))for(Gh(t,e,n),t=t.sibling;t!==null;)Gh(t,e,n),t=t.sibling}function qh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qh(t,e,n),t=t.sibling;t!==null;)qh(t,e,n),t=t.sibling}var Ot=null,ir=!1;function fs(t,e,n){for(n=n.child;n!==null;)lx(t,e,n),n=n.sibling}function lx(t,e,n){if(kr&&typeof kr.onCommitFiberUnmount=="function")try{kr.onCommitFiberUnmount(Fu,n)}catch{}switch(n.tag){case 5:en||po(n,e);case 6:var r=Ot,s=ir;Ot=null,fs(t,e,n),Ot=r,ir=s,Ot!==null&&(ir?(t=Ot,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ot.removeChild(n.stateNode));break;case 18:Ot!==null&&(ir?(t=Ot,n=n.stateNode,t.nodeType===8?Ld(t.parentNode,n):t.nodeType===1&&Ld(t,n),Xa(t)):Ld(Ot,n.stateNode));break;case 4:r=Ot,s=ir,Ot=n.stateNode.containerInfo,ir=!0,fs(t,e,n),Ot=r,ir=s;break;case 0:case 11:case 14:case 15:if(!en&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Wh(n,e,o),s=s.next}while(s!==r)}fs(t,e,n);break;case 1:if(!en&&(po(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){gt(n,e,c)}fs(t,e,n);break;case 21:fs(t,e,n);break;case 22:n.mode&1?(en=(r=en)||n.memoizedState!==null,fs(t,e,n),en=r):fs(t,e,n);break;default:fs(t,e,n)}}function _g(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ab),e.forEach(function(r){var s=yb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ot=c.stateNode,ir=!1;break e;case 3:Ot=c.stateNode.containerInfo,ir=!0;break e;case 4:Ot=c.stateNode.containerInfo,ir=!0;break e}c=c.return}if(Ot===null)throw Error(X(160));lx(i,o,s),Ot=null,ir=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){gt(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cx(e,t),e=e.sibling}function cx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),yr(t),r&4){try{Va(3,t,t.return),qu(3,t)}catch(R){gt(t,t.return,R)}try{Va(5,t,t.return)}catch(R){gt(t,t.return,R)}}break;case 1:rr(e,t),yr(t),r&512&&n!==null&&po(n,n.return);break;case 5:if(rr(e,t),yr(t),r&512&&n!==null&&po(n,n.return),t.flags&32){var s=t.stateNode;try{qa(s,"")}catch(R){gt(t,t.return,R)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Pv(s,i),yh(c,o);var h=yh(c,i);for(o=0;o<u.length;o+=2){var m=u[o],g=u[o+1];m==="style"?Lv(s,g):m==="dangerouslySetInnerHTML"?Dv(s,g):m==="children"?qa(s,g):Df(s,m,g,h)}switch(c){case"input":hh(s,i);break;case"textarea":jv(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var k=i.value;k!=null?yo(s,!!i.multiple,k,!1):y!==!!i.multiple&&(i.defaultValue!=null?yo(s,!!i.multiple,i.defaultValue,!0):yo(s,!!i.multiple,i.multiple?[]:"",!1))}s[nl]=i}catch(R){gt(t,t.return,R)}}break;case 6:if(rr(e,t),yr(t),r&4){if(t.stateNode===null)throw Error(X(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(R){gt(t,t.return,R)}}break;case 3:if(rr(e,t),yr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Xa(e.containerInfo)}catch(R){gt(t,t.return,R)}break;case 4:rr(e,t),yr(t);break;case 13:rr(e,t),yr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(fp=vt())),r&4&&_g(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(en=(h=en)||m,rr(e,t),en=h):rr(e,t),yr(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!m&&t.mode&1)for(ie=t,m=t.child;m!==null;){for(g=ie=m;ie!==null;){switch(y=ie,k=y.child,y.tag){case 0:case 11:case 14:case 15:Va(4,y,y.return);break;case 1:po(y,y.return);var C=y.stateNode;if(typeof C.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(R){gt(r,n,R)}}break;case 5:po(y,y.return);break;case 22:if(y.memoizedState!==null){Eg(g);continue}}k!==null?(k.return=y,ie=k):Eg(g)}m=m.sibling}e:for(m=null,g=t;;){if(g.tag===5){if(m===null){m=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Mv("display",o))}catch(R){gt(t,t.return,R)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(R){gt(t,t.return,R)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:rr(e,t),yr(t),r&4&&_g(t);break;case 21:break;default:rr(e,t),yr(t)}}function yr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ax(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(qa(s,""),r.flags&=-33);var i=xg(t);qh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=xg(t);Gh(t,c,o);break;default:throw Error(X(161))}}catch(u){gt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cb(t,e,n){ie=t,ux(t)}function ux(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||mc;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||en;c=mc;var h=en;if(mc=o,(en=u)&&!h)for(ie=s;ie!==null;)o=ie,u=o.child,o.tag===22&&o.memoizedState!==null?bg(s):u!==null?(u.return=o,ie=u):bg(s);for(;i!==null;)ie=i,ux(i),i=i.sibling;ie=s,mc=c,en=h}wg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ie=i):wg(t)}}function wg(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:en||qu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!en)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:sr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ig(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ig(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&Xa(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}en||e.flags&512&&Hh(e)}catch(y){gt(e,e.return,y)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Eg(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function bg(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qu(4,e)}catch(u){gt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){gt(e,s,u)}}var i=e.return;try{Hh(e)}catch(u){gt(e,i,u)}break;case 5:var o=e.return;try{Hh(e)}catch(u){gt(e,o,u)}}}catch(u){gt(e,e.return,u)}if(e===t){ie=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ie=c;break}ie=e.return}}var ub=Math.ceil,du=rs.ReactCurrentDispatcher,dp=rs.ReactCurrentOwner,Wn=rs.ReactCurrentBatchConfig,Re=0,Dt=null,bt=null,Ut=0,Tn=0,mo=Gs(0),Nt=0,ll=null,Ni=0,Ku=0,hp=0,Fa=null,yn=null,fp=0,Do=1/0,Vr=null,hu=!1,Kh=null,js=null,gc=!1,Is=null,fu=0,za=0,Qh=null,Dc=-1,Mc=0;function un(){return Re&6?vt():Dc!==-1?Dc:Dc=vt()}function Rs(t){return t.mode&1?Re&2&&Ut!==0?Ut&-Ut:qE.transition!==null?(Mc===0&&(Mc=Kv()),Mc):(t=$e,t!==0||(t=window.event,t=t===void 0?16:t0(t.type)),t):1}function cr(t,e,n,r){if(50<za)throw za=0,Qh=null,Error(X(185));wl(t,n,r),(!(Re&2)||t!==Dt)&&(t===Dt&&(!(Re&2)&&(Ku|=n),Nt===4&&vs(t,Ut)),wn(t,r),n===1&&Re===0&&!(e.mode&1)&&(Do=vt()+500,Wu&&qs()))}function wn(t,e){var n=t.callbackNode;q1(t,e);var r=Yc(t,t===Dt?Ut:0);if(r===0)n!==null&&jm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jm(n),e===1)t.tag===0?GE(kg.bind(null,t)):_0(kg.bind(null,t)),$E(function(){!(Re&6)&&qs()}),n=null;else{switch(Qv(r)){case 1:n=Ff;break;case 4:n=Gv;break;case 16:n=Qc;break;case 536870912:n=qv;break;default:n=Qc}n=vx(n,dx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dx(t,e){if(Dc=-1,Mc=0,Re&6)throw Error(X(327));var n=t.callbackNode;if(Eo()&&t.callbackNode!==n)return null;var r=Yc(t,t===Dt?Ut:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=pu(t,r);else{e=r;var s=Re;Re|=2;var i=fx();(Dt!==t||Ut!==e)&&(Vr=null,Do=vt()+500,_i(t,e));do try{fb();break}catch(c){hx(t,c)}while(!0);Jf(),du.current=i,Re=s,bt!==null?e=0:(Dt=null,Ut=0,e=Nt)}if(e!==0){if(e===2&&(s=Eh(t),s!==0&&(r=s,e=Yh(t,s))),e===1)throw n=ll,_i(t,0),vs(t,r),wn(t,vt()),n;if(e===6)vs(t,r);else{if(s=t.current.alternate,!(r&30)&&!db(s)&&(e=pu(t,r),e===2&&(i=Eh(t),i!==0&&(r=i,e=Yh(t,i))),e===1))throw n=ll,_i(t,0),vs(t,r),wn(t,vt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:fi(t,yn,Vr);break;case 3:if(vs(t,r),(r&130023424)===r&&(e=fp+500-vt(),10<e)){if(Yc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){un(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ch(fi.bind(null,t,yn,Vr),e);break}fi(t,yn,Vr);break;case 4:if(vs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-lr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ub(r/1960))-r,10<r){t.timeoutHandle=Ch(fi.bind(null,t,yn,Vr),r);break}fi(t,yn,Vr);break;case 5:fi(t,yn,Vr);break;default:throw Error(X(329))}}}return wn(t,vt()),t.callbackNode===n?dx.bind(null,t):null}function Yh(t,e){var n=Fa;return t.current.memoizedState.isDehydrated&&(_i(t,e).flags|=256),t=pu(t,e),t!==2&&(e=yn,yn=n,e!==null&&Xh(e)),t}function Xh(t){yn===null?yn=t:yn.push.apply(yn,t)}function db(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ur(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vs(t,e){for(e&=~hp,e&=~Ku,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lr(e),r=1<<n;t[n]=-1,e&=~r}}function kg(t){if(Re&6)throw Error(X(327));Eo();var e=Yc(t,0);if(!(e&1))return wn(t,vt()),null;var n=pu(t,e);if(t.tag!==0&&n===2){var r=Eh(t);r!==0&&(e=r,n=Yh(t,r))}if(n===1)throw n=ll,_i(t,0),vs(t,e),wn(t,vt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fi(t,yn,Vr),wn(t,vt()),null}function pp(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(Do=vt()+500,Wu&&qs())}}function Ai(t){Is!==null&&Is.tag===0&&!(Re&6)&&Eo();var e=Re;Re|=1;var n=Wn.transition,r=$e;try{if(Wn.transition=null,$e=1,t)return t()}finally{$e=r,Wn.transition=n,Re=e,!(Re&6)&&qs()}}function mp(){Tn=mo.current,at(mo)}function _i(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,UE(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(Qf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tu();break;case 3:jo(),at(xn),at(rn),sp();break;case 5:rp(r);break;case 4:jo();break;case 13:at(ut);break;case 19:at(ut);break;case 10:Zf(r.type._context);break;case 22:case 23:mp()}n=n.return}if(Dt=t,bt=t=Ds(t.current,null),Ut=Tn=e,Nt=0,ll=null,hp=Ku=Ni=0,yn=Fa=null,yi!==null){for(e=0;e<yi.length;e++)if(n=yi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}yi=null}return t}function hx(t,e){do{var n=bt;try{if(Jf(),Pc.current=uu,cu){for(var r=dt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cu=!1}if(Si=0,Rt=St=dt=null,Oa=!1,il=0,dp.current=null,n===null||n.return===null){Nt=1,ll=e,bt=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=Ut,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,m=c,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var k=dg(o);if(k!==null){k.flags&=-257,hg(k,o,c,i,e),k.mode&1&&ug(i,h,e),e=k,u=h;var C=e.updateQueue;if(C===null){var R=new Set;R.add(u),e.updateQueue=R}else C.add(u);break e}else{if(!(e&1)){ug(i,h,e),gp();break e}u=Error(X(426))}}else if(ct&&c.mode&1){var D=dg(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),hg(D,o,c,i,e),Yf(Ro(u,c));break e}}i=u=Ro(u,c),Nt!==4&&(Nt=2),Fa===null?Fa=[i]:Fa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=Q0(i,u,e);sg(i,A);break e;case 1:c=u;var I=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(js===null||!js.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var M=Y0(i,c,e);sg(i,M);break e}}i=i.return}while(i!==null)}mx(n)}catch(z){e=z,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function fx(){var t=du.current;return du.current=uu,t===null?uu:t}function gp(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),Dt===null||!(Ni&268435455)&&!(Ku&268435455)||vs(Dt,Ut)}function pu(t,e){var n=Re;Re|=2;var r=fx();(Dt!==t||Ut!==e)&&(Vr=null,_i(t,e));do try{hb();break}catch(s){hx(t,s)}while(!0);if(Jf(),Re=n,du.current=r,bt!==null)throw Error(X(261));return Dt=null,Ut=0,Nt}function hb(){for(;bt!==null;)px(bt)}function fb(){for(;bt!==null&&!V1();)px(bt)}function px(t){var e=yx(t.alternate,t,Tn);t.memoizedProps=t.pendingProps,e===null?mx(t):bt=e,dp.current=null}function mx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ob(n,e),n!==null){n.flags&=32767,bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,bt=null;return}}else if(n=ib(n,e,Tn),n!==null){bt=n;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=t}while(e!==null);Nt===0&&(Nt=5)}function fi(t,e,n){var r=$e,s=Wn.transition;try{Wn.transition=null,$e=1,pb(t,e,n,r)}finally{Wn.transition=s,$e=r}return null}function pb(t,e,n,r){do Eo();while(Is!==null);if(Re&6)throw Error(X(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(K1(t,i),t===Dt&&(bt=Dt=null,Ut=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gc||(gc=!0,vx(Qc,function(){return Eo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Wn.transition,Wn.transition=null;var o=$e;$e=1;var c=Re;Re|=4,dp.current=null,lb(t,n),cx(n,t),DE(Nh),Xc=!!Sh,Nh=Sh=null,t.current=n,cb(n),F1(),Re=c,$e=o,Wn.transition=i}else t.current=n;if(gc&&(gc=!1,Is=t,fu=s),i=t.pendingLanes,i===0&&(js=null),$1(n.stateNode),wn(t,vt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(hu)throw hu=!1,t=Kh,Kh=null,t;return fu&1&&t.tag!==0&&Eo(),i=t.pendingLanes,i&1?t===Qh?za++:(za=0,Qh=t):za=0,qs(),null}function Eo(){if(Is!==null){var t=Qv(fu),e=Wn.transition,n=$e;try{if(Wn.transition=null,$e=16>t?16:t,Is===null)var r=!1;else{if(t=Is,Is=null,fu=0,Re&6)throw Error(X(331));var s=Re;for(Re|=4,ie=t.current;ie!==null;){var i=ie,o=i.child;if(ie.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var h=c[u];for(ie=h;ie!==null;){var m=ie;switch(m.tag){case 0:case 11:case 15:Va(8,m,i)}var g=m.child;if(g!==null)g.return=m,ie=g;else for(;ie!==null;){m=ie;var y=m.sibling,k=m.return;if(ox(m),m===h){ie=null;break}if(y!==null){y.return=k,ie=y;break}ie=k}}}var C=i.alternate;if(C!==null){var R=C.child;if(R!==null){C.child=null;do{var D=R.sibling;R.sibling=null,R=D}while(R!==null)}}ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ie=o;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Va(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,ie=A;break e}ie=i.return}}var I=t.current;for(ie=I;ie!==null;){o=ie;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,ie=N;else e:for(o=I;ie!==null;){if(c=ie,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:qu(9,c)}}catch(z){gt(c,c.return,z)}if(c===o){ie=null;break e}var M=c.sibling;if(M!==null){M.return=c.return,ie=M;break e}ie=c.return}}if(Re=s,qs(),kr&&typeof kr.onPostCommitFiberRoot=="function")try{kr.onPostCommitFiberRoot(Fu,t)}catch{}r=!0}return r}finally{$e=n,Wn.transition=e}}return!1}function Ig(t,e,n){e=Ro(n,e),e=Q0(t,e,1),t=Ps(t,e,1),e=un(),t!==null&&(wl(t,1,e),wn(t,e))}function gt(t,e,n){if(t.tag===3)Ig(t,t,n);else for(;e!==null;){if(e.tag===3){Ig(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(js===null||!js.has(r))){t=Ro(n,t),t=Y0(e,t,1),e=Ps(e,t,1),t=un(),e!==null&&(wl(e,1,t),wn(e,t));break}}e=e.return}}function mb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=un(),t.pingedLanes|=t.suspendedLanes&n,Dt===t&&(Ut&n)===n&&(Nt===4||Nt===3&&(Ut&130023424)===Ut&&500>vt()-fp?_i(t,0):hp|=n),wn(t,e)}function gx(t,e){e===0&&(t.mode&1?(e=oc,oc<<=1,!(oc&130023424)&&(oc=4194304)):e=1);var n=un();t=Qr(t,e),t!==null&&(wl(t,e,n),wn(t,n))}function gb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gx(t,n)}function yb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),gx(t,n)}var yx;yx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xn.current)vn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vn=!1,sb(t,e,n);vn=!!(t.flags&131072)}else vn=!1,ct&&e.flags&1048576&&w0(e,su,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rc(t,e),t=e.pendingProps;var s=Ao(e,rn.current);wo(e,n),s=op(null,e,r,t,s,n);var i=ap();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_n(r)?(i=!0,nu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,tp(e),s.updater=Gu,e.stateNode=s,s._reactInternals=e,Oh(e,r,t,n),e=zh(null,e,r,!0,i,n)):(e.tag=0,ct&&i&&Kf(e),cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=xb(r),t=sr(r,t),s){case 0:e=Fh(null,e,r,t,n);break e;case 1:e=mg(null,e,r,t,n);break e;case 11:e=fg(null,e,r,t,n);break e;case 14:e=pg(null,e,r,sr(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sr(r,s),Fh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sr(r,s),mg(t,e,r,s,n);case 3:e:{if(ex(e),t===null)throw Error(X(387));r=e.pendingProps,i=e.memoizedState,s=i.element,S0(t,e),au(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ro(Error(X(423)),e),e=gg(t,e,r,n,s);break e}else if(r!==s){s=Ro(Error(X(424)),e),e=gg(t,e,r,n,s);break e}else for(Sn=Cs(e.stateNode.containerInfo.firstChild),Nn=e,ct=!0,or=null,n=I0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Co(),r===s){e=Yr(t,e,n);break e}cn(t,e,r,n)}e=e.child}return e;case 5:return N0(e),t===null&&Dh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ah(r,s)?o=null:i!==null&&Ah(r,i)&&(e.flags|=32),Z0(t,e),cn(t,e,o,n),e.child;case 6:return t===null&&Dh(e),null;case 13:return tx(t,e,n);case 4:return np(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Po(e,null,r,n):cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sr(r,s),fg(t,e,r,s,n);case 7:return cn(t,e,e.pendingProps,n),e.child;case 8:return cn(t,e,e.pendingProps.children,n),e.child;case 12:return cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,nt(iu,r._currentValue),r._currentValue=o,i!==null)if(ur(i.value,o)){if(i.children===s.children&&!xn.current){e=Yr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Hr(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?u.next=u:(u.next=m.next,m.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Mh(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Mh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,wo(e,n),s=Hn(s),r=r(s),e.flags|=1,cn(t,e,r,n),e.child;case 14:return r=e.type,s=sr(r,e.pendingProps),s=sr(r.type,s),pg(t,e,r,s,n);case 15:return X0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sr(r,s),Rc(t,e),e.tag=1,_n(r)?(t=!0,nu(e)):t=!1,wo(e,n),K0(e,r,s),Oh(e,r,s,n),zh(null,e,r,!0,t,n);case 19:return nx(t,e,n);case 22:return J0(t,e,n)}throw Error(X(156,e.tag))};function vx(t,e){return Hv(t,e)}function vb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(t,e,n,r){return new vb(t,e,n,r)}function yp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xb(t){if(typeof t=="function")return yp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Lf)return 11;if(t===Of)return 14}return 2}function Ds(t,e){var n=t.alternate;return n===null?(n=Bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Lc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")yp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case so:return wi(n.children,s,i,e);case Mf:o=8,s|=8;break;case ah:return t=Bn(12,n,e,s|2),t.elementType=ah,t.lanes=i,t;case lh:return t=Bn(13,n,e,s),t.elementType=lh,t.lanes=i,t;case ch:return t=Bn(19,n,e,s),t.elementType=ch,t.lanes=i,t;case Nv:return Qu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tv:o=10;break e;case Sv:o=9;break e;case Lf:o=11;break e;case Of:o=14;break e;case ms:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=Bn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function wi(t,e,n,r){return t=Bn(7,t,r,e),t.lanes=n,t}function Qu(t,e,n,r){return t=Bn(22,t,r,e),t.elementType=Nv,t.lanes=n,t.stateNode={isHidden:!1},t}function Wd(t,e,n){return t=Bn(6,t,null,e),t.lanes=n,t}function Hd(t,e,n){return e=Bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _b(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Id(0),this.expirationTimes=Id(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Id(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function vp(t,e,n,r,s,i,o,c,u){return t=new _b(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Bn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tp(i),t}function wb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function xx(t){if(!t)return zs;t=t._reactInternals;e:{if(Li(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(_n(n))return x0(t,n,e)}return e}function _x(t,e,n,r,s,i,o,c,u){return t=vp(n,r,!0,t,s,i,o,c,u),t.context=xx(null),n=t.current,r=un(),s=Rs(n),i=Hr(r,s),i.callback=e??null,Ps(n,i,s),t.current.lanes=s,wl(t,s,r),wn(t,r),t}function Yu(t,e,n,r){var s=e.current,i=un(),o=Rs(s);return n=xx(n),e.context===null?e.context=n:e.pendingContext=n,e=Hr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ps(s,e,o),t!==null&&(cr(t,s,o,i),Cc(t,s,o)),o}function mu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Tg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function xp(t,e){Tg(t,e),(t=t.alternate)&&Tg(t,e)}function Eb(){return null}var wx=typeof reportError=="function"?reportError:function(t){console.error(t)};function _p(t){this._internalRoot=t}Xu.prototype.render=_p.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));Yu(t,e,null,null)};Xu.prototype.unmount=_p.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ai(function(){Yu(null,t,null,null)}),e[Kr]=null}};function Xu(t){this._internalRoot=t}Xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Jv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ys.length&&e!==0&&e<ys[n].priority;n++);ys.splice(n,0,t),n===0&&e0(t)}};function wp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sg(){}function bb(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=mu(o);i.call(h)}}var o=_x(e,r,t,0,null,!1,!1,"",Sg);return t._reactRootContainer=o,t[Kr]=o.current,el(t.nodeType===8?t.parentNode:t),Ai(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=mu(u);c.call(h)}}var u=vp(t,0,!1,null,null,!1,!1,"",Sg);return t._reactRootContainer=u,t[Kr]=u.current,el(t.nodeType===8?t.parentNode:t),Ai(function(){Yu(e,u,n,r)}),u}function Zu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=mu(o);c.call(u)}}Yu(e,o,t,s)}else o=bb(n,e,t,s,r);return mu(o)}Yv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ka(e.pendingLanes);n!==0&&(zf(e,n|1),wn(e,vt()),!(Re&6)&&(Do=vt()+500,qs()))}break;case 13:Ai(function(){var r=Qr(t,1);if(r!==null){var s=un();cr(r,t,1,s)}}),xp(t,1)}};Uf=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var n=un();cr(e,t,134217728,n)}xp(t,134217728)}};Xv=function(t){if(t.tag===13){var e=Rs(t),n=Qr(t,e);if(n!==null){var r=un();cr(n,t,e,r)}xp(t,e)}};Jv=function(){return $e};Zv=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};xh=function(t,e,n){switch(e){case"input":if(hh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Bu(r);if(!s)throw Error(X(90));Cv(r),hh(r,s)}}}break;case"textarea":jv(t,n);break;case"select":e=n.value,e!=null&&yo(t,!!n.multiple,e,!1)}};Fv=pp;zv=Ai;var kb={usingClientEntryPoint:!1,Events:[bl,lo,Bu,Ov,Vv,pp]},_a={findFiberByHostInstance:gi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ib={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Bv(t),t===null?null:t.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||Eb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{Fu=yc.inject(Ib),kr=yc}catch{}}Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kb;Cn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wp(e))throw Error(X(200));return wb(t,e,null,n)};Cn.createRoot=function(t,e){if(!wp(t))throw Error(X(299));var n=!1,r="",s=wx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=vp(t,1,!1,null,null,n,!1,r,s),t[Kr]=e.current,el(t.nodeType===8?t.parentNode:t),new _p(e)};Cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=Bv(e),t=t===null?null:t.stateNode,t};Cn.flushSync=function(t){return Ai(t)};Cn.hydrate=function(t,e,n){if(!Ju(e))throw Error(X(200));return Zu(null,t,e,!0,n)};Cn.hydrateRoot=function(t,e,n){if(!wp(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=wx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=_x(e,null,t,1,n??null,s,!1,i,o),t[Kr]=e.current,el(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xu(e)};Cn.render=function(t,e,n){if(!Ju(e))throw Error(X(200));return Zu(null,t,e,!1,n)};Cn.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(X(40));return t._reactRootContainer?(Ai(function(){Zu(null,null,t,!1,function(){t._reactRootContainer=null,t[Kr]=null})}),!0):!1};Cn.unstable_batchedUpdates=pp;Cn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ju(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Zu(t,e,n,!1,r)};Cn.version="18.3.1-next-f1338f8080-20240426";function Ex(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ex)}catch(t){console.error(t)}}Ex(),Ev.exports=Cn;var Tb=Ev.exports,Ng=Tb;ih.createRoot=Ng.createRoot,ih.hydrateRoot=Ng.hydrateRoot;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Sb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),he=(t,e)=>{const n=H.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,...h},m)=>H.createElement("svg",{ref:m,...Sb,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Nb(t)}`,c].join(" "),...h},[...e.map(([g,y])=>H.createElement(g,y)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=he("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=he("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=he("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=he("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=he("ArrowUpToLine",[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=he("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=he("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=he("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=he("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=he("CircleDashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=he("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=he("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=he("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=he("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=he("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=he("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=he("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=he("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=he("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=he("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=he("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=he("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Px=he("Grip",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=he("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=he("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=he("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=he("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=he("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=he("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=he("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=he("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=he("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=he("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=he("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=he("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=he("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=he("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=he("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=he("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=he("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=he("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=he("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=he("StickyNote",[["path",{d:"M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z",key:"1wis1t"}],["path",{d:"M15 3v6h6",key:"edgan2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=he("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=he("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=he("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=he("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=he("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=he("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=he("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=he("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=he("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ip=he("Waypoints",[["circle",{cx:"12",cy:"4.5",r:"2.5",key:"r5ysbb"}],["path",{d:"m10.2 6.3-3.9 3.9",key:"1nzqf6"}],["circle",{cx:"4.5",cy:"12",r:"2.5",key:"jydg6v"}],["path",{d:"M7 12h10",key:"b7w52i"}],["circle",{cx:"19.5",cy:"12",r:"2.5",key:"1piiel"}],["path",{d:"m13.8 17.7 3.9-3.9",key:"1wyg1y"}],["circle",{cx:"12",cy:"19.5",r:"2.5",key:"13o1pw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=he("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=he("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=he("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/*! Capacitor: https://capacitorjs.com/ - MIT License */var Oo;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Oo||(Oo={}));class Gd extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const Qb=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Yb=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:Qb(t),i=()=>s()!=="web",o=g=>{const y=h.get(g);return!!(y!=null&&y.platforms.has(s())||c(g))},c=g=>{var y;return(y=n.PluginHeaders)===null||y===void 0?void 0:y.find(k=>k.name===g)},u=g=>t.console.error(g),h=new Map,m=(g,y={})=>{const k=h.get(g);if(k)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),k.proxy;const C=s(),R=c(g);let D;const A=async()=>(!D&&C in y?D=typeof y[C]=="function"?D=await y[C]():D=y[C]:e!==null&&!D&&"web"in y&&(D=typeof y.web=="function"?D=await y.web():D=y.web),D),I=(_,E)=>{var T,j;if(R){const L=R==null?void 0:R.methods.find(S=>E===S.name);if(L)return L.rtype==="promise"?S=>n.nativePromise(g,E.toString(),S):(S,Je)=>n.nativeCallback(g,E.toString(),S,Je);if(_)return(T=_[E])===null||T===void 0?void 0:T.bind(_)}else{if(_)return(j=_[E])===null||j===void 0?void 0:j.bind(_);throw new Gd(`"${g}" plugin is not implemented on ${C}`,Oo.Unimplemented)}},N=_=>{let E;const T=(...j)=>{const L=A().then(S=>{const Je=I(S,_);if(Je){const oe=Je(...j);return E=oe==null?void 0:oe.remove,oe}else throw new Gd(`"${g}.${_}()" is not implemented on ${C}`,Oo.Unimplemented)});return _==="addListener"&&(L.remove=async()=>E()),L};return T.toString=()=>`${_.toString()}() { [capacitor code] }`,Object.defineProperty(T,"name",{value:_,writable:!1,configurable:!1}),T},M=N("addListener"),z=N("removeListener"),G=(_,E)=>{const T=M({eventName:_},E),j=async()=>{const S=await T;z({eventName:_,callbackId:S},E)},L=new Promise(S=>T.then(()=>S({remove:j})));return L.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await j()},L},x=new Proxy({},{get(_,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return R?G:M;case"removeListener":return z;default:return N(E)}}});return r[g]=x,h.set(g,{name:g,proxy:x,platforms:new Set([...Object.keys(y),...R?[C]:[]])}),x};return n.convertFileSrc||(n.convertFileSrc=g=>g),n.getPlatform=s,n.handleError=u,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=Gd,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Xb=t=>t.Capacitor=Yb(t),rf=Xb(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Tl=rf.registerPlugin;class Tp{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new rf.Exception(e,Oo.Unimplemented)}unavailable(e="not available"){return new rf.Exception(e,Oo.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const Pg=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),jg=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Jb extends Tp{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=jg(s).trim(),i=jg(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=Pg(e.key),r=Pg(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Tl("CapacitorCookies",{web:()=>new Jb});const Zb=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),ek=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},tk=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let c,u;return Array.isArray(o)?(u="",o.forEach(h=>{c=e?encodeURIComponent(h):h,u+=`${i}=${c}&`}),u.slice(0,-1)):(c=e?encodeURIComponent(o):o,u=`${i}=${c}`),`${r}&${u}`},"").substr(1):null,nk=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=ek(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,u)=>{i.append(u,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class rk extends Tp{async request(e){const n=nk(e,e.webFetchExtra),r=tk(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let u,h;switch(c){case"arraybuffer":case"blob":h=await i.blob(),u=await Zb(h);break;case"json":u=await i.json();break;case"document":case"text":default:u=await i.text()}const m={};return i.headers.forEach((g,y)=>{m[y]=g}),{data:u,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Tl("CapacitorHttp",{web:()=>new rk});var Rg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Rg||(Rg={}));var Dg;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})(Dg||(Dg={}));class sk extends Tp{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Tl("SystemBars",{web:()=>new sk});var Mg;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Mg||(Mg={}));var Lg;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(Lg||(Lg={}));const ik=Tl("StatusBar"),ok="modulepreload",ak=function(t){return"/"+t},Og={},lk=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=ak(u),u in Og)return;Og[u]=!0;const h=u.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":ok,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((y,k)=>{g.addEventListener("load",y),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},Vg=Tl("App",{web:()=>lk(()=>import("./web-Biw9kn_p.js"),[]).then(t=>new t.AppWeb)});var Fg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ck=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Fx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,m=i>>2,g=(i&3)<<4|c>>4;let y=(c&15)<<2|h>>6,k=h&63;u||(k=64,o||(y=64)),r.push(n[m],n[g],n[y],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ck(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new uk;const y=i<<2|c>>4;if(r.push(y),h!==64){const k=c<<4&240|h>>2;if(r.push(k),g!==64){const C=h<<6&192|g;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dk=function(t){const e=Vx(t);return Fx.encodeByteArray(e,!0)},_u=function(t){return dk(t).replace(/\./g,"")},zx=function(t){try{return Fx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk=()=>hk().__FIREBASE_DEFAULTS__,pk=()=>{if(typeof process>"u"||typeof Fg>"u")return;const t=Fg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zx(t[1]);return e&&JSON.parse(e)},ed=()=>{try{return fk()||pk()||mk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ux=t=>{var e,n;return(n=(e=ed())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},gk=t=>{const e=Ux(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$x=()=>{var t;return(t=ed())===null||t===void 0?void 0:t.config},Bx=t=>{var e;return(e=ed())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[_u(JSON.stringify(n)),_u(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function _k(){var t;const e=(t=ed())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ek(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function bk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kk(){const t=sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ik(){return!_k()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Tk(){try{return typeof indexedDB=="object"}catch{return!1}}function Sk(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk="FirebaseError";class ss extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Nk,Object.setPrototypeOf(this,ss.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sl.prototype.create)}}class Sl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ak(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new ss(s,c,r)}}function Ak(t,e){return t.replace(Ck,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Ck=/\{\$([^}]+)}/g;function Pk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(zg(i)&&zg(o)){if(!wu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function zg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function jk(t,e){const n=new Rk(t,e);return n.subscribe.bind(n)}class Rk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Dk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=qd),s.error===void 0&&(s.error=qd),s.complete===void 0&&(s.complete=qd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function qd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(t){return t&&t._delegate?t._delegate:t}class Ci{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new yk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ok(e))try{this.getOrInitializeService({instanceIdentifier:pi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=pi){return this.instances.has(e)}getOptions(e=pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Lk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=pi){return this.component?this.component.multipleInstances?e:pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Lk(t){return t===pi?void 0:t}function Ok(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ce||(Ce={}));const Fk={debug:Ce.DEBUG,verbose:Ce.VERBOSE,info:Ce.INFO,warn:Ce.WARN,error:Ce.ERROR,silent:Ce.SILENT},zk=Ce.INFO,Uk={[Ce.DEBUG]:"log",[Ce.VERBOSE]:"log",[Ce.INFO]:"info",[Ce.WARN]:"warn",[Ce.ERROR]:"error"},$k=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Uk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sp{constructor(e){this.name=e,this._logLevel=zk,this._logHandler=$k,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Fk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ce.DEBUG,...e),this._logHandler(this,Ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ce.VERBOSE,...e),this._logHandler(this,Ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ce.INFO,...e),this._logHandler(this,Ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ce.WARN,...e),this._logHandler(this,Ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ce.ERROR,...e),this._logHandler(this,Ce.ERROR,...e)}}const Bk=(t,e)=>e.some(n=>t instanceof n);let Ug,$g;function Wk(){return Ug||(Ug=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hk(){return $g||($g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wx=new WeakMap,sf=new WeakMap,Hx=new WeakMap,Kd=new WeakMap,Np=new WeakMap;function Gk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ms(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Wx.set(n,t)}).catch(()=>{}),Np.set(e,t),e}function qk(t){if(sf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});sf.set(t,e)}let of={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return sf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Hx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ms(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Kk(t){of=t(of)}function Qk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Qd(this),e,...n);return Hx.set(r,e.sort?e.sort():[e]),Ms(r)}:Hk().includes(t)?function(...e){return t.apply(Qd(this),e),Ms(Wx.get(this))}:function(...e){return Ms(t.apply(Qd(this),e))}}function Yk(t){return typeof t=="function"?Qk(t):(t instanceof IDBTransaction&&qk(t),Bk(t,Wk())?new Proxy(t,of):t)}function Ms(t){if(t instanceof IDBRequest)return Gk(t);if(Kd.has(t))return Kd.get(t);const e=Yk(t);return e!==t&&(Kd.set(t,e),Np.set(e,t)),e}const Qd=t=>Np.get(t);function Xk(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Ms(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ms(o.result),u.oldVersion,u.newVersion,Ms(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Jk=["get","getKey","getAll","getAllKeys","count"],Zk=["put","add","delete","clear"],Yd=new Map;function Bg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Yd.get(e))return Yd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Zk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Jk.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),s&&u.done]))[0]};return Yd.set(e,i),i}Kk(t=>({...t,get:(e,n,r)=>Bg(e,n)||t.get(e,n,r),has:(e,n)=>!!Bg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const af="@firebase/app",Wg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new Sp("@firebase/app"),nI="@firebase/app-compat",rI="@firebase/analytics-compat",sI="@firebase/analytics",iI="@firebase/app-check-compat",oI="@firebase/app-check",aI="@firebase/auth",lI="@firebase/auth-compat",cI="@firebase/database",uI="@firebase/data-connect",dI="@firebase/database-compat",hI="@firebase/functions",fI="@firebase/functions-compat",pI="@firebase/installations",mI="@firebase/installations-compat",gI="@firebase/messaging",yI="@firebase/messaging-compat",vI="@firebase/performance",xI="@firebase/performance-compat",_I="@firebase/remote-config",wI="@firebase/remote-config-compat",EI="@firebase/storage",bI="@firebase/storage-compat",kI="@firebase/firestore",II="@firebase/vertexai-preview",TI="@firebase/firestore-compat",SI="firebase",NI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf="[DEFAULT]",AI={[af]:"fire-core",[nI]:"fire-core-compat",[sI]:"fire-analytics",[rI]:"fire-analytics-compat",[oI]:"fire-app-check",[iI]:"fire-app-check-compat",[aI]:"fire-auth",[lI]:"fire-auth-compat",[cI]:"fire-rtdb",[uI]:"fire-data-connect",[dI]:"fire-rtdb-compat",[hI]:"fire-fn",[fI]:"fire-fn-compat",[pI]:"fire-iid",[mI]:"fire-iid-compat",[gI]:"fire-fcm",[yI]:"fire-fcm-compat",[vI]:"fire-perf",[xI]:"fire-perf-compat",[_I]:"fire-rc",[wI]:"fire-rc-compat",[EI]:"fire-gcs",[bI]:"fire-gcs-compat",[kI]:"fire-fst",[TI]:"fire-fst-compat",[II]:"fire-vertex","fire-js":"fire-js",[SI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=new Map,CI=new Map,cf=new Map;function Hg(t,e){try{t.container.addComponent(e)}catch(n){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Vo(t){const e=t.name;if(cf.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;cf.set(e,t);for(const n of cl.values())Hg(n,t);for(const n of CI.values())Hg(n,t);return!0}function Ap(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function wr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ls=new Sl("app","Firebase",PI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ci("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ls.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=NI;function Gx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lf,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ls.create("bad-app-name",{appName:String(s)});if(n||(n=$x()),!n)throw Ls.create("no-options");const i=cl.get(s);if(i){if(wu(n,i.options)&&wu(r,i.config))return i;throw Ls.create("duplicate-app",{appName:s})}const o=new Vk(s);for(const u of cf.values())o.addComponent(u);const c=new jI(n,r,o);return cl.set(s,c),c}function Cp(t=lf){const e=cl.get(t);if(!e&&t===lf&&$x())return Gx();if(!e)throw Ls.create("no-app",{appName:t});return e}function RI(){return Array.from(cl.values())}function Os(t,e,n){var r;let s=(r=AI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(c.join(" "));return}Vo(new Ci(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="firebase-heartbeat-database",MI=1,ul="firebase-heartbeat-store";let Xd=null;function qx(){return Xd||(Xd=Xk(DI,MI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ul)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ls.create("idb-open",{originalErrorMessage:t.message})})),Xd}async function LI(t){try{const n=(await qx()).transaction(ul),r=await n.objectStore(ul).get(Kx(t));return await n.done,r}catch(e){if(e instanceof ss)Xr.warn(e.message);else{const n=Ls.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(n.message)}}}async function Gg(t,e){try{const r=(await qx()).transaction(ul,"readwrite");await r.objectStore(ul).put(e,Kx(t)),await r.done}catch(n){if(n instanceof ss)Xr.warn(n.message);else{const r=Ls.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xr.warn(r.message)}}}function Kx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI=1024,VI=30*24*60*60*1e3;class FI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new UI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=VI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Xr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=qg(),{heartbeatsToSend:r,unsentEntries:s}=zI(this._heartbeatsCache.heartbeats),i=_u(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Xr.warn(n),""}}}function qg(){return new Date().toISOString().substring(0,10)}function zI(t,e=OI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Kg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Kg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class UI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Tk()?Sk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await LI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Gg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Gg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Kg(t){return _u(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(t){Vo(new Ci("platform-logger",e=>new eI(e),"PRIVATE")),Vo(new Ci("heartbeat",e=>new FI(e),"PRIVATE")),Os(af,Wg,t),Os(af,Wg,"esm2017"),Os("fire-js","")}$I("");var BI="firebase",WI="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(BI,WI,"app");function Pp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Qx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const HI=Qx,Yx=new Sl("auth","Firebase",Qx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu=new Sp("@firebase/auth");function GI(t,...e){Eu.logLevel<=Ce.WARN&&Eu.warn(`Auth (${Yo}): ${t}`,...e)}function Oc(t,...e){Eu.logLevel<=Ce.ERROR&&Eu.error(`Auth (${Yo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(t,...e){throw jp(t,...e)}function Tr(t,...e){return jp(t,...e)}function Xx(t,e,n){const r=Object.assign(Object.assign({},HI()),{[e]:n});return new Sl("auth","Firebase",r).create(e,{appName:t.name})}function Gr(t){return Xx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Yx.create(t,...e)}function ge(t,e,...n){if(!t)throw jp(e,...n)}function $r(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Oc(e),new Error(e)}function Zr(t,e){t||$r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function qI(){return Qg()==="http:"||Qg()==="https:"}function Qg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qI()||Ek()||"connection"in navigator)?navigator.onLine:!0}function QI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zr(n>e,"Short delay should be less than long delay!"),this.isMobile=xk()||bk()}get(){return KI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(t,e){Zr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=new Al(3e4,6e4);function Cl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xo(t,e,n,r,s={}){return Zx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=Nl(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},i);return wk()||(h.referrerPolicy="no-referrer"),Jx.fetch()(e_(t,t.config.apiHost,n,c),h)})}async function Zx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},YI),e);try{const s=new JI(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw vc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw vc(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw vc(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw vc(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Xx(t,m,h);Jr(t,m)}}catch(s){if(s instanceof ss)throw s;Jr(t,"network-request-failed",{message:String(s)})}}async function Dp(t,e,n,r,s={}){const i=await Xo(t,e,n,r,s);return"mfaPendingCredential"in i&&Jr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function e_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Rp(t.config,s):`${t.config.apiScheme}://${s}`}class JI{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Tr(this.auth,"network-request-failed")),XI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function vc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Tr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(t,e){return Xo(t,"POST","/v1/accounts:delete",e)}async function t_(t,e){return Xo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eT(t,e=!1){const n=bn(t),r=await n.getIdToken(e),s=Mp(r);ge(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ua(Jd(s.auth_time)),issuedAtTime:Ua(Jd(s.iat)),expirationTime:Ua(Jd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Jd(t){return Number(t)*1e3}function Mp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Oc("JWT malformed, contained fewer than 3 sections"),null;try{const s=zx(n);return s?JSON.parse(s):(Oc("Failed to decode base64 JWT payload"),null)}catch(s){return Oc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Yg(t){const e=Mp(t);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ss&&tT(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ua(this.lastLoginAt),this.creationTime=Ua(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await dl(t,t_(n,{idToken:r}));ge(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?n_(i.providerUserInfo):[],c=sT(t.providerData,o),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),m=u?h:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new df(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function rT(t){const e=bn(t);await bu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sT(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function n_(t){return t.map(e=>{var{providerId:n}=e,r=Pp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iT(t,e){const n=await Zx(t,{},async()=>{const r=Nl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=e_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Jx.fetch()(o,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function oT(t,e){return Xo(t,"POST","/v2/accounts:revokeToken",Cl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ge(e.length!==0,"internal-error");const n=Yg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await iT(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ko;return r&&(ge(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ge(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ge(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ko,this.toJSON())}_performRefresh(){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(t,e){ge(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Br{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Pp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new df(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await dl(this,this.stsTokenManager.getToken(this.auth,e));return ge(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return eT(this,e)}reload(){return rT(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Br(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wr(this.auth.app))return Promise.reject(Gr(this.auth));const e=await this.getIdToken();return await dl(this,ZI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,c,u,h,m;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,k=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,C=(o=n.photoURL)!==null&&o!==void 0?o:void 0,R=(c=n.tenantId)!==null&&c!==void 0?c:void 0,D=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,A=(h=n.createdAt)!==null&&h!==void 0?h:void 0,I=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:N,emailVerified:M,isAnonymous:z,providerData:G,stsTokenManager:x}=n;ge(N&&x,e,"internal-error");const _=ko.fromJSON(this.name,x);ge(typeof N=="string",e,"internal-error"),ps(g,e.name),ps(y,e.name),ge(typeof M=="boolean",e,"internal-error"),ge(typeof z=="boolean",e,"internal-error"),ps(k,e.name),ps(C,e.name),ps(R,e.name),ps(D,e.name),ps(A,e.name),ps(I,e.name);const E=new Br({uid:N,auth:e,email:y,emailVerified:M,displayName:g,isAnonymous:z,photoURL:C,phoneNumber:k,tenantId:R,stsTokenManager:_,createdAt:A,lastLoginAt:I});return G&&Array.isArray(G)&&(E.providerData=G.map(T=>Object.assign({},T))),D&&(E._redirectEventId=D),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new ko;s.updateFromServerResponse(n);const i=new Br({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await bu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ge(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?n_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new ko;c.updateFromIdToken(r);const u=new Br({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new df(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=new Map;function Wr(t){Zr(t instanceof Function,"Expected a class definition");let e=Xg.get(t);return e?(Zr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}r_.type="NONE";const Jg=r_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e,n){return`firebase:${t}:${e}:${n}`}class Io{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Br._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Io(Wr(Jg),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Wr(Jg);const o=Vc(r,e.config.apiKey,e.name);let c=null;for(const h of n)try{const m=await h._get(o);if(m){const g=Br._fromJSON(e,m);h!==i&&(c=g),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Io(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new Io(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(a_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(s_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(c_(e))return"Blackberry";if(u_(e))return"Webos";if(i_(e))return"Safari";if((e.includes("chrome/")||o_(e))&&!e.includes("edge/"))return"Chrome";if(l_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function s_(t=sn()){return/firefox\//i.test(t)}function i_(t=sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function o_(t=sn()){return/crios\//i.test(t)}function a_(t=sn()){return/iemobile/i.test(t)}function l_(t=sn()){return/android/i.test(t)}function c_(t=sn()){return/blackberry/i.test(t)}function u_(t=sn()){return/webos/i.test(t)}function Lp(t=sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aT(t=sn()){var e;return Lp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lT(){return kk()&&document.documentMode===10}function d_(t=sn()){return Lp(t)||l_(t)||u_(t)||c_(t)||/windows phone/i.test(t)||a_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(t,e=[]){let n;switch(t){case"Browser":n=Zg(sn());break;case"Worker":n=`${Zg(sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Yo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uT(t,e={}){return Xo(t,"GET","/v2/passwordPolicy",Cl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT=6;class hT{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:dT,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ey(this),this.idTokenSubscription=new ey(this),this.beforeStateQueue=new cT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Io.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await t_(this,{idToken:e}),r=await Br._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(wr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wr(this.app))return Promise.reject(Gr(this));const n=e?bn(e):null;return n&&ge(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wr(this.app)?Promise.reject(Gr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wr(this.app)?Promise.reject(Gr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uT(this),n=new hT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Sl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await oT(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wr(e)||this._popupRedirectResolver;ge(n,this,"argument-error"),this.redirectPersistenceManager=await Io.create(this,[Wr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=h_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&GI(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Pl(t){return bn(t)}class ey{constructor(e){this.auth=e,this.observer=null,this.addObserver=jk(n=>this.observer=n)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Op={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pT(t){Op=t}function mT(t){return Op.loadJS(t)}function gT(){return Op.gapiScript}function yT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(t,e){const n=Ap(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(wu(i,e??{}))return s;Jr(s,"already-initialized")}return n.initialize({options:e})}function xT(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function _T(t,e,n){const r=Pl(t);ge(r._canInitEmulator,r,"emulator-config-failed"),ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=f_(e),{host:o,port:c}=wT(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),ET()}function f_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wT(t){const e=f_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ty(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:ty(o)}}}function ty(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ET(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $r("not implemented")}_getIdTokenResponse(e){return $r("not implemented")}_linkToIdToken(e,n){return $r("not implemented")}_getReauthenticationResolver(e){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(t,e){return Dp(t,"POST","/v1/accounts:signInWithIdp",Cl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="http://localhost";class Pi extends p_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Jr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Pp(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Pi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return To(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,To(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,To(e,n)}buildRequest(){const e={requestUri:bT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Nl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl extends m_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends jl{constructor(){super("facebook.com")}static credential(e){return Pi._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xs.credential(e.oauthAccessToken)}catch{return null}}}xs.FACEBOOK_SIGN_IN_METHOD="facebook.com";xs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends jl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Pi._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _s.credential(n,r)}catch{return null}}}_s.GOOGLE_SIGN_IN_METHOD="google.com";_s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends jl{constructor(){super("github.com")}static credential(e){return Pi._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.GITHUB_SIGN_IN_METHOD="github.com";ws.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends jl{constructor(){super("twitter.com")}static credential(e,n){return Pi._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Es.credential(n,r)}catch{return null}}}Es.TWITTER_SIGN_IN_METHOD="twitter.com";Es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kT(t,e){return Dp(t,"POST","/v1/accounts:signUp",Cl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Br._fromIdTokenResponse(e,r,s),o=ny(r);return new es({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ny(r);return new es({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ny(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IT(t){var e;if(wr(t.app))return Promise.reject(Gr(t));const n=Pl(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new es({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await kT(n,{returnSecureToken:!0}),s=await es._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends ss{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ku.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ku(e,n,r,s)}}function g_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ku._fromErrorAndOperation(t,i,e,r):i})}async function TT(t,e,n=!1){const r=await dl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return es._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e,n=!1){const{auth:r}=t;if(wr(r.app))return Promise.reject(Gr(r));const s="reauthenticate";try{const i=await dl(t,g_(r,s,e,t),n);ge(i.idToken,r,"internal-error");const o=Mp(i.idToken);ge(o,r,"internal-error");const{sub:c}=o;return ge(t.uid===c,r,"user-mismatch"),es._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Jr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NT(t,e,n=!1){if(wr(t.app))return Promise.reject(Gr(t));const r="signIn",s=await g_(t,r,e),i=await es._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(t,e){return Dp(t,"POST","/v1/accounts:signInWithCustomToken",Cl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CT(t,e){if(wr(t.app))return Promise.reject(Gr(t));const n=Pl(t),r=await AT(n,{token:e,returnSecureToken:!0}),s=await es._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}function PT(t,e,n,r){return bn(t).onIdTokenChanged(e,n,r)}function jT(t,e,n){return bn(t).beforeAuthStateChanged(e,n)}function RT(t,e,n,r){return bn(t).onAuthStateChanged(e,n,r)}const Iu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Iu,"1"),this.storage.removeItem(Iu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT=1e3,MT=10;class v_ extends y_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=d_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);lT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,MT):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},DT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}v_.type="LOCAL";const LT=v_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_ extends y_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}x_.type="SESSION";const __=x_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new td(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async h=>h(n.origin,i)),u=await OT(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=Vp("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(y.data.response);break;default:clearTimeout(m),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function FT(t){Sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function zT(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UT(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function $T(){return w_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_="firebaseLocalStorageDb",BT=1,Tu="firebaseLocalStorage",b_="fbase_key";class Rl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nd(t,e){return t.transaction([Tu],e?"readwrite":"readonly").objectStore(Tu)}function WT(){const t=indexedDB.deleteDatabase(E_);return new Rl(t).toPromise()}function hf(){const t=indexedDB.open(E_,BT);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Tu,{keyPath:b_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Tu)?e(r):(r.close(),await WT(),e(await hf()))})})}async function ry(t,e,n){const r=nd(t,!0).put({[b_]:e,value:n});return new Rl(r).toPromise()}async function HT(t,e){const n=nd(t,!1).get(e),r=await new Rl(n).toPromise();return r===void 0?null:r.value}function sy(t,e){const n=nd(t,!0).delete(e);return new Rl(n).toPromise()}const GT=800,qT=3;class k_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>qT)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return w_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance($T()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await zT(),!this.activeServiceWorker)return;this.sender=new VT(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hf();return await ry(e,Iu,"1"),await sy(e,Iu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ry(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>HT(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=nd(s,!1).getAll();return new Rl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k_.type="LOCAL";const KT=k_;new Al(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(t,e){return e?Wr(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp extends p_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return To(e,this._buildIdpRequest())}_linkToIdToken(e,n){return To(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return To(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function YT(t){return NT(t.auth,new Fp(t),t.bypassAuthState)}function XT(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),ST(n,new Fp(t),t.bypassAuthState)}async function JT(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),TT(n,new Fp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return YT;case"linkViaPopup":case"linkViaRedirect":return JT;case"reauthViaPopup":case"reauthViaRedirect":return XT;default:Jr(this.auth,"internal-error")}}resolve(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT=new Al(2e3,1e4);class go extends I_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,go.currentPopupAction&&go.currentPopupAction.cancel(),go.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ge(e,this.auth,"internal-error"),e}async onExecution(){Zr(this.filter.length===1,"Popup operations only handle one event");const e=Vp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,go.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZT.get())};e()}}go.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2="pendingRedirect",Fc=new Map;class t2 extends I_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fc.get(this.auth._key());if(!e){try{const r=await n2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fc.set(this.auth._key(),e)}return this.bypassAuthState||Fc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n2(t,e){const n=i2(e),r=s2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function r2(t,e){Fc.set(t._key(),e)}function s2(t){return Wr(t._redirectPersistence)}function i2(t){return Vc(e2,t.config.apiKey,t.name)}async function o2(t,e,n=!1){if(wr(t.app))return Promise.reject(Gr(t));const r=Pl(t),s=QT(r,e),o=await new t2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2=10*60*1e3;class l2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!T_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Tr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=a2&&this.cachedEventUids.clear(),this.cachedEventUids.has(iy(e))}saveEventToCache(e){this.cachedEventUids.add(iy(e)),this.lastProcessedEventTime=Date.now()}}function iy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function T_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function c2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return T_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u2(t,e={}){return Xo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h2=/^https?/;async function f2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await u2(t);for(const n of e)try{if(p2(n))return}catch{}Jr(t,"unauthorized-domain")}function p2(t){const e=uf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!h2.test(n))return!1;if(d2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=new Al(3e4,6e4);function oy(){const t=Sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function g2(t){return new Promise((e,n)=>{var r,s,i;function o(){oy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oy(),n(Tr(t,"network-request-failed"))},timeout:m2.get()})}if(!((s=(r=Sr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Sr().gapi)===null||i===void 0)&&i.load)o();else{const c=yT("iframefcb");return Sr()[c]=()=>{gapi.load?o():n(Tr(t,"network-request-failed"))},mT(`${gT()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw zc=null,e})}let zc=null;function y2(t){return zc=zc||g2(t),zc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=new Al(5e3,15e3),x2="__/auth/iframe",_2="emulator/auth/iframe",w2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b2(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Rp(e,_2):`https://${t.config.authDomain}/${x2}`,r={apiKey:e.apiKey,appName:t.name,v:Yo},s=E2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Nl(r).slice(1)}`}async function k2(t){const e=await y2(t),n=Sr().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:b2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:w2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Tr(t,"network-request-failed"),c=Sr().setTimeout(()=>{i(o)},v2.get());function u(){Sr().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T2=500,S2=600,N2="_blank",A2="http://localhost";class ay{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function C2(t,e,n,r=T2,s=S2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},I2),{width:r.toString(),height:s.toString(),top:i,left:o}),h=sn().toLowerCase();n&&(c=o_(h)?N2:n),s_(h)&&(e=e||A2,u.scrollbars="yes");const m=Object.entries(u).reduce((y,[k,C])=>`${y}${k}=${C},`,"");if(aT(h)&&c!=="_self")return P2(e||"",c),new ay(null);const g=window.open(e||"",c,m);ge(g,t,"popup-blocked");try{g.focus()}catch{}return new ay(g)}function P2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="__/auth/handler",R2="emulator/auth/handler",D2=encodeURIComponent("fac");async function ly(t,e,n,r,s,i){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Yo,eventId:s};if(e instanceof m_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Pk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))o[m]=g}if(e instanceof jl){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),h=u?`#${D2}=${encodeURIComponent(u)}`:"";return`${M2(t)}?${Nl(c).slice(1)}${h}`}function M2({config:t}){return t.emulator?Rp(t,R2):`https://${t.authDomain}/${j2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="webStorageSupport";class L2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=__,this._completeRedirectFn=o2,this._overrideRedirectResult=r2}async _openPopup(e,n,r,s){var i;Zr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await ly(e,n,r,uf(),s);return C2(e,o,Vp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await ly(e,n,r,uf(),s);return FT(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Zr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await k2(e),r=new l2(e);return n.register("authEvent",s=>(ge(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Zd,{type:Zd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Zd];o!==void 0&&n(!!o),Jr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=f2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return d_()||i_()||Lp()}}const O2=L2;var cy="@firebase/auth",uy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z2(t){Vo(new Ci("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ge(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:h_(t)},h=new fT(r,s,i,u);return xT(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Vo(new Ci("auth-internal",e=>{const n=Pl(e.getProvider("auth").getImmediate());return(r=>new V2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(cy,uy,F2(t)),Os(cy,uy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=5*60,$2=Bx("authIdTokenMaxAge")||U2;let dy=null;const B2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>$2)return;const s=n==null?void 0:n.token;dy!==s&&(dy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function W2(t=Cp()){const e=Ap(t,"auth");if(e.isInitialized())return e.getImmediate();const n=vT(t,{popupRedirectResolver:O2,persistence:[KT,LT,__]}),r=Bx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=B2(i.toString());jT(n,o,()=>o(n.currentUser)),PT(n,c=>o(c))}}const s=Ux("auth");return s&&_T(n,`http://${s}`),n}function H2(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pT({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Tr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",H2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z2("Browser");var hy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ei,S_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,_){function E(){}E.prototype=_.prototype,x.D=_.prototype,x.prototype=new E,x.prototype.constructor=x,x.C=function(T,j,L){for(var S=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)S[Je-2]=arguments[Je];return _.prototype[j].apply(T,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,_,E){E||(E=0);var T=Array(16);if(typeof _=="string")for(var j=0;16>j;++j)T[j]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(j=0;16>j;++j)T[j]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=x.g[0],E=x.g[1],j=x.g[2];var L=x.g[3],S=_+(L^E&(j^L))+T[0]+3614090360&4294967295;_=E+(S<<7&4294967295|S>>>25),S=L+(j^_&(E^j))+T[1]+3905402710&4294967295,L=_+(S<<12&4294967295|S>>>20),S=j+(E^L&(_^E))+T[2]+606105819&4294967295,j=L+(S<<17&4294967295|S>>>15),S=E+(_^j&(L^_))+T[3]+3250441966&4294967295,E=j+(S<<22&4294967295|S>>>10),S=_+(L^E&(j^L))+T[4]+4118548399&4294967295,_=E+(S<<7&4294967295|S>>>25),S=L+(j^_&(E^j))+T[5]+1200080426&4294967295,L=_+(S<<12&4294967295|S>>>20),S=j+(E^L&(_^E))+T[6]+2821735955&4294967295,j=L+(S<<17&4294967295|S>>>15),S=E+(_^j&(L^_))+T[7]+4249261313&4294967295,E=j+(S<<22&4294967295|S>>>10),S=_+(L^E&(j^L))+T[8]+1770035416&4294967295,_=E+(S<<7&4294967295|S>>>25),S=L+(j^_&(E^j))+T[9]+2336552879&4294967295,L=_+(S<<12&4294967295|S>>>20),S=j+(E^L&(_^E))+T[10]+4294925233&4294967295,j=L+(S<<17&4294967295|S>>>15),S=E+(_^j&(L^_))+T[11]+2304563134&4294967295,E=j+(S<<22&4294967295|S>>>10),S=_+(L^E&(j^L))+T[12]+1804603682&4294967295,_=E+(S<<7&4294967295|S>>>25),S=L+(j^_&(E^j))+T[13]+4254626195&4294967295,L=_+(S<<12&4294967295|S>>>20),S=j+(E^L&(_^E))+T[14]+2792965006&4294967295,j=L+(S<<17&4294967295|S>>>15),S=E+(_^j&(L^_))+T[15]+1236535329&4294967295,E=j+(S<<22&4294967295|S>>>10),S=_+(j^L&(E^j))+T[1]+4129170786&4294967295,_=E+(S<<5&4294967295|S>>>27),S=L+(E^j&(_^E))+T[6]+3225465664&4294967295,L=_+(S<<9&4294967295|S>>>23),S=j+(_^E&(L^_))+T[11]+643717713&4294967295,j=L+(S<<14&4294967295|S>>>18),S=E+(L^_&(j^L))+T[0]+3921069994&4294967295,E=j+(S<<20&4294967295|S>>>12),S=_+(j^L&(E^j))+T[5]+3593408605&4294967295,_=E+(S<<5&4294967295|S>>>27),S=L+(E^j&(_^E))+T[10]+38016083&4294967295,L=_+(S<<9&4294967295|S>>>23),S=j+(_^E&(L^_))+T[15]+3634488961&4294967295,j=L+(S<<14&4294967295|S>>>18),S=E+(L^_&(j^L))+T[4]+3889429448&4294967295,E=j+(S<<20&4294967295|S>>>12),S=_+(j^L&(E^j))+T[9]+568446438&4294967295,_=E+(S<<5&4294967295|S>>>27),S=L+(E^j&(_^E))+T[14]+3275163606&4294967295,L=_+(S<<9&4294967295|S>>>23),S=j+(_^E&(L^_))+T[3]+4107603335&4294967295,j=L+(S<<14&4294967295|S>>>18),S=E+(L^_&(j^L))+T[8]+1163531501&4294967295,E=j+(S<<20&4294967295|S>>>12),S=_+(j^L&(E^j))+T[13]+2850285829&4294967295,_=E+(S<<5&4294967295|S>>>27),S=L+(E^j&(_^E))+T[2]+4243563512&4294967295,L=_+(S<<9&4294967295|S>>>23),S=j+(_^E&(L^_))+T[7]+1735328473&4294967295,j=L+(S<<14&4294967295|S>>>18),S=E+(L^_&(j^L))+T[12]+2368359562&4294967295,E=j+(S<<20&4294967295|S>>>12),S=_+(E^j^L)+T[5]+4294588738&4294967295,_=E+(S<<4&4294967295|S>>>28),S=L+(_^E^j)+T[8]+2272392833&4294967295,L=_+(S<<11&4294967295|S>>>21),S=j+(L^_^E)+T[11]+1839030562&4294967295,j=L+(S<<16&4294967295|S>>>16),S=E+(j^L^_)+T[14]+4259657740&4294967295,E=j+(S<<23&4294967295|S>>>9),S=_+(E^j^L)+T[1]+2763975236&4294967295,_=E+(S<<4&4294967295|S>>>28),S=L+(_^E^j)+T[4]+1272893353&4294967295,L=_+(S<<11&4294967295|S>>>21),S=j+(L^_^E)+T[7]+4139469664&4294967295,j=L+(S<<16&4294967295|S>>>16),S=E+(j^L^_)+T[10]+3200236656&4294967295,E=j+(S<<23&4294967295|S>>>9),S=_+(E^j^L)+T[13]+681279174&4294967295,_=E+(S<<4&4294967295|S>>>28),S=L+(_^E^j)+T[0]+3936430074&4294967295,L=_+(S<<11&4294967295|S>>>21),S=j+(L^_^E)+T[3]+3572445317&4294967295,j=L+(S<<16&4294967295|S>>>16),S=E+(j^L^_)+T[6]+76029189&4294967295,E=j+(S<<23&4294967295|S>>>9),S=_+(E^j^L)+T[9]+3654602809&4294967295,_=E+(S<<4&4294967295|S>>>28),S=L+(_^E^j)+T[12]+3873151461&4294967295,L=_+(S<<11&4294967295|S>>>21),S=j+(L^_^E)+T[15]+530742520&4294967295,j=L+(S<<16&4294967295|S>>>16),S=E+(j^L^_)+T[2]+3299628645&4294967295,E=j+(S<<23&4294967295|S>>>9),S=_+(j^(E|~L))+T[0]+4096336452&4294967295,_=E+(S<<6&4294967295|S>>>26),S=L+(E^(_|~j))+T[7]+1126891415&4294967295,L=_+(S<<10&4294967295|S>>>22),S=j+(_^(L|~E))+T[14]+2878612391&4294967295,j=L+(S<<15&4294967295|S>>>17),S=E+(L^(j|~_))+T[5]+4237533241&4294967295,E=j+(S<<21&4294967295|S>>>11),S=_+(j^(E|~L))+T[12]+1700485571&4294967295,_=E+(S<<6&4294967295|S>>>26),S=L+(E^(_|~j))+T[3]+2399980690&4294967295,L=_+(S<<10&4294967295|S>>>22),S=j+(_^(L|~E))+T[10]+4293915773&4294967295,j=L+(S<<15&4294967295|S>>>17),S=E+(L^(j|~_))+T[1]+2240044497&4294967295,E=j+(S<<21&4294967295|S>>>11),S=_+(j^(E|~L))+T[8]+1873313359&4294967295,_=E+(S<<6&4294967295|S>>>26),S=L+(E^(_|~j))+T[15]+4264355552&4294967295,L=_+(S<<10&4294967295|S>>>22),S=j+(_^(L|~E))+T[6]+2734768916&4294967295,j=L+(S<<15&4294967295|S>>>17),S=E+(L^(j|~_))+T[13]+1309151649&4294967295,E=j+(S<<21&4294967295|S>>>11),S=_+(j^(E|~L))+T[4]+4149444226&4294967295,_=E+(S<<6&4294967295|S>>>26),S=L+(E^(_|~j))+T[11]+3174756917&4294967295,L=_+(S<<10&4294967295|S>>>22),S=j+(_^(L|~E))+T[2]+718787259&4294967295,j=L+(S<<15&4294967295|S>>>17),S=E+(L^(j|~_))+T[9]+3951481745&4294967295,x.g[0]=x.g[0]+_&4294967295,x.g[1]=x.g[1]+(j+(S<<21&4294967295|S>>>11))&4294967295,x.g[2]=x.g[2]+j&4294967295,x.g[3]=x.g[3]+L&4294967295}r.prototype.u=function(x,_){_===void 0&&(_=x.length);for(var E=_-this.blockSize,T=this.B,j=this.h,L=0;L<_;){if(j==0)for(;L<=E;)s(this,x,L),L+=this.blockSize;if(typeof x=="string"){for(;L<_;)if(T[j++]=x.charCodeAt(L++),j==this.blockSize){s(this,T),j=0;break}}else for(;L<_;)if(T[j++]=x[L++],j==this.blockSize){s(this,T),j=0;break}}this.h=j,this.o+=_},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var _=1;_<x.length-8;++_)x[_]=0;var E=8*this.o;for(_=x.length-8;_<x.length;++_)x[_]=E&255,E/=256;for(this.u(x),x=Array(16),_=E=0;4>_;++_)for(var T=0;32>T;T+=8)x[E++]=this.g[_]>>>T&255;return x};function i(x,_){var E=c;return Object.prototype.hasOwnProperty.call(E,x)?E[x]:E[x]=_(x)}function o(x,_){this.h=_;for(var E=[],T=!0,j=x.length-1;0<=j;j--){var L=x[j]|0;T&&L==_||(E[j]=L,T=!1)}this.g=E}var c={};function u(x){return-128<=x&&128>x?i(x,function(_){return new o([_|0],0>_?-1:0)}):new o([x|0],0>x?-1:0)}function h(x){if(isNaN(x)||!isFinite(x))return g;if(0>x)return D(h(-x));for(var _=[],E=1,T=0;x>=E;T++)_[T]=x/E|0,E*=4294967296;return new o(_,0)}function m(x,_){if(x.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(x.charAt(0)=="-")return D(m(x.substring(1),_));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=h(Math.pow(_,8)),T=g,j=0;j<x.length;j+=8){var L=Math.min(8,x.length-j),S=parseInt(x.substring(j,j+L),_);8>L?(L=h(Math.pow(_,L)),T=T.j(L).add(h(S))):(T=T.j(E),T=T.add(h(S)))}return T}var g=u(0),y=u(1),k=u(16777216);t=o.prototype,t.m=function(){if(R(this))return-D(this).m();for(var x=0,_=1,E=0;E<this.g.length;E++){var T=this.i(E);x+=(0<=T?T:4294967296+T)*_,_*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(C(this))return"0";if(R(this))return"-"+D(this).toString(x);for(var _=h(Math.pow(x,6)),E=this,T="";;){var j=M(E,_).g;E=A(E,j.j(_));var L=((0<E.g.length?E.g[0]:E.h)>>>0).toString(x);if(E=j,C(E))return L+T;for(;6>L.length;)L="0"+L;T=L+T}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function C(x){if(x.h!=0)return!1;for(var _=0;_<x.g.length;_++)if(x.g[_]!=0)return!1;return!0}function R(x){return x.h==-1}t.l=function(x){return x=A(this,x),R(x)?-1:C(x)?0:1};function D(x){for(var _=x.g.length,E=[],T=0;T<_;T++)E[T]=~x.g[T];return new o(E,~x.h).add(y)}t.abs=function(){return R(this)?D(this):this},t.add=function(x){for(var _=Math.max(this.g.length,x.g.length),E=[],T=0,j=0;j<=_;j++){var L=T+(this.i(j)&65535)+(x.i(j)&65535),S=(L>>>16)+(this.i(j)>>>16)+(x.i(j)>>>16);T=S>>>16,L&=65535,S&=65535,E[j]=S<<16|L}return new o(E,E[E.length-1]&-2147483648?-1:0)};function A(x,_){return x.add(D(_))}t.j=function(x){if(C(this)||C(x))return g;if(R(this))return R(x)?D(this).j(D(x)):D(D(this).j(x));if(R(x))return D(this.j(D(x)));if(0>this.l(k)&&0>x.l(k))return h(this.m()*x.m());for(var _=this.g.length+x.g.length,E=[],T=0;T<2*_;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var j=0;j<x.g.length;j++){var L=this.i(T)>>>16,S=this.i(T)&65535,Je=x.i(j)>>>16,oe=x.i(j)&65535;E[2*T+2*j]+=S*oe,I(E,2*T+2*j),E[2*T+2*j+1]+=L*oe,I(E,2*T+2*j+1),E[2*T+2*j+1]+=S*Je,I(E,2*T+2*j+1),E[2*T+2*j+2]+=L*Je,I(E,2*T+2*j+2)}for(T=0;T<_;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=_;T<2*_;T++)E[T]=0;return new o(E,0)};function I(x,_){for(;(x[_]&65535)!=x[_];)x[_+1]+=x[_]>>>16,x[_]&=65535,_++}function N(x,_){this.g=x,this.h=_}function M(x,_){if(C(_))throw Error("division by zero");if(C(x))return new N(g,g);if(R(x))return _=M(D(x),_),new N(D(_.g),D(_.h));if(R(_))return _=M(x,D(_)),new N(D(_.g),_.h);if(30<x.g.length){if(R(x)||R(_))throw Error("slowDivide_ only works with positive integers.");for(var E=y,T=_;0>=T.l(x);)E=z(E),T=z(T);var j=G(E,1),L=G(T,1);for(T=G(T,2),E=G(E,2);!C(T);){var S=L.add(T);0>=S.l(x)&&(j=j.add(E),L=S),T=G(T,1),E=G(E,1)}return _=A(x,j.j(_)),new N(j,_)}for(j=g;0<=x.l(_);){for(E=Math.max(1,Math.floor(x.m()/_.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),L=h(E),S=L.j(_);R(S)||0<S.l(x);)E-=T,L=h(E),S=L.j(_);C(L)&&(L=y),j=j.add(L),x=A(x,S)}return new N(j,x)}t.A=function(x){return M(this,x).h},t.and=function(x){for(var _=Math.max(this.g.length,x.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)&x.i(T);return new o(E,this.h&x.h)},t.or=function(x){for(var _=Math.max(this.g.length,x.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)|x.i(T);return new o(E,this.h|x.h)},t.xor=function(x){for(var _=Math.max(this.g.length,x.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)^x.i(T);return new o(E,this.h^x.h)};function z(x){for(var _=x.g.length+1,E=[],T=0;T<_;T++)E[T]=x.i(T)<<1|x.i(T-1)>>>31;return new o(E,x.h)}function G(x,_){var E=_>>5;_%=32;for(var T=x.g.length-E,j=[],L=0;L<T;L++)j[L]=0<_?x.i(L+E)>>>_|x.i(L+E+1)<<32-_:x.i(L+E);return new o(j,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,S_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,Ei=o}).apply(typeof hy<"u"?hy:typeof self<"u"?self:typeof window<"u"?window:{});var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var N_,Sa,A_,Uc,ff,C_,P_,j_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,p){return l==Array.prototype||l==Object.prototype||(l[d]=p.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof xc=="object"&&xc];for(var d=0;d<l.length;++d){var p=l[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,d){if(d)e:{var p=r;l=l.split(".");for(var w=0;w<l.length-1;w++){var V=l[w];if(!(V in p))break e;p=p[V]}l=l[l.length-1],w=p[l],d=d(w),d!=w&&d!=null&&e(p,l,{configurable:!0,writable:!0,value:d})}}function i(l,d){l instanceof String&&(l+="");var p=0,w=!1,V={next:function(){if(!w&&p<l.length){var $=p++;return{value:d($,l[$]),done:!1}}return w=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(l){return l||function(){return i(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function h(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function m(l,d,p){return l.call.apply(l.bind,arguments)}function g(l,d,p){if(!l)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,w),l.apply(d,V)}}return function(){return l.apply(d,arguments)}}function y(l,d,p){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,y.apply(null,arguments)}function k(l,d){var p=Array.prototype.slice.call(arguments,1);return function(){var w=p.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function C(l,d){function p(){}p.prototype=d.prototype,l.aa=d.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(w,V,$){for(var te=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)te[Xe-2]=arguments[Xe];return d.prototype[V].apply(w,te)}}function R(l){const d=l.length;if(0<d){const p=Array(d);for(let w=0;w<d;w++)p[w]=l[w];return p}return[]}function D(l,d){for(let p=1;p<arguments.length;p++){const w=arguments[p];if(u(w)){const V=l.length||0,$=w.length||0;l.length=V+$;for(let te=0;te<$;te++)l[V+te]=w[te]}else l.push(w)}}class A{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function I(l){return/^[\s\xa0]*$/.test(l)}function N(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function M(l){return M[" "](l),l}M[" "]=function(){};var z=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function G(l,d,p){for(const w in l)d.call(p,l[w],w,l)}function x(l,d){for(const p in l)d.call(void 0,l[p],p,l)}function _(l){const d={};for(const p in l)d[p]=l[p];return d}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,d){let p,w;for(let V=1;V<arguments.length;V++){w=arguments[V];for(p in w)l[p]=w[p];for(let $=0;$<E.length;$++)p=E[$],Object.prototype.hasOwnProperty.call(w,p)&&(l[p]=w[p])}}function j(l){var d=1;l=l.split(":");const p=[];for(;0<d&&l.length;)p.push(l.shift()),d--;return l.length&&p.push(l.join(":")),p}function L(l){c.setTimeout(()=>{throw l},0)}function S(){var l=ae;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class Je{constructor(){this.h=this.g=null}add(d,p){const w=oe.get();w.set(d,p),this.h?this.h.next=w:this.g=w,this.h=w}}var oe=new A(()=>new re,l=>l.reset());class re{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let We,Z=!1,ae=new Je,fe=()=>{const l=c.Promise.resolve(void 0);We=()=>{l.then(De)}};var De=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(p){L(p)}var d=oe;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}Z=!1};function Se(){this.s=this.s,this.C=this.C}Se.prototype.s=!1,Se.prototype.ma=function(){this.s||(this.s=!0,this.N())},Se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Fe(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}Fe.prototype.h=function(){this.defaultPrevented=!0};var on=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};c.addEventListener("test",p,d),c.removeEventListener("test",p,d)}catch{}return l}();function jn(l,d){if(Fe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(z){e:{try{M(d.nodeName);var V=!0;break e}catch{}V=!1}V||(d=null)}}else p=="mouseover"?d=l.fromElement:p=="mouseout"&&(d=l.toElement);this.relatedTarget=d,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:an[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&jn.aa.h.call(this)}}C(jn,Fe);var an={2:"touch",3:"pen",4:"mouse"};jn.prototype.h=function(){jn.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Mt="closure_listenable_"+(1e6*Math.random()|0),Rn=0;function vm(l,d,p,w,V){this.listener=l,this.proxy=null,this.src=d,this.type=p,this.capture=!!w,this.ha=V,this.key=++Rn,this.da=this.fa=!1}function Dn(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ks(l){this.src=l,this.g={},this.h=0}Ks.prototype.add=function(l,d,p,w,V){var $=l.toString();l=this.g[$],l||(l=this.g[$]=[],this.h++);var te=Qs(l,d,w,V);return-1<te?(d=l[te],p||(d.fa=!1)):(d=new vm(d,this.src,$,!!w,V),d.fa=p,l.push(d)),d};function qn(l,d){var p=d.type;if(p in l.g){var w=l.g[p],V=Array.prototype.indexOf.call(w,d,void 0),$;($=0<=V)&&Array.prototype.splice.call(w,V,1),$&&(Dn(d),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Qs(l,d,p,w){for(var V=0;V<l.length;++V){var $=l[V];if(!$.da&&$.listener==d&&$.capture==!!p&&$.ha==w)return V}return-1}var is="closure_lm_"+(1e6*Math.random()|0),Fi={};function os(l,d,p,w,V){if(Array.isArray(d)){for(var $=0;$<d.length;$++)os(l,d[$],p,w,V);return null}return p=Wi(p),l&&l[Mt]?l.K(d,p,h(w)?!!w.capture:!1,V):zi(l,d,p,!1,w,V)}function zi(l,d,p,w,V,$){if(!d)throw Error("Invalid event type");var te=h(V)?!!V.capture:!!V,Xe=Bi(l);if(Xe||(l[is]=Xe=new Ks(l)),p=Xe.add(d,p,w,te,$),p.proxy)return p;if(w=Ys(),p.proxy=w,w.src=l,w.listener=p,l.addEventListener)on||(V=te),V===void 0&&(V=!1),l.addEventListener(d.toString(),w,V);else if(l.attachEvent)l.attachEvent($i(d.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Ys(){function l(p){return d.call(l.src,l.listener,p)}const d=as;return l}function Kn(l,d,p,w,V){if(Array.isArray(d))for(var $=0;$<d.length;$++)Kn(l,d[$],p,w,V);else w=h(w)?!!w.capture:!!w,p=Wi(p),l&&l[Mt]?(l=l.i,d=String(d).toString(),d in l.g&&($=l.g[d],p=Qs($,p,w,V),-1<p&&(Dn($[p]),Array.prototype.splice.call($,p,1),$.length==0&&(delete l.g[d],l.h--)))):l&&(l=Bi(l))&&(d=l.g[d.toString()],l=-1,d&&(l=Qs(d,p,w,V)),(p=-1<l?d[l]:null)&&Ui(p))}function Ui(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[Mt])qn(d.i,l);else{var p=l.type,w=l.proxy;d.removeEventListener?d.removeEventListener(p,w,l.capture):d.detachEvent?d.detachEvent($i(p),w):d.addListener&&d.removeListener&&d.removeListener(w),(p=Bi(d))?(qn(p,l),p.h==0&&(p.src=null,d[is]=null)):Dn(l)}}}function $i(l){return l in Fi?Fi[l]:Fi[l]="on"+l}function as(l,d){if(l.da)l=!0;else{d=new jn(d,this);var p=l.listener,w=l.ha||l.src;l.fa&&Ui(l),l=p.call(w,d)}return l}function Bi(l){return l=l[is],l instanceof Ks?l:null}var Mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wi(l){return typeof l=="function"?l:(l[Mn]||(l[Mn]=function(d){return l.handleEvent(d)}),l[Mn])}function xt(){Se.call(this),this.i=new Ks(this),this.M=this,this.F=null}C(xt,Se),xt.prototype[Mt]=!0,xt.prototype.removeEventListener=function(l,d,p,w){Kn(this,l,d,p,w)};function It(l,d){var p,w=l.F;if(w)for(p=[];w;w=w.F)p.push(w);if(l=l.M,w=d.type||d,typeof d=="string")d=new Fe(d,l);else if(d instanceof Fe)d.target=d.target||l;else{var V=d;d=new Fe(w,l),T(d,V)}if(V=!0,p)for(var $=p.length-1;0<=$;$--){var te=d.g=p[$];V=se(te,w,!0,d)&&V}if(te=d.g=l,V=se(te,w,!0,d)&&V,V=se(te,w,!1,d)&&V,p)for($=0;$<p.length;$++)te=d.g=p[$],V=se(te,w,!1,d)&&V}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var p=l.g[d],w=0;w<p.length;w++)Dn(p[w]);delete l.g[d],l.h--}}this.F=null},xt.prototype.K=function(l,d,p,w){return this.i.add(String(l),d,!1,p,w)},xt.prototype.L=function(l,d,p,w){return this.i.add(String(l),d,!0,p,w)};function se(l,d,p,w){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var V=!0,$=0;$<d.length;++$){var te=d[$];if(te&&!te.da&&te.capture==p){var Xe=te.listener,Lt=te.ha||te.src;te.fa&&qn(l.i,te),V=Xe.call(Lt,w)!==!1&&V}}return V&&!w.defaultPrevented}function Qn(l,d,p){if(typeof l=="function")p&&(l=y(l,p));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(l,d||0)}function Ae(l){l.g=Qn(()=>{l.g=null,l.i&&(l.i=!1,Ae(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class hr extends Se{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function we(l){Se.call(this),this.h=l,this.g={}}C(we,Se);var fr=[];function Xs(l){G(l.g,function(d,p){this.g.hasOwnProperty(p)&&Ui(d)},l),l.g={}}we.prototype.N=function(){we.aa.N.call(this),Xs(this)},we.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hi=c.JSON.stringify,jr=c.JSON.parse,ra=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Ht(){}Ht.prototype.h=null;function ls(l){return l.h||(l.h=l.i())}function kn(){}var rt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fn(){Fe.call(this,"d")}C(fn,Fe);function Ln(){Fe.call(this,"c")}C(Ln,Fe);var pr={},Rr=null;function Js(){return Rr=Rr||new xt}pr.La="serverreachability";function sa(l){Fe.call(this,pr.La,l)}C(sa,Fe);function de(l){const d=Js();It(d,new sa(d))}pr.STAT_EVENT="statevent";function Ze(l,d){Fe.call(this,pr.STAT_EVENT,l),this.stat=d}C(Ze,Fe);function et(l){const d=Js();It(d,new Ze(d,l))}pr.Ma="timingevent";function pn(l,d){Fe.call(this,pr.Ma,l),this.size=d}C(pn,Fe);function ln(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},d)}function Ct(){this.g=!0}Ct.prototype.xa=function(){this.g=!1};function Dr(l,d,p,w,V,$){l.info(function(){if(l.g)if($)for(var te="",Xe=$.split("&"),Lt=0;Lt<Xe.length;Lt++){var Oe=Xe[Lt].split("=");if(1<Oe.length){var Kt=Oe[0];Oe=Oe[1];var Qt=Kt.split("_");te=2<=Qt.length&&Qt[1]=="type"?te+(Kt+"="+Oe+"&"):te+(Kt+"=redacted&")}}else te=null;else te=$;return"XMLHTTP REQ ("+w+") [attempt "+V+"]: "+d+`
`+p+`
`+te})}function ia(l,d,p,w,V,$,te){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+V+"]: "+d+`
`+p+`
`+$+" "+te})}function Qe(l,d,p,w){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+On(l,p)+(w?" "+w:"")})}function cs(l,d){l.info(function(){return"TIMEOUT: "+d})}Ct.prototype.info=function(){};function On(l,d){if(!l.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var w=p[l];if(!(2>w.length)){var V=w[1];if(Array.isArray(V)&&!(1>V.length)){var $=V[0];if($!="noop"&&$!="stop"&&$!="close")for(var te=1;te<V.length;te++)V[te]=""}}}}return Hi(p)}catch{return d}}var Zs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ei={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},oa;function Yn(){}C(Yn,Ht),Yn.prototype.g=function(){return new XMLHttpRequest},Yn.prototype.i=function(){return{}},oa=new Yn;function Xn(l,d,p,w){this.j=l,this.i=d,this.l=p,this.R=w||1,this.U=new we(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gi}function Gi(){this.i=null,this.g="",this.h=!1}var qi={},ti={};function ni(l,d,p){l.L=1,l.v=Qi(_t(d)),l.m=p,l.P=!0,Jn(l,null)}function Jn(l,d){l.F=Date.now(),us(l),l.A=_t(l.v);var p=l.A,w=l.R;Array.isArray(w)||(w=[String(w)]),Vn(p.i,"t",w),l.C=0,p=l.j.J,l.h=new Gi,l.g=mn(l.j,p?d:null,!l.m),0<l.O&&(l.M=new hr(y(l.Y,l,l.g),l.O)),d=l.U,p=l.g,w=l.ca;var V="readystatechange";Array.isArray(V)||(V&&(fr[0]=V.toString()),V=fr);for(var $=0;$<V.length;$++){var te=os(p,V[$],w||d.handleEvent,!1,d.h||d);if(!te)break;d.g[te.key]=te}d=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),de(),Dr(l.i,l.u,l.A,l.l,l.R,l.m)}Xn.prototype.ca=function(l){l=l.target;const d=this.M;d&&O(l)==3?d.j():this.Y(l)},Xn.prototype.Y=function(l){try{if(l==this.g)e:{const Qt=O(this.g);var d=this.g.Ba();const Ji=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||B(this.g)))){this.J||Qt!=4||d==7||(d==8||0>=Ji?de(3):de(2)),Ki(this);var p=this.g.Z();this.X=p;t:if(Ul(this)){var w=B(this.g);l="";var V=w.length,$=O(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pt(this),je(this);var te="";break t}this.h.i=new c.TextDecoder}for(d=0;d<V;d++)this.h.h=!0,l+=this.h.i.decode(w[d],{stream:!($&&d==V-1)});w.length=0,this.h.g+=l,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=p==200,ia(this.i,this.u,this.A,this.l,this.R,Qt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Xe,Lt=this.g;if((Xe=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(Xe)){var Oe=Xe;break t}}Oe=null}if(p=Oe)Qe(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$l(this,p);else{this.o=!1,this.s=3,et(12),pt(this),je(this);break e}}if(this.P){p=!0;let nr;for(;!this.J&&this.C<te.length;)if(nr=aa(this,te),nr==ti){Qt==4&&(this.s=4,et(14),p=!1),Qe(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==qi){this.s=4,et(15),Qe(this.i,this.l,te,"[Invalid Chunk]"),p=!1;break}else Qe(this.i,this.l,nr,null),$l(this,nr);if(Ul(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||te.length!=0||this.h.h||(this.s=1,et(16),p=!1),this.o=this.o&&p,!p)Qe(this.i,this.l,te,"[Invalid Chunked Response]"),pt(this),je(this);else if(0<te.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),lt(Kt),Kt.M=!0,et(11))}}else Qe(this.i,this.l,te,null),$l(this,te);Qt==4&&pt(this),this.o&&!this.J&&(Qt==4?st(this.j,this):(this.o=!1,us(this)))}else U(this.g),p==400&&0<te.indexOf("Unknown SID")?(this.s=3,et(12)):(this.s=0,et(13)),pt(this),je(this)}}}catch{}finally{}};function Ul(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function aa(l,d){var p=l.C,w=d.indexOf(`
`,p);return w==-1?ti:(p=Number(d.substring(p,w)),isNaN(p)?qi:(w+=1,w+p>d.length?ti:(d=d.slice(w,w+p),l.C=w+p,d)))}Xn.prototype.cancel=function(){this.J=!0,pt(this)};function us(l){l.S=Date.now()+l.I,la(l,l.I)}function la(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ln(y(l.ba,l),d)}function Ki(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Xn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(cs(this.i,this.A),this.L!=2&&(de(),et(17)),pt(this),this.s=2,je(this)):la(this,this.S-l)};function je(l){l.j.G==0||l.J||st(l.j,l)}function pt(l){Ki(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,Xs(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function $l(l,d){try{var p=l.j;if(p.G!=0&&(p.g==l||mr(p.h,l))){if(!l.K&&mr(p.h,l)&&p.G==3){try{var w=p.Da.g.parse(d)}catch{w=null}if(Array.isArray(w)&&w.length==3){var V=w;if(V[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)me(p),J(p);else break e;ze(p),et(18)}}else p.za=V[1],0<p.za-p.T&&37500>V[2]&&p.F&&p.v==0&&!p.C&&(p.C=ln(y(p.Za,p),6e3));if(1>=hs(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else be(p,11)}else if((l.K||p.g==l)&&me(p),!I(d))for(V=p.Da.g.parse(d),d=0;d<V.length;d++){let Oe=V[d];if(p.T=Oe[0],Oe=Oe[1],p.G==2)if(Oe[0]=="c"){p.K=Oe[1],p.ia=Oe[2];const Kt=Oe[3];Kt!=null&&(p.la=Kt,p.j.info("VER="+p.la));const Qt=Oe[4];Qt!=null&&(p.Aa=Qt,p.j.info("SVER="+p.Aa));const Ji=Oe[5];Ji!=null&&typeof Ji=="number"&&0<Ji&&(w=1.5*Ji,p.L=w,p.j.info("backChannelRequestTimeoutMs_="+w)),w=p;const nr=l.g;if(nr){const ec=nr.g?nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var $=w.h;$.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(ri($,$.h),$.h=null))}if(w.D){const xd=nr.g?nr.g.getResponseHeader("X-HTTP-Session-Id"):null;xd&&(w.ya=xd,Ye(w.I,w.D,xd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),w=p;var te=l;if(w.qa=tt(w,w.J?w.ia:null,w.W),te.K){ca(w.h,te);var Xe=te,Lt=w.L;Lt&&(Xe.I=Lt),Xe.B&&(Ki(Xe),us(Xe)),w.g=te}else wt(w);0<p.i.length&&Y(p)}else Oe[0]!="stop"&&Oe[0]!="close"||be(p,7);else p.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?be(p,7):ee(p):Oe[0]!="noop"&&p.l&&p.l.ta(Oe),p.v=0)}}de(4)}catch{}}var xm=class{constructor(l,d){this.g=l,this.map=d}};function ds(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function In(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function hs(l){return l.h?1:l.g?l.g.size:0}function mr(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function ri(l,d){l.g?l.g.add(d):l.h=d}function ca(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}ds.prototype.cancel=function(){if(this.i=ua(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ua(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const p of l.g.values())d=d.concat(p.D);return d}return R(l.i)}function da(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var d=[],p=l.length,w=0;w<p;w++)d.push(l[w]);return d}d=[],p=0;for(w in l)d[p++]=l[w];return d}function Gt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var d=[];l=l.length;for(var p=0;p<l;p++)d.push(p);return d}d=[],p=0;for(const w in l)d[p++]=w;return d}}}function Zn(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var p=Gt(l),w=da(l),V=w.length,$=0;$<V;$++)d.call(void 0,w[$],p&&p[$],l)}var Bl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mr(l,d){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var w=l[p].indexOf("="),V=null;if(0<=w){var $=l[p].substring(0,w);V=l[p].substring(w+1)}else $=l[p];d($,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function er(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof er){this.h=l.h,si(this,l.j),this.o=l.o,this.g=l.g,qt(this,l.s),this.l=l.l;var d=l.i,p=new ai;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),Wl(this,p),this.m=l.m}else l&&(d=String(l).match(Bl))?(this.h=!1,si(this,d[1]||"",!0),this.o=ii(d[2]||""),this.g=ii(d[3]||"",!0),qt(this,d[4]),this.l=ii(d[5]||"",!0),Wl(this,d[6]||"",!0),this.m=ii(d[7]||"")):(this.h=!1,this.i=new ai(null,this.h))}er.prototype.toString=function(){var l=[],d=this.j;d&&l.push(oi(d,Hl,!0),":");var p=this.g;return(p||d=="file")&&(l.push("//"),(d=this.o)&&l.push(oi(d,Hl,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(oi(p,p.charAt(0)=="/"?gd:md,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",oi(p,Gl)),l.join("")};function _t(l){return new er(l)}function si(l,d,p){l.j=p?ii(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function qt(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function Wl(l,d,p){d instanceof ai?(l.i=d,Kl(l.i,l.h)):(p||(d=oi(d,yd)),l.i=new ai(d,l.h))}function Ye(l,d,p){l.i.set(d,p)}function Qi(l){return Ye(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ii(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function oi(l,d,p){return typeof l=="string"?(l=encodeURI(l).replace(d,pd),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function pd(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Hl=/[#\/\?@]/g,md=/[#\?:]/g,gd=/[#\?]/g,yd=/[#\?@]/g,Gl=/#/g;function ai(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function tr(l){l.g||(l.g=new Map,l.h=0,l.i&&Mr(l.i,function(d,p){l.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}t=ai.prototype,t.add=function(l,d){tr(this),this.i=null,l=Lr(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(d),this.h+=1,this};function Yi(l,d){tr(l),d=Lr(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function ql(l,d){return tr(l),d=Lr(l,d),l.g.has(d)}t.forEach=function(l,d){tr(this),this.g.forEach(function(p,w){p.forEach(function(V){l.call(d,V,w,this)},this)},this)},t.na=function(){tr(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let w=0;w<d.length;w++){const V=l[w];for(let $=0;$<V.length;$++)p.push(d[w])}return p},t.V=function(l){tr(this);let d=[];if(typeof l=="string")ql(this,l)&&(d=d.concat(this.g.get(Lr(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)d=d.concat(l[p])}return d},t.set=function(l,d){return tr(this),this.i=null,l=Lr(this,l),ql(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function Vn(l,d,p){Yi(l,d),0<p.length&&(l.i=null,l.g.set(Lr(l,d),R(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var w=d[p];const $=encodeURIComponent(String(w)),te=this.V(w);for(w=0;w<te.length;w++){var V=$;te[w]!==""&&(V+="="+encodeURIComponent(String(te[w]))),l.push(V)}}return this.i=l.join("&")};function Lr(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function Kl(l,d){d&&!l.j&&(tr(l),l.i=null,l.g.forEach(function(p,w){var V=w.toLowerCase();w!=V&&(Yi(this,w),Vn(this,V,p))},l)),l.j=d}function Ql(l,d){const p=new Ct;if(c.Image){const w=new Image;w.onload=k(gr,p,"TestLoadImage: loaded",!0,d,w),w.onerror=k(gr,p,"TestLoadImage: error",!1,d,w),w.onabort=k(gr,p,"TestLoadImage: abort",!1,d,w),w.ontimeout=k(gr,p,"TestLoadImage: timeout",!1,d,w),c.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else d(!1)}function vd(l,d){const p=new Ct,w=new AbortController,V=setTimeout(()=>{w.abort(),gr(p,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:w.signal}).then($=>{clearTimeout(V),$.ok?gr(p,"TestPingServer: ok",!0,d):gr(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(V),gr(p,"TestPingServer: error",!1,d)})}function gr(l,d,p,w,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),w(p)}catch{}}function Yl(){this.g=new ra}function ha(l,d,p){const w=p||"";try{Zn(l,function(V,$){let te=V;h(V)&&(te=Hi(V)),d.push(w+$+"="+encodeURIComponent(te))})}catch(V){throw d.push(w+"type="+encodeURIComponent("_badmap")),V}}function li(l){this.l=l.Ub||null,this.j=l.eb||!1}C(li,Ht),li.prototype.g=function(){return new Xi(this.l,this.j)},li.prototype.i=function(l){return function(){return l}}({});function Xi(l,d){xt.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Xi,xt),t=Xi.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,ui(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ci(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ui(this)),this.g&&(this.readyState=3,ui(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xl(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xl(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?ci(this):ui(this),this.readyState==3&&Xl(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,ci(this))},t.Qa=function(l){this.g&&(this.response=l,ci(this))},t.ga=function(){this.g&&ci(this)};function ci(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ui(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=d.next();return l.join(`\r
`)};function ui(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Xi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Jl(l){let d="";return G(l,function(p,w){d+=w,d+=":",d+=p,d+=`\r
`}),d}function He(l,d,p){e:{for(w in p){var w=!1;break e}w=!0}w||(p=Jl(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Ye(l,d,p))}function _e(l){xt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(_e,xt);var Tt=/^https?$/i,Zl=["POST","PUT"];t=_e.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,p,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():oa.g(),this.v=this.o?ls(this.o):ls(oa),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch($){f(this,$);return}if(l=p||"",p=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var V in w)p.set(V,w[V]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const $ of w.keys())p.set($,w.get($));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(p.keys()).find($=>$.toLowerCase()=="content-type"),V=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Zl,d,void 0))||w||V||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,te]of p)this.g.setRequestHeader($,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{F(this),this.u=!0,this.g.send(l),this.u=!1}catch($){f(this,$)}};function f(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,v(l),P(l)}function v(l){l.A||(l.A=!0,It(l,"complete"),It(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,It(this,"complete"),It(this,"abort"),P(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),P(this,!0)),_e.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?b(this):this.bb())},t.bb=function(){b(this)};function b(l){if(l.h&&typeof o<"u"&&(!l.v[1]||O(l)!=4||l.Z()!=2)){if(l.u&&O(l)==4)Qn(l.Ea,0,l);else if(It(l,"readystatechange"),O(l)==4){l.h=!1;try{const te=l.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var w;if(w=te===0){var V=String(l.D).match(Bl)[1]||null;!V&&c.self&&c.self.location&&(V=c.self.location.protocol.slice(0,-1)),w=!Tt.test(V?V.toLowerCase():"")}p=w}if(p)It(l,"complete"),It(l,"success");else{l.m=6;try{var $=2<O(l)?l.g.statusText:""}catch{$=""}l.l=$+" ["+l.Z()+"]",v(l)}}finally{P(l)}}}}function P(l,d){if(l.g){F(l);const p=l.g,w=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||It(l,"ready");try{p.onreadystatechange=w}catch{}}}function F(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function O(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<O(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),jr(d)}};function B(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function U(l){const d={};l=(l.g&&2<=O(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(I(l[w]))continue;var p=j(l[w]);const V=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const $=d[V]||[];d[V]=$,$.push(p)}x(d,function(w){return w.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Q(l,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||d}function W(l){this.Aa=0,this.i=[],this.j=new Ct,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Q("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Q("baseRetryDelayMs",5e3,l),this.cb=Q("retryDelaySeedMs",1e4,l),this.Wa=Q("forwardChannelMaxRetries",2,l),this.wa=Q("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new ds(l&&l.concurrentRequestLimit),this.Da=new Yl,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=W.prototype,t.la=8,t.G=1,t.connect=function(l,d,p,w){et(0),this.W=l,this.H=d||{},p&&w!==void 0&&(this.H.OSID=p,this.H.OAID=w),this.F=this.X,this.I=tt(this,null,this.W),Y(this)};function ee(l){if(le(l),l.G==3){var d=l.U++,p=_t(l.I);if(Ye(p,"SID",l.K),Ye(p,"RID",d),Ye(p,"TYPE","terminate"),Ge(l,p),d=new Xn(l,l.j,d),d.L=2,d.v=Qi(_t(p)),p=!1,c.navigator&&c.navigator.sendBeacon)try{p=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&c.Image&&(new Image().src=d.v,p=!0),p||(d.g=mn(d.j,null),d.g.ea(d.v)),d.F=Date.now(),us(d)}Ke(l)}function J(l){l.g&&(lt(l),l.g.cancel(),l.g=null)}function le(l){J(l),l.u&&(c.clearTimeout(l.u),l.u=null),me(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Y(l){if(!In(l.h)&&!l.s){l.s=!0;var d=l.Ga;We||fe(),Z||(We(),Z=!0),ae.add(d,l),l.B=0}}function Ie(l,d){return hs(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ln(y(l.Ga,l,d),qe(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const V=new Xn(this,this.j,l);let $=this.o;if(this.S&&($?($=_($),T($,this.S)):$=this.S),this.m!==null||this.O||(V.H=$,$=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var w=this.i[p];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(d+=w,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=Me(this,V,d),p=_t(this.I),Ye(p,"RID",l),Ye(p,"CVER",22),this.D&&Ye(p,"X-HTTP-Session-Id",this.D),Ge(this,p),$&&(this.O?d="headers="+encodeURIComponent(String(Jl($)))+"&"+d:this.m&&He(p,this.m,$)),ri(this.h,V),this.Ua&&Ye(p,"TYPE","init"),this.P?(Ye(p,"$req",d),Ye(p,"SID","null"),V.T=!0,ni(V,p,null)):ni(V,p,d),this.G=2}}else this.G==3&&(l?Ee(this,l):this.i.length==0||In(this.h)||Ee(this))};function Ee(l,d){var p;d?p=d.l:p=l.U++;const w=_t(l.I);Ye(w,"SID",l.K),Ye(w,"RID",p),Ye(w,"AID",l.T),Ge(l,w),l.m&&l.o&&He(w,l.m,l.o),p=new Xn(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),d&&(l.i=d.D.concat(l.i)),d=Me(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),ri(l.h,p),ni(p,w,d)}function Ge(l,d){l.H&&G(l.H,function(p,w){Ye(d,w,p)}),l.l&&Zn({},function(p,w){Ye(d,w,p)})}function Me(l,d,p){p=Math.min(l.i.length,p);var w=l.l?y(l.l.Na,l.l,l):null;e:{var V=l.i;let $=-1;for(;;){const te=["count="+p];$==-1?0<p?($=V[0].g,te.push("ofs="+$)):$=0:te.push("ofs="+$);let Xe=!0;for(let Lt=0;Lt<p;Lt++){let Oe=V[Lt].g;const Kt=V[Lt].map;if(Oe-=$,0>Oe)$=Math.max(0,V[Lt].g-100),Xe=!1;else try{ha(Kt,te,"req"+Oe+"_")}catch{w&&w(Kt)}}if(Xe){w=te.join("&");break e}}}return l=l.i.splice(0,p),d.D=l,w}function wt(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;We||fe(),Z||(We(),Z=!0),ae.add(d,l),l.v=0}}function ze(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ln(y(l.Fa,l),qe(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,ne(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ln(y(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,et(10),J(this),ne(this))};function lt(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function ne(l){l.g=new Xn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=_t(l.qa);Ye(d,"RID","rpc"),Ye(d,"SID",l.K),Ye(d,"AID",l.T),Ye(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ye(d,"TO",l.ja),Ye(d,"TYPE","xmlhttp"),Ge(l,d),l.m&&l.o&&He(d,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Qi(_t(d)),p.m=null,p.P=!0,Jn(p,l)}t.Za=function(){this.C!=null&&(this.C=null,J(this),ze(this),et(19))};function me(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function st(l,d){var p=null;if(l.g==d){me(l),lt(l),l.g=null;var w=2}else if(mr(l.h,d))p=d.D,ca(l.h,d),w=1;else return;if(l.G!=0){if(d.o)if(w==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var V=l.B;w=Js(),It(w,new pn(w,p)),Y(l)}else wt(l);else if(V=d.s,V==3||V==0&&0<d.X||!(w==1&&Ie(l,d)||w==2&&ze(l)))switch(p&&0<p.length&&(d=l.h,d.i=d.i.concat(p)),V){case 1:be(l,5);break;case 4:be(l,10);break;case 3:be(l,6);break;default:be(l,2)}}}function qe(l,d){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*d}function be(l,d){if(l.j.info("Error code "+d),d==2){var p=y(l.fb,l),w=l.Xa;const V=!w;w=new er(w||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||si(w,"https"),Qi(w),V?Ql(w.toString(),p):vd(w.toString(),p)}else et(2);l.G=0,l.l&&l.l.sa(d),Ke(l),le(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function Ke(l){if(l.G=0,l.ka=[],l.l){const d=ua(l.h);(d.length!=0||l.i.length!=0)&&(D(l.ka,d),D(l.ka,l.i),l.h.i.length=0,R(l.i),l.i.length=0),l.l.ra()}}function tt(l,d,p){var w=p instanceof er?_t(p):new er(p);if(w.g!="")d&&(w.g=d+"."+w.g),qt(w,w.s);else{var V=c.location;w=V.protocol,d=d?d+"."+V.hostname:V.hostname,V=+V.port;var $=new er(null);w&&si($,w),d&&($.g=d),V&&qt($,V),p&&($.l=p),w=$}return p=l.D,d=l.ya,p&&d&&Ye(w,p,d),Ye(w,"VER",l.la),Ge(l,w),w}function mn(l,d,p){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new _e(new li({eb:p})):new _e(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gn(){}t=gn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fn(){}Fn.prototype.g=function(l,d){return new Le(l,d)};function Le(l,d){xt.call(this),this.g=new W(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!I(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!I(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new Or(this)}C(Le,xt),Le.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Le.prototype.close=function(){ee(this.g)},Le.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Hi(l),l=p);d.i.push(new xm(d.Ya++,l)),d.G==3&&Y(d)},Le.prototype.N=function(){this.g.l=null,delete this.j,ee(this.g),delete this.g,Le.aa.N.call(this)};function mt(l){fn.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const p in d){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}C(mt,fn);function di(){Ln.call(this),this.status=1}C(di,Ln);function Or(l){this.g=l}C(Or,gn),Or.prototype.ua=function(){It(this.g,"a")},Or.prototype.ta=function(l){It(this.g,new mt(l))},Or.prototype.sa=function(l){It(this.g,new di)},Or.prototype.ra=function(){It(this.g,"b")},Fn.prototype.createWebChannel=Fn.prototype.g,Le.prototype.send=Le.prototype.o,Le.prototype.open=Le.prototype.m,Le.prototype.close=Le.prototype.close,j_=function(){return new Fn},P_=function(){return Js()},C_=pr,ff={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zs.NO_ERROR=0,Zs.TIMEOUT=8,Zs.HTTP_ERROR=6,Uc=Zs,ei.COMPLETE="complete",A_=ei,kn.EventType=rt,rt.OPEN="a",rt.CLOSE="b",rt.ERROR="c",rt.MESSAGE="d",xt.prototype.listen=xt.prototype.K,Sa=kn,_e.prototype.listenOnce=_e.prototype.L,_e.prototype.getLastError=_e.prototype.Ka,_e.prototype.getLastErrorCode=_e.prototype.Ba,_e.prototype.getStatus=_e.prototype.Z,_e.prototype.getResponseJson=_e.prototype.Oa,_e.prototype.getResponseText=_e.prototype.oa,_e.prototype.send=_e.prototype.ea,_e.prototype.setWithCredentials=_e.prototype.Ha,N_=_e}).apply(typeof xc<"u"?xc:typeof self<"u"?self:typeof window<"u"?window:{});const fy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zt.UNAUTHENTICATED=new Zt(null),Zt.GOOGLE_CREDENTIALS=new Zt("google-credentials-uid"),Zt.FIRST_PARTY=new Zt("first-party-uid"),Zt.MOCK_USER=new Zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new Sp("@firebase/firestore");function wa(){return ji.logLevel}function ce(t,...e){if(ji.logLevel<=Ce.DEBUG){const n=e.map(zp);ji.debug(`Firestore (${Jo}): ${t}`,...n)}}function ts(t,...e){if(ji.logLevel<=Ce.ERROR){const n=e.map(zp);ji.error(`Firestore (${Jo}): ${t}`,...n)}}function Fo(t,...e){if(ji.logLevel<=Ce.WARN){const n=e.map(zp);ji.warn(`Firestore (${Jo}): ${t}`,...n)}}function zp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(t="Unexpected state"){const e=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: `+t;throw ts(e),new Error(e)}function Be(t,e){t||ye()}function xe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends ss{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zt.UNAUTHENTICATED))}shutdown(){}}class q2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class K2{constructor(e){this.t=e,this.currentUser=Zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Be(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new bi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new bi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new bi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Be(typeof r.accessToken=="string"),new R_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Be(e===null||typeof e=="string"),new Zt(e)}}class Q2{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Y2{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Q2(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class X2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Be(this.o===void 0);const r=i=>{i.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Be(typeof n.token=="string"),this.R=n.token,new X2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Z2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ve(t,e){return t<e?-1:t>e?1:0}function zo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ue(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return At.fromMillis(Date.now())}static fromDate(e){return At.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new At(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new At(0,0))}static max(){return new ve(new At(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n,r){n===void 0?n=0:n>e.length&&ye(),r===void 0?r=e.length-n:r>e.length-n&&ye(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return hl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof hl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ot extends hl{construct(e,n,r){return new ot(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ot(n)}static emptyPath(){return new ot([])}}const eS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends hl{construct(e,n,r){return new zt(e,n,r)}static isValidIdentifier(e){return eS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new ue(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ue(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new ue(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(n)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(ot.fromString(e))}static fromName(e){return new pe(ot.fromString(e).popFirst(5))}static empty(){return new pe(ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ot.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ot.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new ot(e.slice()))}}function tS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new At(n+1,0):new At(n,r));return new $s(s,pe.empty(),e)}function nS(t){return new $s(t.readTime,t.key,-1)}class $s{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $s(ve.min(),pe.empty(),-1)}static max(){return new $s(ve.max(),pe.empty(),-1)}}function rS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=pe.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dl(t){if(t.code!==q.FAILED_PRECONDITION||t.message!==sS)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ye(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(s=>s?K.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new K((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(m=>{o[h]=m,++c,c===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new K((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function oS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ml(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Up.oe=-1;function rd(t){return t==null}function Su(t){return t===0&&1/t==-1/0}function aS(t){return typeof t=="number"&&Number.isInteger(t)&&!Su(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function M_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){this.comparator=e,this.root=n||Ft.EMPTY}insert(e,n){return new ft(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ft.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _c(this.root,e,this.comparator,!1)}getReverseIterator(){return new _c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _c(this.root,e,this.comparator,!0)}}class _c{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ft.RED,this.left=s??Ft.EMPTY,this.right=i??Ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ft.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ye();const e=this.left.check();if(e!==this.right.check())throw ye();return e+(this.isRed()?0:1)}}Ft.EMPTY=null,Ft.RED=!0,Ft.BLACK=!1;Ft.EMPTY=new class{constructor(){this.size=0}get key(){throw ye()}get value(){throw ye()}get color(){throw ye()}get left(){throw ye()}get right(){throw ye()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new my(this.data.getIterator())}getIteratorFrom(e){return new my(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $t(this.comparator);return n.data=e,n}}class my{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new ar([])}unionWith(e){let n=new $t(zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ar(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new L_("Invalid base64 string: "+i):i}}(e);return new Wt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Wt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const lS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(t){if(Be(!!t),typeof t=="string"){let e=0;const n=lS.exec(t);if(Be(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ri(t){return typeof t=="string"?Wt.fromBase64String(t):Wt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Bp(t){const e=t.mapValue.fields.__previous_value__;return $p(e)?Bp(e):e}function fl(t){const e=Bs(t.mapValue.fields.__local_write_time__.timestampValue);return new At(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,n,r,s,i,o,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class pl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new pl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof pl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wc={mapValue:{}};function Di(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$p(t)?4:dS(t)?9007199254740991:uS(t)?10:11:ye()}function Pr(t,e){if(t===e)return!0;const n=Di(t);if(n!==Di(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fl(t).isEqual(fl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Bs(s.timestampValue),c=Bs(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ri(s.bytesValue).isEqual(Ri(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return yt(s.geoPointValue.latitude)===yt(i.geoPointValue.latitude)&&yt(s.geoPointValue.longitude)===yt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return yt(s.integerValue)===yt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=yt(s.doubleValue),c=yt(i.doubleValue);return o===c?Su(o)===Su(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return zo(t.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(py(o)!==py(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Pr(o[u],c[u])))return!1;return!0}(t,e);default:return ye()}}function ml(t,e){return(t.values||[]).find(n=>Pr(n,e))!==void 0}function Uo(t,e){if(t===e)return 0;const n=Di(t),r=Di(e);if(n!==r)return Ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=yt(i.integerValue||i.doubleValue),u=yt(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return gy(t.timestampValue,e.timestampValue);case 4:return gy(fl(t),fl(e));case 5:return Ve(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Ri(i),u=Ri(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const m=Ve(c[h],u[h]);if(m!==0)return m}return Ve(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=Ve(yt(i.latitude),yt(o.latitude));return c!==0?c:Ve(yt(i.longitude),yt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,u,h,m;const g=i.fields||{},y=o.fields||{},k=(c=g.value)===null||c===void 0?void 0:c.arrayValue,C=(u=y.value)===null||u===void 0?void 0:u.arrayValue,R=Ve(((h=k==null?void 0:k.values)===null||h===void 0?void 0:h.length)||0,((m=C==null?void 0:C.values)===null||m===void 0?void 0:m.length)||0);return R!==0?R:yy(k,C)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===wc.mapValue&&o===wc.mapValue)return 0;if(i===wc.mapValue)return 1;if(o===wc.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},m=Object.keys(h);u.sort(),m.sort();for(let g=0;g<u.length&&g<m.length;++g){const y=Ve(u[g],m[g]);if(y!==0)return y;const k=Uo(c[u[g]],h[m[g]]);if(k!==0)return k}return Ve(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ye()}}function gy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=Bs(t),r=Bs(e),s=Ve(n.seconds,r.seconds);return s!==0?s:Ve(n.nanos,r.nanos)}function yy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Uo(n[s],r[s]);if(i)return i}return Ve(n.length,r.length)}function $o(t){return pf(t)}function pf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Bs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ri(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return pe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=pf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${pf(n.fields[o])}`;return s+"}"}(t.mapValue):ye()}function vy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mf(t){return!!t&&"integerValue"in t}function Wp(t){return!!t&&"arrayValue"in t}function xy(t){return!!t&&"nullValue"in t}function _y(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $c(t){return!!t&&"mapValue"in t}function uS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function $a(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Zo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=$a(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$a(t.arrayValue.values[n]);return e}return Object.assign({},t)}function dS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$c(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$a(n)}setAll(e){let n=zt.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=$a(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$c(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Pr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$c(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Zo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new $n($a(this.value))}}function O_(t){const e=[];return Zo(t.fields,(n,r)=>{const s=new zt([n]);if($c(r)){const i=O_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ar(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new tn(e,0,ve.min(),ve.min(),ve.min(),$n.empty(),0)}static newFoundDocument(e,n,r,s){return new tn(e,1,n,ve.min(),r,s,0)}static newNoDocument(e,n){return new tn(e,2,n,ve.min(),ve.min(),$n.empty(),0)}static newUnknownDocument(e,n){return new tn(e,3,n,ve.min(),ve.min(),$n.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.position=e,this.inclusive=n}}function wy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=pe.comparator(pe.fromName(o.referenceValue),n.key):r=Uo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ey(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n="asc"){this.field=e,this.dir=n}}function hS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{}class kt extends V_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new pS(e,n,r):n==="array-contains"?new yS(e,r):n==="in"?new vS(e,r):n==="not-in"?new xS(e,r):n==="array-contains-any"?new _S(e,r):new kt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new mS(e,r):new gS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Uo(n,this.value)):n!==null&&Di(this.value)===Di(n)&&this.matchesComparison(Uo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dr extends V_{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new dr(e,n)}matches(e){return F_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function F_(t){return t.op==="and"}function z_(t){return fS(t)&&F_(t)}function fS(t){for(const e of t.filters)if(e instanceof dr)return!1;return!0}function gf(t){if(t instanceof kt)return t.field.canonicalString()+t.op.toString()+$o(t.value);if(z_(t))return t.filters.map(e=>gf(e)).join(",");{const e=t.filters.map(n=>gf(n)).join(",");return`${t.op}(${e})`}}function U_(t,e){return t instanceof kt?function(r,s){return s instanceof kt&&r.op===s.op&&r.field.isEqual(s.field)&&Pr(r.value,s.value)}(t,e):t instanceof dr?function(r,s){return s instanceof dr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&U_(o,s.filters[c]),!0):!1}(t,e):void ye()}function $_(t){return t instanceof kt?function(n){return`${n.field.canonicalString()} ${n.op} ${$o(n.value)}`}(t):t instanceof dr?function(n){return n.op.toString()+" {"+n.getFilters().map($_).join(" ,")+"}"}(t):"Filter"}class pS extends kt{constructor(e,n,r){super(e,n,r),this.key=pe.fromName(r.referenceValue)}matches(e){const n=pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class mS extends kt{constructor(e,n){super(e,"in",n),this.keys=B_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class gS extends kt{constructor(e,n){super(e,"not-in",n),this.keys=B_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function B_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>pe.fromName(r.referenceValue))}class yS extends kt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Wp(n)&&ml(n.arrayValue,this.value)}}class vS extends kt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ml(this.value.arrayValue,n)}}class xS extends kt{constructor(e,n){super(e,"not-in",n)}matches(e){if(ml(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ml(this.value.arrayValue,n)}}class _S extends kt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Wp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ml(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}}function by(t,e=null,n=[],r=[],s=null,i=null,o=null){return new wS(t,e,n,r,s,i,o)}function Hp(t){const e=xe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),rd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$o(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$o(r)).join(",")),e.ue=n}return e.ue}function Gp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!hS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!U_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ey(t.startAt,e.startAt)&&Ey(t.endAt,e.endAt)}function yf(t){return pe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ES(t,e,n,r,s,i,o,c){return new Ll(t,e,n,r,s,i,o,c)}function qp(t){return new Ll(t)}function ky(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function W_(t){return t.collectionGroup!==null}function Ba(t){const e=xe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new $t(zt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Au(i,r))}),n.has(zt.keyField().canonicalString())||e.ce.push(new Au(zt.keyField(),r))}return e.ce}function Nr(t){const e=xe(t);return e.le||(e.le=bS(e,Ba(t))),e.le}function bS(t,e){if(t.limitType==="F")return by(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Au(s.field,i)});const n=t.endAt?new Nu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nu(t.startAt.position,t.startAt.inclusive):null;return by(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vf(t,e){const n=t.filters.concat([e]);return new Ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function xf(t,e,n){return new Ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function sd(t,e){return Gp(Nr(t),Nr(e))&&t.limitType===e.limitType}function H_(t){return`${Hp(Nr(t))}|lt:${t.limitType}`}function eo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>$_(s)).join(", ")}]`),rd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$o(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$o(s)).join(",")),`Target(${r})`}(Nr(t))}; limitType=${t.limitType})`}function id(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):pe.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Ba(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const h=wy(o,c,u);return o.inclusive?h<=0:h<0}(r.startAt,Ba(r),s)||r.endAt&&!function(o,c,u){const h=wy(o,c,u);return o.inclusive?h>=0:h>0}(r.endAt,Ba(r),s))}(t,e)}function kS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function G_(t){return(e,n)=>{let r=!1;for(const s of Ba(t)){const i=IS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function IS(t,e,n){const r=t.field.isKeyField()?pe.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?Uo(u,h):ye()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ye()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Zo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return M_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS=new ft(pe.comparator);function ns(){return TS}const q_=new ft(pe.comparator);function Na(...t){let e=q_;for(const n of t)e=e.insert(n.key,n);return e}function K_(t){let e=q_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xi(){return Wa()}function Q_(){return Wa()}function Wa(){return new ea(t=>t.toString(),(t,e)=>t.isEqual(e))}const SS=new ft(pe.comparator),NS=new $t(pe.comparator);function Ne(...t){let e=NS;for(const n of t)e=e.add(n);return e}const AS=new $t(Ve);function CS(){return AS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Su(e)?"-0":e}}function Y_(t){return{integerValue:""+t}}function PS(t,e){return aS(e)?Y_(e):Kp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(){this._=void 0}}function jS(t,e,n){return t instanceof Cu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$p(i)&&(i=Bp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof gl?J_(t,e):t instanceof yl?Z_(t,e):function(s,i){const o=X_(s,i),c=Iy(o)+Iy(s.Pe);return mf(o)&&mf(s.Pe)?Y_(c):Kp(s.serializer,c)}(t,e)}function RS(t,e,n){return t instanceof gl?J_(t,e):t instanceof yl?Z_(t,e):n}function X_(t,e){return t instanceof Pu?function(r){return mf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Cu extends od{}class gl extends od{constructor(e){super(),this.elements=e}}function J_(t,e){const n=ew(e);for(const r of t.elements)n.some(s=>Pr(s,r))||n.push(r);return{arrayValue:{values:n}}}class yl extends od{constructor(e){super(),this.elements=e}}function Z_(t,e){let n=ew(e);for(const r of t.elements)n=n.filter(s=>!Pr(s,r));return{arrayValue:{values:n}}}class Pu extends od{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Iy(t){return yt(t.integerValue||t.doubleValue)}function ew(t){return Wp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function DS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof gl&&s instanceof gl||r instanceof yl&&s instanceof yl?zo(r.elements,s.elements,Pr):r instanceof Pu&&s instanceof Pu?Pr(r.Pe,s.Pe):r instanceof Cu&&s instanceof Cu}(t.transform,e.transform)}class MS{constructor(e,n){this.version=e,this.transformResults=n}}class Ar{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ar}static exists(e){return new Ar(void 0,e)}static updateTime(e){return new Ar(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ad{}function tw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Qp(t.key,Ar.none()):new Ol(t.key,t.data,Ar.none());{const n=t.data,r=$n.empty();let s=new $t(zt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Oi(t.key,r,new ar(s.toArray()),Ar.none())}}function LS(t,e,n){t instanceof Ol?function(s,i,o){const c=s.value.clone(),u=Sy(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Oi?function(s,i,o){if(!Bc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=Sy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(nw(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ha(t,e,n,r){return t instanceof Ol?function(i,o,c,u){if(!Bc(i.precondition,o))return c;const h=i.value.clone(),m=Ny(i.fieldTransforms,u,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Oi?function(i,o,c,u){if(!Bc(i.precondition,o))return c;const h=Ny(i.fieldTransforms,u,o),m=o.data;return m.setAll(nw(i)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,c){return Bc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function OS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=X_(r.transform,s||null);i!=null&&(n===null&&(n=$n.empty()),n.set(r.field,i))}return n||null}function Ty(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&zo(r,s,(i,o)=>DS(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ol extends ad{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Oi extends ad{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Sy(t,e,n){const r=new Map;Be(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,RS(o,c,n[s]))}return r}function Ny(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,jS(i,o,e))}return r}class Qp extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VS extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&LS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ha(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ha(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Q_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=tw(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&zo(this.mutations,e.mutations,(n,r)=>Ty(n,r))&&zo(this.baseMutations,e.baseMutations,(n,r)=>Ty(n,r))}}class Yp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Be(e.mutations.length===r.length);let s=function(){return SS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Yp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,Pe;function $S(t){switch(t){default:return ye();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0}}function rw(t){if(t===void 0)return ts("GRPC error has no .code"),q.UNKNOWN;switch(t){case Et.OK:return q.OK;case Et.CANCELLED:return q.CANCELLED;case Et.UNKNOWN:return q.UNKNOWN;case Et.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case Et.INTERNAL:return q.INTERNAL;case Et.UNAVAILABLE:return q.UNAVAILABLE;case Et.UNAUTHENTICATED:return q.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case Et.NOT_FOUND:return q.NOT_FOUND;case Et.ALREADY_EXISTS:return q.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return q.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case Et.ABORTED:return q.ABORTED;case Et.OUT_OF_RANGE:return q.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return q.UNIMPLEMENTED;case Et.DATA_LOSS:return q.DATA_LOSS;default:return ye()}}(Pe=Et||(Et={}))[Pe.OK=0]="OK",Pe[Pe.CANCELLED=1]="CANCELLED",Pe[Pe.UNKNOWN=2]="UNKNOWN",Pe[Pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pe[Pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pe[Pe.NOT_FOUND=5]="NOT_FOUND",Pe[Pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pe[Pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pe[Pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pe[Pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pe[Pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pe[Pe.ABORTED=10]="ABORTED",Pe[Pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pe[Pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pe[Pe.INTERNAL=13]="INTERNAL",Pe[Pe.UNAVAILABLE=14]="UNAVAILABLE",Pe[Pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=new Ei([4294967295,4294967295],0);function Ay(t){const e=BS().encode(t),n=new S_;return n.update(e),new Uint8Array(n.digest())}function Cy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ei([n,r],0),new Ei([s,i],0)]}class Xp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Aa(`Invalid padding: ${n}`);if(r<0)throw new Aa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Aa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Aa(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ei.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ei.fromNumber(r)));return s.compare(WS)===1&&(s=new Ei([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ay(e),[r,s]=Cy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Xp(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const n=Ay(e),[r,s]=Cy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Aa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Vl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ld(ve.min(),s,new ft(Ve),ns(),Ne())}}class Vl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Vl(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class sw{constructor(e,n){this.targetId=e,this.me=n}}class iw{constructor(e,n,r=Wt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Py{constructor(){this.fe=0,this.ge=Ry(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ne(),n=Ne(),r=Ne();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ye()}}),new Vl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Ry()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class HS{constructor(e){this.Le=e,this.Be=new Map,this.ke=ns(),this.qe=jy(),this.Qe=new ft(Ve)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ye()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(yf(i))if(r===0){const o=new pe(i.path);this.Ue(n,o,tn.newNoDocument(o,ve.min()))}else Be(r===1);else{const o=this.Ye(n);if(o!==r){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Ri(r).toUint8Array()}catch(u){if(u instanceof L_)return Fo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Xp(o,s,i)}catch(u){return Fo(u instanceof Aa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const c=this.Je(o);if(c){if(i.current&&yf(c.target)){const u=new pe(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,tn.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ne();this.qe.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ld(e,n,this.Qe,this.ke,r);return this.ke=ns(),this.qe=jy(),this.Qe=new ft(Ve),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Py,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new $t(Ve),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Py),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function jy(){return new ft(pe.comparator)}function Ry(){return new ft(pe.comparator)}const GS={asc:"ASCENDING",desc:"DESCENDING"},qS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KS={and:"AND",or:"OR"};class QS{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function _f(t,e){return t.useProto3Json||rd(e)?e:{value:e}}function ju(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ow(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function YS(t,e){return ju(t,e.toTimestamp())}function Cr(t){return Be(!!t),ve.fromTimestamp(function(n){const r=Bs(n);return new At(r.seconds,r.nanos)}(t))}function Jp(t,e){return wf(t,e).canonicalString()}function wf(t,e){const n=function(s){return new ot(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function aw(t){const e=ot.fromString(t);return Be(hw(e)),e}function Ef(t,e){return Jp(t.databaseId,e.path)}function eh(t,e){const n=aw(e);if(n.get(1)!==t.databaseId.projectId)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ue(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new pe(cw(n))}function lw(t,e){return Jp(t.databaseId,e)}function XS(t){const e=aw(t);return e.length===4?ot.emptyPath():cw(e)}function bf(t){return new ot(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cw(t){return Be(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Dy(t,e,n){return{name:Ef(t,e),fields:n.value.mapValue.fields}}function JS(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ye()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,m){return h.useProto3Json?(Be(m===void 0||typeof m=="string"),Wt.fromBase64String(m||"")):(Be(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Wt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const m=h.code===void 0?q.UNKNOWN:rw(h.code);return new ue(m,h.message||"")}(o);n=new iw(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=eh(t,r.document.name),i=Cr(r.document.updateTime),o=r.document.createTime?Cr(r.document.createTime):ve.min(),c=new $n({mapValue:{fields:r.document.fields}}),u=tn.newFoundDocument(s,i,o,c),h=r.targetIds||[],m=r.removedTargetIds||[];n=new Wc(h,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=eh(t,r.document),i=r.readTime?Cr(r.readTime):ve.min(),o=tn.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Wc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=eh(t,r.document),i=r.removedTargetIds||[];n=new Wc([],i,s,null)}else{if(!("filter"in e))return ye();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new US(s,i),c=r.targetId;n=new sw(c,o)}}return n}function ZS(t,e){let n;if(e instanceof Ol)n={update:Dy(t,e.key,e.value)};else if(e instanceof Qp)n={delete:Ef(t,e.key)};else if(e instanceof Oi)n={update:Dy(t,e.key,e.data),updateMask:lN(e.fieldMask)};else{if(!(e instanceof VS))return ye();n={verify:Ef(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Cu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof gl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof yl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Pu)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw ye()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:YS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ye()}(t,e.precondition)),n}function eN(t,e){return t&&t.length>0?(Be(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Cr(s.updateTime):Cr(i);return o.isEqual(ve.min())&&(o=Cr(i)),new MS(o,s.transformResults||[])}(n,e))):[]}function tN(t,e){return{documents:[lw(t,e.path)]}}function nN(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lw(t,s);const i=function(h){if(h.length!==0)return dw(dr.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(m=>function(y){return{field:to(y.field),direction:iN(y.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=_f(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function rN(t){let e=XS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Be(r===1);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(g){const y=uw(g);return y instanceof dr&&z_(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(C){return new Au(no(C.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(y))}(n.orderBy));let c=null;n.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,rd(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,k=g.values||[];return new Nu(k,y)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const y=!g.before,k=g.values||[];return new Nu(k,y)}(n.endAt)),ES(e,s,o,i,c,"F",u,h)}function sN(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function uw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=no(n.unaryFilter.field);return kt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=no(n.unaryFilter.field);return kt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=no(n.unaryFilter.field);return kt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=no(n.unaryFilter.field);return kt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ye()}}(t):t.fieldFilter!==void 0?function(n){return kt.create(no(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ye()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return dr.create(n.compositeFilter.filters.map(r=>uw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ye()}}(n.compositeFilter.op))}(t):ye()}function iN(t){return GS[t]}function oN(t){return qS[t]}function aN(t){return KS[t]}function to(t){return{fieldPath:t.canonicalString()}}function no(t){return zt.fromServerFormat(t.fieldPath)}function dw(t){return t instanceof kt?function(n){if(n.op==="=="){if(_y(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NAN"}};if(xy(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_y(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NOT_NAN"}};if(xy(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:to(n.field),op:oN(n.op),value:n.value}}}(t):t instanceof dr?function(n){const r=n.getFilters().map(s=>dw(s));return r.length===1?r[0]:{compositeFilter:{op:aN(n.op),filters:r}}}(t):ye()}function lN(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n,r,s,i=ve.min(),o=ve.min(),c=Wt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.ct=e}}function uN(t){const e=rN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.un=new hN}addToCollectionParentIndex(e,n){return this.un.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve($s.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve($s.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class hN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new $t(ot.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new $t(ot.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Bo(0)}static kn(){return new Bo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(){this.changes=new ea(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ha(r.mutation,s,ar.empty(),At.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const s=xi();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Na();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=ns();const o=Wa(),c=function(){return Wa()}();return n.forEach((u,h)=>{const m=r.get(h.key);s.has(h.key)&&(m===void 0||m.mutation instanceof Oi)?i=i.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),Ha(m.mutation,h,m.mutation.getFieldMask(),At.now())):o.set(h.key,ar.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,m)=>o.set(h,m)),n.forEach((h,m)=>{var g;return c.set(h,new pN(m,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=Wa();let s=new ft((o,c)=>o-c),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let m=r.get(u)||ar.empty();m=c.applyToLocalView(h,m),r.set(u,m);const g=(s.get(c.batchId)||Ne()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,m=u.value,g=Q_();m.forEach(y=>{if(!i.has(y)){const k=tw(n.get(y),r.get(y));k!==null&&g.set(y,k),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):W_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):K.resolve(xi());let c=-1,u=i;return o.next(h=>K.forEach(h,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(m)?K.resolve():this.remoteDocumentCache.getEntry(e,m).next(y=>{u=u.insert(m,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,Ne())).next(m=>({batchId:c,changes:K_(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new pe(n)).next(r=>{let s=Na();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Na();return this.indexManager.getCollectionParents(e,i).next(c=>K.forEach(c,u=>{const h=function(g,y){return new Ll(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(m=>{m.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,h)=>{const m=h.getKey();o.get(m)===null&&(o=o.insert(m,tn.newInvalidDocument(m)))});let c=Na();return o.forEach((u,h)=>{const m=i.get(u);m!==void 0&&Ha(m.mutation,h,ar.empty(),At.now()),id(n,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return K.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Cr(s.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:uN(s.bundledQuery),readTime:Cr(s.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(){this.overlays=new ft(pe.comparator),this.Ir=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xi();return K.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const s=xi(),i=n.length+1,o=new pe(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ft((h,m)=>h-m);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let m=i.get(h.largestBatchId);m===null&&(m=xi(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=xi(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,m)=>c.set(h,m)),!(c.size()>=s)););return K.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zS(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ne(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(){this.Tr=new $t(jt.Er),this.dr=new $t(jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new jt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new jt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new pe(new ot([])),r=new jt(n,e),s=new jt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new pe(new ot([])),r=new jt(n,e),s=new jt(n,e+1);let i=Ne();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new jt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class jt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return pe.comparator(e.key,n.key)||Ve(e.wr,n.wr)}static Ar(e,n){return Ve(e.wr,n.wr)||pe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new $t(jt.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new FS(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new jt(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jt(n,0),s=new jt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);i.push(c)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $t(Ve);return n.forEach(s=>{const i=new jt(s,0),o=new jt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],c=>{r=r.add(c.wr)})}),K.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;pe.isDocumentKey(i)||(i=i.child(""));const o=new jt(new pe(i),0);let c=new $t(Ve);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.wr)),!0)},o),K.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Be(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return K.forEach(n.mutations,s=>{const i=new jt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new jt(n,0),s=this.br.firstAfterOrEqual(r);return K.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e){this.Mr=e,this.docs=function(){return new ft(pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():tn.newInvalidDocument(n))}getEntries(e,n){let r=ns();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():tn.newInvalidDocument(s))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ns();const o=n.path,c=new pe(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:m}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||rS(nS(m),r)<=0||(s.has(m.key)||id(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ye()}Or(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new wN(this)}getSize(e){return K.resolve(this.size)}}class wN extends fN{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(e){this.persistence=e,this.Nr=new ea(n=>Hp(n),Gp),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zp,this.targetCount=0,this.kr=Bo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),K.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Bo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.Kn(n),K.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Up(0),this.Kr=!1,this.Kr=!0,this.$r=new vN,this.referenceDelegate=e(this),this.Ur=new EN(this),this.indexManager=new dN,this.remoteDocumentCache=function(s){return new _N(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new cN(n),this.Gr=new gN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new yN,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new xN(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const s=new kN(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return K.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class kN extends iS{constructor(e){super(),this.currentSequenceNumber=e}}class em{constructor(e){this.persistence=e,this.Jr=new Zp,this.Yr=null}static Zr(e){return new em(e)}get Xr(){if(this.Yr)return this.Yr;throw ye()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),K.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,r=>{const s=pe.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return K.or([()=>K.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ne(),s=Ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new tm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Ik()?8:oS(sn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new IN;return this.Xi(e,n,o).next(c=>{if(i.result=c,this.zi)return this.es(e,n,o,c.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(wa()<=Ce.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",eo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(wa()<=Ce.DEBUG&&ce("QueryEngine","Query:",eo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(wa()<=Ce.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",eo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nr(n))):K.resolve())}Yi(e,n){if(ky(n))return K.resolve(null);let r=Nr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=xf(n,null,"F"),r=Nr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ne(...i);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,c);return this.ns(n,h,o,u.readTime)?this.Yi(e,xf(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return ky(n)||s.isEqual(ve.min())?K.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?K.resolve(null):(wa()<=Ce.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),eo(n)),this.rs(e,o,n,tS(s,-1)).next(c=>c))})}ts(e,n){let r=new $t(G_(e));return n.forEach((s,i)=>{id(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return wa()<=Ce.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",eo(n)),this.Ji.getDocumentsMatchingQuery(e,n,$s.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ft(Ve),this._s=new ea(i=>Hp(i),Gp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function NN(t,e,n,r){return new SN(t,e,n,r)}async function fw(t,e){const n=xe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=Ne();for(const h of s){o.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}for(const h of i){c.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:c}))})})}function AN(t,e){const n=xe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,m){const g=h.batch,y=g.keys();let k=K.resolve();return y.forEach(C=>{k=k.next(()=>m.getEntry(u,C)).next(R=>{const D=h.docVersions.get(C);Be(D!==null),R.version.compareTo(D)<0&&(g.applyToRemoteDocument(R,h),R.isValidDocument()&&(R.setReadTime(h.commitVersion),m.addEntry(R)))})}),k.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Ne();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function pw(t){const e=xe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function CN(t,e){const n=xe(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((m,g)=>{const y=s.get(g);if(!y)return;c.push(n.Ur.removeMatchingKeys(i,m.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,m.addedDocuments,g)));let k=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?k=k.withResumeToken(Wt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):m.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(m.resumeToken,r)),s=s.insert(g,k),function(R,D,A){return R.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(y,k,m)&&c.push(n.Ur.updateTargetData(i,k))});let u=ns(),h=Ne();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(PN(i,o,e.documentUpdates).next(m=>{u=m.Ps,h=m.Is})),!r.isEqual(ve.min())){const m=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(m)}return K.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function PN(t,e,n){let r=Ne(),s=Ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ns();return n.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ve.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ce("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function jN(t,e){const n=xe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function RN(t,e){const n=xe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,K.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ts(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function kf(t,e,n){const r=xe(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ml(o))throw o;ce("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function My(t,e,n){const r=xe(t);let s=ve.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,m){const g=xe(u),y=g._s.get(m);return y!==void 0?K.resolve(g.os.get(y)):g.Ur.getTargetData(h,m)}(r,o,Nr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ve.min(),n?i:Ne())).next(c=>(DN(r,kS(e),c),{documents:c,Ts:i})))}function DN(t,e,n){let r=t.us.get(e)||ve.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Ly{constructor(){this.activeTargetIds=CS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class MN{constructor(){this.so=new Ly,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ly,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ec=null;function th(){return Ec===null?Ec=function(){return 268435456+Math.round(2147483648*Math.random())}():Ec++,"0x"+Ec.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class FN extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const c=th(),u=this.xo(n,r.toUriEncodedString());ce("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,o),this.No(n,u,h,s).then(m=>(ce("RestConnection",`Received RPC '${n}' ${c}: `,m),m),m=>{throw Fo("RestConnection",`RPC '${n}' ${c} failed with error: `,m,"url: ",u,"request:",s),m})}Lo(n,r,s,i,o,c){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=ON[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=th();return new Promise((o,c)=>{const u=new N_;u.setWithCredentials(!0),u.listenOnce(A_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Uc.NO_ERROR:const m=u.getResponseJson();ce(Jt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(m)),o(m);break;case Uc.TIMEOUT:ce(Jt,`RPC '${e}' ${i} timed out`),c(new ue(q.DEADLINE_EXCEEDED,"Request time out"));break;case Uc.HTTP_ERROR:const g=u.getStatus();if(ce(Jt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const k=y==null?void 0:y.error;if(k&&k.status&&k.message){const C=function(D){const A=D.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(A)>=0?A:q.UNKNOWN}(k.status);c(new ue(C,k.message))}else c(new ue(q.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new ue(q.UNAVAILABLE,"Connection failed."));break;default:ye()}}finally{ce(Jt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ce(Jt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=th(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=j_(),c=P_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=i.join("");ce(Jt,`Creating RPC '${e}' stream ${s}: ${m}`,u);const g=o.createWebChannel(m,u);let y=!1,k=!1;const C=new VN({Io:D=>{k?ce(Jt,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(y||(ce(Jt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),ce(Jt,`RPC '${e}' stream ${s} sending:`,D),g.send(D))},To:()=>g.close()}),R=(D,A,I)=>{D.listen(A,N=>{try{I(N)}catch(M){setTimeout(()=>{throw M},0)}})};return R(g,Sa.EventType.OPEN,()=>{k||(ce(Jt,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),R(g,Sa.EventType.CLOSE,()=>{k||(k=!0,ce(Jt,`RPC '${e}' stream ${s} transport closed`),C.So())}),R(g,Sa.EventType.ERROR,D=>{k||(k=!0,Fo(Jt,`RPC '${e}' stream ${s} transport errored:`,D),C.So(new ue(q.UNAVAILABLE,"The operation could not be completed")))}),R(g,Sa.EventType.MESSAGE,D=>{var A;if(!k){const I=D.data[0];Be(!!I);const N=I,M=N.error||((A=N[0])===null||A===void 0?void 0:A.error);if(M){ce(Jt,`RPC '${e}' stream ${s} received error:`,M);const z=M.status;let G=function(E){const T=Et[E];if(T!==void 0)return rw(T)}(z),x=M.message;G===void 0&&(G=q.INTERNAL,x="Unknown error status: "+z+" with message "+M.message),k=!0,C.So(new ue(G,x)),g.close()}else ce(Jt,`RPC '${e}' stream ${s} received:`,I),C.bo(I)}}),R(c,C_.STAT_EVENT,D=>{D.stat===ff.PROXY?ce(Jt,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===ff.NOPROXY&&ce(Jt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function nh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){return new QS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ce("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n,r,s,i,o,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new mw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===q.RESOURCE_EXHAUSTED?(ts(n.toString()),ts("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new ue(q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ce("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zN extends gw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=JS(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Cr(o.readTime):ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=bf(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=yf(u)?{documents:tN(i,u)}:{query:nN(i,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=ow(i,o.resumeToken);const h=_f(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(ve.min())>0){c.readTime=ju(i,o.snapshotVersion.toTimestamp());const h=_f(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const r=sN(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=bf(this.serializer),n.removeTarget=e,this.a_(n)}}class UN extends gw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Be(!!e.streamToken),this.lastStreamToken=e.streamToken,Be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=eN(e.writeResults,e.commitTime),r=Cr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=bf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>ZS(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,wf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ue(q.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,wf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class BN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ts(n),this.D_=!1):ce("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Vi(this)&&(ce("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=xe(u);h.L_.add(4),await Fl(h),h.q_.set("Unknown"),h.L_.delete(4),await ud(h)}(this))})}),this.q_=new BN(r,s)}}async function ud(t){if(Vi(t))for(const e of t.B_)await e(!0)}async function Fl(t){for(const e of t.B_)await e(!1)}function yw(t,e){const n=xe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),im(n)?sm(n):ta(n).r_()&&rm(n,e))}function nm(t,e){const n=xe(t),r=ta(n);n.N_.delete(e),r.r_()&&vw(n,e),n.N_.size===0&&(r.r_()?r.o_():Vi(n)&&n.q_.set("Unknown"))}function rm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ta(t).A_(e)}function vw(t,e){t.Q_.xe(e),ta(t).R_(e)}function sm(t){t.Q_=new HS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ta(t).start(),t.q_.v_()}function im(t){return Vi(t)&&!ta(t).n_()&&t.N_.size>0}function Vi(t){return xe(t).L_.size===0}function xw(t){t.Q_=void 0}async function HN(t){t.q_.set("Online")}async function GN(t){t.N_.forEach((e,n)=>{rm(t,e)})}async function qN(t,e){xw(t),im(t)?(t.q_.M_(e),sm(t)):t.q_.set("Unknown")}async function KN(t,e,n){if(t.q_.set("Online"),e instanceof iw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){ce("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ru(t,r)}else if(e instanceof Wc?t.Q_.Ke(e):e instanceof sw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ve.min()))try{const r=await pw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Q_.rt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const m=i.N_.get(h);m&&i.N_.set(h,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const m=i.N_.get(u);if(!m)return;i.N_.set(u,m.withResumeToken(Wt.EMPTY_BYTE_STRING,m.snapshotVersion)),vw(i,u);const g=new Ts(m.target,u,h,m.sequenceNumber);rm(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ce("RemoteStore","Failed to raise snapshot:",r),await Ru(t,r)}}async function Ru(t,e,n){if(!Ml(e))throw e;t.L_.add(1),await Fl(t),t.q_.set("Offline"),n||(n=()=>pw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await ud(t)})}function _w(t,e){return e().catch(n=>Ru(t,n,e))}async function dd(t){const e=xe(t),n=Ws(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;QN(e);)try{const s=await jN(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,YN(e,s)}catch(s){await Ru(e,s)}ww(e)&&Ew(e)}function QN(t){return Vi(t)&&t.O_.length<10}function YN(t,e){t.O_.push(e);const n=Ws(t);n.r_()&&n.V_&&n.m_(e.mutations)}function ww(t){return Vi(t)&&!Ws(t).n_()&&t.O_.length>0}function Ew(t){Ws(t).start()}async function XN(t){Ws(t).p_()}async function JN(t){const e=Ws(t);for(const n of t.O_)e.m_(n.mutations)}async function ZN(t,e,n){const r=t.O_.shift(),s=Yp.from(r,e,n);await _w(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await dd(t)}async function eA(t,e){e&&Ws(t).V_&&await async function(r,s){if(function(o){return $S(o)&&o!==q.ABORTED}(s.code)){const i=r.O_.shift();Ws(r).s_(),await _w(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await dd(r)}}(t,e),ww(t)&&Ew(t)}async function Vy(t,e){const n=xe(t);n.asyncQueue.verifyOperationInProgress(),ce("RemoteStore","RemoteStore received new credentials");const r=Vi(n);n.L_.add(3),await Fl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ud(n)}async function tA(t,e){const n=xe(t);e?(n.L_.delete(2),await ud(n)):e||(n.L_.add(2),await Fl(n),n.q_.set("Unknown"))}function ta(t){return t.K_||(t.K_=function(n,r,s){const i=xe(n);return i.w_(),new zN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:HN.bind(null,t),Ro:GN.bind(null,t),mo:qN.bind(null,t),d_:KN.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),im(t)?sm(t):t.q_.set("Unknown")):(await t.K_.stop(),xw(t))})),t.K_}function Ws(t){return t.U_||(t.U_=function(n,r,s){const i=xe(n);return i.w_(),new UN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:XN.bind(null,t),mo:eA.bind(null,t),f_:JN.bind(null,t),g_:ZN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await dd(t)):(await t.U_.stop(),t.O_.length>0&&(ce("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new bi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new om(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function am(t,e){if(ts("AsyncQueue",`${e}: ${t}`),Ml(t))return new ue(q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.comparator=e?(n,r)=>e(n,r)||pe.comparator(n.key,r.key):(n,r)=>pe.comparator(n.key,r.key),this.keyedMap=Na(),this.sortedSet=new ft(this.comparator)}static emptySet(e){return new So(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof So)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new So;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(){this.W_=new ft(pe.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ye():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Wo{constructor(e,n,r,s,i,o,c,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Wo(e,n,So.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class rA{constructor(){this.queries=zy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=xe(n),i=s.queries;s.queries=zy(),i.forEach((o,c)=>{for(const u of c.j_)u.onError(r)})})(this,new ue(q.ABORTED,"Firestore shutting down"))}}function zy(){return new ea(t=>H_(t),sd)}async function sA(t,e){const n=xe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new nA,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=am(o,`Initialization of query '${eo(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&lm(n)}async function iA(t,e){const n=xe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function oA(t,e){const n=xe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&lm(n)}function aA(t,e,n){const r=xe(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function lm(t){t.Y_.forEach(e=>{e.next()})}var If,Uy;(Uy=If||(If={})).ea="default",Uy.Cache="cache";class lA{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Wo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==If.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e){this.key=e}}class kw{constructor(e){this.key=e}}class cA{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ne(),this.mutatedKeys=Ne(),this.Aa=G_(e),this.Ra=new So(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Fy,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,g)=>{const y=s.get(m),k=id(this.query,g)?g:null,C=!!y&&this.mutatedKeys.has(y.key),R=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let D=!1;y&&k?y.data.isEqual(k.data)?C!==R&&(r.track({type:3,doc:k}),D=!0):this.ga(y,k)||(r.track({type:2,doc:k}),D=!0,(u&&this.Aa(k,u)>0||h&&this.Aa(k,h)<0)&&(c=!0)):!y&&k?(r.track({type:0,doc:k}),D=!0):y&&!k&&(r.track({type:1,doc:y}),D=!0,(u||h)&&(c=!0)),D&&(k?(o=o.add(k),i=R?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:c,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,g)=>function(k,C){const R=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye()}};return R(k)-R(C)}(m.type,g.type)||this.Aa(m.doc,g.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new Wo(this.query,e.Ra,i,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new kw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new bw(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ne();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Wo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class uA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class dA{constructor(e){this.key=e,this.va=!1}}class hA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ea(c=>H_(c),sd),this.Ma=new Map,this.xa=new Set,this.Oa=new ft(pe.comparator),this.Na=new Map,this.La=new Zp,this.Ba={},this.ka=new Map,this.qa=Bo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function fA(t,e,n=!0){const r=Cw(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Iw(r,e,n,!0),s}async function pA(t,e){const n=Cw(t);await Iw(n,e,!0,!1)}async function Iw(t,e,n,r){const s=await RN(t.localStore,Nr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await mA(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&yw(t.remoteStore,s),c}async function mA(t,e,n,r,s){t.Ka=(g,y,k)=>async function(R,D,A,I){let N=D.view.ma(A);N.ns&&(N=await My(R.localStore,D.query,!1).then(({documents:x})=>D.view.ma(x,N)));const M=I&&I.targetChanges.get(D.targetId),z=I&&I.targetMismatches.get(D.targetId)!=null,G=D.view.applyChanges(N,R.isPrimaryClient,M,z);return By(R,D.targetId,G.wa),G.snapshot}(t,g,y,k);const i=await My(t.localStore,e,!0),o=new cA(e,i.Ts),c=o.ma(i.documents),u=Vl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);By(t,n,h.wa);const m=new uA(e,n,o);return t.Fa.set(e,m),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function gA(t,e,n){const r=xe(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!sd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await kf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&nm(r.remoteStore,s.targetId),Tf(r,s.targetId)}).catch(Dl)):(Tf(r,s.targetId),await kf(r.localStore,s.targetId,!0))}async function yA(t,e){const n=xe(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),nm(n.remoteStore,r.targetId))}async function vA(t,e,n){const r=IA(t);try{const s=await function(o,c){const u=xe(o),h=At.now(),m=c.reduce((k,C)=>k.add(C.key),Ne());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",k=>{let C=ns(),R=Ne();return u.cs.getEntries(k,m).next(D=>{C=D,C.forEach((A,I)=>{I.isValidDocument()||(R=R.add(A))})}).next(()=>u.localDocuments.getOverlayedDocuments(k,C)).next(D=>{g=D;const A=[];for(const I of c){const N=OS(I,g.get(I.key).overlayedDocument);N!=null&&A.push(new Oi(I.key,N,O_(N.value.mapValue),Ar.exists(!0)))}return u.mutationQueue.addMutationBatch(k,h,A,c)}).next(D=>{y=D;const A=D.applyToLocalDocumentSet(g,R);return u.documentOverlayCache.saveOverlays(k,D.batchId,A)})}).then(()=>({batchId:y.batchId,changes:K_(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new ft(Ve)),h=h.insert(c,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await zl(r,s.changes),await dd(r.remoteStore)}catch(s){const i=am(s,"Failed to persist write");n.reject(i)}}async function Tw(t,e){const n=xe(t);try{const r=await CN(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Be(o.va):s.removedDocuments.size>0&&(Be(o.va),o.va=!1))}),await zl(n,r,e)}catch(r){await Dl(r)}}function $y(t,e,n){const r=xe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=xe(o);u.onlineState=c;let h=!1;u.queries.forEach((m,g)=>{for(const y of g.j_)y.Z_(c)&&(h=!0)}),h&&lm(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xA(t,e,n){const r=xe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ft(pe.comparator);o=o.insert(i,tn.newNoDocument(i,ve.min()));const c=Ne().add(i),u=new ld(ve.min(),new Map,new ft(Ve),o,c);await Tw(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),cm(r)}else await kf(r.localStore,e,!1).then(()=>Tf(r,e,n)).catch(Dl)}async function _A(t,e){const n=xe(t),r=e.batch.batchId;try{const s=await AN(n.localStore,e);Nw(n,r,null),Sw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zl(n,s)}catch(s){await Dl(s)}}async function wA(t,e,n){const r=xe(t);try{const s=await function(o,c){const u=xe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(Be(g!==null),m=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>u.localDocuments.getDocuments(h,m))})}(r.localStore,e);Nw(r,e,n),Sw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await zl(r,s)}catch(s){await Dl(s)}}function Sw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Nw(t,e,n){const r=xe(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Tf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Aw(t,r)})}function Aw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(nm(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),cm(t))}function By(t,e,n){for(const r of n)r instanceof bw?(t.La.addReference(r.key,e),EA(t,r)):r instanceof kw?(ce("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Aw(t,r.key)):ye()}function EA(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ce("SyncEngine","New document in limbo: "+n),t.xa.add(r),cm(t))}function cm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new pe(ot.fromString(e)),r=t.qa.next();t.Na.set(r,new dA(n)),t.Oa=t.Oa.insert(n,r),yw(t.remoteStore,new Ts(Nr(qp(n.path)),r,"TargetPurposeLimboResolution",Up.oe))}}async function zl(t,e,n){const r=xe(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{o.push(r.Ka(u,e,n).then(h=>{var m;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=tm.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const m=xe(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>K.forEach(h,y=>K.forEach(y.$i,k=>m.persistence.referenceDelegate.addReference(g,y.targetId,k)).next(()=>K.forEach(y.Ui,k=>m.persistence.referenceDelegate.removeReference(g,y.targetId,k)))))}catch(g){if(!Ml(g))throw g;ce("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const k=m.os.get(y),C=k.snapshotVersion,R=k.withLastLimboFreeSnapshotVersion(C);m.os=m.os.insert(y,R)}}}(r.localStore,i))}async function bA(t,e){const n=xe(t);if(!n.currentUser.isEqual(e)){ce("SyncEngine","User change. New user:",e.toKey());const r=await fw(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new ue(q.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zl(n,r.hs)}}function kA(t,e){const n=xe(t),r=n.Na.get(e);if(r&&r.va)return Ne().add(r.key);{let s=Ne();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const c=n.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function Cw(t){const e=xe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Tw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xA.bind(null,e),e.Ca.d_=oA.bind(null,e.eventManager),e.Ca.$a=aA.bind(null,e.eventManager),e}function IA(t){const e=xe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_A.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wA.bind(null,e),e}class Du{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return NN(this.persistence,new TN,e.initialUser,this.serializer)}Ga(e){return new bN(em.Zr,this.serializer)}Wa(e){return new MN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Du.provider={build:()=>new Du};class Sf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$y(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bA.bind(null,this.syncEngine),await tA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rA}()}createDatastore(e){const n=cd(e.databaseInfo.databaseId),r=function(i){return new FN(i)}(e.databaseInfo);return function(i,o,c,u){return new $N(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new WN(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>$y(this.syncEngine,n,0),function(){return Oy.D()?new Oy:new LN}())}createSyncEngine(e,n){return function(s,i,o,c,u,h,m){const g=new hA(s,i,o,c,u,h);return m&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=xe(s);ce("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Fl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Sf.provider={build:()=>new Sf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ts("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Zt.UNAUTHENTICATED,this.clientId=D_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ce("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=am(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function rh(t,e){t.asyncQueue.verifyOperationInProgress(),ce("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await fw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Wy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await NA(t);ce("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Vy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Vy(e.remoteStore,s)),t._onlineComponents=e}async function NA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await rh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===q.FAILED_PRECONDITION||s.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fo("Error using user provided cache. Falling back to memory cache: "+n),await rh(t,new Du)}}else ce("FirestoreClient","Using default OfflineComponentProvider"),await rh(t,new Du);return t._offlineComponents}async function Pw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce("FirestoreClient","Using user provided OnlineComponentProvider"),await Wy(t,t._uninitializedComponentsProvider._online)):(ce("FirestoreClient","Using default OnlineComponentProvider"),await Wy(t,new Sf))),t._onlineComponents}function AA(t){return Pw(t).then(e=>e.syncEngine)}async function Hy(t){const e=await Pw(t),n=e.eventManager;return n.onListen=fA.bind(null,e.syncEngine),n.onUnlisten=gA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=pA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=yA.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(t,e,n){if(!n)throw new ue(q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function CA(t,e,n,r){if(e===!0&&r===!0)throw new ue(q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qy(t){if(!pe.isDocumentKey(t))throw new ue(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ky(t){if(pe.isDocumentKey(t))throw new ue(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ye()}function ki(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hd(t);throw new ue(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new G2;switch(r.type){case"firstParty":return new Y2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Gy.get(n);r&&(ce("ComponentProvider","Removing Datastore"),Gy.delete(n),r.terminate())}(this),Promise.resolve()}}function PA(t,e,n,r={}){var s;const i=(t=ki(t,fd))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Fo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Zt.MOCK_USER;else{c=vk(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new ue(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Zt(h)}t._authCredentials=new q2(new R_(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new na(this.firestore,e,this._query)}}class En{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new En(this.firestore,e,this._key)}}class Vs extends na{constructor(e,n,r){super(e,n,qp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new En(this.firestore,null,new pe(e))}withConverter(e){return new Vs(this.firestore,e,this._path)}}function jA(t,e,...n){if(t=bn(t),Rw("collection","path",e),t instanceof fd){const r=ot.fromString(e,...n);return Ky(r),new Vs(t,null,r)}{if(!(t instanceof En||t instanceof Vs))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ot.fromString(e,...n));return Ky(r),new Vs(t.firestore,null,r)}}function Yy(t,e,...n){if(t=bn(t),arguments.length===1&&(e=D_.newId()),Rw("doc","path",e),t instanceof fd){const r=ot.fromString(e,...n);return qy(r),new En(t,null,new pe(r))}{if(!(t instanceof En||t instanceof Vs))throw new ue(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ot.fromString(e,...n));return qy(r),new En(t.firestore,t instanceof Vs?t.converter:null,new pe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new mw(this,"async_queue_retry"),this.Vu=()=>{const r=nh();r&&ce("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=nh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=nh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new bi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ml(e))throw e;ce("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw ts("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=om.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ye()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Jy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class vl extends fd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Xy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xy(e),this._firestoreClient=void 0,await e}}}function RA(t,e){const n=typeof t=="object"?t:Cp(),r=typeof t=="string"?t:"(default)",s=Ap(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=gk("firestore");i&&PA(s,...i)}return s}function Dw(t){if(t._terminated)throw new ue(q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||DA(t),t._firestoreClient}function DA(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,h,m){return new cS(c,u,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,jw(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new SA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ho(Wt.fromBase64String(e))}catch(n){throw new ue(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ho(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ue(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ue(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ue(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=/^__.*__$/;class LA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Oi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ol(e,this.data,n,this.fieldTransforms)}}function Lw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye()}}class fm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new fm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Mu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Lw(this.Cu)&&MA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class OA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||cd(e)}Qu(e,n,r,s=!1){return new fm({Cu:e,methodName:n,qu:r,path:zt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ow(t){const e=t._freezeSettings(),n=cd(t._databaseId);return new OA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VA(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);zw("Data must be an object, but it was:",o,r);const c=Vw(r,o);let u,h;if(i.merge)u=new ar(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const y=zA(e,g,n);if(!o.contains(y))throw new ue(q.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);$A(m,y)||m.push(y)}u=new ar(m),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new LA(new $n(c),u,h)}function FA(t,e,n,r=!1){return pm(n,t.Qu(r?4:3,e))}function pm(t,e){if(Fw(t=bn(t)))return zw("Unsupported field value:",e,t),Vw(t,e);if(t instanceof Mw)return function(r,s){if(!Lw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=pm(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=bn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return PS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=At.fromDate(r);return{timestampValue:ju(s.serializer,i)}}if(r instanceof At){const i=new At(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ju(s.serializer,i)}}if(r instanceof dm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ho)return{bytesValue:ow(s.serializer,r._byteString)};if(r instanceof En){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Jp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof hm)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return Kp(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${hd(r)}`)}(t,e)}function Vw(t,e){const n={};return M_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zo(t,(r,s)=>{const i=pm(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Fw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof At||t instanceof dm||t instanceof Ho||t instanceof En||t instanceof Mw||t instanceof hm)}function zw(t,e,n){if(!Fw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=hd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function zA(t,e,n){if((e=bn(e))instanceof um)return e._internalPath;if(typeof e=="string")return Uw(t,e);throw Mu("Field path arguments must be of type string or ",t,!1,void 0,n)}const UA=new RegExp("[~\\*/\\[\\]]");function Uw(t,e,n){if(e.search(UA)>=0)throw Mu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new um(...e.split("."))._internalPath}catch{throw Mu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new ue(q.INVALID_ARGUMENT,c+t+u)}function $A(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new En(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Bw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class BA extends $w{data(){return super.data()}}function Bw(t,e){return typeof e=="string"?Uw(t,e):e instanceof um?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ue(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mm{}class HA extends mm{}function GA(t,e,...n){let r=[];e instanceof mm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof ym).length,c=i.filter(u=>u instanceof gm).length;if(o>1||o>0&&c>0)throw new ue(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class gm extends HA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new gm(e,n,r)}_apply(e){const n=this._parse(e);return Ww(e._query,n),new na(e.firestore,e.converter,vf(e._query,n))}_parse(e){const n=Ow(e.firestore);return function(i,o,c,u,h,m,g){let y;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new ue(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){ev(g,m);const k=[];for(const C of g)k.push(Zy(u,i,C));y={arrayValue:{values:k}}}else y=Zy(u,i,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||ev(g,m),y=FA(c,o,g,m==="in"||m==="not-in");return kt.create(h,m,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class ym extends mm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ym(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:dr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)Ww(o,u),o=vf(o,u)}(e._query,n),new na(e.firestore,e.converter,vf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Zy(t,e,n){if(typeof(n=bn(n))=="string"){if(n==="")throw new ue(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!W_(e)&&n.indexOf("/")!==-1)throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ot.fromString(n));if(!pe.isDocumentKey(r))throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vy(t,new pe(r))}if(n instanceof En)return vy(t,n._key);throw new ue(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hd(n)}.`)}function ev(t,e){if(!Array.isArray(t)||t.length===0)throw new ue(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ww(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class qA{convertValue(e,n="none"){switch(Di(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ye()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Zo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>yt(o.doubleValue));return new hm(i)}convertGeoPoint(e){return new dm(yt(e.latitude),yt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Bp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(fl(e));default:return null}}convertTimestamp(e){const n=Bs(e);return new At(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ot.fromString(e);Be(hw(r));const s=new pl(r.get(1),r.get(3)),i=new pe(r.popFirst(5));return s.isEqual(n)||ts(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hw extends $w{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Hc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Bw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Hc extends Hw{data(e={}){return super.data(e)}}class QA{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ca(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Hc(this._firestore,this._userDataWriter,r.key,r,new Ca(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ue(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new Hc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ca(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Hc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ca(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,m=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:YA(c.type),doc:u,oldIndex:h,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function YA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye()}}class Gw extends qA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ho(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,n)}}function XA(t,e,n){t=ki(t,En);const r=ki(t.firestore,vl),s=KA(t.converter,e,n);return qw(r,[VA(Ow(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ar.none())])}function JA(t){return qw(ki(t.firestore,vl),[new Qp(t._key,Ar.none())])}function ZA(t,...e){var n,r,s;t=bn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Jy(e[o])||(i=e[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Jy(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,h,m;if(t instanceof En)h=ki(t.firestore,vl),m=qp(t._key.path),u={next:g=>{e[o]&&e[o](eC(h,t,g))},error:e[o+1],complete:e[o+2]};else{const g=ki(t,na);h=ki(g.firestore,vl),m=g._query;const y=new Gw(h);u={next:k=>{e[o]&&e[o](new QA(h,y,g,k))},error:e[o+1],complete:e[o+2]},WA(t._query)}return function(y,k,C,R){const D=new TA(R),A=new lA(k,D,C);return y.asyncQueue.enqueueAndForget(async()=>sA(await Hy(y),A)),()=>{D.Za(),y.asyncQueue.enqueueAndForget(async()=>iA(await Hy(y),A))}}(Dw(h),m,c,u)}function qw(t,e){return function(r,s){const i=new bi;return r.asyncQueue.enqueueAndForget(async()=>vA(await AA(r),s,i)),i.promise}(Dw(t),e)}function eC(t,e,n){const r=n.docs.get(e._key),s=new Gw(t);return new Hw(t,s,e._key,r,new Ca(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Jo=s})(Yo),Vo(new Ci("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new vl(new K2(r.getProvider("auth-internal")),new J2(r.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ue(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pl(h.options.projectId,m)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Os(fy,"4.7.3",e),Os(fy,"4.7.3","esm2017")})();const nn={marriage:{label:"Matrimonio",color:"#000000",lineStyle:"solid",renderType:"standard"},secret:{label:"Relazione Segreta",color:"#000000",lineStyle:"solid",renderType:"triangle-up-center"},cohabitation:{label:"Convivenza",color:"#000000",lineStyle:"dashed",renderType:"standard"},couple:{label:"Relazione di Coppia",color:"#000000",lineStyle:"dashed",renderType:"standard"},"divorce-commit":{label:"Divorzio Impegno Emot.",color:"#000000",lineStyle:"solid",renderType:"dashed-inner"},separation:{label:"Separazione",color:"#000000",lineStyle:"solid",renderType:"oblique"},"separation-repaired":{label:"Separazione Riparata",color:"#000000",lineStyle:"solid",renderType:"x-cross"},"separation-cohab":{label:"Separazione (Conv.)",color:"#000000",lineStyle:"dashed",renderType:"oblique"},divorce:{label:"Divorzio (2 Tagli)",color:"#000000",lineStyle:"solid",renderType:"oblique-double"},"divorce-repaired":{label:"Divorzio Riparato",color:"#000000",lineStyle:"solid",renderType:"oblique-double-crossed"},"re-marriage":{label:"Risposati",color:"#000000",lineStyle:"solid",renderType:"standard"},affair:{label:"Relazione Extra/Amante",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},"one-night":{label:"Avventura",color:"#FFD700",lineStyle:"dotted",renderType:"standard"},engagement:{label:"Fidanzamento",color:"#0000FF",lineStyle:"dashed",renderType:"standard"},"child-bio":{label:"Figlio Biologico",color:"#000000",lineStyle:"solid",renderType:"standard"},"child-adopted":{label:"Adozione",color:"#0000FF",lineStyle:"dotted",renderType:"standard"},"child-foster":{label:"Affido",color:"#000000",lineStyle:"dashed",renderType:"standard"},"twin-dizygotic":{label:"Gemelli Dizigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link"},"twin-monozygotic":{label:"Gemelli Monozigoti",color:"#000000",lineStyle:"solid",renderType:"twin-link-bar"},pregnancy:{label:"Gravidanza",color:"#000000",lineStyle:"solid",renderType:"standard"},correlated:{label:"Correlato/Collegamento",color:"#000000",lineStyle:"solid",renderType:"standard"},harmony:{label:"Armonia",color:"#008000",lineStyle:"solid",renderType:"standard"},friendship:{label:"Amicizia",color:"#008000",lineStyle:"dashed",renderType:"standard"},"best-friend":{label:"Migliore Amico",color:"#008000",lineStyle:"dotted",renderType:"double"},close:{label:"Invischiamento/Molto Uniti",color:"#008000",lineStyle:"solid",renderType:"double"},fusion:{label:"Fusione",color:"#008000",lineStyle:"solid",renderType:"triple"},"in-love":{label:"Innamorati",color:"#008000",lineStyle:"solid",renderType:"two-circles-center"},fan:{label:"Ammiratore",color:"#008000",lineStyle:"dashed",renderType:"arrow"},spiritual:{label:"Conn. Spirituale",color:"#800080",lineStyle:"dashed",renderType:"standard"},distance:{label:"Distanza",color:"#808080",lineStyle:"dashed",renderType:"standard"},poor:{label:"Povera",color:"#808080",lineStyle:"dotted",renderType:"standard"},hostile:{label:"Ostile",color:"#FF0000",lineStyle:"zigzag",renderType:"standard"},"close-hostile":{label:"Vicini-Ostile",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag-center"},"fusion-hostile":{label:"Fusione & Conflitto",color:"#000000",lineStyle:"solid",renderType:"fusion-hostile"},hate:{label:"Odio",color:"#FF0000",lineStyle:"solid",renderType:"triple-zigzag"},cutoff:{label:"Rottura/Taglio (//)",color:"#FF0000",lineStyle:"solid",renderType:"cutoff"},restored:{label:"Relazione Ristabilita",color:"#008000",lineStyle:"solid",renderType:"cutoff-repaired-circle"},"violence-psychological":{label:"Violenza Psicologica",color:"#FF0000",lineStyle:"zigzag",renderType:"arrow-open-end"},"violence-physical":{label:"Violenza Fisica",color:"#FF0000",lineStyle:"zigzag-thick",renderType:"arrow-open-end"},"violence-sexual":{label:"Violenza Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"triple-zigzag-center-arrow"},"abuse-physical":{label:"Abuso Fisico",color:"#800000",lineStyle:"solid",renderType:"arrow-thick"},"abuse-emotional":{label:"Abuso Emotivo",color:"#800000",lineStyle:"dashed",renderType:"arrow"},"abuse-sexual":{label:"Abuso Sessuale",color:"#FF0080",lineStyle:"solid",renderType:"arrow-double-bar-center"},focused:{label:"Focalizzato sul",color:"#0000FF",lineStyle:"solid",renderType:"arrow-end"},"focused-negative":{label:"Focalizzato Negativamente",color:"#FF0000",lineStyle:"zigzag",renderType:"arrow-end"},companions:{label:"Accompagnatori",color:"#000000",lineStyle:"solid",renderType:"arrow-open-end"},manipulative:{label:"Manipolativo",color:"#FF0000",lineStyle:"solid",renderType:"arrow-x-center"},controlling:{label:"Controllante",color:"#800080",lineStyle:"solid",renderType:"arrow-box-center"},keeper:{label:"Custode/Caregiver",color:"#008080",lineStyle:"solid",renderType:"arrow-diamond-center"},neglect:{label:"Trascuratezza",color:"#808080",lineStyle:"dashed",renderType:"double-arrow-inward"},custom:{label:"Personalizzata",color:"#000000",lineStyle:"solid",renderType:"standard"}},Er={"Struttura / Coppia":["marriage","secret","cohabitation","couple","divorce-commit","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","re-marriage","engagement","affair","one-night"],Figli:["child-bio","child-adopted","child-foster","twin-dizygotic","twin-monozygotic","pregnancy"],"Interazione / Affettive":["correlated","harmony","friendship","best-friend","close","fusion","in-love","fan","spiritual"],"Conflitto e Distanza":["distance","poor","hostile","close-hostile","fusion-hostile","hate","cutoff","restored"],"Violenza, Abuso e Potere":["violence-psychological","violence-physical","violence-sexual","abuse-physical","abuse-emotional","abuse-sexual","neglect","focused","focused-negative","companions","manipulative","controlling","keeper"],Altro:["custom"]},tv={home:Ob,heart:Mo,user:Gb,users:Lo,grad:Lb,book:Cb,briefcase:Pb,folder:Mb,help:bp,tag:nf},tC=[{id:"family",label:"Famiglie",color:"#3b82f6",iconKey:"home"},{id:"couple",label:"Coppie",color:"#ec4899",iconKey:"heart"},{id:"individual",label:"Individuali",color:"#10b981",iconKey:"user"},{id:"school",label:"Scolastico",color:"#f59e0b",iconKey:"grad"},{id:"exercise",label:"Esercitazioni",color:"#6366f1",iconKey:"book"},{id:"work",label:"Lavoro/Org",color:"#64748b",iconKey:"briefcase"},{id:"other",label:"Altro",color:"#94a3b8",iconKey:"folder"}],Kw=["#bfdbfe","#bbf7d0","#fbcfe8","#fde68a","#ddd6fe","#fed7aa","#e2e8f0"],Qw=["#3b82f6","#22c55e","#ec4899","#f59e0b","#8b5cf6","#f97316","#64748b"],nC=["#ffffff","#f3f4f6","#d1d5db","#9ca3af","#4b5563","#1f2937","#000000"],rC=["#78350f","#92400e","#b45309","#d97706","#f59e0b","#fcd34d","#fffbeb"],sC=["#f8fafc","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#475569","#1e293b"],Pa={Classico:["#fef3c7","#d1fae5","#dbeafe","#fce7f3","#f3f4f6","#ffedd5","#e0e7ff"],Pastello:Kw,Vivido:Qw,Terra:rC,Monocromo:sC},iC=["#1f2937","#000000","#ffffff","#dc2626","#2563eb","#16a34a","#d97706","#57534e"],Yw=[{label:"App Default",value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},{label:"Handwriting",value:'"Comic Sans MS", "Chalkboard SE", sans-serif'},{label:"Sans Serif",value:"ui-sans-serif, system-ui, sans-serif"},{label:"Serif",value:"ui-serif, Georgia, serif"},{label:"Monospace",value:"ui-monospace, monospace"}],bs=[{id:"light",label:"Light (Default)",type:"light",colors:{bgMain:"#f9fafb",bgPanel:"#ffffff",border:"#e5e7eb",text:"#111827",textMuted:"#6b7280",accent:"#2563eb"}},{id:"sepia",label:"Vintage Sepia",type:"light",colors:{bgMain:"#fdf6e3",bgPanel:"#eee8d5",border:"#d2b48c",text:"#433422",textMuted:"#93a1a1",accent:"#b58900"}},{id:"nordic",label:"Nordic Snow",type:"light",colors:{bgMain:"#eceff4",bgPanel:"#e5e9f0",border:"#d8dee9",text:"#2e3440",textMuted:"#4c566a",accent:"#5e81ac"}},{id:"dark",label:"Dark (Classic)",type:"dark",colors:{bgMain:"#111827",bgPanel:"#1f2937",border:"#374151",text:"#f9fafb",textMuted:"#9ca3af",accent:"#3b82f6"}},{id:"onedark",label:"One Dark Pro",type:"dark",colors:{bgMain:"#282c34",bgPanel:"#21252b",border:"#3e4451",text:"#abb2bf",textMuted:"#5c6370",accent:"#61afef"}},{id:"dracula",label:"Dracula",type:"dark",colors:{bgMain:"#282a36",bgPanel:"#44475a",border:"#6272a4",text:"#f8f8f2",textMuted:"#bd93f9",accent:"#ff79c6"}},{id:"nightowl",label:"Night Owl",type:"dark",colors:{bgMain:"#011627",bgPanel:"#0b2942",border:"#5f7e97",text:"#d6deeb",textMuted:"#7e57c2",accent:"#82aaff"}},{id:"forest",label:"Forest Night",type:"dark",colors:{bgMain:"#0d1117",bgPanel:"#161b22",border:"#30363d",text:"#c9d1d9",textMuted:"#8b949e",accent:"#238636"}}],nv=20,ke=40,mi=8e3,Pt=mi/2,Vt=40,br=40,Go=20,Xw=40,oC=Go+Xw,bc=40,Ue=()=>Math.random().toString(36).substr(2,9),Jw=t=>{if(!t)return null;const e=t.split(/[\/\-\.]/);if(e.length===3){const n=parseInt(e[0]),r=parseInt(e[1])-1,s=parseInt(e[2]);if(!isNaN(n)&&!isNaN(r)&&!isNaN(s)){const i=s<100?s>30?1900+s:2e3+s:s;return new Date(i,r,n)}}if(/^\d{4}$/.test(t))return new Date(parseInt(t),0,1);if(/^\d{1,3}$/.test(t)){const n=parseInt(t);if(n<=150)return new Date(new Date().getFullYear()-n,0,1)}return null},xl=t=>{if(!t)return"?";const e=t.trim();if(/^\d{1,3}$/.test(e)&&parseInt(e)<=150)return e;const n=Jw(t);if(!n)return"?";const r=new Date;let s=r.getFullYear()-n.getFullYear();const i=r.getMonth()-n.getMonth();return(i<0||i===0&&r.getDate()<n.getDate())&&s--,s.toString()},rv=(t,e)=>e.find(n=>(n.fromId===t||n.toId===t)&&["marriage","cohabitation","separation","divorce","affair","re-marriage"].includes(n.type)),aC=(t,e)=>Math.max(t,e)+Xw,Zw=(t,e)=>{const n=e.filter(c=>t.memberIds.includes(c.id));if(!n.length)return null;const r=Math.min(...n.map(c=>c.x)),s=Math.max(...n.map(c=>c.x+Vt)),i=Math.min(...n.map(c=>c.y)),o=Math.max(...n.map(c=>c.y+br));return{x:r-bc,y:i-bc,w:s-r+bc*2,h:o-i+bc*2,cx:(r+s)/2,cy:(i+o)/2}},sv=(t,e,n)=>{const r=e.find(i=>i.id===t);if(r)return{x:r.x+Go,y:r.y+Go};const s=n.find(i=>i.id===t);if(s){const i=Zw(s,e);if(i)return{x:i.x+i.w/2,y:i.y+i.h/2}}return null},iv=(t,e,n)=>(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),lC=t=>{t.sort((r,s)=>r.x===s.x?r.y-s.y:r.x-s.x);const e=[];for(let r=0;r<t.length;r++){for(;e.length>=2&&iv(e[e.length-2],e[e.length-1],t[r])<=0;)e.pop();e.push(t[r])}const n=[];for(let r=t.length-1;r>=0;r--){for(;n.length>=2&&iv(n[n.length-2],n[n.length-1],t[r])<=0;)n.pop();n.push(t[r])}return[...e.slice(0,-1),...n.slice(0,-1)]},cC=(t,e)=>{if(t.length<3)return{d:"",cx:0,cy:0,expandedPoints:[],controlPoints:[]};const n=t.reduce((u,h)=>u+h.x,0)/t.length,r=t.reduce((u,h)=>u+h.y,0)/t.length,s=t.map(u=>{const h=Math.atan2(u.y-r,u.x-n),m=Math.hypot(u.x-n,u.y-r);return{x:n+Math.cos(h)*(m+e),y:r+Math.sin(h)*(m+e)}}),i=s.length,o=s.map((u,h)=>{const m=s[(h+1)%i];return{x:(u.x+m.x)/2,y:(u.y+m.y)/2}});let c=`M ${o[0].x} ${o[0].y}`;for(let u=0;u<i;u++){const h=s[(u+1)%i],m=o[(u+1)%i];c+=` Q ${h.x} ${h.y} ${m.x} ${m.y}`}return c+=" Z",{d:c,cx:n,cy:r,expandedPoints:o,controlPoints:s}},ov=(t,e)=>{let n=1/0,r=e;for(let s=0;s<t.length;s++){const i=t[s],o=t[(s+1)%t.length],c=(i.x-o.x)**2+(i.y-o.y)**2;if(c===0)continue;let u=((e.x-i.x)*(o.x-i.x)+(e.y-i.y)*(o.y-i.y))/c;u=Math.max(0,Math.min(1,u));const h=i.x+u*(o.x-i.x),m=i.y+u*(o.y-i.y),g=(e.x-h)**2+(e.y-m)**2;g<n&&(n=g,r={x:h,y:m})}return r},av=(t,e)=>{const n=t.length;if(n<3)return t[0];const s=e*n,i=Math.floor(s)%n,o=s-Math.floor(s),c=t[(i+1)%n],u=t[i],h=t[(i+2)%n],m={x:(u.x+c.x)/2,y:(u.y+c.y)/2},g={x:(c.x+h.x)/2,y:(c.y+h.y)/2},y=c,k=1-o,C=k*k*m.x+2*k*o*y.x+o*o*g.x,R=k*k*m.y+2*k*o*y.y+o*o*g.y;return{x:C,y:R}},kc=(t,e)=>{const n=e.filter(o=>t.memberIds.includes(o.id));if(n.length===0)return null;let r=[];n.forEach(o=>{const u=Math.max(80,o.name.length*8)/2,h=o.x+Vt/2,m=o.y-25;r.push({x:h-u,y:m}),r.push({x:h+u,y:m});const g=o.y+br+10;r.push({x:h-u,y:g}),r.push({x:h+u,y:g}),r.push({x:o.x-5,y:o.y+br/2}),r.push({x:o.x+Vt+5,y:o.y+br/2})});const s=lC(r),i=t.customPadding||23;return cC(s,i)},_r=(t,e,n,r,s=4,i=12)=>{const o=n-t,c=r-e,u=Math.sqrt(o*o+c*c);if(u===0)return`M ${t} ${e}`;const h=o/u,m=c/u,g=-m,y=h,k=Math.max(1,Math.round(u/i)),C=u/k;let R=`M ${t} ${e}`;for(let D=1;D<k;D++){const A=D*C,I=t+h*A,N=e+m*A,M=D%2!==0?s:-s;R+=` L ${I+g*M} ${N+y*M}`}return R+=` L ${n} ${r}`,R},Lu=t=>{if(!t)return 0;const e=t.match(/\d{4}/);return e?parseInt(e[0]):0},uC=({x:t,y:e,darkMode:n,nodes:r,edges:s})=>{const i=n?"#1f2937":"#ffffff",o=n?"#f3f4f6":"#1f2937",c=n?"#374151":"#e5e7eb",u=n?"#9ca3af":"#6b7280",h=Array.from(new Set(r.map(_=>_.gender))).sort(),m=r.some(_=>_.deceased),g=r.some(_=>_.indexPerson),y=Array.from(new Set(s.map(_=>_.type))).sort(),k=15,C=24,R=140,D=30,A=h.length+(m?1:0)+(g?1:0),I=y.length,N=A+I>8,M=N?R*2+k*3:R+k*2,z=D+k+Math.max(A,N?I:A+I)*C+(N?0:20),G=_=>{const E=o,T="none",j=1.5;return _==="M"?a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:E,fill:T,strokeWidth:j}):_==="F"?a.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:E,fill:T,strokeWidth:j}):_==="Pet"?a.jsx("path",{d:"M8 2 L14 8 L8 14 L2 8 Z",stroke:E,fill:T,strokeWidth:j}):_==="Pregnancy"?a.jsx("path",{d:"M8 2 L14 14 L2 14 Z",stroke:E,fill:T,strokeWidth:j}):a.jsx("text",{x:"8",y:"12",textAnchor:"middle",fontSize:"10",fill:E,fontFamily:"sans-serif",children:"?"})},x=_=>a.jsx(Ou,{type:_,width:30,darkMode:n,transparent:!0});return a.jsxs("g",{transform:`translate(${t}, ${e})`,children:[a.jsx("rect",{width:M,height:z,rx:"8",fill:i,stroke:c,strokeWidth:"1",filter:"drop-shadow(0 4px 6px rgb(0 0 0 / 0.1))"}),a.jsx("text",{x:k,y:22,fontWeight:"bold",fill:o,fontSize:"12",letterSpacing:"0.5px",fontFamily:"sans-serif",children:"LEGENDA"}),a.jsx("line",{x1:k,y1:D,x2:M-k,y2:D,stroke:c,strokeWidth:"1"}),a.jsxs("g",{transform:`translate(${k}, ${D+15})`,children:[a.jsxs("g",{children:[A>0&&a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Persone"}),h.map((_,E)=>a.jsxs("g",{transform:`translate(0, ${E*C})`,children:[G(_),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:_==="M"?"Maschio":_==="F"?"Femmina":_})]},_)),m&&a.jsxs("g",{transform:`translate(0, ${h.length*C})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("line",{x1:"2",y1:"2",x2:"14",y2:"14",stroke:o}),a.jsx("line",{x1:"14",y1:"2",x2:"2",y2:"14",stroke:o}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Deceduto"})]}),g&&a.jsxs("g",{transform:`translate(0, ${(h.length+(m?1:0))*C})`,children:[a.jsx("rect",{x:"2",y:"2",width:"12",height:"12",stroke:o,fill:"none"}),a.jsx("rect",{x:"4",y:"4",width:"8",height:"8",stroke:o,fill:"none"}),a.jsx("text",{x:"25",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:"Paz. Designato"})]})]}),y.length>0&&a.jsxs("g",{transform:`translate(${N?R+k:0}, ${N?0:A*C+15})`,children:[a.jsx("text",{x:"0",y:"-5",fontSize:"9",fontWeight:"bold",fill:u,style:{textTransform:"uppercase"},fontFamily:"sans-serif",children:"Relazioni"}),y.map((_,E)=>{var j;const T=((j=nn[_])==null?void 0:j.label)||"Custom";return a.jsxs("g",{transform:`translate(0, ${E*C})`,children:[x(_),a.jsx("text",{x:"35",y:"11",fill:o,fontSize:"11",fontFamily:"sans-serif",children:T})]},_)})]})]})]})},Ou=({type:t,width:e=50,darkMode:n=!1,transparent:r=!1})=>{const s=nn[t]||nn.custom;if(!s)return null;let i=s.color;i==="#000000"&&n&&(i="#ffffff"),(s.renderType.includes("hostile")||s.renderType.includes("triple-zigzag")||s.lineStyle==="zigzag-thick")&&(i="#ef4444");let o=e;const c=e/2,u=7,h=s.renderType.includes("arrow")&&!s.renderType.includes("center")&&s.renderType!=="double-arrow-inward"||s.renderType==="triple-zigzag-center-arrow";let m=6;s.renderType==="arrow-thick"&&(m=8),h&&(o-=m);let g=`M 0 ${u} L ${o} ${u}`,y="2";if(s.lineStyle.startsWith("zigzag")){let z=e>30?3:2,G=e>30?8:6;s.lineStyle==="zigzag-thick"&&(z=e>30?4:3,G=e>30?6:4),g=_r(0,u,o,u,z,G),y="1.5"}const k=s.lineStyle==="dashed"?"6,3":s.lineStyle==="dotted"?"2,2":"",C=c,R=u,D=i,A=`translate(${o}, ${u})`,I=`translate(${c}, ${u})`,N=()=>{if(s.renderType==="fusion"||s.renderType==="triple")return a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, -3)",fill:"none"})]});if(s.renderType==="fusion-hostile")return a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:_r(0,u,o,u),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(s.renderType==="triple-zigzag")return a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:_r(0,u,o,u),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(s.renderType==="double"||s.renderType==="double-zigzag"||s.renderType==="best-friend")return a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, 3)",fill:"none",strokeDasharray:k});if(s.renderType==="oblique")return a.jsx("line",{x1:C+3,y1:R-6,x2:C-3,y2:R+6,stroke:D,strokeWidth:2});if(s.renderType==="oblique-double")return a.jsxs("g",{children:[a.jsx("line",{x1:C+1,y1:R-6,x2:C-5,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("line",{x1:C+5,y1:R-6,x2:C-1,y2:R+6,stroke:D,strokeWidth:2})]});if(s.renderType==="x-cross")return a.jsxs("g",{children:[a.jsx("line",{x1:C+4,y1:R-6,x2:C-4,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("line",{x1:C-4,y1:R-6,x2:C+4,y2:R+6,stroke:D,strokeWidth:2})]});if(s.renderType==="oblique-double-crossed")return a.jsxs("g",{children:[a.jsx("line",{x1:C-1,y1:R-6,x2:C-7,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("line",{x1:C+7,y1:R-6,x2:C+1,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("line",{x1:C-7,y1:R-6,x2:C+7,y2:R+6,stroke:D,strokeWidth:2})]});if(s.renderType==="cutoff-double")return a.jsxs("g",{children:[a.jsx("line",{x1:C-3,y1:R-6,x2:C-3,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("line",{x1:C+3,y1:R-6,x2:C+3,y2:R+6,stroke:D,strokeWidth:2})]});if(s.renderType==="cutoff")return a.jsx("line",{x1:C,y1:R-6,x2:C,y2:R+6,stroke:D,strokeWidth:3});if(s.renderType==="cutoff-repaired-circle")return a.jsxs("g",{children:[a.jsx("line",{x1:C-3,y1:R-6,x2:C-9,y2:R+6,stroke:D,strokeWidth:2}),a.jsx("circle",{cx:C,cy:R,r:4,fill:"none",stroke:D,strokeWidth:1.5}),a.jsx("line",{x1:C+9,y1:R-6,x2:C+3,y2:R+6,stroke:D,strokeWidth:2})]});if(s.renderType==="dashed-inner")return a.jsx("g",{children:a.jsx("path",{d:g,stroke:D,strokeWidth:1.5,strokeDasharray:"3,3",fill:"none",transform:"translate(0, 4)"})});if(s.renderType==="triple-zigzag-center-arrow")return a.jsxs("g",{children:[a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, 3)",fill:"none"}),a.jsx("path",{d:g,stroke:D,strokeWidth:1,transform:"translate(0, -3)",fill:"none"}),a.jsx("path",{d:_r(0,u,o,u,3,8),stroke:"red",strokeWidth:1.5,fill:"none"}),a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:"red",transform:A})]});if(s.renderType==="triangle-up-center")return a.jsx("polygon",{points:"-5,0 5,0 0,-8",fill:D,transform:I});if(s.renderType==="arrow-thick")return a.jsx("polygon",{points:"-6,-6 4,0 -6,6",fill:D,transform:A});if(s.renderType==="double-arrow-inward"){const z=o*.3,G=o*.7;return a.jsxs("g",{children:[a.jsx("polygon",{points:"4,-4 -4,0 4,4",fill:D,transform:`translate(${z}, ${u})`}),a.jsx("polygon",{points:"-4,-4 4,0 -4,4",fill:D,transform:`translate(${G}, ${u})`})]})}return s.renderType.includes("arrow")&&!s.renderType.includes("center")?a.jsx("g",{children:a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:D,transform:A})}):s.renderType==="arrow-x-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:D,transform:A}),a.jsxs("g",{transform:I,children:[a.jsx("line",{x1:"-4",y1:"-4",x2:"4",y2:"4",stroke:D,strokeWidth:2}),a.jsx("line",{x1:"-4",y1:"4",x2:"4",y2:"-4",stroke:D,strokeWidth:2})]})]}):s.renderType==="arrow-box-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:D,transform:A}),a.jsx("rect",{x:"-4",y:"-4",width:"8",height:"8",stroke:D,strokeWidth:2,fill:"white",transform:I})]}):s.renderType==="arrow-diamond-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:D,transform:A}),a.jsx("polygon",{points:"0,-4 4,0 0,4 -4,0",stroke:D,strokeWidth:2,fill:"white",transform:I})]}):s.renderType==="arrow-double-bar-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-5,-4 5,0 -5,4",fill:D,transform:A}),a.jsxs("g",{transform:I,children:[a.jsx("line",{x1:"-2",y1:"-6",x2:"-2",y2:"6",stroke:D,strokeWidth:2}),a.jsx("line",{x1:"2",y1:"-6",x2:"2",y2:"6",stroke:D,strokeWidth:2})]})]}):null},M=r?"shrink-0 mr-2 overflow-visible":"shrink-0 mr-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 overflow-visible";return a.jsxs("svg",{width:e,height:"14",className:M,children:[s.type!=="best-friend"&&a.jsx("path",{d:g,stroke:D,strokeWidth:y,strokeDasharray:k,fill:"none"}),a.jsx(N,{})]})},dC=({value:t,onChange:e,className:n})=>{const[r,s]=H.useState(!1),i=nn[t]||nn.custom||{label:t};return a.jsxs("div",{className:`relative ${n}`,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between p-2 border rounded bg-white text-gray-900 dark:text-gray-100 dark:bg-gray-700 text-xs hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[a.jsxs("div",{className:"flex items-center overflow-hidden",children:[a.jsx(Ou,{type:t}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsx(Tx,{size:14,className:"opacity-50 shrink-0 ml-1"})]}),r&&a.jsxs("div",{className:"absolute top-full left-0 w-full mt-1 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded shadow-xl max-h-60 overflow-y-auto z-50 text-gray-900 dark:text-gray-100 text-left",children:[Object.entries(Er).map(([o,c])=>a.jsxs("div",{children:[a.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-900 text-[9px] font-bold uppercase text-gray-500 sticky top-0 border-b border-gray-200 dark:border-gray-700",children:o}),c.map(u=>{const h=nn[u];return h?a.jsxs("button",{onClick:()=>{e(u),s(!1)},className:`w-full flex items-center p-2 text-xs hover:bg-blue-50 dark:hover:bg-blue-900/30 text-left border-b border-gray-50 dark:border-gray-700 ${t===u?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[a.jsx(Ou,{type:u}),a.jsx("span",{children:h.label})]},u):null})]},o)),a.jsx("div",{className:"p-1 sticky bottom-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:a.jsx("button",{onClick:()=>s(!1),className:"w-full py-1 text-center text-gray-400 hover:text-red-500 text-[10px]",children:"Chiudi"})})]})]})},hC=({edge:t,start:e,end:n,isSelected:r,darkMode:s,customConfig:i,onSelect:o,onAddChild:c,isTargetGroup:u,tNode:h})=>{let m=nn[t.type];!m&&i&&(m=i.config),m||(m={color:"#000",lineStyle:"solid",renderType:"standard"});const g=t.color||m.color,y=m.renderType,k=r?"#3b82f6":s&&g==="#000000"?"#ffffff":g,C=["marriage","secret","couple","divorce-commit","separation","separation-repaired","separation-cohab","divorce","divorce-repaired","cohabitation","affair","re-marriage","engagement","one-night"].includes(t.type),R=aC(e.y,n.y);let D=(e.x+n.x)/2,A=(e.y+n.y)/2;C&&(A=R);let I="";const N=C?0:Math.atan2(n.y-e.y,n.x-e.x)*180/Math.PI;let M=20;if(h&&!u){const oe=e.x-n.x,re=e.y-n.y;let We=20;if(["M","F","TransWoman","TransMan","NonBinary"].includes(h.gender)||(We=15),h.gender!=="F"&&(Math.abs(oe)>.01||Math.abs(re)>.01)){const Z=Math.atan2(re,oe),ae=Math.abs(Math.cos(Z)),fe=Math.abs(Math.sin(Z));We=Math.min(We/(ae||1),We/(fe||1)),We>30&&(We=30)}M=We}const z=y.includes("arrow-thick")?4:6,G=(u?0:M)+z,x=`translate(${n.x},${n.y}) rotate(${N}) translate(-${G},0)`,_=`translate(${D},${A}) rotate(${N})`;let E=n.x,T=n.y;if((y.includes("arrow")&&!y.includes("center")&&y!=="double-arrow-inward"||y==="triple-zigzag-center-arrow")&&!C){const oe=G+4,re=Math.atan2(n.y-e.y,n.x-e.x);E=n.x-Math.cos(re)*oe,T=n.y-Math.sin(re)*oe}if(C)I=`M ${e.x} ${e.y+Go} L ${e.x} ${R} L ${n.x} ${R} L ${n.x} ${n.y+Go}`;else if(t.type.startsWith("child")||t.type.startsWith("twin"))t.type.startsWith("twin")?I=`M ${e.x} ${e.y} L ${E} ${T}`:I=`M ${e.x} ${e.y} L ${E} ${e.y} L ${E} ${T}`;else if(m.lineStyle.startsWith("zigzag")){let oe=4,re=12;m.lineStyle==="zigzag-thick"&&(oe=6,re=10),I=_r(e.x,e.y,E,T,oe,re)}else I=`M ${e.x} ${e.y} Q ${D} ${A} ${E} ${T}`;const L=m.lineStyle==="dashed"?"8,4":m.lineStyle==="dotted"?"2,2":"0",S=()=>{let oe=D,re=A;if(t.type==="best-friend")return a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(y==="fusion"||y==="triple")return a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"})]});if(y==="fusion-hostile")return a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:_r(e.x,e.y,E,T),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(y==="triple-zigzag")return a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-3,-3)",fill:"none"}),a.jsx("path",{d:_r(e.x,e.y,E,T),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(y==="double"||y==="double-zigzag"||y==="best-friend")return a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(3,3)",fill:"none",strokeDasharray:L});if(y==="oblique")return a.jsx("line",{x1:oe+5,y1:re-10,x2:oe-5,y2:re+10,stroke:k,strokeWidth:2});if(y==="oblique-double")return a.jsxs("g",{children:[a.jsx("line",{x1:oe+2,y1:re-10,x2:oe-8,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:oe+8,y1:re-10,x2:oe-2,y2:re+10,stroke:k,strokeWidth:2})]});if(y==="x-cross")return a.jsxs("g",{children:[a.jsx("line",{x1:oe+5,y1:re-10,x2:oe-5,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:oe-5,y1:re-10,x2:oe+5,y2:re+10,stroke:k,strokeWidth:2})]});if(y==="oblique-double-crossed")return a.jsxs("g",{children:[a.jsx("line",{x1:oe+2,y1:re-10,x2:oe-8,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:oe+8,y1:re-10,x2:oe-2,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:oe-8,y1:re-10,x2:oe+8,y2:re+10,stroke:k,strokeWidth:2})]});if(y==="cutoff-double")return a.jsxs("g",{children:[a.jsx("line",{x1:oe-3,y1:re-10,x2:oe-3,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("line",{x1:oe+3,y1:re-10,x2:oe+3,y2:re+10,stroke:k,strokeWidth:2})]});if(y==="cutoff")return a.jsx("line",{x1:oe,y1:re-10,x2:oe,y2:re+10,stroke:k,strokeWidth:3});if(y==="cutoff-repaired-circle")return a.jsxs("g",{children:[a.jsx("line",{x1:oe-4,y1:re-10,x2:oe-14,y2:re+10,stroke:k,strokeWidth:2}),a.jsx("circle",{cx:oe,cy:re,r:5,fill:"none",stroke:k,strokeWidth:1.5}),a.jsx("line",{x1:oe+14,y1:re-10,x2:oe+4,y2:re+10,stroke:k,strokeWidth:2})]});if(y==="dashed-inner")return a.jsx("g",{children:a.jsx("path",{d:I,stroke:k,strokeWidth:1.5,strokeDasharray:"4,4",fill:"none",transform:"translate(0, 6)"})});if(y==="triple-zigzag-center")return a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(6,6)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-6,-6)",fill:"none"}),a.jsx("path",{d:_r(e.x,e.y,E,T,4,12),stroke:"red",strokeWidth:1.5,fill:"none"})]});if(y==="triangle-up-center")return a.jsx("polygon",{points:"-6,0 6,0 0,-10",fill:k,transform:`translate(${D},${A})`});if(y==="double-arrow-inward"){const We=E-e.x,Z=T-e.y,ae=Math.atan2(Z,We)*180/Math.PI,fe=e.x+We*.33,De=e.y+Z*.33,Se=e.x+We*.67,Fe=e.y+Z*.67;return a.jsxs("g",{children:[a.jsx("polygon",{points:"6,-6 -6,0 6,6",fill:k,transform:`translate(${fe},${De}) rotate(${ae})`}),a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:`translate(${Se},${Fe}) rotate(${ae})`})]})}return y==="arrow-x-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x}),a.jsxs("g",{transform:_,children:[a.jsx("line",{x1:"-6",y1:"-6",x2:"6",y2:"6",stroke:k,strokeWidth:2}),a.jsx("line",{x1:"-6",y1:"6",x2:"6",y2:"-6",stroke:k,strokeWidth:2})]})]}):y==="arrow-box-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x}),a.jsx("rect",{x:"-6",y:"-6",width:"12",height:"12",stroke:k,strokeWidth:2,fill:"white",transform:_})]}):y==="arrow-diamond-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x}),a.jsx("polygon",{points:"0,-6 6,0 0,6 -6,0",stroke:k,strokeWidth:2,fill:"white",transform:_})]}):y==="arrow-double-bar-center"?a.jsxs("g",{children:[a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x}),a.jsxs("g",{transform:_,children:[a.jsx("line",{x1:"-3",y1:"-8",x2:"-3",y2:"8",stroke:k,strokeWidth:2}),a.jsx("line",{x1:"3",y1:"-8",x2:"3",y2:"8",stroke:k,strokeWidth:2})]})]}):y.includes("arrow")&&!y.includes("center")&&!y.includes("thick")?a.jsx("g",{children:a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x})}):y==="arrow-thick"?a.jsx("polygon",{points:"-8,-8 4,0 -8,8",fill:k,transform:x}):y==="arrow-end"?a.jsx("g",{children:a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:k,transform:x})}):y==="arrow-open-end"?a.jsx("g",{children:a.jsx("polyline",{points:"-6,-6 6,0 -6,6",stroke:k,strokeWidth:2,fill:"none",transform:x})}):y==="arrow-open-center"?a.jsx("g",{children:a.jsx("polyline",{points:"-6,-6 6,0 -6,6",stroke:k,strokeWidth:2,fill:"none",transform:_})}):y==="triple-zigzag-center-arrow"?a.jsxs("g",{children:[a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(6,6)",fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:1,transform:"translate(-6,-6)",fill:"none"}),a.jsx("path",{d:_r(e.x,e.y,E,T,4,12),stroke:"red",strokeWidth:1.5,fill:"none"}),a.jsx("polygon",{points:"-6,-6 6,0 -6,6",fill:"red",transform:x})]}):null},Je=oe=>{oe.stopPropagation(),oe.preventDefault(),c(oe,t.id)};return a.jsxs("g",{className:"group hover:opacity-80 cursor-pointer",onClick:o,children:[a.jsx("path",{d:I,stroke:"transparent",strokeWidth:20,fill:"none"}),a.jsx("path",{d:I,stroke:k,strokeWidth:r||m.lineStyle==="zigzag-thick"?3:2,strokeDasharray:L,fill:"none"}),a.jsx(S,{}),t.label&&a.jsx("text",{x:D,y:A-15,textAnchor:"middle",fill:k,className:"text-[10px] bg-white dark:bg-gray-800 px-1",children:t.label}),r&&C&&a.jsxs("g",{transform:`translate(${D}, ${R})`,onPointerDown:Je,style:{touchAction:"none"},children:[a.jsx("circle",{r:12,fill:"#10b981",stroke:"white"}),a.jsx(Il,{size:12,x:-6,y:-6,stroke:"white",strokeWidth:3}),a.jsx("title",{children:"Aggiungi Figlio alla Coppia"})]})]})},fC=({node:t,isSelected:e,showLabelType:n,darkMode:r,onHandleDown:s,selectionMode:i,onRename:o})=>{const[c,u]=H.useState(!1),[h,m]=H.useState(t.name),g=H.useRef(null);H.useEffect(()=>{c&&g.current&&(g.current.focus(),g.current.select())},[c]);const y=re=>{re.stopPropagation(),m(t.name),u(!0)},k=()=>{u(!1),h.trim()!==""&&h!==t.name&&o(t.id,h)},C=re=>{re.key==="Enter"&&k(),re.key==="Escape"&&u(!1)},R=r?"#ffffff":"#000000",D=e||t.indexPerson?3:1.5,A=e?r?"#374151":"#e0f2fe":r?"#1f2937":"#ffffff",I=r?"#ffffff":"#000000",N=r?"#111827":"#ffffff",M=Vt,z=br,G=Go;let x;switch(t.gender){case"M":x=a.jsx("rect",{x:0,y:0,width:M,height:z,stroke:R,strokeWidth:D,fill:A});break;case"F":x=a.jsx("circle",{cx:M/2,cy:z/2,r:M/2,stroke:R,strokeWidth:D,fill:A});break;case"TransWoman":x=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:M,height:z,stroke:R,strokeWidth:D,fill:A}),a.jsx("circle",{cx:M/2,cy:z/2,r:M/3,stroke:R,strokeWidth:1,fill:"none"})]});break;case"TransMan":x=a.jsxs("g",{children:[a.jsx("circle",{cx:M/2,cy:z/2,r:M/2,stroke:R,strokeWidth:D,fill:A}),a.jsx("rect",{x:10,y:10,width:M-20,height:z-20,stroke:R,strokeWidth:1,fill:"none"})]});break;case"NonBinary":x=a.jsx("polygon",{points:`${M/2},0 ${M},${z/2} ${M/2},${z} 0,${z/2}`,stroke:R,strokeWidth:D,fill:A});break;case"Pet":x=a.jsx("path",{d:`M${M/2} 0 L${M} ${z/2} L${M/2} ${z} L0 ${z/2} Z`,stroke:R,strokeWidth:D,fill:A});break;case"Pregnancy":x=a.jsx("path",{d:`M${M/2} 0 L${M} ${z} L0 ${z} Z`,stroke:R,strokeWidth:D,fill:A});break;case"Miscarriage":x=a.jsx("circle",{cx:M/2,cy:z/2,r:8,fill:R});break;case"Abortion":x=a.jsx("g",{children:a.jsx("path",{d:`M5 5 L${M-5} ${z-5} M${M-5} 5 L5 ${z-5}`,stroke:R,strokeWidth:2})});break;case"Stillbirth":x=a.jsxs("g",{children:[a.jsx("rect",{x:0,y:0,width:M,height:z,stroke:R,strokeWidth:D,fill:A}),a.jsx("path",{d:`M0 0 L${M} ${z} M${M} 0 L0 ${z}`,stroke:R,strokeWidth:1})]});break;default:x=a.jsx("rect",{x:5,y:5,width:M-10,height:z-10,stroke:R,strokeWidth:D,fill:A,strokeDasharray:"4 2"});break}const _=()=>a.jsxs("g",{className:"pointer-events-none",children:[t.substanceAbuse&&(t.gender==="M"?a.jsx("rect",{x:0,y:z/2,width:M,height:z/2,fill:"#f97316",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M 0 ${z/2} A ${G} ${G} 0 0 0 ${M} ${z/2} Z`,fill:"#f97316",fillOpacity:"0.8",stroke:"none"})),t.mentalIssue&&(t.gender==="M"?a.jsx("rect",{x:0,y:0,width:M/3,height:z,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"}):a.jsx("path",{d:`M ${G} 0 A ${G} ${G} 0 0 0 ${G} ${z} Z`,fill:"#8b5cf6",fillOpacity:"0.8",stroke:"none"})),t.gayLesbian&&a.jsx("path",{d:`M ${M/2-7} ${z-12} L ${M/2+7} ${z-12} L ${M/2} ${z} Z`,fill:"#ec4899",stroke:A,strokeWidth:1})]}),E=t.deceased?a.jsxs("g",{stroke:R,strokeWidth:1.5,children:[a.jsx("line",{x1:0,y1:0,x2:M,y2:z}),a.jsx("line",{x1:M,y1:0,x2:0,y2:z})]}):null,T=t.indexPerson?t.gender==="M"?a.jsx("rect",{x:6,y:6,width:M-12,height:z-12,stroke:R,strokeWidth:1.5,fill:"none"}):a.jsx("circle",{cx:M/2,cy:z/2,r:M/2-6,stroke:R,strokeWidth:1.5,fill:"none"}):null,j=t.birthDate&&t.birthDate.trim()!=="",L=t.showAge!==!1;let S="";if(j&&L)if(n==="age")S=xl(t.birthDate);else if(n==="year"){const re=Jw(t.birthDate);re&&(S=re.getFullYear().toString())}else n==="date"&&(S=t.birthDate);const Je=(re,We)=>{re.stopPropagation(),re.preventDefault(),s(re,We,t.id)},oe=({y:re,text:We,size:Z,bold:ae})=>{if(!We)return null;const fe=Z*.65,De=We.length*fe+8,Se=Z+4;return a.jsxs("g",{pointerEvents:"none",children:[a.jsx("rect",{x:M/2-De/2,y:re-Se/2,width:De,height:Se,fill:N,fillOpacity:"0.9",rx:"3"}),a.jsx("text",{x:M/2,y:re,dominantBaseline:"middle",textAnchor:"middle",fill:I,className:`text-[${Z}px] font-sans ${ae?"font-bold":""} select-none`,style:{fontSize:Z},children:We})]})};return a.jsxs("g",{transform:`translate(${t.x},${t.y})`,className:"cursor-pointer group",onDoubleClick:y,children:[x," ",a.jsx(_,{})," ",T," ",E,c?a.jsx("foreignObject",{x:-40,y:-30,width:120,height:30,children:a.jsx("input",{ref:g,value:h,onChange:re=>m(re.target.value),onBlur:k,onKeyDown:C,style:{width:"100%",height:"100%",border:"1px solid #3b82f6",borderRadius:"4px",padding:"2px",fontSize:"12px",textAlign:"center",background:N,color:I,outline:"none"}})}):a.jsx(oe,{y:-10,text:t.name,size:11,bold:!0}),S&&a.jsx("text",{x:M/2,y:z/2,dominantBaseline:"middle",textAnchor:"middle",fill:I,className:"text-[11px] font-bold select-none pointer-events-none opacity-80",children:S}),t.label&&a.jsx(oe,{y:z+14,text:t.label,size:9}),t.notes&&t.notes.length>0&&a.jsx("circle",{cx:M+5,cy:0,r:4,fill:"#ef4444",stroke:"white",strokeWidth:1}),e&&!i&&!c&&a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${M+20}, ${G})`,onPointerDown:re=>Je(re,"spouse"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#db2777",strokeWidth:2}),a.jsx(Mo,{size:14,x:-7,y:-7,fill:"#db2777",stroke:"#db2777"}),a.jsx("title",{children:"Coniuge"})]}),a.jsxs("g",{transform:`translate(${G}, ${z+25})`,onPointerDown:re=>Je(re,"child"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#10b981",strokeWidth:2}),a.jsx(Il,{size:14,x:-7,y:-7,color:"#10b981",strokeWidth:3}),a.jsx("title",{children:"Figlio"})]}),a.jsxs("g",{transform:`translate(${G}, -25)`,onPointerDown:re=>Je(re,"parents"),className:"cursor-crosshair hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("circle",{r:14,fill:r?"#333":"white",stroke:"#8b5cf6",strokeWidth:2}),a.jsx(Lo,{size:14,x:-7,y:-7,color:"#8b5cf6"}),a.jsx("title",{children:"Genitori"})]}),a.jsxs("g",{transform:`translate(-20, ${G})`,onPointerDown:re=>Je(re,"link"),className:"cursor-alias hover:opacity-80",style:{touchAction:"none"},children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:1}),a.jsx(Ip,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Relazione"})]})]})]})},pC=({x:t,y:e,mode:n,customPresets:r,onSelect:s,onClose:i})=>{let o=[];n==="child"||n==="parents"?o=Er.Figli||[]:n==="spouse"?o=Er["Struttura / Coppia"]||[]:o=["Interazione / Affettive","Conflitto e Distanza","Violenza, Abuso e Potere","Simboli (Immagini)"].reduce((m,g)=>m.concat(Er[g]||[]),[]);const c=[...o.map(h=>{const m=nn[h];return m?{type:h,label:m.label}:null}).filter(Boolean),...r.map(h=>({type:h.id,label:h.name}))],u={left:t,top:e};return t>window.innerWidth-260&&(u.left=t-260),e>window.innerHeight-300&&(u.top=e-300),a.jsxs("div",{className:"fixed theme-panel shadow-2xl rounded-lg p-2 w-64 border theme-border z-[9999] flex flex-col max-h-80",style:u,children:[a.jsxs("div",{className:"text-[10px] font-bold opacity-50 uppercase px-2 py-1 rounded sticky top-0 flex justify-between items-center z-10 mb-1",style:{backgroundColor:"rgba(127,127,127,0.1)"},children:[a.jsx("span",{children:"Seleziona Tipo"}),a.jsx("button",{onClick:i,className:"hover:text-red-500",children:a.jsx(Us,{size:12})})]}),a.jsx("div",{className:"overflow-y-auto flex-1 custom-scrollbar",children:c.map(h=>h&&a.jsxs("button",{onClick:()=>s(h.type),className:"w-full flex items-center gap-2 p-2 text-xs theme-hover text-left border-b theme-border last:border-0",children:[a.jsx("div",{className:"shrink-0",children:a.jsx(Ou,{type:h.type})}),a.jsx("span",{className:"truncate",children:h.label})]},h.type))})]})},mC={Pastello:Kw,Vividi:Qw,Neutri:nC},gC=({value:t,onChange:e})=>{const n=H.useRef(null);return a.jsxs("div",{className:"space-y-2",children:[Object.entries(mC).map(([r,s])=>a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1",children:r}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.map(i=>a.jsx("button",{onClick:()=>e(i),className:"w-6 h-6 rounded-full border border-black/10 dark:border-white/10 transition-transform hover:scale-110 flex items-center justify-center relative",style:{backgroundColor:i},title:i,children:t.toLowerCase()===i.toLowerCase()&&a.jsx("div",{className:`w-2 h-2 rounded-full ${["#ffffff","#f3f4f6","#fbcfe8","#fde68a"].includes(i)?"bg-black":"bg-white"}`})},i))})]},r)),a.jsxs("div",{className:"pt-2 border-t theme-border mt-2",children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},className:"w-full flex items-center justify-center gap-2 p-1.5 text-xs rounded border theme-border theme-hover opacity-70 hover:opacity-100",children:[a.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:t}}),a.jsx("span",{children:"Colore Personalizzato..."})]}),a.jsx("input",{ref:n,type:"color",className:"hidden",value:t,onChange:r=>e(r.target.value)})]})]})},sh=({notes:t,onChange:e})=>{const[n,r]=H.useState(""),[s,i]=H.useState(""),[o,c]=H.useState(null),u=H.useMemo(()=>[...t].sort((g,y)=>{const k=Lu(g.date);return Lu(y.date)-k}),[t]),h=()=>{if(!n.trim())return;const g=s||new Date().toLocaleDateString();o?(e(t.map(y=>y.id===o?{...y,text:n,date:g}:y)),c(null)):e([...t,{id:Ue(),text:n,date:g}]),r(""),i("")},m=g=>{c(g.id),r(g.text),i(g.date)};return a.jsxs("div",{className:"border-t theme-border pt-2 mt-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1 theme-text",children:"Diario Clinico / Note"}),a.jsx("div",{className:"space-y-1 mb-2 max-h-32 overflow-y-auto custom-scrollbar",children:u.map(g=>a.jsxs("div",{className:"p-2 rounded text-xs relative group border theme-border bg-yellow-50/10 border-yellow-200/50 dark:border-yellow-900/30",children:[a.jsx("div",{className:"absolute inset-0 bg-yellow-500 opacity-10 rounded pointer-events-none"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("div",{className:"font-bold opacity-50 text-[10px] theme-text",children:g.date||"Senza data"}),a.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:()=>m(g),className:"theme-text hover:bg-black/10 dark:hover:bg-white/10 rounded p-0.5",children:a.jsx(vu,{size:10})}),a.jsx("button",{onClick:()=>e(t.filter(y=>y.id!==g.id)),className:"text-red-500 hover:bg-red-100 rounded p-0.5",children:a.jsx(Us,{size:10})})]})]}),a.jsx("div",{className:"whitespace-pre-wrap theme-text",children:g.text})]})]},g.id))}),a.jsxs("div",{className:"flex flex-col gap-1 border theme-border p-1 rounded bg-black/5 dark:bg-white/5",children:[a.jsx("input",{type:"text",className:"w-full text-[10px] border-b theme-border bg-transparent p-1 outline-none theme-text placeholder-opacity-50 placeholder-current",value:s,onChange:g=>i(g.target.value),placeholder:"Data (es. Gennaio 2025, 12/05/98)"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("textarea",{className:"flex-1 border-none bg-transparent text-xs p-1 outline-none resize-none h-12 theme-text placeholder-opacity-50 placeholder-current",value:n,onChange:g=>r(g.target.value),placeholder:o?"Modifica nota...":"Nuova nota...",onKeyDown:g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),h())}}),a.jsx("button",{onClick:h,className:"bg-blue-600 text-white p-1 rounded self-end hover:bg-blue-700",children:o?a.jsx(Ix,{size:14}):a.jsx(Il,{size:14})}),o&&a.jsx("button",{onClick:()=>{c(null),r(""),i("")},className:"bg-gray-200 text-gray-600 p-1 rounded self-end hover:bg-gray-300",children:a.jsx(Us,{size:14})})]})]})]})},yC=({onClose:t,nodes:e,edges:n,groups:r})=>{const[s,i]=H.useState(null),[o,c]=H.useState(""),u=H.useMemo(()=>{if(!s)return null;const m=e.find(N=>N.id===s);if(!m)return null;const y=n.filter(N=>(N.fromId===s||N.toId===s)&&Er.Struttura.includes(N.type)).map(N=>{const M=N.fromId===s?N.toId:N.fromId,z=e.find(x=>x.id===M),G=nn[N.type];return{name:z?z.name:"Sconosciuto",type:G?G.label:N.type}}),C=n.filter(N=>N.fromId===s||N.toId===s).map(N=>{if(Er.Struttura.includes(N.type))return null;const M=N.fromId===s?N.toId:N.fromId;let z="Sconosciuto";const G=e.find(_=>_.id===M);if(G)z=G.name;else{const _=r.find(E=>E.id===M);if(_){const E=e.filter(T=>_.memberIds.includes(T.id)).map(T=>T.name).join(", ");z=`Gruppo: ${_.label} (Membri: ${E})`}}const x=nn[N.type];return{id:N.id,with:z,type:x?x.label:N.type,notes:N.notes}}).filter(Boolean),D=n.filter(N=>N.toId===s&&N.type.startsWith("child")).map(N=>{const M=e.find(z=>z.id===N.fromId);return M?M.name:"Ignoto"}),I=n.filter(N=>N.fromId===s&&N.type.startsWith("child")).map(N=>{const M=e.find(z=>z.id===N.toId);return M?M.name:"Ignoto"});return{person:m,relations:C,parents:D,children:I,spouses:y}},[s,e,n,r]),h=e.filter(m=>m.name.toLowerCase().includes(o.toLowerCase()));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel border theme-border rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex overflow-hidden",children:[a.jsxs("div",{className:"w-1/3 border-r theme-border flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h2",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(bo,{})," Report"]}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx(xu,{className:"absolute left-2 top-2.5 opacity-50 theme-text",size:14}),a.jsx("input",{className:"w-full pl-8 p-2 text-sm border rounded bg-transparent theme-border theme-text placeholder-opacity-50 placeholder-current focus:outline-none focus:ring-1 focus:ring-[var(--theme-accent)]",placeholder:"Cerca persona...",value:o,onChange:m=>c(m.target.value)})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:h.map(m=>a.jsxs("button",{onClick:()=>i(m.id),className:`w-full text-left p-3 border-b theme-border theme-hover transition-colors ${s===m.id?"bg-black/10 dark:bg-white/10 border-l-4 border-l-[var(--theme-accent)]":""}`,children:[a.jsx("div",{className:"font-bold text-sm theme-text",children:m.name}),a.jsxs("div",{className:"text-xs opacity-50 theme-text",children:[m.gender,"  ",xl(m.birthDate)," anni"]})]},m.id))})]}),a.jsxs("div",{className:"flex-1 flex flex-col bg-black/5 dark:bg-white/5",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center theme-panel border-b theme-border",children:[a.jsx("h3",{className:"font-bold theme-text",children:"Dettagli Scheda"}),a.jsx("button",{onClick:t,className:"theme-text theme-hover p-1 rounded",children:a.jsx(Us,{})})]}),a.jsx("div",{className:"p-6 overflow-y-auto flex-1 custom-scrollbar",children:u?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsx("div",{className:`w-16 h-16 flex items-center justify-center rounded-full text-2xl font-bold shadow-sm border theme-border ${["M","TransMan"].includes(u.person.gender)?"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200":["F","TransWoman"].includes(u.person.gender)?"bg-pink-100 text-pink-600 dark:bg-pink-900 dark:text-pink-200":"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-200"}`,children:u.person.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold theme-text",children:u.person.name}),a.jsxs("div",{className:"text-sm opacity-70 theme-text",children:["Nato/a: ",u.person.birthDate||"?","  Et: ",xl(u.person.birthDate)]})]})]}),u.spouses.length>0&&a.jsxs("div",{className:"p-4 rounded shadow-sm border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h4",{className:"font-bold mb-2 text-sm uppercase opacity-70 theme-text flex items-center gap-2",children:[a.jsx(Mo,{size:12})," Partner / Coniugi"]}),u.spouses.map((m,g)=>a.jsxs("div",{className:"font-medium theme-text",children:[" ",m.name," ",a.jsxs("span",{className:"opacity-60 text-xs",children:["(",m.type,")"]})]},g))]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Genitori"}),u.parents.length?u.parents.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsx("h4",{className:"font-bold mb-2 text-sm uppercase opacity-50 theme-text",children:"Figli"}),u.children.length?u.children.map((m,g)=>a.jsxs("div",{className:"theme-text",children:[" ",m]},g)):a.jsx("span",{className:"theme-text opacity-50",children:"-"})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-4 rounded shadow-sm",children:[a.jsxs("h4",{className:"font-bold mb-3 text-sm uppercase opacity-50 theme-text",children:["Altre Relazioni (",u.relations.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[u.relations.map(m=>a.jsxs("div",{className:"flex justify-between items-center p-2 border theme-border rounded theme-hover",children:[a.jsxs("span",{className:"font-medium theme-text",children:[m.type," ",a.jsx("span",{className:"font-normal opacity-70",children:"con"})," ",m.with]}),m.notes.length>0&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100 px-2 py-0.5 rounded border border-yellow-200 dark:border-yellow-700",children:"Note"})]},m.id)),u.relations.length===0&&a.jsx("div",{className:"text-sm opacity-50 theme-text",children:"Nessuna altra relazione registrata"})]})]})]}):a.jsx("div",{className:"opacity-50 text-center mt-20 theme-text",children:"Seleziona una persona per vedere il report"})})]})]})})},vC=({onClose:t,onExport:e,onImport:n,setCustomUser:r,customUser:s,setFirebaseConfig:i,firebaseConfig:o})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"theme-panel p-6 rounded-lg shadow-xl w-96 space-y-4 border theme-border",children:[a.jsxs("h2",{className:"font-bold text-lg flex justify-between items-center",children:["Impostazioni ",a.jsx("button",{onClick:t,children:a.jsx(Us,{size:20})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"ID Utente (Opzionale)"}),a.jsx("input",{className:"w-full border theme-border p-2 rounded bg-transparent text-sm",value:s,onChange:c=>r(c.target.value),placeholder:"Tuo ID univoco per sync"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Configurazione Firebase (JSON)"}),a.jsx("textarea",{className:"w-full border theme-border p-2 rounded bg-transparent text-[10px] h-24 font-mono",value:o,onChange:c=>i(c.target.value),placeholder:'{"apiKey": "...", ...}'})]}),a.jsxs("div",{className:"pt-4 border-t theme-border flex flex-col gap-2",children:[a.jsxs("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm flex items-center justify-center gap-2",children:[a.jsx(Ep,{size:14})," Backup Dati (JSON)"]}),a.jsxs("label",{className:"w-full border theme-border py-2 rounded text-sm flex items-center justify-center gap-2 cursor-pointer theme-hover",children:[a.jsx(Hb,{size:14})," Ripristina Backup",a.jsx("input",{type:"file",onChange:n,className:"hidden",accept:".json"})]})]})]})}),xC=({onClose:t,firebaseConfig:e})=>a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-4xl h-[90vh] rounded-xl shadow-2xl flex flex-col overflow-hidden border theme-border",children:[a.jsxs("div",{className:"p-4 border-b theme-border flex justify-between items-center bg-black/5 dark:bg-white/5 shrink-0",children:[a.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2 theme-text",children:[a.jsx(bp,{className:"text-[var(--theme-accent)]"})," Manuale Utente"]}),a.jsx("button",{onClick:t,className:"p-1 theme-hover rounded theme-text",children:a.jsx(Us,{})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar leading-relaxed",children:[a.jsx("style",{children:`
                        .manual-section { margin-bottom: 40px; }
                        .manual-h2 { font-size: 1.4rem; font-weight: 700; color: var(--theme-accent); border-left: 4px solid var(--theme-accent); padding-left: 12px; margin-bottom: 1.5rem; margin-top: 1rem; background: rgba(125,125,125,0.05); padding-top:8px; padding-bottom:8px; border-radius: 0 8px 8px 0; }
                        .manual-h3 { font-size: 1.1rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.8rem; opacity: 0.9; color: var(--theme-text); border-bottom: 1px dashed var(--theme-border); padding-bottom: 4px; }
                        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; margin-top: 15px; }
                        .tool-card { border: 1px solid var(--theme-border); border-radius: 8px; padding: 16px; display: flex; gap: 16px; background: rgba(125,125,125,0.03); align-items: flex-start; transition: transform 0.2s; }
                        .tool-card:hover { background: rgba(125,125,125,0.06); }
                        .key-badge { background: rgba(125,125,125,0.1); border: 1px solid var(--theme-border); padding: 2px 8px; border-radius: 6px; font-family: monospace; font-weight: bold; font-size: 0.9em; color: var(--theme-text); display: inline-block; min-width: 24px; text-align: center; }
                        .theme-text-desc { color: var(--theme-text); opacity: 0.7; font-size: 0.9rem; margin-top: 4px; line-height: 1.4; }
                        .icon-box { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: rgba(125,125,125,0.1); }
                        ul.manual-list { list-style: disc; margin-left: 20px; color: var(--theme-text); opacity: 0.9; }
                        ul.manual-list li { margin-bottom: 6px; }
                        strong { color: var(--theme-text); opacity: 1; }
                    `}),a.jsxs("div",{className:"text-center mb-10",children:[a.jsx("h1",{className:"text-3xl font-bold theme-text mb-2",children:"GenoPro Web"}),a.jsx("p",{className:"opacity-60 theme-text text-lg",children:"Guida completa alle funzionalit, strumenti e simbologia."})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"1. Dashboard e Temi"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Zh,{className:"text-blue-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Categorie"}),a.jsx("div",{className:"theme-text-desc",children:"Filtra per Famiglie, Coppie, Individuali, Lavoro, ecc."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(kp,{className:"text-orange-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Temi Grafici"}),a.jsxs("div",{className:"theme-text-desc",children:["Scegli tra vari stili: ",a.jsx("b",{children:"Light"}),", ",a.jsx("b",{children:"Dark"}),", ",a.jsx("b",{children:"Sepia"}),", ",a.jsx("b",{children:"Dracula"}),", ",a.jsx("b",{children:"Nordic"})," e altri."]})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(xu,{className:"text-purple-500"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Ricerca"}),a.jsx("div",{className:"theme-text-desc",children:"Cerca genogrammi velocemente per titolo."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"2. Navigazione Touch (Tablet & iPad)"}),a.jsx("p",{className:"theme-text mb-4 opacity-80",children:"L'interfaccia  ottimizzata per l'uso con le dita e supporta gesture avanzate."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 rounded border theme-border bg-blue-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scorrimento (Pan)"}),a.jsx("p",{className:"theme-text-desc",children:"Trascina un dito su un'area vuota per spostarti nel grafico."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-green-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Zoom (Pinch)"}),a.jsx("p",{className:"theme-text-desc",children:"Usa due dita (pizzico) per ingrandire o rimpicciolire la vista."})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-purple-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiunta Rapida (Long Press)"}),a.jsxs("p",{className:"theme-text-desc",children:["Tocca e ",a.jsx("b",{children:"tieni premuto"})," un dito su un punto vuoto per aprire il menu rapido (M/F)."]})]})]}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-orange-500/5 flex gap-4 items-start",children:[a.jsx("div",{className:"text-2xl",children:""}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Selezione Multipla"}),a.jsxs("p",{className:"theme-text-desc",children:["Attiva ",a.jsx("strong",{children:"Mod. Selezione"})," nella toolbar, poi trascina per creare un rettangolo."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"3. Costruzione Rapida"}),a.jsx("p",{className:"mb-4 theme-text opacity-80",children:"Seleziona una persona per vedere le 4 maniglie colorate:"}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-pink-100 dark:bg-pink-900/30 border border-pink-200 dark:border-pink-800",children:a.jsx(Mo,{size:20,className:"text-pink-600 dark:text-pink-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Destra: Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un coniuge/partner a destra."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800",children:a.jsx(Il,{size:20,className:"text-green-600 dark:text-green-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Basso: Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio (collegato alla coppia se presente)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-purple-100 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800",children:a.jsx(Lo,{size:20,className:"text-purple-600 dark:text-purple-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Alto: Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Genera automaticamente la coppia di genitori sopra il soggetto."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800",children:a.jsx(Ip,{size:20,className:"text-orange-600 dark:text-orange-400"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Sinistra: Link"}),a.jsxs("div",{className:"theme-text-desc",children:["Trascina verso un'altra persona ",a.jsx("b",{children:"o un Gruppo"})," per creare una relazione manuale."]})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"4. Propriet e Simbologia"}),a.jsx("h3",{className:"manual-h3",children:" Propriet Persona"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Dati Anagrafici:"}),' Nome, Data (es. "1980" o "12/05/1980").']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Mostra Et:"})," Checkbox per nascondere/mostrare l'et calcolata."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Marcatori Clinici:"})," Deceduto (X), Pz. Designato (Doppio bordo), Abuso Sostanze (Arancio), Problema Psi (Viola), Omosessualit (Triangolo Rosa)."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Relazione"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Tipo Relazione:"})," Scegli tra decine di stili (Conflitto, Armonia, Abuso, Distanza, ecc.)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Ancoraggio Gruppi:"})," Se colleghi un gruppo, usa lo ",a.jsx("strong",{children:"Slider (0-100%)"})," nella sidebar per spostare la freccia lungo il bordo curvo."]})]}),a.jsx("h3",{className:"manual-h3",children:" Propriet Gruppo"}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Palette Colori:"})," Selettore rapido (Pastello, Vividi, Neutri)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Forma Organica:"})," Si adatta automaticamente al contenuto."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Viola (Basso):"})," Trascina per regolare la grandezza (padding)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Maniglia Gialla (Sinistra):"})," Trascina per creare relazioni dal gruppo."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"5. Strumenti della Toolbar"}),a.jsx("p",{className:"theme-text opacity-80 mb-4",children:"Ecco la spiegazione di tutti i pulsanti presenti nella barra in alto, da sinistra a destra."}),a.jsxs("div",{className:"tool-grid",children:[a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(ef,{size:20,className:"text-[var(--theme-accent)]"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Maschio"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto maschio al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Jh,{size:20,className:"text-pink-600"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuova Femmina"}),a.jsx("div",{className:"theme-text-desc",children:"Aggiunge un soggetto femmina al centro del grafico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ox,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Crea i genitori sopra la persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Mo,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Partner"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un coniuge a fianco della persona selezionata."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Ax,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Aggiungi Figlio"}),a.jsx("div",{className:"theme-text-desc",children:"Crea un figlio sotto la selezione (se coppia, collega a entrambi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Lo,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Nuovo Gruppo"}),a.jsx("div",{className:"theme-text-desc",children:'Raggruppa le persone selezionate in una "Household" o sottosistema.'})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Dx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Auto-Layout"}),a.jsx("div",{className:"theme-text-desc",children:"Riorganizza automaticamente l'intero albero genealogico."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(gu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Orizzontale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa riga (Y)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(gu,{size:20,className:"theme-text rotate-90"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Allinea Verticale"}),a.jsx("div",{className:"theme-text-desc",children:"Allinea i nodi selezionati sulla stessa colonna (X)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(bx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Figli"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i figli selezionati esattamente sotto al centro dei genitori."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(kx,{size:20,style:{color:"var(--theme-accent)"}})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Centra Genitori"}),a.jsx("div",{className:"theme-text-desc",children:"Sposta i genitori selezionati esattamente sopra al centro dei figli."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Sx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Cerchio"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi selezionati in cerchio (utile per sociogrammi)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Cx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Ordina i nodi selezionati in una griglia compatta."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Lx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Scala / Diagonale"}),a.jsx("div",{className:"theme-text-desc",children:"Dispone i nodi in diagonale (utile per linee temporali)."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Px,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Snap Griglia"}),a.jsx("div",{className:"theme-text-desc",children:"Attiva/Disattiva l'aggancio magnetico dei nodi alla griglia."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(Rx,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Mod. Selezione"}),a.jsx("div",{className:"theme-text-desc",children:"Permette di selezionare pi elementi trascinando un rettangolo blu."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(vu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Designer Stili"}),a.jsx("div",{className:"theme-text-desc",children:"Editor per creare nuovi tipi di linee o simboli relazionali."})]})]}),a.jsxs("div",{className:"tool-card",children:[a.jsx("div",{className:"icon-box",children:a.jsx(yu,{size:20,className:"theme-text"})}),a.jsxs("div",{children:[a.jsx("strong",{className:"theme-text",children:"Legenda"}),a.jsx("div",{className:"theme-text-desc",children:"Mostra o nasconde la legenda automatica sul grafico."})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"6. Esportazione"}),a.jsxs("div",{className:"p-4 rounded border theme-border bg-yellow-500/10 mb-4 flex gap-3 items-center",children:[a.jsx(yu,{size:24,className:"text-yellow-600 dark:text-yellow-400 shrink-0"}),a.jsxs("p",{className:"theme-text text-sm",children:[a.jsx("strong",{children:"Nota Importante:"})," L'esportazione mantiene i colori del ",a.jsx("strong",{children:"Tema Attuale"}),'. Se sei in "Dark Mode", il PDF/Immagine avr sfondo scuro. Passa a "Light Mode" prima di esportare se desideri uno sfondo bianco per la stampa.']})]}),a.jsxs("ul",{className:"manual-list",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"PNG / JPEG:"})," Immagine raster ad alta risoluzione (supporta zoom impostabile da 1x a 6x)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"PDF Vettoriale:"})," Scarica solo il grafico in vettoriale. Perfetto per stampe professionali o tesi (non sgrana mai)."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Report Clinico:"})," Genera un documento PDF multipagina con grafico, legenda simboli e scheda testuale dettagliata per ogni persona."]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"7. Impostazioni, Backup e Cloud"}),a.jsx("p",{className:"theme-text opacity-80 mb-6",children:"Gestisci i tuoi dati, salvali al sicuro o sincronizzali tra pi dispositivi."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-600",children:a.jsx(Ep,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Backup Locale"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Salva tutti i tuoi genogrammi in un unico file (JSON) sul tuo computer. Utile per creare copie di sicurezza o trasferire i dati manualmente."}),a.jsxs("ul",{className:"manual-list text-sm",children:[a.jsxs("li",{children:["Clicca su ",a.jsx(Mx,{size:12,className:"inline"})," ",a.jsx("strong",{children:"Impostazioni"}),"."]}),a.jsxs("li",{children:["Premi ",a.jsx("strong",{children:"Backup Dati"})," per scaricare il file."]}),a.jsxs("li",{children:["Usa ",a.jsx("strong",{children:"Ripristina"})," per caricare un backup salvato."]})]})]}),a.jsxs("div",{className:"theme-panel border theme-border p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 rounded bg-orange-100 dark:bg-orange-900/30 text-orange-600",children:a.jsx(Nx,{size:20})}),a.jsx("h3",{className:"font-bold text-lg theme-text m-0 border-none",children:"Sincronizzazione Cloud"})]}),a.jsx("p",{className:"theme-text-desc mb-4",children:"Collega un database personale per salvare i dati online e accedervi da PC, iPad e Tablet contemporaneamente."}),a.jsxs("div",{className:"p-3 rounded bg-green-500/10 border border-green-500/20 text-xs theme-text",children:[a.jsx("strong",{className:"text-green-600 dark:text-green-400",children:"Stato:"})," ",e?" Connesso":" Non configurato (Salvataggio solo locale)"]})]})]}),a.jsxs("div",{className:"p-5 rounded-xl border theme-border bg-black/5 dark:bg-white/5",children:[a.jsxs("h3",{className:"text-base font-bold theme-text mb-4 flex items-center gap-2",children:[a.jsx(jb,{size:18,className:"text-[var(--theme-accent)]"}),"Guida: Come creare il tuo Cloud Personale (Gratis)"]}),a.jsxs("div",{className:"space-y-4 text-sm theme-text opacity-90",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"1"}),a.jsxs("div",{children:["Vai su ",a.jsx("a",{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Firebase Console"})," e accedi con il tuo account Google."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"2"}),a.jsxs("div",{children:["Clicca ",a.jsx("strong",{children:'"Crea un progetto"'}),' (chiamalo es. "GenoPro-Mio"). Disabilita Google Analytics per fare prima.']})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"3"}),a.jsxs("div",{children:["Nel menu a sinistra, vai su ",a.jsx("strong",{children:'"Build" > "Firestore Database"'})," e clicca su ",a.jsx("strong",{children:'"Crea Database"'}),".",a.jsx("br",{}),a.jsxs("span",{className:"opacity-70 text-xs",children:["(Seleziona una localit vicina, es. eur3, e scegli avvia in ",a.jsx("strong",{children:"Modalit Test"}),")."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"4"}),a.jsxs("div",{children:["Torna alla ",a.jsx("strong",{children:"Home del Progetto"}),` (icona ingranaggio in alto a sx > Impostazioni progetto). Scorri in basso fino a "Le tue app" e clicca sull'icona `,a.jsx("strong",{children:"Web (</>)"}),"."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"5"}),a.jsxs("div",{children:["Dai un nome all'app e registrala. Ti verr mostrato un codice. Copia tutto il contenuto tra le parentesi graffe:",a.jsxs("div",{className:"mt-2 p-2 bg-gray-200 dark:bg-gray-800 rounded font-mono text-[10px] opacity-70",children:['apiKey: "AIzaSy...",',a.jsx("br",{}),'authDomain: "...",',a.jsx("br",{}),'projectId: "...",',a.jsx("br",{}),"..."]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--theme-accent)] text-white flex items-center justify-center font-bold text-xs",children:"6"}),a.jsxs("div",{children:["Torna qui in GenoPro, apri ",a.jsx("strong",{children:"Impostazioni"}),' e incolla il codice nel box "Configurazione Firebase".']})]})]})]})]}),a.jsxs("div",{className:"manual-section",children:[a.jsx("h2",{className:"manual-h2",children:"Scorciatoie da Tastiera"}),a.jsxs("div",{className:"border theme-border rounded overflow-hidden text-sm mt-4",children:[a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 bg-black/5 dark:bg-white/5 font-bold theme-text",children:[a.jsx("span",{children:"Azione"})," ",a.jsx("span",{children:"Tasti"})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Maschio / Femmina"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"M"})," / ",a.jsx("span",{className:"key-badge",children:"F"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Partner"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"S"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Figlio"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"C"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Genitori"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"P"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Seleziona Tutto"}),a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"A"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Cerchio"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"C"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Griglia"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"G"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Disponi a Scala"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"D"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Allinea Orizz./Vert."})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Alt"})," + ",a.jsx("span",{className:"key-badge",children:"H"})," / ",a.jsx("span",{className:"key-badge",children:"V"})]})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Legenda"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"I"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Elimina"})," ",a.jsx("span",{children:a.jsx("span",{className:"key-badge",children:"Canc"})})]}),a.jsxs("div",{className:"flex justify-between border-b theme-border p-2 theme-text",children:[a.jsx("span",{children:"Salva"})," ",a.jsxs("span",{children:[a.jsx("span",{className:"key-badge",children:"Ctrl"})," + ",a.jsx("span",{className:"key-badge",children:"S"})]})]})]})]})]})," ",a.jsx("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 text-center shrink-0",children:a.jsx("button",{onClick:t,className:"px-8 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md transition-all font-medium",children:"Chiudi Manuale"})})]})}),_C=({onClose:t,onSave:e})=>{const[n,r]=H.useState("Nuovo Stile"),[s,i]=H.useState("#000000"),[o,c]=H.useState("solid"),[u,h]=H.useState("standard"),m=()=>{e({id:`custom-${Ue()}`,name:n,type:"relationship",config:{color:s,lineStyle:o,renderType:u,decorator:""}}),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-96 space-y-4 text-black dark:text-white",children:[a.jsx("h3",{className:"font-bold text-lg",children:"Designer Relazioni"}),a.jsx("input",{className:"w-full border p-2 rounded dark:bg-gray-700",value:n,onChange:g=>r(g.target.value),placeholder:"Nome stile"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Colore"}),a.jsx("input",{type:"color",className:"w-full h-8",value:s,onChange:g=>i(g.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Tratteggio"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:o,onChange:g=>c(g.target.value),children:[a.jsx("option",{value:"solid",children:"Solido"}),a.jsx("option",{value:"dashed",children:"Tratteggiato"}),a.jsx("option",{value:"dotted",children:"Puntinato"}),a.jsx("option",{value:"zigzag",children:"ZigZag"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs block mb-1",children:"Decorazione"}),a.jsxs("select",{className:"w-full border p-1 rounded dark:bg-gray-700",value:u,onChange:g=>h(g.target.value),children:[a.jsx("option",{value:"standard",children:"Nessuna"}),a.jsx("option",{value:"arrow",children:"Freccia Singola"}),a.jsx("option",{value:"arrow-double",children:"Freccia Doppia"}),a.jsx("option",{value:"fusion",children:"Fusione"}),a.jsx("option",{value:"cutoff",children:"Taglio"})]})]}),a.jsx("div",{className:"p-4 border rounded bg-gray-50 dark:bg-gray-900 flex justify-center items-center h-20",children:a.jsx("svg",{width:"200",height:"20",children:a.jsx("line",{x1:"0",y1:"10",x2:"200",y2:"10",stroke:s,strokeWidth:"2",strokeDasharray:o==="dashed"?"5,5":o==="dotted"?"2,2":""})})}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500",children:"Annulla"}),a.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Salva Preset"})]})]})})},wC=t=>{try{if(!t)return null;let e=t.trim();const n=e.indexOf("{"),r=e.lastIndexOf("}");return n===-1||r===-1||(e=e.substring(n,r+1),e=e.replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2":'),e=e.replace(/'/g,'"'),e=e.replace(/,(\s*[}\]])/g,"$1")),JSON.parse(e)}catch(e){console.error("Errore parsing config string:",e);try{return JSON.parse(t)}catch{return null}}},EC=({nodes:t,selectedIds:e,onHandleDown:n,onMove:r})=>{if(e.length<2)return null;const s=t.filter(C=>e.includes(C.id));if(s.length===0)return null;const i=Math.min(...s.map(C=>C.x)),o=Math.max(...s.map(C=>C.x+Vt)),c=Math.min(...s.map(C=>C.y)),u=Math.max(...s.map(C=>C.y+br)),h=20,m=i-h,g=c-h,y=o-i+h*2,k=u-c+h*2;return a.jsxs("g",{pointerEvents:"visible",children:[a.jsx("rect",{x:m,y:g,width:y,height:k,fill:"black",fillOpacity:"0.01",stroke:"#3b82f6",strokeWidth:1,strokeDasharray:"5,5",className:"cursor-move",style:{touchAction:"none"},onPointerDown:r}),a.jsxs("g",{transform:`translate(${m+y/2}, ${g})`,className:"cursor-grab active:cursor-grabbing",onPointerDown:C=>{n(C,"rotate")},style:{touchAction:"none"},children:[a.jsx("line",{x1:0,y1:0,x2:0,y2:-25,stroke:"#3b82f6",strokeWidth:1}),a.jsx("circle",{cx:0,cy:-25,r:5,fill:"white",stroke:"#3b82f6",strokeWidth:2})]}),a.jsx("g",{transform:`translate(${m+y}, ${g+k})`,className:"cursor-nwse-resize",onPointerDown:C=>{n(C,"scale")},style:{touchAction:"none"},children:a.jsx("rect",{x:-6,y:-6,width:12,height:12,fill:"white",stroke:"#3b82f6",strokeWidth:2})})]})},lv=({currentThemeId:t,onChange:e,placement:n="bottom"})=>{const[r,s]=H.useState(!1),i=bs.find(c=>c.id===t)||bs[0],o=H.useRef(null);return H.useEffect(()=>{const c=u=>{o.current&&!o.current.contains(u.target)&&s(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),a.jsxs("div",{className:"relative w-full",ref:o,children:[a.jsxs("button",{onClick:()=>s(!r),className:"w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors border theme-border theme-panel hover:brightness-95 overflow-hidden",children:[a.jsxs("span",{className:"flex items-center gap-2 truncate min-w-0",children:[i.type==="dark"?a.jsx(jx,{size:14,className:"shrink-0"}):a.jsx(kp,{size:14,className:"shrink-0"}),a.jsx("span",{className:"truncate",children:i.label})]}),a.jsxs("div",{className:"flex gap-1 ml-2 shrink-0",children:[a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.bgMain}}),a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-500/20",style:{background:i.colors.accent}})]})]}),r&&a.jsxs("div",{className:`absolute left-0 w-64 max-h-80 overflow-y-auto theme-panel border theme-border shadow-xl rounded-lg p-1 z-[100] ${n==="top"?"bottom-full mb-2":"top-full mt-2"}`,children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 px-2 py-1 uppercase theme-text",children:"Seleziona Tema"}),bs.map(c=>a.jsxs("button",{onClick:()=>{e(c.id),s(!1)},className:`w-full flex items-center justify-between p-2 rounded text-xs theme-hover mb-1 ${t===c.id?"border theme-border bg-black/5 dark:bg-white/5":""}`,children:[a.jsx("span",{className:"font-medium theme-text",children:c.label}),a.jsxs("div",{className:"flex gap-1 shrink-0",children:[a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgMain},title:"Sfondo"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.bgPanel},title:"Pannelli"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20",style:{background:c.colors.accent},title:"Accento"}),a.jsx("div",{className:"w-4 h-4 rounded border border-gray-500/20 flex items-center justify-center",style:{background:c.colors.bgMain},children:a.jsx("span",{style:{color:c.colors.text,fontSize:"8px"},children:"A"})})]})]},c.id))]})]})},bC=({note:t,onUpdate:e,onDelete:n})=>{const[r,s]=H.useState("Classico"),[i,o]=H.useState("Classico");return a.jsxs("div",{onPointerDown:c=>c.stopPropagation(),className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b theme-border",children:[a.jsx(tf,{className:"text-yellow-500"}),a.jsx("span",{className:"font-bold",children:"Nota Adesiva"})]}),a.jsxs("div",{className:"bg-black/5 dark:bg-white/5 p-1 rounded flex text-xs font-bold mb-2",children:[a.jsx("button",{onClick:()=>e({variant:"classic"}),className:`flex-1 py-1.5 rounded transition-all ${!t.variant||t.variant==="classic"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Post-it"}),a.jsx("button",{onClick:()=>e({variant:"label"}),className:`flex-1 py-1.5 rounded transition-all ${t.variant==="label"?"bg-white dark:bg-gray-700 shadow text-blue-600":"opacity-50 hover:opacity-100"}`,children:"Etichetta"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Contenuto"}),a.jsx("textarea",{className:"w-full h-24 p-2 rounded border bg-white/50 dark:bg-black/20 theme-border text-sm resize-none focus:ring-2 focus:ring-blue-500 outline-none",style:{fontFamily:t.fontFamily,color:t.textColor},value:t.text,onChange:c=>e({text:c.target.value}),placeholder:"Scrivi qui..."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Sfondo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:r,onChange:c=>s(c.target.value),children:Object.keys(Pa).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:[Pa[r].map(c=>a.jsx("button",{onClick:()=>e({color:c}),className:`w-6 h-6 rounded-full border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.color===c?"ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-800 scale-110":""}`,style:{backgroundColor:c}},c)),a.jsx("button",{onClick:()=>e({color:"transparent",opacity:0}),className:"w-6 h-6 rounded-full border border-dashed border-gray-400 flex items-center justify-center text-[8px] opacity-70 hover:opacity-100",title:"Trasparente",children:"/"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold opacity-50 block mb-1 flex justify-between",children:["Opacit ",a.jsxs("span",{children:[Math.round(t.opacity*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",className:"w-full accent-blue-500",value:t.opacity,onChange:c=>e({opacity:parseFloat(c.target.value)})})]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 my-2"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold opacity-50 block mb-1",children:"Font"}),a.jsx("select",{className:"w-full p-2 rounded border bg-transparent theme-border text-sm",value:t.fontFamily,onChange:c=>e({fontFamily:c.target.value}),children:Yw.map(c=>a.jsx("option",{value:c.value,className:"text-black",style:{fontFamily:c.value},children:c.label},c.value))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold opacity-50",children:"Colore Testo"}),a.jsx("select",{className:"text-xs p-1 rounded border bg-transparent theme-border",value:i,onChange:c=>o(c.target.value),children:Object.keys(Pa).map(c=>a.jsx("option",{value:c,className:"text-black",children:c},c))})]}),a.jsx("div",{className:"flex flex-wrap gap-2 p-2 border theme-border rounded bg-white/30 dark:bg-black/10",children:Pa[i].map(c=>a.jsx("button",{onClick:()=>e({textColor:c}),className:`w-6 h-6 rounded-md border border-gray-200 dark:border-gray-600 transition-transform hover:scale-110 ${t.textColor===c?"ring-2 ring-blue-500 ring-offset-1 scale-110":""}`,style:{backgroundColor:c}},c))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"W"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.width,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold opacity-50 block",children:"H"}),a.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-transparent theme-border text-xs",value:t.height,readOnly:!0})]})]}),a.jsx("div",{className:"pt-4 border-t theme-border mt-auto",children:a.jsxs("button",{onClick:n,className:"w-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 py-2 rounded text-xs hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Nota"]})})]})},kC=({note:t,isSelected:e,onPointerDown:n,onUpdate:r,zoom:s=1})=>{const[i,o]=H.useState(null);H.useEffect(()=>{if(!i||!i.active)return;const y=C=>{if(i.pointerId!==void 0&&C.pointerId!==void 0&&i.pointerId!==C.pointerId)return;const R=(C.clientX-i.startX)/s,D=(C.clientY-i.startY)/s;let A=i.startW,I=i.startH;i.handle.includes("e")&&(A=Math.max(30,i.startW+R)),i.handle.includes("s")&&(I=Math.max(30,i.startH+D)),r({...t,width:Math.round(A),height:Math.round(I)})},k=C=>{i.pointerId!==void 0&&C.pointerId!==void 0&&i.pointerId!==C.pointerId||o(null)};return window.addEventListener("pointermove",y),window.addEventListener("pointerup",k),()=>{window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",k)}},[i,t,r]);const c=(y,k)=>{y.stopPropagation(),y.preventDefault();try{y.target.setPointerCapture(y.pointerId)}catch{}o({active:!0,handle:k,startX:y.clientX,startY:y.clientY,startW:t.width,startH:t.height,pointerId:y.pointerId})},u=({x:y,y:k,cursor:C,handle:R})=>a.jsx("rect",{x:y-8,y:k-8,width:16,height:16,fill:"white",stroke:"#3b82f6",strokeWidth:1,style:{cursor:C,touchAction:"none"},onPointerDown:D=>c(D,R)}),h=t.variant==="label",m=h?8:1,g=h&&t.opacity===0&&(e||(i==null?void 0:i.active));return a.jsxs("g",{transform:`translate(${t.x}, ${t.y})`,onPointerDown:n,className:"cursor-move group",children:[!h&&a.jsx("rect",{x:3,y:3,width:t.width,height:t.height,fill:"black",fillOpacity:.15*t.opacity,rx:2,pointerEvents:"none"}),a.jsx("rect",{width:t.width,height:t.height,fill:t.color,fillOpacity:t.opacity,stroke:e?"#3b82f6":g?"#ccc":"rgba(0,0,0,0.05)",strokeWidth:e?2:1,strokeDasharray:g?"4,2":"",rx:m,style:h?{}:{filter:`drop-shadow(0 1px 2px rgba(0,0,0,${.1*t.opacity}))`}}),!h&&a.jsx("rect",{x:0,y:0,width:t.width,height:20,fill:"black",fillOpacity:.05*t.opacity,pointerEvents:"none"}),a.jsx("foreignObject",{x:5,y:5,width:t.width-10,height:t.height-10,style:{pointerEvents:"none"},children:a.jsx("div",{className:"w-full h-full text-sm whitespace-pre-wrap overflow-hidden leading-snug flex items-center justify-center",style:{fontFamily:t.fontFamily||"sans-serif",fontSize:"13px",color:t.textColor||"#000",opacity:t.opacity<.3&&t.textColor==="#000000"?1:.9,textAlign:h?"center":"left",alignItems:h?"center":"flex-start",display:"flex"},children:a.jsx("span",{className:"w-full",children:t.text||(h?"Etichetta":"Nuova nota...")})})}),e&&a.jsxs(a.Fragment,{children:[a.jsx(u,{x:t.width,y:t.height/2,cursor:"ew-resize",handle:"e"}),a.jsx(u,{x:t.width/2,y:t.height,cursor:"ns-resize",handle:"s"}),a.jsx(u,{x:t.width,y:t.height,cursor:"nwse-resize",handle:"se"})]})]})},IC=({onClose:t,onConfirm:e})=>{const[n,r]=H.useState({onlyPeopleWithNotes:!1,showGender:!0,showBirthDate:!0,showAge:!0,showClinical:!0,showGroups:!0,showFamily:!0,showRelations:!0,showNotes:!0}),s=i=>r(o=>({...o,[i]:!o[i]}));return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"theme-panel w-full max-w-md rounded-xl shadow-2xl border theme-border overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b theme-border bg-black/5 dark:bg-white/5 flex justify-between items-center",children:[a.jsxs("h3",{className:"font-bold flex items-center gap-2 theme-text",children:[a.jsx(bo,{size:18})," Configura Report"]}),a.jsx("button",{onClick:t,children:a.jsx(Us,{size:18,className:"theme-text opacity-50 hover:opacity-100"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 rounded-lg",children:a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600 shrink-0",checked:n.onlyPeopleWithNotes,onChange:()=>s("onlyPeopleWithNotes")}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm text-blue-900 dark:text-blue-100",children:"Includi solo persone con note"}),a.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300 opacity-80",children:"Esclude dal report chi non ha voci nel diario clinico."})]})]})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Dati Anagrafici"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGender,onChange:()=>s("showGender"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Genere"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showBirthDate,onChange:()=>s("showBirthDate"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Data Nascita"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showAge,onChange:()=>s("showAge"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Et"})]})]}),a.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-3 theme-text",children:"Altri Contenuti"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showClinical,onChange:()=>s("showClinical"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Marcatori Clinici (Simboli, Deceduto, ecc)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showGroups,onChange:()=>s("showGroups"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Appartenenza a Gruppi"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showFamily,onChange:()=>s("showFamily"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Legami Familiari (Partner, Genitori, Figli)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showRelations,onChange:()=>s("showRelations"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Altre Relazioni (Amicizie, Conflitti, ecc.)"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer theme-text text-sm",children:[a.jsx("input",{type:"checkbox",checked:n.showNotes,onChange:()=>s("showNotes"),className:"accent-[var(--theme-accent)]"}),a.jsx("span",{children:"Diario Clinico / Note"})]})]})]})]}),a.jsxs("div",{className:"p-4 border-t theme-border bg-black/5 dark:bg-white/5 flex justify-end gap-2",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm rounded hover:bg-black/10 dark:hover:bg-white/10 theme-text",children:"Annulla"}),a.jsxs("button",{onClick:()=>e(n),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded shadow-sm flex items-center gap-2",children:[a.jsx(bo,{size:16})," Genera PDF"]})]})]})})};function TC(){var Zl;const t=H.useRef(null),e=H.useRef(null),n=H.useRef(null),r=H.useRef({clientX:0,clientY:0}),s=H.useRef(!1),i=H.useRef(null),[o,c]=H.useState(null),[u,h]=H.useState([]),[m,g]=H.useState([]),[y,k]=H.useState(!1),C=H.useRef(null),R=f=>{if(f.touches.length===2){s.current=!0;const v=f.touches[0],b=f.touches[1],P=Math.hypot(v.clientX-b.clientX,v.clientY-b.clientY);C.current={dist:P}}},D=f=>{if(f.touches.length===2&&C.current){s.current=!0;const v=f.touches[0],b=f.touches[1],P=Math.hypot(v.clientX-b.clientX,v.clientY-b.clientY),F=P/C.current.dist,O=Math.min(Math.max(hs*F,.1),5);mr(O),C.current={dist:P}}},A=f=>{f.touches.length<2&&(C.current=null,setTimeout(()=>{s.current=!1},100))},[I,N]=H.useState(!!document.fullscreenElement);H.useEffect(()=>{const f=()=>N(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",f),document.addEventListener("webkitfullscreenchange",f),()=>{document.removeEventListener("fullscreenchange",f),document.removeEventListener("webkitfullscreenchange",f)}},[]);const M=async()=>{try{document.fullscreenElement?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen&&await document.webkitExitFullscreen():document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&await document.documentElement.webkitRequestFullscreen()}catch(f){console.log("Fullscreen toggle failed:",f)}};H.useEffect(()=>{(async()=>{try{await ik.hide()}catch{console.log("Status bar hide not supported on web")}})()},[]),H.useEffect(()=>{const f=v=>{console.log("S PEN NATIVE:",v);const{clientX:b,clientY:P}=r.current,{x:F,y:O}=_(b,P);fe({x:b,y:P,gx:F,gy:O})};return window.addEventListener("sPenNativeEvent",f),()=>{window.removeEventListener("sPenNativeEvent",f)}},[]),H.useEffect(()=>{const f=v=>{r.current={clientX:v.clientX,clientY:v.clientY}};return window.addEventListener("mousemove",f),()=>window.removeEventListener("mousemove",f)},[]);const z=()=>{var b;const{clientX:f,clientY:v}=r.current;if(f===0&&v===0)return{x:Pt,y:Pt};if(t.current&&e.current){const P=t.current.createSVGPoint();P.x=f,P.y=v;const F=P.matrixTransform((b=e.current.getScreenCTM())==null?void 0:b.inverse());return On?{x:Math.round(F.x/ke)*ke,y:Math.round(F.y/ke)*ke}:{x:F.x,y:F.y}}return{x:Pt,y:Pt}},G=(f,v)=>{let b,P;if(f!==void 0&&v!==void 0)b=f,P=v;else{const B=z();b=B.x,P=B.y}const F={id:Ue(),x:b,y:P,width:160,height:140,text:"Nuova nota...",color:Pa.Classico[0],fontFamily:Yw[0].value,opacity:1,textColor:iC[0],variant:"classic"},O=[...u,F];h(O),kn(se,Ae,we,O)},x=H.useRef(null),_=(f,v)=>{var b;if(t.current&&e.current){const P=t.current.createSVGPoint();return P.x=f,P.y=v,P.matrixTransform((b=e.current.getScreenCTM())==null?void 0:b.inverse())}return{x:0,y:0}},[E,T]=H.useState(null),[j,L]=H.useState("dashboard"),[S,Je]=H.useState(localStorage.getItem("genopro_custom_user")||""),[oe,re]=H.useState(localStorage.getItem("genopro_firebase_config")||""),[We,Z]=H.useState(null);H.useRef(null);const[ae,fe]=H.useState(null),[De,Se]=H.useState(!1),[Fe,on]=H.useState("offline"),jn=H.useRef(!1),[an,Mt]=H.useState([]),[Rn,vm]=H.useState(()=>{const f=localStorage.getItem("genopro_categories");return f?JSON.parse(f):tC}),[Dn,Ks]=H.useState("ALL"),[qn,Qs]=H.useState("date_desc"),[is,Fi]=H.useState(""),[os,zi]=H.useState(!1),{auth:Ys,db:Kn}=H.useMemo(()=>{try{let f=null;if(oe?f=wC(oe):typeof window.__firebase_config<"u"&&(f=JSON.parse(window.__firebase_config)),!f||!f.apiKey)return{auth:null,db:null};const v=RI().length?Cp():Gx(f);return{auth:W2(v),db:RA(v)}}catch(f){return console.error("Firebase Init Error:",f),{auth:null,db:null}}},[oe]),Ui=H.useMemo(()=>an.filter(f=>{const v=f.title.toLowerCase().includes(is.toLowerCase()),b=Dn==="ALL"||f.category===Dn||Dn==="other"&&!Rn.some(P=>P.id===f.category);return v&&b}).sort((f,v)=>qn==="date_desc"?v.lastModified-f.lastModified:qn==="date_asc"?f.lastModified-v.lastModified:qn==="name_asc"?f.title.localeCompare(v.title):0),[an,Dn,qn,is,Rn]);H.useEffect(()=>{localStorage.setItem("genopro_categories",JSON.stringify(Rn))},[Rn]),H.useEffect(()=>{localStorage.setItem("genopro_custom_user",S)},[S]),H.useEffect(()=>{localStorage.setItem("genopro_firebase_config",oe)},[oe]);const $i=typeof window.__app_id<"u"?window.__app_id:"default-app-id",[as,Bi]=H.useState(null),[Mn,Wi]=H.useState("Nuovo Genogramma"),[xt,It]=H.useState("family"),[se,Qn]=H.useState([]),[Ae,hr]=H.useState([]),[we,fr]=H.useState([]),[Xs,Hi]=H.useState([]),[jr,ra]=H.useState([]),[Ht,ls]=H.useState(-1),kn=H.useCallback((f,v,b,P)=>{const F=JSON.stringify({nodes:f,edges:v,groups:b,stickyNotes:P});ra(O=>[...O.slice(0,Ht+1),F]),ls(O=>O+1)},[Ht]),rt=f=>{const v=typeof f=="function"?f(se):f;Qn(v),kn(v,Ae,we)},fn=f=>{const v=typeof f=="function"?f(Ae):f;hr(v),kn(se,v,we)},Ln=f=>{const v=typeof f=="function"?f(we):f;fr(v),kn(se,Ae,v)},pr=(f,v,b,P)=>{Qn(f),hr(v),fr(b),h(P),kn(f,v,b,P)},Rr=(f,v,b,P)=>{pr(f,v,b,P||u)},Js=()=>{if(Ht>0){const f=Ht-1,v=JSON.parse(jr[f]);Qn(v.nodes),hr(v.edges),fr(v.groups),ls(f)}},sa=()=>{if(Ht<jr.length-1){const f=Ht+1,v=JSON.parse(jr[f]);Qn(v.nodes),hr(v.edges),fr(v.groups),ls(f)}};H.useEffect(()=>{jr.length===0&&j==="editor"&&kn(se,Ae,we)},[j]);const[de,Ze]=H.useState([]),[et,pn]=H.useState([]),[ln,Ct]=H.useState([]),[Dr,ia]=H.useState(()=>localStorage.getItem("genopro_theme_id")||"light"),Qe=H.useMemo(()=>bs.find(f=>f.id===Dr)||bs[0],[Dr]),cs=Qe.type==="dark";H.useEffect(()=>{localStorage.setItem("genopro_theme_id",Dr)},[Dr]);const[On,Zs]=H.useState(()=>localStorage.getItem("genopro_snap")!=="false"),[ei,oa]=H.useState(()=>localStorage.getItem("genopro_labels")||"age"),[Yn,Xn]=H.useState(()=>localStorage.getItem("genopro_legend")==="true");H.useEffect(()=>{localStorage.setItem("genopro_snap",String(On))},[On]),H.useEffect(()=>{localStorage.setItem("genopro_labels",ei)},[ei]),H.useEffect(()=>{localStorage.setItem("genopro_legend",String(Yn))},[Yn]);const[Gi,qi]=H.useState(!1),[ti,ni]=H.useState(!1),[Jn,Ul]=H.useState(!1),[aa,us]=H.useState(!1),[la,Ki]=H.useState(!1),[je,pt]=H.useState(null),[$l,xm]=H.useState(null),[ds,In]=H.useState(null),[hs,mr]=H.useState(1),[ri,ca]=H.useState(4),ua=H.useRef({view:j,showSettings:Gi,showReport:ti,showReportConfig:y,showDesigner:aa,showHelp:De,showCategoryMenu:os,editingGroupId:o,selectedNodeIds:de,selectedEdgeIds:et,selectedGroupIds:ln,selectedNoteIds:m});H.useEffect(()=>{ua.current={view:j,showSettings:Gi,showReport:ti,showReportConfig:y,showDesigner:aa,showHelp:De,showCategoryMenu:os,editingGroupId:o,selectedNodeIds:de,selectedEdgeIds:et,selectedGroupIds:ln,selectedNoteIds:m}});const da=H.useCallback(async()=>{const f=ua.current;let v=!1;return f.showSettings?(qi(!1),v=!0):f.showReport?(ni(!1),v=!0):f.showReportConfig?(k(!1),v=!0):f.showDesigner?(us(!1),v=!0):f.showHelp?(Se(!1),v=!0):f.showCategoryMenu?(zi(!1),v=!0):f.editingGroupId!==null?(c(null),v=!0):f.selectedNodeIds.length>0?(Ze([]),v=!0):f.selectedEdgeIds.length>0?(pn([]),v=!0):f.selectedGroupIds.length>0?(Ct([]),v=!0):f.selectedNoteIds.length>0?(g([]),v=!0):f.view==="editor"&&(L("dashboard"),v=!0),v},[]);H.useEffect(()=>{let f=null;(async()=>{try{f=await Vg.addListener("backButton",async P=>{await da()||Vg.exitApp()})}catch(P){console.log("Capacitor backButton non supportato",P)}})();const b=async P=>{await da()&&window.history.pushState(null,"",window.location.href)};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",b),()=>{f&&f.remove(),window.removeEventListener("popstate",b)}},[da]),H.useEffect(()=>{if(j!=="editor"||!as||se.length===0&&Ae.length===0&&Ht<=0)return;if(jn.current){jn.current=!1;return}const f=setTimeout(async()=>{const v={id:as,title:Mn,category:xt,lastModified:Date.now(),data:{nodes:se,edges:Ae,groups:we,presets:Xs,stickyNotes:u}};localStorage.setItem(`genopro_data_${as}`,JSON.stringify(v));const b=localStorage.getItem("genopro_local_index");let P=b?JSON.parse(b):[];const F=P.findIndex(O=>O.id===as);if(F>=0?P[F]=v:P.push(v),localStorage.setItem("genopro_local_index",JSON.stringify(P)),E&&Kn){const O=S||E.uid;if(!O){on("error");return}on("syncing");try{const B=Yy(Kn,"artifacts",$i,"users",O,"genograms",as);await XA(B,v,{merge:!0}),on("synced")}catch(B){console.error("Errore Salvataggio:",B),on("error")}}else on("offline")},1500);return()=>clearTimeout(f)},[se,Ae,we,u,Mn,xt,Xs,S,E,Kn,j,as]),H.useEffect(()=>{const f=v=>{v.key==="i"&&!["INPUT","TEXTAREA"].includes(v.target.tagName)&&Xn(b=>!b)};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[]),H.useEffect(()=>{const f=O=>{if(O.ctrlKey){O.preventDefault();const U=-O.deltaY*.008;mr(Q=>{const W=Q+U;return Math.min(3,Math.max(.2,W))})}},v=O=>{O.preventDefault()},b=O=>{O.preventDefault();const U=(O.scale-1)*.05;mr(Q=>Math.min(3,Math.max(.2,Q+U)))},P=O=>O.preventDefault(),F={passive:!1};return document.addEventListener("wheel",f,F),document.addEventListener("gesturestart",v,F),document.addEventListener("gesturechange",b,F),document.addEventListener("gestureend",P,F),()=>{document.removeEventListener("wheel",f),document.removeEventListener("gesturestart",v),document.removeEventListener("gesturechange",b),document.removeEventListener("gestureend",P)}},[]);const Gt=H.useRef(se);H.useEffect(()=>{Gt.current=se},[se]);const Zn=H.useRef(Ae);H.useEffect(()=>{Zn.current=Ae},[Ae]);const Bl=H.useRef(de);H.useEffect(()=>{Bl.current=de},[de]);const Mr=H.useRef(we);H.useEffect(()=>{Mr.current=we},[we]);const er=H.useRef(u);H.useEffect(()=>{er.current=u},[u]);const _t=f=>{if(de.length===0)return;const v=se.filter(B=>de.includes(B.id)),b=v.reduce((B,U)=>B+U.x,0)/v.length,P=v.reduce((B,U)=>B+U.y,0)/v.length,F=[...v];f==="circle"?F.sort((B,U)=>{const Q=Math.atan2(B.y-P,B.x-b),W=Math.atan2(U.y-P,U.x-b);return Q-W}):f==="h"?F.sort((B,U)=>B.x-U.x):f==="v"?F.sort((B,U)=>B.y-U.y):f==="diagonal"?F.sort((B,U)=>B.x+B.y-(U.x+U.y)):f==="grid"&&F.sort((B,U)=>Math.abs(B.y-U.y)>40?B.y-U.y:B.x-U.x);let O=150;if(f==="circle"){const B=v.reduce((Q,W)=>Q+Math.hypot(W.x-b,W.y-P),0)/v.length,U=prompt("Inserisci raggio cerchio (px):",Math.round(B).toString());if(U!==null)O=parseInt(U)||150;else return}rt(B=>B.map(U=>{if(!de.includes(U.id))return U;const Q=F.findIndex(W=>W.id===U.id);if(f==="h")return{...U,y:Math.round(P/ke)*ke};if(f==="v")return{...U,x:Math.round(b/ke)*ke};if(f==="circle"){if(v.length<2)return U;const W=2*Math.PI/v.length,ee=F[0],le=Math.atan2(ee.y-P,ee.x-b)+W*Q;return{...U,x:Math.round((b+O*Math.cos(le))/ke)*ke,y:Math.round((P+O*Math.sin(le))/ke)*ke}}if(f==="grid"){const W=Math.ceil(Math.sqrt(v.length)),ee=Math.floor(Q/W),J=Q%W,le=(W-1)*120,Y=(Math.ceil(v.length/W)-1)*120,Ie=b-le/2,Ee=P-Y/2;return{...U,x:Math.round((Ie+J*120)/ke)*ke,y:Math.round((Ee+ee*120)/ke)*ke}}if(f==="diagonal"){const W=(Q-(v.length-1)/2)*80;return{...U,x:Math.round((b+W)/ke)*ke,y:Math.round((P+W)/ke)*ke}}return U}))},si=f=>{const v=se.filter(W=>de.includes(W.id));if(v.length<2)return;const b=[...v].sort((W,ee)=>W.y-ee.y),P=[];let F=[b[0]];for(let W=1;W<b.length;W++){const ee=b[W],J=b[W-1];Math.abs(ee.y-J.y)<50?F.push(ee):(P.push(F),F=[ee])}if(P.push(F),P.length<2)return alert("Seleziona persone di almeno due generazioni diverse");const O=P[0],B=P[P.length-1];O.sort((W,ee)=>W.x-ee.x),B.sort((W,ee)=>W.x-ee.x);const U=40,Q=Vt+U;rt(W=>W.map(ee=>{if(!de.includes(ee.id))return ee;if(f==="align-children"&&B.some(J=>J.id===ee.id)){const J=O[0].x,le=O[O.length-1].x+Vt,Y=(J+le)/2,Ie=B.length*Vt+(B.length-1)*U,Ee=Y-Ie/2,Ge=B.findIndex(Me=>Me.id===ee.id);return{...ee,x:Ee+Ge*Q,y:O[0].y+180}}if(f==="align-parents"&&O.some(J=>J.id===ee.id)){const J=B[0].x,le=B[B.length-1].x+Vt,Y=(J+le)/2,Ie=O.length*Vt+(O.length-1)*U,Ee=Y-Ie/2,Ge=O.findIndex(Me=>Me.id===ee.id);return{...ee,x:Ee+Ge*Q}}return ee}))};H.useEffect(()=>{const f=b=>{if(!["INPUT","TEXTAREA","SELECT"].includes(b.target.tagName)){if(b.code==="Space"&&(b.preventDefault(),Ki(!0)),(b.ctrlKey||b.metaKey)&&b.key.toLowerCase()==="a"){b.preventDefault(),Ze(Gt.current.map(P=>P.id));return}if((b.ctrlKey||b.metaKey)&&b.key.toLowerCase()==="z"){b.preventDefault(),Js();return}if((b.ctrlKey||b.metaKey)&&b.key.toLowerCase()==="y"){b.preventDefault(),sa();return}if((b.ctrlKey||b.metaKey)&&b.key==="s"){b.preventDefault(),yd();return}if(b.altKey&&de.length>1)switch(b.code){case"KeyH":b.preventDefault(),_t("h");break;case"KeyV":b.preventDefault(),_t("v");break;case"KeyC":b.preventDefault(),_t("circle");break;case"KeyG":b.preventDefault(),_t("grid");break;case"KeyD":b.preventDefault(),_t("diagonal");break}if((b.key==="Backspace"||b.key==="Delete")&&(de.length>0||et.length>0||ln.length>0)&&confirm("Eliminare gli elementi selezionati?")){let P=Gt.current.filter(U=>!de.includes(U.id)),F=Zn.current.filter(U=>!de.includes(U.fromId)&&!de.includes(U.toId)&&!et.includes(U.id)),O=Mr.current.filter(U=>!ln.includes(U.id)),B=u.filter(U=>!m.includes(U.id));Rr(P,F,O,B),Ze([]),pn([]),Ct([]),g([])}if((b.key==="Esc"||b.key==="Escape")&&(Ze([]),pn([]),Ct([]),In(null)),(b.key.toLowerCase()==="m"||b.key.toLowerCase()==="f")&&de.length===0&&!b.altKey&&!b.ctrlKey){const{x:P,y:F}=z();Yi(b.key.toLowerCase()==="m"?"M":"F",P,F)}if(b.key.toLowerCase()==="n"&&!b.altKey&&!b.ctrlKey&&G(),b.key.toLowerCase()==="g"&&!b.altKey&&!b.ctrlKey&&de.length===0&&Zs(P=>!P),de.length===1&&!b.altKey&&!b.ctrlKey){const P=de[0];Gt.current.find(F=>F.id===P)&&(b.key.toLowerCase()==="s"&&Kl(),b.key.toLowerCase()==="c"&&Ql(),b.key.toLowerCase()==="p"&&Lr())}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(b.key)&&de.length>0){b.preventDefault();const P=b.shiftKey?10:1,F=b.key==="ArrowLeft"?-P:b.key==="ArrowRight"?P:0,O=b.key==="ArrowUp"?-P:b.key==="ArrowDown"?P:0;rt(B=>B.map(U=>de.includes(U.id)?{...U,x:U.x+F,y:U.y+O}:U))}}},v=b=>{b.code==="Space"&&Ki(!1)};return window.addEventListener("keydown",f),window.addEventListener("keyup",v),()=>{window.removeEventListener("keydown",f),window.removeEventListener("keyup",v)}},[de,et,ln,Ht,jr,hs]);const qt=f=>{let v,b;f.touches&&f.touches.length>0?(v=f.touches[0].clientX,b=f.touches[0].clientY):f.changedTouches&&f.changedTouches.length>0?(v=f.changedTouches[0].clientX,b=f.changedTouches[0].clientY):(v=f.clientX,b=f.clientY);const P=_(v,b);return{x:P.x,y:P.y,cx:v,cy:b}},Wl=(f,v,b)=>{const{x:P,y:F}=qt(f);x.current={active:!0,type:v,sourceId:b,startX:P,startY:F,currX:P,currY:F,pointerId:f.pointerId},pt({...x.current}),In(null)},Ye=f=>{f.stopPropagation(),f.preventDefault();const{x:v,y:b}=qt(f),P={};Gt.current.forEach(F=>{de.includes(F.id)&&(P[F.id]={x:F.x,y:F.y})}),x.current={active:!0,type:"move",sourceId:"selection-group",startX:v,startY:b,currX:v,currY:b,initialNodePositions:P,pointerId:f.pointerId},pt({...x.current})},Qi=(f,v)=>{f.stopPropagation(),f.preventDefault();const{x:b,y:P}=qt(f),F=se.filter(Q=>de.includes(Q.id)),O=F.reduce((Q,W)=>Q+W.x,0)/F.length,B=F.reduce((Q,W)=>Q+W.y,0)/F.length,U={};F.forEach(Q=>U[Q.id]={x:Q.x,y:Q.y}),x.current={active:!0,type:`transform-${v}`,sourceId:"group",startX:b,startY:P,currX:b,currY:P,initialNodePositions:U,centerX:O,centerY:B,startAngle:Math.atan2(P-B,b-O),startDist:Math.hypot(b-O,P-B),pointerId:f.pointerId},pt({...x.current})},ii=(f,v)=>{const{x:b,y:P}=qt(f),F=Zn.current.find(O=>O.id===v);if(F){const O=Ue(),B=b-Vt/2,U=P+50,Q={id:O,x:B,y:U,gender:"Unknown",name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},W={id:Ue(),fromId:F.fromId,toId:O,type:"child-bio",label:"",notes:[]},ee={id:Ue(),fromId:F.toId,toId:O,type:"child-bio",label:"",notes:[]};Rr([...Gt.current,Q],[...Zn.current,W,ee],Mr.current),In({x:f.clientX,y:f.clientY,edgeId:O,mode:"child"})}},oi=f=>{var Q,W;if(f.target.tagName!=="svg")return;if(i.current&&clearTimeout(i.current),f.pointerType==="touch"&&f.isPrimary){const ee=f.clientX,J=f.clientY;i.current=setTimeout(()=>{x.current={active:!1,...x.current},pt(null);const{x:le,y:Y}=_(ee,J);fe({x:ee,y:J,gx:le,gy:Y})},500)}if(f.isPrimary&&f.preventDefault(),o){c(null);return}ae&&fe(null),!f.shiftKey&&!Jn&&(Ze([]),pn([]),Ct([]),g([]));const{x:v,y:b,cx:P,cy:F}=qt(f);let O="pan";!la&&(f.pointerType==="mouse"||f.pointerType==="pen"||Jn)&&(O="box");const B=((Q=n.current)==null?void 0:Q.scrollLeft)||0,U=((W=n.current)==null?void 0:W.scrollTop)||0;x.current={active:!0,type:O,sourceId:"",startX:v,startY:b,currX:v,currY:b,clientStartX:P,clientStartY:F,initialScrollLeft:B,initialScrollTop:U,pointerId:f.pointerId},pt({...x.current}),In(null)},pd=(f,v)=>{f.stopPropagation(),f.preventDefault();const{x:b,y:P}=qt(f),F=f.shiftKey||Jn;let O=[...m];F?(O.includes(v)?O=O.filter(U=>U!==v):O.push(v),g(O)):(Ze([]),pn([]),Ct([]),O=[v],g(O));const B={};O.forEach(U=>{const Q=u.find(W=>W.id===U);Q&&(B[U]={x:Q.x,y:Q.y})}),x.current={active:!0,type:"move-note",sourceId:v,startX:b,startY:P,currX:b,currY:P,initialNodePositions:B,pointerId:f.pointerId},pt({...x.current})},Hl=(f,v)=>{if(f.stopPropagation(),f.preventDefault(),o){Ln(U=>U.map(Q=>{if(Q.id!==o)return Q;const W=Q.memberIds.includes(v);return{...Q,memberIds:W?Q.memberIds.filter(ee=>ee!==v):[...Q.memberIds,v]}}));return}const{x:b,y:P}=qt(f),F=f.shiftKey||Jn;let O=de;F?O=de.includes(v)?de.filter(U=>U!==v):[...de,v]:de.includes(v)||(O=[v],pn([]),Ct([]),g([])),Ze(O);const B={};Gt.current.forEach(U=>{O.includes(U.id)&&(B[U.id]={x:U.x,y:U.y})}),x.current={active:!0,type:"move",sourceId:v,startX:b,startY:P,currX:b,currY:P,initialNodePositions:B,pointerId:f.pointerId},pt({...x.current}),In(null)},md=(f,v)=>{f.stopPropagation(),f.preventDefault();const{x:b,y:P}=qt(f);x.current={active:!0,type:"link",sourceId:v,startX:b,startY:P,currX:b,currY:P,pointerId:f.pointerId},pt({...x.current}),In(null)},gd=(f,v)=>{v.stopPropagation(),pn([f]),Ze([]);const b=Ae.find(P=>P.id===f);b&&["marriage","cohabitation","separation","divorce"].includes(b.type)&&Ze([b.fromId,b.toId])};H.useEffect(()=>{const f=P=>{var Ge;if(s.current||(r.current={clientX:P.clientX,clientY:P.clientY},i.current&&x.current&&x.current.active&&Math.hypot(P.clientX-(x.current.clientStartX||0),P.clientY-(x.current.clientStartY||0))>10&&(clearTimeout(i.current),i.current=null),x.current&&x.current.active&&x.current.pointerId!==void 0&&P.pointerId!==void 0&&P.pointerId!==x.current.pointerId)||!x.current||!x.current.active)return;P.preventDefault();const{currX:F,currY:O,startX:B,startY:U,clientStartX:Q,clientStartY:W,initialScrollLeft:ee,initialScrollTop:J}=x.current,{x:le,y:Y,cx:Ie,cy:Ee}=qt(P);if(x.current.currX=le,x.current.currY=Y,x.current.type==="pan"&&n.current){const Me=Ie-(Q||0),wt=Ee-(W||0);n.current.scrollLeft=(ee||0)-Me,n.current.scrollTop=(J||0)-wt}else if(x.current.type==="box")pt({...x.current,currX:le,currY:Y});else if(x.current.type==="move"){const Me=le-B,wt=Y-U,ze=x.current.initialNodePositions;Qn(lt=>lt.map(ne=>{if(de.includes(ne.id)){const me=(ze==null?void 0:ze[ne.id])||{x:ne.x,y:ne.y};let st=me.x+Me,qe=me.y+wt;return On&&(st=Math.round(st/ke)*ke,qe=Math.round(qe/ke)*ke),{...ne,x:st,y:qe}}return ne}))}else if(x.current.type==="move-note"){const Me=le-B,wt=Y-U,ze=x.current.initialNodePositions;h(lt=>lt.map(ne=>{if(m.includes(ne.id)){const me=(ze==null?void 0:ze[ne.id])||{x:ne.x,y:ne.y},st=Math.max(0,Math.min(mi-ne.width,me.x+Me)),qe=Math.max(0,Math.min(mi-ne.height,me.y+wt));return{...ne,x:st,y:qe}}return ne}))}else if(["spouse","child","parents","link","group-label","group-padding","transform-scale","transform-rotate"].includes(x.current.type)){if(x.current.type==="group-padding"){const Me=le-B,wt=Y-U,ze=x.current.initialPadding||20,lt=Math.max(10,ze+Math.max(Me,wt));fr(ne=>ne.map(me=>me.id===x.current.sourceId?{...me,customPadding:lt}:me))}else if(x.current.type==="group-label"){const Me=le-B,wt=Y-U,ze=(Ge=x.current.initialNodePositions)==null?void 0:Ge[x.current.sourceId];ze&&fr(lt=>lt.map(ne=>ne.id===x.current.sourceId?{...ne,labelPos:{x:ze.x+Me,y:ze.y+wt}}:ne))}pt({...x.current,currX:le,currY:Y})}},v=P=>{if(x.current&&x.current.active&&x.current.pointerId!==void 0&&P.pointerId!==void 0&&P.pointerId!==x.current.pointerId||(i.current&&(clearTimeout(i.current),i.current=null),!x.current||!x.current.active))return;if((x.current.type==="move"||x.current.type==="move-note"||x.current.type==="group-label"||x.current.type==="group-padding"||x.current.type==="transform-scale"||x.current.type==="transform-rotate"||x.current.type==="selection-group")&&kn(Gt.current,Zn.current,Mr.current,er.current),x.current.type==="box"){const O=Math.min(x.current.startX,x.current.currX),B=Math.max(x.current.startX,x.current.currX),U=Math.min(x.current.startY,x.current.currY),Q=Math.max(x.current.startY,x.current.currY);if(Math.abs(B-O)>5||Math.abs(Q-U)>5){const W=[],ee=[];Gt.current.forEach(J=>{J.x>=O&&J.x<=B&&J.y>=U&&J.y<=Q&&W.push(J.id)}),er.current.forEach(J=>{J.x>=O&&J.x<=B&&J.y>=U&&J.y<=Q&&ee.push(J.id)}),P.shiftKey?(Ze(J=>[...new Set([...J,...W])]),g(J=>[...new Set([...J,...ee])])):(Ze(W),g(ee),pn([]),Ct([]))}}if(["spouse","child","parents","link"].includes(x.current.type)){const{currX:O,currY:B,sourceId:U,type:Q}=x.current,W=Gt.current.find(J=>O>=J.x-20&&O<=J.x+80&&B>=J.y-20&&B<=J.y+80&&J.id!==U),ee=Gt.current.find(J=>J.id===U);if(W&&ee){let J=U,le=W.id,Y="friendship";Q==="spouse"?Y="marriage":Q==="child"?Y="child-bio":Q==="parents"&&(J=W.id,le=U,Y="child-bio");const Ie={id:Ue(),fromId:J,toId:le,type:Y,label:"",notes:[]},Ee=[...Zn.current,Ie];hr(Ee),kn(Gt.current,Ee,Mr.current,u),In({x:P.clientX,y:P.clientY,edgeId:Ie.id,mode:Q})}else if(ee){const J=Math.hypot(O-x.current.startX,B-x.current.startY)<10;let le=O-30,Y=B-30;if(Q==="parents"){const st=U,qe=Ue(),be=Ue(),Ke=J?ee.y-120:B-20,tt=J?ee.x:O-20,mn={id:qe,x:tt-80,y:Ke,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},gn={id:be,x:tt+80,y:Ke,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},Fn=[{id:Ue(),fromId:qe,toId:be,type:"marriage",label:"",notes:[]},{id:Ue(),fromId:qe,toId:st,type:"child-bio",label:"",notes:[]},{id:Ue(),fromId:be,toId:st,type:"child-bio",label:"",notes:[]}],Le=[...Gt.current,mn,gn],mt=[...Zn.current,...Fn];Qn(Le),hr(mt),kn(Le,mt,Mr.current,u),Ze([qe,be]),x.current={...x.current,active:!1},pt(null);return}else J&&(Q==="child"?(le=ee.x,Y=ee.y+120):Q==="spouse"&&(le=ee.x+120,Y=ee.y));const Ie=Ue(),Ee=Q==="spouse"?ee.gender==="M"?"F":"M":"Unknown",Ge={id:Ie,x:le,y:Y,gender:Ee,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};let Me=U,wt=Ie,ze="friendship";Q==="spouse"?ze="marriage":Q==="child"&&(ze="child-bio");const lt={id:Ue(),fromId:Me,toId:wt,type:ze,label:"",notes:[]},ne=[...Zn.current,lt],me=[...Gt.current,Ge];Qn(me),hr(ne),kn(me,ne,Mr.current,u),In({x:P.clientX,y:P.clientY,edgeId:lt.id,mode:Q})}}x.current={active:!1,type:"pan",sourceId:"",startX:0,startY:0,currX:0,currY:0,clientStartX:0,clientStartY:0},pt(null)},b=()=>{};return window.addEventListener("pointermove",f),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),window.addEventListener("resize",b),()=>{window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),window.removeEventListener("resize",b)}},[de,m,Jn]),H.useEffect(()=>Ys?((async()=>{const v=window.__initial_auth_token;v?await CT(Ys,v).catch(b=>console.error("Token Auth Error:",b)):await IT(Ys).catch(b=>console.error("Anon Auth Error:",b))})(),RT(Ys,v=>{T(v)})):void 0,[Ys]),H.useEffect(()=>{const f=localStorage.getItem("genopro_local_index"),b=(f?JSON.parse(f):[]).map(F=>{try{return JSON.parse(localStorage.getItem(`genopro_data_${F.id}`)||JSON.stringify(F))}catch{return F}});if(!E||!Kn){Mt(b);return}const P=S||E.uid;if(!P){Mt(b);return}try{const F=GA(jA(Kn,"artifacts",$i,"users",P,"genograms")),O=ZA(F,B=>{const U=[];B.forEach(W=>U.push({id:W.id,...W.data()}));const Q=new Map;b.forEach(W=>Q.set(W.id,W)),U.forEach(W=>{const ee=Q.get(W.id);(!ee||W.lastModified>=ee.lastModified)&&(Q.set(W.id,W),localStorage.setItem(`genopro_data_${W.id}`,JSON.stringify(W)))}),Mt(Array.from(Q.values()))},B=>{console.error("Dashboard offline, uso cache locale"),Mt(b)});return()=>O()}catch{Mt(b)}},[E,Kn,S]),H.useLayoutEffect(()=>{j==="editor"&&n.current&&setTimeout(()=>{n.current&&n.current.scrollTo(Pt-n.current.clientWidth/2,Pt-n.current.clientHeight/2)},100)},[j]);const yd=()=>{alert("I tuoi salvataggi sono gestiti in modo completamente automatico e avvengono ogni volta che compi un'azione!")},Gl=(f,v,b,P=[])=>{Qn(f),hr(v),fr(b),h(P),ra([]),ls(-1),setTimeout(()=>{const F=JSON.stringify({nodes:f,edges:v,groups:b,stickyNotes:P});ra([F]),ls(0)},0)},ai=()=>{Bi(Ue()),Wi("Nuovo Genogramma"),It("family"),Gl([],[],[]),L("editor")},tr=f=>{const v={id:Ue(),x:Pt,y:Pt,gender:f,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};rt(b=>[...b,v]),Ze([v.id])},Yi=(f,v,b)=>{On&&(v=Math.round(v/ke)*ke,b=Math.round(b/ke)*ke);const P={id:Ue(),x:v,y:b,gender:f,name:"Nuovo",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]};rt(F=>[...F,P]),Ze([P.id])},ql=()=>{if(de.length===0)return alert("Seleziona nodi");const f={id:Ue(),memberIds:[...de],type:"household",label:"Nuovo Gruppo",color:"#000000",notes:[]};Ln(v=>[...v,f]),Ct([f.id]),Ze([])},Vn=f=>On?Math.round(f/ke)*ke:f,Lr=()=>{if(de.length!==1)return alert("Seleziona una persona");const f=de[0],v=se.find(Q=>Q.id===f);if(!v)return;const b=Ue(),P=Ue(),F=Vn(v.y-150),O={id:b,x:Vn(v.x-80),y:F,gender:"M",name:"Padre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},B={id:P,x:Vn(v.x+80),y:F,gender:"F",name:"Madre",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},U=[{id:Ue(),fromId:b,toId:P,type:"marriage",label:"",notes:[]},{id:Ue(),fromId:b,toId:f,type:"child-bio",label:"",notes:[]},{id:Ue(),fromId:P,toId:f,type:"child-bio",label:"",notes:[]}];Rr([...se,O,B],[...Ae,...U],we),Ze([b,P])},Kl=()=>{if(de.length!==1)return alert("Seleziona una persona");const f=de[0],v=se.find(O=>O.id===f);if(!v)return;const b=Ue(),P={id:b,x:Vn(v.x+120),y:Vn(v.y),gender:v.gender==="M"?"F":"M",name:"Partner",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},F={id:Ue(),fromId:f,toId:b,type:"marriage",label:"",notes:[]};Rr([...se,P],[...Ae,F],we),Ze([b])},Ql=()=>{if(et.length===1){const f=Ae.find(v=>v.id===et[0]);if(f&&Er.Struttura.includes(f.type)){const v=se.find(U=>U.id===f.fromId),b=se.find(U=>U.id===f.toId);if(!v||!b)return;const P=Ue(),F={id:P,x:Vn((v.x+b.x)/2),y:Vn(Math.max(v.y,b.y)+150),gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},O={id:Ue(),fromId:f.fromId,toId:P,type:"child-bio",label:"",notes:[]},B={id:Ue(),fromId:f.toId,toId:P,type:"child-bio",label:"",notes:[]};Rr([...se,F],[...Ae,O,B],we),Ze([P]),pn([]);return}}if(de.length===1){const f=de[0],v=se.find(B=>B.id===f);if(!v)return;const b=rv(f,Ae),P=Ue(),F={id:P,x:Vn(v.x),y:Vn(v.y+150),gender:"Unknown",name:"Figlio",birthDate:"",deceased:!1,indexPerson:!1,substanceAbuse:!1,mentalIssue:!1,physicalIssue:!1,recovery:!1,gayLesbian:!1,notes:[]},O=[{id:Ue(),fromId:f,toId:P,type:"child-bio",label:"",notes:[]}];if(b){const B=b.fromId===f?b.toId:b.fromId;O.push({id:Ue(),fromId:B,toId:P,type:"child-bio",label:"",notes:[]})}Rr([...se,F],[...Ae,...O],we),Ze([P])}else alert("Seleziona una coppia o un genitore")},vd=()=>{const f=de.length>0?se.filter(ne=>de.includes(ne.id)):se;if(f.length===0)return;const v=JSON.parse(JSON.stringify(se)),b=new Map(v.map(ne=>[ne.id,ne])),P=180,F=60,O=80,B=100,U=250,Q=ne=>Ae.filter(me=>(me.fromId===ne||me.toId===ne)&&Er.Struttura.includes(me.type)).map(me=>me.fromId===ne?me.toId:me.fromId),W=ne=>{const me=Ae.filter(st=>st.toId===ne&&st.type.startsWith("child"));return[...new Set(me.map(st=>st.fromId))]},ee=ne=>{const me=Ae.filter(qe=>ne.includes(qe.fromId)&&qe.type.startsWith("child"));return[...new Set(me.map(qe=>qe.toId))]},J=new Map;f.forEach(ne=>J.set(ne.id,-1));const le=(ne,me=new Set)=>{if(me.has(ne))return 0;if(J.get(ne)!==-1)return J.get(ne);me.add(ne);const st=ee([ne]),qe=Q(ne);let be=-1;const Ke=new Set(st);if(qe.forEach(mn=>ee([mn]).forEach(gn=>Ke.add(gn))),Ke.size>0){const mn=Array.from(Ke).map(gn=>le(gn,new Set(me)));be=Math.max(...mn)}const tt=be+1;return J.set(ne,tt),tt};f.forEach(ne=>le(ne.id));let Y=!0;for(;Y;)Y=!1,f.forEach(ne=>{const me=J.get(ne.id)||0;Q(ne.id).forEach(st=>{const qe=J.get(st)||0;if(me!==qe){const be=Math.max(me,qe);J.set(ne.id,be),J.set(st,be),Y=!0}})});const Ie=Math.max(...Array.from(J.values())),Ee=new Map;J.forEach((ne,me)=>Ee.set(me,Ie-ne)),[...f].sort((ne,me)=>Lu(ne.birthDate||"")-Lu(me.birthDate||"")).forEach((ne,me)=>{ne.x=me*(F+20)});for(let ne=0;ne<U;ne++){const me=new Map;f.forEach(be=>{let Ke=0,tt=0;if(W(be.id).forEach(Le=>{const mt=b.get(Le);mt&&(Ke+=mt.x,tt++)}),ee([be.id]).forEach(Le=>{const mt=b.get(Le);mt&&(Ke+=mt.x,tt++)}),Q(be.id).forEach(Le=>{const mt=b.get(Le);mt&&(Ke+=mt.x,tt++)}),tt>0){const Le=Ke/tt,mt=.5*(1-ne/U);me.set(be.id,(Le-be.x)*mt)}}),f.forEach(be=>{me.has(be.id)&&(be.x+=me.get(be.id))});const st=new Set;f.forEach(be=>{if(st.has(be.id))return;const Ke=Q(be.id);if(Ke.length>0){const tt=[be.id,...Ke];tt.forEach(Le=>st.add(Le)),tt.sort((Le,mt)=>{var l,d;const di=(l=b.get(Le))==null?void 0:l.gender,Or=(d=b.get(mt))==null?void 0:d.gender;return di==="M"&&Or!=="M"?-1:di!=="M"&&Or==="M"?1:0});const mn=tt.reduce((Le,mt)=>Le+b.get(mt).x,0)/tt.length,gn=(tt.length-1)*O;let Fn=mn-gn/2;tt.forEach((Le,mt)=>{const di=b.get(Le);di.x=Fn+mt*O})}});const qe=new Map;f.forEach(be=>{const Ke=Ee.get(be.id)||0;qe.has(Ke)||qe.set(Ke,[]),qe.get(Ke).push(be)}),qe.forEach(be=>{be.sort((Ke,tt)=>Ke.x-tt.x);for(let Ke=0;Ke<be.length-1;Ke++){const tt=be[Ke],mn=be[Ke+1],gn=mn.x-tt.x;if(gn<B){const Fn=(B-gn)/2;tt.x-=Fn,mn.x+=Fn}}})}const Me=f.map(ne=>ne.x),wt=Math.min(...Me),ze=Math.max(...Me),lt=Pt-(wt+ze)/2;f.forEach(ne=>{ne.x=Math.round((ne.x+lt)/ke)*ke;const me=Ee.get(ne.id)||0;ne.y=Math.round((Pt+me*P)/ke)*ke}),rt(v)},gr=()=>{mr(1),n.current&&n.current.scrollTo({left:Pt-n.current.clientWidth/2,top:Pt-n.current.clientHeight/2,behavior:"smooth"})},Yl=H.useCallback(()=>{let f=1/0,v=1/0,b=-1/0,P=-1/0;return se.length===0?{minX:Pt-400,minY:Pt-300,maxX:Pt+400,maxY:Pt+300}:(se.forEach(F=>{f=Math.min(f,F.x),v=Math.min(v,F.y),b=Math.max(b,F.x+Vt),P=Math.max(P,F.y+br)}),we.forEach(F=>{const O=Zw(F,se);O&&(f=Math.min(f,O.x),v=Math.min(v,O.y),b=Math.max(b,O.x+O.w),P=Math.max(P,O.y+O.h))}),{minX:f,minY:v,maxX:b,maxY:P})},[se,we]),ha=()=>{let{minX:f,minY:v,maxX:b,maxY:P}=Yl();if(Yn){const B=new Set(se.map(J=>J.gender)).size+(se.some(J=>J.deceased)?1:0)+(se.some(J=>J.indexPerson)?1:0),U=new Set(Ae.map(J=>J.type)).size,Q=80+Math.max(B,U)*24+20,W=f-220-50,ee=v;f=Math.min(f,W),v=Math.min(v,ee),b=Math.max(b,f+220+(b-f)),P=Math.max(P,ee+Q)}const F=100;return{x:f-F,y:v-F,w:b-f+F*2,h:P-v+F*2}},li=async f=>{if(!t.current)return;const v=ha(),b=ri,P=t.current.cloneNode(!0),F=P.querySelector("g");F&&(F.setAttribute("transform",""),F.style.transform=""),P.setAttribute("viewBox",`${v.x} ${v.y} ${v.w} ${v.h}`),P.setAttribute("width",`${v.w*b}`),P.setAttribute("height",`${v.h*b}`),P.style.fontFamily="sans-serif";const O=new XMLSerializer().serializeToString(P),B=document.createElement("canvas"),U=B.getContext("2d"),Q=new Image,W=new Blob([O],{type:"image/svg+xml;charset=utf-8"}),ee=URL.createObjectURL(W),J=new Date,le=`${Mn.replace(/\s+/g,"_")}_${J.toISOString().slice(0,10)}.${f}`;Q.onload=()=>{B.width=v.w*b,B.height=v.h*b,U&&(U.font="12px sans-serif",f==="jpeg"&&(U.fillStyle=cs?"#111827":"#ffffff",U.fillRect(0,0,B.width,B.height)),U.drawImage(Q,0,0),B.toBlob(async Y=>{if(!Y)return;if(navigator.canShare&&navigator.share)try{const Ge=new File([Y],le,{type:`image/${f}`});if(navigator.canShare({files:[Ge]})){await navigator.share({files:[Ge],title:Mn,text:"Esportazione Genogramma"}),URL.revokeObjectURL(ee);return}}catch(Ge){console.warn("Share fallito, provo download classico",Ge)}const Ie=URL.createObjectURL(Y),Ee=document.createElement("a");Ee.href=Ie,Ee.download=le,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),URL.revokeObjectURL(Ie),URL.revokeObjectURL(ee)},`image/${f}`,1))},Q.src=ee},Xi=()=>{const f=window.open("","_blank");if(f&&t.current){const v=ha(),b=t.current.cloneNode(!0),P=cs?"#111827":"#ffffff",F=document.createElementNS("http://www.w3.org/2000/svg","rect");F.setAttribute("x",String(v.x)),F.setAttribute("y",String(v.y)),F.setAttribute("width",String(v.w)),F.setAttribute("height",String(v.h)),F.setAttribute("fill",P),b.firstChild?b.insertBefore(F,b.firstChild):b.appendChild(F),b.setAttribute("viewBox",`${v.x} ${v.y} ${v.w} ${v.h}`),b.setAttribute("width",`${v.w}px`),b.setAttribute("height",`${v.h}px`);const O=b.querySelector("g");O&&(O.setAttribute("transform",""),O.style.transform=""),b.style.display="block",b.style.overflow="visible";const B=new XMLSerializer().serializeToString(b);f.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${Mn} - Vettoriale</title>
                    <style>
                        @page { 
                            size: ${v.w}px ${v.h}px; 
                            margin: 0; 
                        }
                        body { 
                            margin: 0; 
                            padding: 0; 
                            width: ${v.w}px;
                            height: ${v.h}px;
                            overflow: hidden;
                            background-color: ${P};
                            /* FORZA STAMPA COLORI SFONDO */
                            -webkit-print-color-adjust: exact; 
                            print-color-adjust: exact;
                        }
                        svg { 
                            width: 100%; 
                            height: 100%; 
                            display: block;
                        }
                        /* FIX FONT */
                        text { 
                            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important; 
                        }
                    </style>
                </head>
                <body>
                    ${B}
                </body>
                </html>
            `),f.document.close(),f.onload=()=>{setTimeout(()=>{f.focus(),f.print()},500)}}},Xl=(f,v,b,P)=>{const F=f.filter(O=>P.onlyPeopleWithNotes?O.notes&&O.notes.length>0:!0);return F.length===0?'<div style="padding:20px; text-align:center; color:#666;">Nessuna persona corrisponde ai criteri selezionati.</div>':F.map(O=>{const B=v.filter(Y=>(Y.fromId===O.id||Y.toId===O.id)&&Er.Struttura.includes(Y.type)).map(Y=>{const Ie=Y.fromId===O.id?Y.toId:Y.fromId,Ee=f.find(Me=>Me.id===Ie),Ge=nn[Y.type];return Ee?`<b>${Ee.name}</b> (${Ge.label})`:null}).filter(Boolean).join(", "),U=v.filter(Y=>Y.fromId===O.id&&Y.type.startsWith("child")).map(Y=>{const Ie=f.find(Ee=>Ee.id===Y.toId);return Ie?Ie.name:null}).filter(Boolean).join(", "),Q=v.filter(Y=>(Y.fromId===O.id||Y.toId===O.id)&&!Er.Struttura.includes(Y.type)&&!Y.type.startsWith("child")).map(Y=>{const Ie=Y.fromId===O.id?Y.toId:Y.fromId,Ee=f.find(ze=>ze.id===Ie),Ge=Ee?null:b.find(ze=>ze.id===Ie),Me=Ee?Ee.name:Ge?`Gruppo: ${Ge.label}`:"Sconosciuto";return`<li>${(nn[Y.type]||{label:Y.type}).label} con <b>${Me}</b>${Y.notes.length?` (Note: ${Y.notes.map(ze=>ze.text).join("; ")})`:""}</li>`}).join(""),W=b.filter(Y=>Y.memberIds.includes(O.id)).map(Y=>Y.label).join(", ");let ee=[];P.showGender&&ee.push(O.gender),P.showBirthDate&&O.birthDate&&ee.push(O.birthDate),P.showAge&&O.birthDate&&ee.push(`${xl(O.birthDate)} anni`);const J=ee.length>0?`<small style="font-weight:normal; color:#666;">(${ee.join(", ")})</small>`:"";let le=[];return O.deceased&&le.push("Deceduto"),O.indexPerson&&le.push("Paziente Designato"),O.substanceAbuse&&le.push("Abuso Sostanze"),O.mentalIssue&&le.push("Problema Psicologico"),O.physicalIssue&&le.push("Problema Fisico"),O.gayLesbian&&le.push("Omosessuale"),`
            <div class="person-card">
                <h3>${O.name} ${J}</h3>
                
                ${P.showClinical&&le.length>0?`<p class="clinical-tags"><strong>Clinica:</strong> ${le.join(", ")}</p>`:""}

                ${P.showGroups&&W?`<p><strong>Gruppi:</strong> ${W}</p>`:""}
                
                ${P.showFamily&&(B||U)?`
                    <div style="margin-top:10px; padding-top:10px; border-top:1px solid #eee;">
                        ${B?`<p><strong>Partner:</strong> ${B}</p>`:""}
                        ${U?`<p><strong>Figli:</strong> ${U}</p>`:""}
                    </div>
                `:""}

                ${P.showRelations&&Q?`<p><strong>Altre Relazioni:</strong></p><ul>${Q}</ul>`:""}
                
                ${P.showNotes&&O.notes.length>0?`<div class="notes-section"><strong>Diario Clinico:</strong><ul>${O.notes.map(Y=>`<li><span class="note-date">${Y.date}</span>: ${Y.text}</li>`).join("")}</ul></div>`:""}
            </div>
          `}).join("")},ci=f=>{const v=window.open("","_blank");if(v&&t.current){const b=ha(),P=t.current.cloneNode(!0),F=P.querySelector("g");F&&(F.setAttribute("transform",""),F.style.transform=""),P.setAttribute("viewBox",`${b.x} ${b.y} ${b.w} ${b.h}`),P.setAttribute("width","100%"),P.setAttribute("height","50vh");const O=new XMLSerializer().serializeToString(P),B=Xl(se,Ae,we,f),U=Array.from(new Set(Ae.map(le=>le.type))),Q=Array.from(new Set(se.map(le=>le.gender))),W=le=>{const Y=nn[le]||nn.custom;if(!Y)return"";let Ie=Y.color;(Y.renderType.includes("hostile")||Y.renderType.includes("triple-zigzag")||Y.lineStyle==="zigzag-thick")&&(Ie="#ef4444");let Ee=30;const Ge=Y.renderType.includes("arrow")&&!Y.renderType.includes("center")&&Y.renderType!=="double-arrow-inward"||Y.renderType==="triple-zigzag-center-arrow";Ge&&(Ee-=6);let Me=`M 0 7 L ${Ee} 7`;Y.lineStyle.startsWith("zigzag")&&(Me=_r(0,7,Ee,7,3,8));const wt=Y.lineStyle==="dashed"?'stroke-dasharray="4,2"':Y.lineStyle==="dotted"?'stroke-dasharray="1,2"':"",ze=Y.lineStyle.startsWith("zigzag")?"1.5":"2";let lt="";if(Y.type!=="best-friend"&&(lt=`<path d="${Me}" stroke="${Ie}" stroke-width="${ze}" ${wt} fill="none" />`),(Y.renderType==="fusion"||Y.renderType==="triple")&&(lt+=`<g><path d="${Me}" stroke="${Ie}" stroke-width="1" transform="translate(0, 3)" fill="none"/><path d="${Me}" stroke="${Ie}" stroke-width="1" transform="translate(0, -3)" fill="none"/></g>`),(Y.renderType==="double"||Y.renderType==="double-zigzag"||Y.renderType==="best-friend")&&(lt+=`<path d="${Me}" stroke="${Ie}" stroke-width="1" transform="translate(0, 3)" fill="none" ${wt}/>`),Y.renderType==="double-arrow-inward"){const ne=Ee*.3,me=Ee*.7;lt+=`<polygon points="4,-4 -4,0 4,4" fill="${Ie}" transform="translate(${ne}, 7)" />`,lt+=`<polygon points="-4,-4 4,0 -4,4" fill="${Ie}" transform="translate(${me}, 7)" />`}else Ge&&(lt+=`<polygon points="-5,-4 5,0 -5,4" fill="${Ie}" transform="translate(${Ee}, 7)" />`);return`<svg width="30" height="14" style="vertical-align:middle; margin-right:5px; overflow:visible">${lt}</svg>`},ee=le=>`<svg width="16" height="16" style="vertical-align:middle; margin-right:5px">${le==="M"?'<rect x="2" y="2" width="12" height="12" stroke="black" fill="white"/>':'<circle cx="8" cy="8" r="6" stroke="black" fill="white"/>'}</svg>`,J=`
              <div style="margin-top: 20px; border: 1px solid #eee; padding: 10px; border-radius: 8px; background: #fcfcfc; page-break-inside: avoid; font-size: 0.8em;">
                  <h4 style="margin:0 0 10px 0;">Legenda Rapida</h4>
                  <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                      <div>${Q.map(le=>`<span style="margin-right:10px">${ee(le)} ${le}</span>`).join("")}</div>
                      <div>${U.map(le=>{var Y;return`<span style="margin-right:10px">${W(le)} ${((Y=nn[le])==null?void 0:Y.label)||le}</span>`}).join("")}</div>
                  </div>
              </div>
          `;v.document.write(`
              <html>
              <head>
                  <title>${Mn} - Report</title>
                  <style>
                      body { font-family: 'Segoe UI', sans-serif; padding: 40px; color: #333; max-width: 1000px; margin: 0 auto; background: white; }
                      h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; color: #111; }
                      .diagram-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; margin-bottom: 30px; text-align: center; background: white; }
                      .person-card { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3b82f6; page-break-inside: avoid; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
                      .person-card h3 { margin: 0 0 5px 0; font-size: 1.1em; color: #1e293b; }
                      .clinical-tags { font-size: 0.85em; color: #e11d48; margin-bottom: 5px; }
                      .notes-section { margin-top: 8px; padding-top: 8px; border-top: 1px dashed #cbd5e1; font-size: 0.9em; background: #fffbeb; padding: 10px; border-radius: 4px; }
                      .note-date { font-weight: bold; color: #b45309; }
                      ul { margin: 5px 0 0 20px; padding: 0; }
                      @media print { body { padding: 0; } }
                  </style>
              </head>
              <body>
                  <h1>${Mn}</h1>
                  <p style="color:#666; font-size:0.9em">Generato il ${new Date().toLocaleDateString()}</p>
                  
                  <div class="diagram-container">
                      ${O}
                  </div>
                  ${J}
                  
                  <h2 style="margin-top:30px; border-bottom:1px solid #eee;">Dettaglio Clinico</h2>
                  ${B}
              </body>
              </html>
          `),v.document.close(),setTimeout(()=>{v.focus(),v.print()},500)}},ui=f=>{var P;const v=(P=f.target.files)==null?void 0:P[0];if(!v)return;const b=new FileReader;b.onload=F=>{var O;try{const B=JSON.parse((O=F.target)==null?void 0:O.result);Array.isArray(B)&&(Mt(U=>[...U,...B]),alert("Importazione completata!"))}catch{alert("Errore file")}},b.readAsText(v)},Jl=()=>{const f=new Blob([JSON.stringify(an)],{type:"application/json"}),v=URL.createObjectURL(f),b=document.createElement("a");b.href=v,b.download="backup_genopro.json",b.click()},He=de.length===1?se.find(f=>f.id===de[0]):null,_e=Ae.find(f=>f.id===et[0]),Tt=we.find(f=>f.id===ln[0]);return j==="dashboard"?a.jsxs("div",{className:"h-screen flex flex-col transition-colors duration-300",style:{backgroundColor:Qe.colors.bgMain,color:Qe.colors.text,"--theme-bg-main":Qe.colors.bgMain,"--theme-bg-panel":Qe.colors.bgPanel,"--theme-border":Qe.colors.border,"--theme-text":Qe.colors.text,"--theme-text-muted":Qe.colors.textMuted,"--theme-accent":Qe.colors.accent},children:[a.jsx("style",{children:`
                .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
                .theme-border { border-color: var(--theme-border); }
                .theme-text { color: var(--theme-text); }
                .theme-text-muted { color: var(--theme-text-muted); }
                .theme-hover:hover { background-color: rgba(127,127,127, 0.1); }
              `}),De&&a.jsx(xC,{onClose:()=>Se(!1),firebaseConfig:oe}),Gi&&a.jsx(vC,{onClose:()=>qi(!1),onExport:Jl,onImport:ui,setCustomUser:Je,customUser:S,setFirebaseConfig:re,firebaseConfig:oe}),a.jsxs("div",{className:"flex h-full",children:[a.jsxs("div",{className:"w-64 border-r p-4 flex flex-col gap-4 theme-panel theme-border",children:[a.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl mb-2",style:{color:"var(--theme-accent)"},children:[a.jsx(Ab,{})," GenoPro"]}),a.jsxs("button",{onClick:ai,className:"text-white px-4 py-2 rounded flex items-center justify-center gap-2 font-medium transition-colors shadow-sm hover:opacity-90",style:{backgroundColor:"var(--theme-accent)"},children:[a.jsx(Il,{size:18})," Nuovo"]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-xs font-bold uppercase opacity-50 mb-2 mt-4 px-2 theme-text",children:"Categorie"}),a.jsxs("button",{onClick:()=>Ks("ALL"),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${Dn==="ALL"?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,style:Dn==="ALL"?{color:"var(--theme-accent)"}:{},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Zh,{size:16})," Tutti"]}),a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:an.length})]}),Rn.map(f=>{const v=tv[f.iconKey]||nf,b=an.filter(F=>F.category===f.id).length,P=Dn===f.id;return a.jsxs("button",{onClick:()=>Ks(f.id),className:`w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors ${P?"theme-border border bg-black/5 dark:bg-white/5 font-bold":"theme-hover"}`,children:[a.jsxs("span",{className:"flex items-center gap-2",style:{color:P?void 0:f.color},children:[a.jsx(v,{size:16,color:f.color})," ",f.label]}),b>0&&a.jsx("span",{className:"opacity-50 px-1.5 py-0.5 rounded text-[10px] border theme-border",children:b})]},f.id)})]}),a.jsxs("div",{className:"mt-auto border-t theme-border pt-4 space-y-2",children:[a.jsx(lv,{currentThemeId:Dr,onChange:ia,placement:"top"}),a.jsxs("button",{onClick:()=>Se(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(bp,{size:16})," Istruzioni"]}),a.jsxs("button",{onClick:()=>qi(!0),className:"w-full flex items-center gap-2 px-3 py-2 rounded text-sm theme-hover transition-colors theme-text",children:[a.jsx(Mx,{size:16})," Impostazioni"]})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{backgroundColor:Qe.colors.bgMain},children:[a.jsxs("div",{className:"h-16 border-b flex items-center justify-between px-8 theme-panel theme-border",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(xu,{className:"absolute left-3 top-1/2 -translate-y-1/2 opacity-50",size:18}),a.jsx("input",{className:"w-full pl-10 pr-4 py-2 rounded-lg border theme-border bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 theme-text placeholder-opacity-50 placeholder-current",placeholder:"Cerca genogramma...",value:is,onChange:f=>Fi(f.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2 border-l pl-4 theme-border",children:[a.jsx("span",{className:"text-xs uppercase font-bold opacity-50 theme-text",children:"Ordina"}),a.jsx("button",{onClick:()=>Qs("date_desc"),className:`p-1.5 rounded ${qn==="date_desc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Recenti",children:a.jsx(Ag,{className:"rotate-180",size:18})}),a.jsx("button",{onClick:()=>Qs("date_asc"),className:`p-1.5 rounded ${qn==="date_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Pi Vecchi",children:a.jsx(Ag,{size:18})}),a.jsx("button",{onClick:()=>Qs("name_asc"),className:`p-1.5 rounded ${qn==="name_asc"?"bg-black/10 dark:bg-white/10 text-[var(--theme-accent)]":"theme-hover"}`,title:"Alfabetico",children:a.jsx(Db,{size:18})})]})]}),a.jsx("button",{onClick:M,className:"p-2 rounded-lg theme-hover transition-colors",title:I?"Esci da Schermo Intero":"Schermo Intero",children:I?a.jsx(zb,{size:18,className:"theme-text"}):a.jsx(Fb,{size:18,className:"theme-text"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[Ui.map(f=>{var P;const v=Rn.find(F=>F.id===f.category)||Rn[Rn.length-1],b=tv[v.iconKey]||nf;return a.jsxs("div",{onClick:()=>{Bi(f.id),Wi(f.title),It(f.category),Hi(f.data.presets||[]),Gl(f.data.nodes||[],f.data.edges||[],f.data.groups||[],f.data.stickyNotes||[]),L("editor")},className:"group relative theme-panel rounded-xl shadow-sm hover:shadow-md transition-all border theme-border cursor-pointer overflow-hidden flex flex-col h-48",children:[a.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full",style:{backgroundColor:v.color}}),a.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider",style:{color:v.color},children:[a.jsx(b,{size:12})," ",v.label]}),a.jsx("button",{onClick:F=>{if(F.stopPropagation(),confirm("Eliminare?")){Kn&&JA(Yy(Kn,"artifacts",$i,"users",S||(E==null?void 0:E.uid)||"anon","genograms",f.id)),localStorage.removeItem(`genopro_data_${f.id}`);const O=localStorage.getItem("genopro_local_index");if(O){const B=JSON.parse(O).filter(U=>U.id!==f.id);localStorage.setItem("genopro_local_index",JSON.stringify(B)),Mt(U=>U.filter(Q=>Q.id!==f.id))}}},className:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(Ta,{size:16})})]}),a.jsx("h3",{className:"text-lg font-bold mb-1 line-clamp-2 theme-text",children:f.title}),a.jsxs("div",{className:"mt-auto pt-4 flex items-center justify-between text-xs opacity-60 border-t theme-border",children:[a.jsx("span",{children:new Date(f.lastModified).toLocaleDateString()}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lo,{size:12})," ",((P=f.data.nodes)==null?void 0:P.length)||0]})]})]})]},f.id)}),Ui.length===0&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center h-64 opacity-40 border-2 border-dashed theme-border rounded-xl",children:[a.jsx(xu,{size:48,className:"mb-4"}),a.jsx("p",{children:"Nessun genogramma trovato"}),is&&a.jsx("button",{onClick:()=>Fi(""),className:"hover:underline mt-2 text-sm",style:{color:"var(--theme-accent)"},children:"Pulisci ricerca"})]})]})})]})]})]}):a.jsxs("div",{className:"h-screen flex flex-col overflow-hidden transition-colors duration-300 relative",style:{backgroundColor:Qe.colors.bgMain,color:Qe.colors.text,"--theme-bg-main":Qe.colors.bgMain,"--theme-bg-panel":Qe.colors.bgPanel,"--theme-border":Qe.colors.border,"--theme-text":Qe.colors.text,"--theme-text-muted":Qe.colors.textMuted,"--theme-accent":Qe.colors.accent,touchAction:"none"},children:[a.jsx("style",{children:`
         .no-scrollbar::-webkit-scrollbar { display: none; }
         .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
         
         /* Classi di utilit per i temi */
         .theme-panel { background-color: var(--theme-bg-panel); border-color: var(--theme-border); color: var(--theme-text); }
         .theme-border { border-color: var(--theme-border); }
         .theme-text { color: var(--theme-text); }
         .theme-text-muted { color: var(--theme-text-muted); }
         .theme-hover:hover { background-color: rgba(128,128,128, 0.1); }
       `}),aa&&a.jsx(_C,{onClose:()=>us(!1),onSave:f=>Hi(v=>[...v,f])}),ti&&a.jsx(yC,{onClose:()=>ni(!1),nodes:se,edges:Ae,groups:we}),y&&a.jsx(IC,{onClose:()=>k(!1),onConfirm:f=>{k(!1),ci(f)}}),ds&&a.jsx(pC,{x:ds.x,y:ds.y,mode:ds.mode,customPresets:Xs,onClose:()=>In(null),onSelect:f=>{fn(v=>v.map(b=>b.id===ds.edgeId?{...b,type:f}:b)),In(null)}}),os&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>zi(!1)}),a.jsxs("div",{className:"h-14 border-b flex items-center px-2 md:px-4 justify-between shrink-0 gap-2 relative z-50 overflow-visible theme-panel border-b theme-border",children:[a.jsxs("div",{className:"flex gap-2 md:gap-3 items-center shrink-0",children:[a.jsx("button",{onClick:()=>L("dashboard"),className:"p-2 theme-hover rounded",children:a.jsx(Zh,{size:20})}),a.jsxs("div",{className:"flex flex-col ml-1",children:[a.jsx("input",{value:Mn,onChange:f=>Wi(f.target.value),className:"bg-transparent font-bold text-sm w-24 md:w-40 outline-none theme-text truncate",placeholder:"Titolo"}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>zi(!os),className:"flex items-center gap-1 text-[10px] uppercase font-bold theme-text-muted hover:text-[var(--theme-accent)]",children:[(Zl=Rn.find(f=>f.id===xt))==null?void 0:Zl.label," ",a.jsx(Tx,{size:10})]}),os&&a.jsx("div",{className:"absolute top-full left-0 mt-1 shadow-lg rounded-lg p-1 w-40 z-50 theme-panel border theme-border",children:Rn.map(f=>a.jsxs("button",{onClick:()=>{It(f.id),zi(!1)},className:"w-full text-left px-2 py-1.5 text-xs rounded theme-hover flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:f.color}})," ",f.label]},f.id))})]})]}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"})]}),a.jsx("div",{className:"flex-1 min-w-0 flex justify-start md:justify-center px-2",children:a.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar w-full md:w-auto md:max-w-full",children:[a.jsx("button",{onClick:()=>tr("M"),title:"Nuovo Maschio (M)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(ef,{style:{color:"var(--theme-accent)"},size:20})}),a.jsx("button",{onClick:()=>tr("F"),title:"Nuova Femmina (F)",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(Jh,{className:"text-pink-600",size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:Lr,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Genitori",children:a.jsx(Ox,{size:18})}),a.jsx("button",{onClick:Kl,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Partner",children:a.jsx(Mo,{size:18})}),a.jsx("button",{onClick:Ql,className:"p-1.5 theme-hover rounded shrink-0",title:"Aggiungi Figlio",children:a.jsx(Ax,{size:18})}),a.jsx("button",{onClick:ql,title:"Gruppo",className:"p-1.5 theme-hover rounded shrink-0",children:a.jsx(Lo,{size:20})}),a.jsx("button",{onClick:G,title:"Aggiungi Nota (N)",className:"p-1.5 theme-hover rounded shrink-0",style:{color:"#f59e0b"},children:a.jsx(tf,{size:20})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:vd,className:"p-1.5 theme-hover rounded shrink-0",style:{color:"var(--theme-accent)"},title:"Auto-Layout",children:a.jsx(Dx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>_t("h"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Orizzontale",children:a.jsx(gu,{size:18})}),a.jsx("button",{onClick:()=>_t("v"),className:"p-1.5 theme-hover rounded shrink-0",title:"Allinea Verticale",children:a.jsx(gu,{className:"rotate-90",size:18})}),a.jsx("button",{onClick:()=>si("align-children"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Figli",children:a.jsx(bx,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("button",{onClick:()=>si("align-parents"),className:"p-1.5 theme-hover rounded shrink-0",title:"Centra Genitori",children:a.jsx(kx,{size:18,style:{color:"var(--theme-accent)"}})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>_t("circle"),className:"p-1.5 theme-hover rounded shrink-0",title:"Cerchio",children:a.jsx(Sx,{size:18})}),a.jsx("button",{onClick:()=>_t("grid"),className:"p-1.5 theme-hover rounded shrink-0",title:"Griglia",children:a.jsx(Cx,{size:18})}),a.jsx("button",{onClick:()=>_t("diagonal"),className:"p-1.5 theme-hover rounded shrink-0",title:"Diagonale",children:a.jsx(Lx,{size:18})}),a.jsx("div",{className:"h-4 w-px bg-gray-300 opacity-30 mx-1 shrink-0"}),a.jsx("button",{onClick:()=>Zs(!On),className:`p-1.5 rounded shrink-0 ${On?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Snap Griglia",children:a.jsx(Px,{size:18})}),a.jsx("button",{onClick:()=>Ul(!Jn),className:`p-1.5 rounded shrink-0 ${Jn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mod. Selezione",children:a.jsx(Rx,{size:18})}),a.jsx("button",{onClick:()=>us(!0),className:"p-1.5 theme-hover rounded shrink-0",title:"Stili",children:a.jsx(vu,{size:18})}),a.jsxs("div",{className:"flex items-center gap-1 border-l pl-2 dark:border-gray-700",children:[a.jsx("label",{className:"text-xs text-gray-500 whitespace-nowrap ml-1",children:"Testo Nodo:"}),a.jsxs("select",{value:ei,onChange:f=>oa(f.target.value),className:"bg-transparent text-xs p-1 rounded border hover:bg-black/5 dark:border-gray-600 dark:hover:bg-white/5 outline-none",children:[a.jsx("option",{value:"age",className:"text-black",children:"Et"}),a.jsx("option",{value:"year",className:"text-black",children:"Anno"}),a.jsx("option",{value:"date",className:"text-black",children:"Data"}),a.jsx("option",{value:"none",className:"text-black",children:"Nessuno"})]})]}),a.jsx("button",{onClick:()=>Xn(!Yn),className:`p-1.5 rounded shrink-0 ${Yn?"bg-black/10 dark:bg-white/10":"theme-hover"}`,title:"Mostra Legenda",children:a.jsx(yu,{size:18})})]})}),a.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[a.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm mr-2 theme-border theme-panel",title:"Stato Sync",children:[Fe==="synced"&&a.jsx(Nx,{className:"text-green-500",size:16}),Fe==="syncing"&&a.jsx(Ub,{className:"text-orange-500 animate-spin",size:16}),Fe==="error"&&a.jsx(Cg,{className:"text-red-500",size:16}),Fe==="offline"&&a.jsx(Cg,{className:"opacity-50",size:16}),a.jsx("span",{className:`text-[10px] font-bold uppercase ${Fe==="synced"?"text-green-600":"opacity-50"}`,children:Fe==="synced"?"SYNC":Fe==="syncing"?"SAVING":"OFFLINE"})]}),a.jsx("button",{onClick:Js,disabled:Ht<=0,className:`p-1.5 rounded ${Ht<=0?"opacity-30":"theme-hover"}`,title:"Annulla",children:a.jsx($b,{size:18})}),a.jsx("button",{onClick:sa,disabled:Ht>=jr.length-1,className:`p-1.5 rounded ${Ht>=jr.length-1?"opacity-30":"theme-hover"}`,title:"Ripristina",children:a.jsx(Bb,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1 hidden md:block"}),a.jsx("button",{onClick:gr,className:"p-1.5 theme-hover rounded hidden md:block",title:"Ricentra",children:a.jsx(Wb,{size:18})}),a.jsx("button",{onClick:()=>mr(f=>Math.max(.2,f-.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(Kb,{size:18})}),a.jsxs("span",{className:"text-xs w-8 text-center hidden md:block",children:[Math.round(hs*100),"%"]}),a.jsx("button",{onClick:()=>mr(f=>Math.min(3,f+.1)),className:"p-1.5 theme-hover rounded hidden sm:block",children:a.jsx(qb,{size:18})}),a.jsx("div",{className:"h-6 w-px bg-gray-300 opacity-30 mx-1"}),a.jsxs("div",{className:"w-10 md:w-32",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(lv,{currentThemeId:Dr,onChange:ia,placement:"bottom"})}),a.jsx("div",{className:"md:hidden",children:a.jsx("button",{onClick:()=>{const f=bs.findIndex(b=>b.id===Dr),v=bs[(f+1)%bs.length];ia(v.id)},className:"p-1.5 theme-hover rounded",children:Qe.type==="dark"?a.jsx(jx,{size:18}):a.jsx(kp,{size:18})})})]}),a.jsx("button",{onClick:()=>ni(!0),className:"p-1.5 theme-hover rounded hidden sm:block",style:{color:"var(--theme-accent)"},title:"Report",children:a.jsx(bo,{size:20})}),a.jsxs("div",{className:"relative group z-50",children:[a.jsx("button",{className:"p-1.5 theme-hover rounded font-bold",style:{color:"var(--theme-accent)"},title:"Esporta",children:a.jsx(Ep,{size:20})}),a.jsxs("div",{className:"absolute right-0 top-full theme-panel border theme-border shadow-lg rounded p-3 hidden group-hover:block w-64 z-[70]",children:[a.jsxs("div",{className:"mb-3 pb-3 border-b theme-border",children:[a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-2",children:"Qualit Immagine"}),a.jsxs("div",{className:"flex bg-black/5 dark:bg-white/5 rounded p-1 gap-1 items-center",children:[[1,2,4,6].map(f=>a.jsxs("button",{onClick:v=>{v.stopPropagation(),ca(f)},className:`flex-1 text-[10px] py-1.5 rounded transition-all font-medium ${ri===f?"theme-panel shadow text-[var(--theme-accent)]":"opacity-50"}`,children:[f,"x"]},f)),a.jsx("div",{className:"w-px h-4 bg-gray-300 opacity-30 mx-0.5"}),a.jsx("div",{className:"relative group/input",children:a.jsx("input",{type:"number",min:"1",max:"12",value:ri,onClick:f=>f.stopPropagation(),onChange:f=>{const v=parseInt(f.target.value);isNaN(v)||ca(Math.max(1,Math.min(12,v)))},className:"w-10 text-[10px] py-1 rounded border-none bg-transparent text-center outline-none font-bold text-[var(--theme-accent)]",placeholder:"#"})})]})]}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Immagini"}),a.jsxs("button",{onClick:()=>li("png"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Vb,{size:14})," Scarica PNG"]}),a.jsxs("button",{onClick:()=>li("jpeg"),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(Rb,{size:14})," Scarica JPEG"]}),a.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-600 my-2 opacity-30"}),a.jsx("div",{className:"text-[10px] uppercase font-bold opacity-50 mb-1 px-2",children:"Documenti"}),a.jsxs("button",{onClick:Xi,className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(bo,{size:14})," PDF Vettoriale (Solo Grafico)"]}),a.jsxs("button",{onClick:()=>k(!0),className:"block w-full text-left p-2 theme-hover text-xs rounded flex items-center gap-2",children:[a.jsx(bo,{size:14})," Report Clinico (Completo)"]})]})]})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden relative print:overflow-visible",children:[a.jsx("div",{ref:n,className:"flex-1 overflow-auto relative",style:{touchAction:"none"},children:a.jsxs("div",{style:{width:mi,height:mi},className:"relative print:w-full print:h-full",children:[a.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none print:hidden",style:{backgroundImage:"radial-gradient(currentColor 1px, transparent 1px)",backgroundSize:`${nv}px ${nv}px`,color:"var(--theme-text-muted)"}}),On&&a.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none print:hidden",style:{backgroundImage:"radial-gradient(currentColor 1.5px, transparent 1.5px)",backgroundSize:`${ke}px ${ke}px`,color:"var(--theme-text-muted)"}}),a.jsx("svg",{ref:t,width:mi,height:mi,className:`block touch-none ${la?je!=null&&je.active?"cursor-grabbing":"cursor-grab":""}`,style:{touchAction:"none"},onContextMenu:f=>{f.preventDefault(),f.stopPropagation()},onPointerDown:oi,onTouchStart:R,onTouchMove:D,onTouchEnd:A,children:a.jsxs("g",{ref:e,transform:`scale(${hs})`,style:{transformOrigin:`${Pt}px ${Pt}px`},children:[we.map(f=>{const v=kc(f,se);if(!v)return null;const{d:b,cx:P,cy:F}=v,O=ln.includes(f.id),B=f.color==="#000000"&&cs?"#ffffff":f.color,U=f.labelPos?f.labelPos.x:P,Q=f.labelPos?f.labelPos.y:Math.min(...v.expandedPoints.map(W=>W.y))-20;return a.jsxs("g",{onClick:W=>{W.stopPropagation(),Ct([f.id]),Ze([])},children:[a.jsx("path",{d:b,fill:B,fillOpacity:.05,stroke:B,strokeDasharray:"10,5",strokeWidth:O?3:2,strokeLinejoin:"round",className:O?"stroke-blue-500 cursor-move":"cursor-pointer",onPointerDown:W=>{W.stopPropagation(),Ct([f.id]),Ze([])}}),f.showLabel!==!1&&a.jsxs("g",{transform:`translate(${U}, ${Q})`,className:"cursor-move",onPointerDown:W=>{W.stopPropagation(),W.preventDefault();const{x:ee,y:J}=qt(W);x.current={active:!0,type:"group-label",sourceId:f.id,startX:ee,startY:J,currX:ee,currY:J,initialNodePositions:{[f.id]:{x:U,y:Q}},pointerId:W.pointerId},pt({...x.current})},children:[a.jsx("rect",{x:-(f.label.length*4)-10,y:"-12",width:f.label.length*8+20,height:"24",fill:Qe.colors.bgPanel,fillOpacity:"0.8",rx:"4",stroke:O?"blue":"transparent"}),a.jsx("text",{textAnchor:"middle",dy:"5",fill:B,className:"text-xs font-bold uppercase select-none pointer-events-none",children:f.label})]})]},f.id)}),Ae.map(f=>{let v=sv(f.fromId,se,we),b=sv(f.toId,se,we);if(!v||!b)return null;const P=we.find(W=>W.id===f.toId);if(P){const W=kc(P,se);W&&(f.toAnchor!==void 0?b=av(W.controlPoints,f.toAnchor):b=ov(W.expandedPoints,v))}const F=we.find(W=>W.id===f.fromId);if(F){const W=kc(F,se);W&&(f.fromAnchor!==void 0?v=av(W.controlPoints,f.fromAnchor):v=ov(W.expandedPoints,b))}const O=se.find(W=>W.id===f.fromId),B=se.find(W=>W.id===f.toId),U=f.type.startsWith("twin");if((f.type.startsWith("child")||U)&&O&&B){const W=rv(f.fromId,Ae);if(W){const ee=se.find(le=>le.id===W.fromId),J=se.find(le=>le.id===W.toId);ee&&J&&(v={x:(ee.x+J.x+Vt)/2,y:Math.max(ee.y,J.y)+oC})}else v={x:O.x+Vt/2,y:O.y+br}}const Q=Xs.find(W=>W.id===f.type);return a.jsx("g",{onClick:W=>{W.stopPropagation(),gd(f.id,W)},children:a.jsx(hC,{edge:f,start:v,end:b,isSelected:et.includes(f.id),darkMode:cs,customConfig:Q,onAddChild:(W,ee)=>ii(W,ee),isTargetGroup:we.some(W=>W.id===f.toId),tNode:B})},f.id)}),je&&je.type!=="move"&&je.type!=="box"&&je.type!=="pan"&&a.jsx("line",{x1:je.startX,y1:je.startY,x2:je.currX,y2:je.currY,stroke:"gray",strokeDasharray:"5,5"}),je&&je.type==="move"&&de.map(f=>{var U,Q;if(!se.find(W=>W.id===f))return null;const b=(Q=(U=x.current)==null?void 0:U.initialNodePositions)==null?void 0:Q[f];if(!b)return null;const P=je.currX-je.startX,F=je.currY-je.startY;let O=b.x+P,B=b.y+F;return On&&(O=Math.round(O/ke)*ke,B=Math.round(B/ke)*ke),a.jsx("rect",{x:O,y:B,width:Vt,height:br,fill:"none",stroke:"gray",strokeDasharray:"2,2"},f)}),se.map(f=>{var b;const v=o?(b=we.find(P=>P.id===o))==null?void 0:b.memberIds.includes(f.id):!1;return a.jsxs("g",{onPointerDown:P=>Hl(P,f.id),style:{touchAction:"none"},children:[o&&a.jsx("circle",{cx:f.x+Vt/2,cy:f.y+br/2,r:Vt,fill:"none",stroke:v?"#22c55e":"transparent",strokeWidth:3,strokeDasharray:v?"":"4,2",className:"pointer-events-none transition-all duration-300",opacity:v?1:.3}),a.jsx(fC,{node:f,isSelected:de.includes(f.id),showLabelType:ei,darkMode:cs,onHandleDown:Wl,selectionMode:Jn,onRename:(P,F)=>rt(O=>O.map(B=>B.id===P?{...B,name:F}:B))})]},f.id)}),(()=>{if(!Yn)return null;const f=Yl();return a.jsx(uC,{x:f.minX-350,y:f.minY,darkMode:cs,nodes:se,edges:Ae})})(),je&&je.type==="box"&&a.jsx("rect",{x:Math.min(je.startX,je.currX),y:Math.min(je.startY,je.currY),width:Math.abs(je.currX-je.startX),height:Math.abs(je.currY-je.startY),fill:"rgba(0,0,255,0.1)",stroke:"blue"}),we.map(f=>{if(!ln.includes(f.id))return null;const v=kc(f,se);if(!v)return null;const{cx:b,cy:P}=v,F=f.customPadding||50;return a.jsxs("g",{children:[a.jsxs("g",{transform:`translate(${b-F-20}, ${P})`,className:"cursor-crosshair",style:{touchAction:"none"},onPointerDown:O=>{O.stopPropagation(),O.preventDefault(),md(O,f.id)},children:[a.jsx("rect",{x:-10,y:-10,width:20,height:20,rx:4,fill:"#f59e0b",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx(Ip,{size:12,x:-6,y:-6,color:"white"}),a.jsx("title",{children:"Crea Relazione"})]}),a.jsxs("g",{transform:`translate(${b}, ${P+F+10})`,className:"cursor-ns-resize",style:{touchAction:"none"},onPointerDown:O=>{O.stopPropagation(),O.preventDefault();const{x:B,y:U}=qt(O);x.current={active:!0,type:"group-padding",sourceId:f.id,startX:B,startY:U,currX:B,currY:U,initialPadding:F,pointerId:O.pointerId},pt({...x.current})},children:[a.jsx("path",{d:"M0 -8 L8 0 L0 8 L-8 0 Z",fill:"#8b5cf6",stroke:"white",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}}),a.jsx("title",{children:"Regola Grandezza"})]})]},`handles-${f.id}`)}),u.map(f=>a.jsx(kC,{note:f,zoom:hs,isSelected:m.includes(f.id),onPointerDown:v=>pd(v,f.id),onUpdate:v=>{h(b=>b.map(P=>P.id===v.id?v:P))}},f.id)),a.jsx(EC,{nodes:se,selectedIds:de,onHandleDown:Qi,onMove:Ye})]})})]})}),(de.length>0||et.length>0||ln.length>0||m.length>0)&&a.jsxs("div",{className:"w-80 border-l p-4 overflow-y-auto theme-panel theme-border print:hidden flex flex-col h-full shadow-xl z-50",children:[a.jsxs("h3",{className:"font-bold mb-4 flex justify-between items-center shrink-0",children:["Propriet",a.jsx("button",{onClick:()=>{Ze([]),pn([]),Ct([]),g([])},className:"p-1 hover:bg-red-100 hover:text-red-600 rounded transition-colors",children:a.jsx(Us,{size:18})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-6",children:[He&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border font-bold",value:He.name,onChange:f=>rt(se.map(v=>v.id===He.id?{...v,name:f.target.value}:v)),placeholder:"Nome"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:He.label||"",onChange:f=>rt(se.map(v=>v.id===He.id?{...v,label:f.target.value}:v)),placeholder:"Etichetta (es. Padre)"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:He.birthDate,onChange:f=>rt(se.map(v=>v.id===He.id?{...v,birthDate:f.target.value}:v)),placeholder:"Nascita (Data, Anno o inserisci direttamente un'Et)"}),a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("input",{type:"checkbox",id:"showAge",checked:He.showAge!==!1,onChange:f=>rt(se.map(v=>v.id===He.id?{...v,showAge:f.target.checked}:v))}),a.jsx("label",{htmlFor:"showAge",className:"text-xs opacity-70",children:"Mostra Et"})]}),a.jsxs("div",{className:"text-xs opacity-50",children:["Et: ",xl(He.birthDate)]}),a.jsxs("select",{className:"w-full border p-1 rounded bg-transparent theme-border",value:He.gender,onChange:f=>rt(se.map(v=>v.id===He.id?{...v,gender:f.target.value}:v)),children:[a.jsx("option",{value:"M",className:"text-black",children:"Maschio"}),a.jsx("option",{value:"F",className:"text-black",children:"Femmina"}),a.jsx("option",{value:"TransWoman",className:"text-black",children:"Donna Trans (MTF)"}),a.jsx("option",{value:"TransMan",className:"text-black",children:"Uomo Trans (FTM)"}),a.jsx("option",{value:"NonBinary",className:"text-black",children:"Non-Binary/Genderqueer"}),a.jsx("option",{value:"Pet",className:"text-black",children:"Animale"}),a.jsx("option",{value:"Pregnancy",className:"text-black",children:"Gravidanza"}),a.jsx("option",{value:"Miscarriage",className:"text-black",children:"Aborto Spontaneo"}),a.jsx("option",{value:"Abortion",className:"text-black",children:"Aborto Volontario"}),a.jsx("option",{value:"Stillbirth",className:"text-black",children:"Morto alla nascita"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${He.deceased?"bg-black text-white dark:bg-white dark:text-black":"theme-border hover:bg-black/5"}`,onClick:()=>rt(se.map(f=>f.id===He.id?{...f,deceased:!f.deceased}:f)),children:"Deceduto"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${He.indexPerson?"bg-blue-600 text-white":"theme-border hover:bg-blue-50"}`,onClick:()=>rt(se.map(f=>f.id===He.id?{...f,indexPerson:!f.indexPerson}:f)),children:"Pz. Designato"}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${He.substanceAbuse?"bg-orange-500 text-white":"theme-border hover:bg-orange-50"}`,onClick:()=>rt(se.map(f=>f.id===He.id?{...f,substanceAbuse:!f.substanceAbuse}:f)),children:"Abuso Sost."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${He.mentalIssue?"bg-purple-500 text-white":"theme-border hover:bg-purple-50"}`,onClick:()=>rt(se.map(f=>f.id===He.id?{...f,mentalIssue:!f.mentalIssue}:f)),children:"Problema Psi."}),a.jsx("button",{className:`border px-2 py-1 text-xs rounded transition-colors ${He.gayLesbian?"bg-pink-500 text-white":"theme-border hover:bg-pink-50"}`,onClick:()=>rt(se.map(f=>f.id===He.id?{...f,gayLesbian:!f.gayLesbian}:f)),children:"Omosessuale"})]}),a.jsx(sh,{notes:He.notes,onChange:f=>rt(se.map(v=>v.id===He.id?{...v,notes:f}:v))}),a.jsxs("button",{onClick:()=>{rt(se.filter(f=>!de.includes(f.id))),fn(Ae.filter(f=>!de.includes(f.fromId)&&!de.includes(f.toId))),Ze([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Persona"]})]}),_e&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[we.some(f=>f.id===_e.fromId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Partenza"}),a.jsxs("span",{children:[Math.round((_e.fromAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(_e.fromAnchor??-1)===-1?0:_e.fromAnchor*100,onChange:f=>{const v=parseInt(f.target.value)/100;fn(b=>b.map(P=>P.id===_e.id?{...P,fromAnchor:v}:P))}}),a.jsx("button",{onClick:()=>fn(f=>f.map(v=>v.id===_e.id?{...v,fromAnchor:void 0}:v)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),we.some(f=>f.id===_e.toId)&&a.jsxs("div",{className:"pt-2 border-t theme-border",children:[a.jsxs("div",{className:"flex justify-between text-xs mb-1 opacity-70",children:[a.jsx("span",{children:"Punto di Arrivo"}),a.jsxs("span",{children:[Math.round((_e.toAnchor??0)*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--theme-accent)]",value:(_e.toAnchor??-1)===-1?0:_e.toAnchor*100,onChange:f=>{const v=parseInt(f.target.value)/100;fn(b=>b.map(P=>P.id===_e.id?{...P,toAnchor:v}:P))}}),a.jsx("button",{onClick:()=>fn(f=>f.map(v=>v.id===_e.id?{...v,toAnchor:void 0}:v)),className:"text-[10px] text-blue-500 hover:underline mt-1",children:"Reset Automatico"})]}),a.jsx("label",{className:"text-xs opacity-50 font-bold block",children:"Tipo Relazione"}),a.jsx(dC,{value:_e.type,onChange:f=>{const v=nn[f]||{};fn(b=>b.map(P=>P.id===_e.id?{...P,type:f,color:v.color,lineStyle:v.lineStyle,decorator:v.decorator}:P))},className:"text-black"}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:_e.label,onChange:f=>fn(v=>v.map(b=>b.id===_e.id?{...b,label:f.target.value}:b)),placeholder:"Etichetta"}),a.jsx(sh,{notes:_e.notes,onChange:f=>fn(v=>v.map(b=>b.id===_e.id?{...b,notes:f}:b))}),a.jsxs("button",{onClick:()=>{fn(Ae.filter(f=>f.id!==_e.id)),pn([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Relazione"]})]}),Tt&&a.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-200",children:[a.jsx("label",{className:"text-xs opacity-50 font-bold",children:"Tipo Gruppo"}),a.jsxs("select",{className:"w-full p-2 rounded border bg-transparent theme-border",value:Tt.type,onChange:f=>Ln(we.map(v=>v.id===Tt.id?{...v,type:f.target.value}:v)),children:[a.jsx("option",{value:"household",className:"text-black",children:"Household"}),a.jsx("option",{value:"subsystem",className:"text-black",children:"Sottosistema"})]}),a.jsxs("button",{onClick:()=>c(Tt.id),className:`w-full py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors border ${o===Tt.id?"bg-green-100 text-green-700 border-green-300":"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100"}`,children:[o===Tt.id?a.jsx(Ix,{size:14}):a.jsx(vu,{size:14}),o===Tt.id?"Fine Modifica Membri":"Modifica Membri"]}),o===Tt.id&&a.jsxs("div",{className:"text-[10px] opacity-70 text-center bg-yellow-50 dark:bg-yellow-900/10 p-2 rounded text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-800",children:[a.jsx(yu,{size:10,className:"inline mr-1"})," Clicca sulle persone nel grafico per aggiungerle o rimuoverle dal gruppo."]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2 pt-2 border-t theme-border",children:[a.jsx("input",{type:"checkbox",id:"showLabel",checked:Tt.showLabel!==!1,onChange:f=>Ln(we.map(v=>v.id===Tt.id?{...v,showLabel:f.target.checked}:v))}),a.jsx("label",{htmlFor:"showLabel",className:"text-xs",children:"Mostra Etichetta"})]}),a.jsx("input",{className:"w-full border p-1 rounded bg-transparent theme-border",value:Tt.label,onChange:f=>Ln(we.map(v=>v.id===Tt.id?{...v,label:f.target.value}:v)),placeholder:"Etichetta Gruppo"}),a.jsx("div",{className:"border theme-border rounded p-2 bg-black/5 dark:bg-white/5",children:a.jsx(gC,{value:Tt.color,onChange:f=>Ln(we.map(v=>v.id===Tt.id?{...v,color:f}:v))})}),a.jsx(sh,{notes:Tt.notes,onChange:f=>Ln(we.map(v=>v.id===Tt.id?{...v,notes:f}:v))}),a.jsxs("button",{onClick:()=>{Ln(we.filter(f=>f.id!==Tt.id)),Ct([])},className:"w-full bg-red-100 text-red-600 py-2 rounded text-xs hover:bg-red-200 mt-4 flex items-center justify-center gap-2",children:[a.jsx(Ta,{size:14})," Elimina Gruppo"]})]}),m.length===1&&(()=>{const f=u.find(v=>v.id===m[0]);return f?a.jsx(bC,{note:f,onUpdate:v=>{h(b=>b.map(P=>P.id===f.id?{...P,...v}:P))},onDelete:()=>{if(confirm("Eliminare questa nota?")){const v=u.filter(b=>b.id!==f.id);pr(se,Ae,we,v),g([])}}}):null})()]})]}),ae&&a.jsxs("div",{className:"fixed z-[9999] flex flex-col gap-2 p-3 rounded-xl shadow-2xl theme-panel theme-border border animate-in fade-in zoom-in duration-200",style:{left:ae.x-75,top:ae.y-100},children:[a.jsx("div",{className:"text-[10px] font-bold opacity-50 text-center uppercase mb-1",children:"Aggiungi"}),a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsxs("button",{onClick:()=>{Yi("M",ae.gx,ae.gy),fe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(ef,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"M"})]}),a.jsxs("button",{onClick:()=>{Yi("F",ae.gx,ae.gy),fe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-pink-50 dark:hover:bg-pink-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-full shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(Jh,{size:20,className:"text-black dark:text-white"})}),a.jsx("span",{className:"text-xs font-bold",children:"F"})]}),a.jsxs("button",{onClick:()=>{G(ae.gx,ae.gy),fe(null)},className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-yellow-50 dark:hover:bg-yellow-900/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded shadow-sm border theme-border bg-white dark:bg-gray-800 flex items-center justify-center",children:a.jsx(tf,{size:20,className:"text-yellow-500"})}),a.jsx("span",{className:"text-xs font-bold",children:"Nota"})]})]}),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 w-3 h-3 bg-inherit border-b border-r theme-border rotate-45 transform"}),a.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>fe(null)})]})]})," "]})}class SC extends _v.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Errore Critico di Avvio:",e,n)}render(){var e,n;return this.state.hasError?a.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"800px",margin:"0 auto"},children:[a.jsx("h1",{style:{color:"#dc2626",fontSize:"1.5rem",marginBottom:"1rem"},children:"Si  verificato un errore critico"}),a.jsx("p",{style:{marginBottom:"1rem",color:"#4b5563"},children:"L'applicazione non  riuscita ad avviarsi. Ecco i dettagli tecnici:"}),a.jsxs("div",{style:{backgroundColor:"#f3f4f6",padding:"1rem",borderRadius:"0.5rem",overflow:"auto",border:"1px solid #e5e7eb"},children:[a.jsx("code",{style:{color:"#dc2626",fontSize:"0.875rem"},children:(e=this.state.error)==null?void 0:e.message}),a.jsx("pre",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"#374151"},children:(n=this.state.error)==null?void 0:n.stack})]}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1.5rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontWeight:"bold"},children:"Ricarica Applicazione"})]}):this.props.children}}const cv=document.getElementById("root");cv?ih.createRoot(cv).render(a.jsx(_v.StrictMode,{children:a.jsx(SC,{children:a.jsx(TC,{})})})):document.body.innerHTML=`<div style="color: red; padding: 20px; font-weight: bold;">ERRORE FATALE: Impossibile trovare l'elemento con id="root" nel file index.html.</div>`;export{Tp as W};
